<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.16" />

  <title>Etc &middot; tanaike</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  
  <link rel="alternate" type="application/rss+xml" title="tanaike" href="https://tanaikech.github.io/topics/etc/index.xml" />
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://tanaikech.github.io/topics/etc/index.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2016. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Etc</h1>
</div>

<div class="content">
  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/04/17/comprehension-of-gas">Comprehension of GAS</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Apr 2017, 08:16</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  Here, I would like to introduce a comprehension of GAS. Input : var data = [[[0], [1], [2], [3]], [[4], [5], [6], [7]]]; Output : [[0.0, 2.0], [0.0, 2.0]] Pattern 1 var a = []; for (var i=0; i&lt;data.length; i++) { var temp = []; for (var j=0; j&lt;data[i].length; j++) { if (data[i][j][0] % 2 == 0) temp.push(j); } a.push(temp); } Logger.log(a) Pattern 2 var b = []; data.forEach(function(e1){ var temp = []; e1.forEach(function(e2, i2){ if (e2[0] % 2 == 0) temp.push(parseInt(i2, 10)); }); b.push(temp); }); Logger.log(b) Pattern 3 var c = [[parseInt(i, 10) for (i in e) if (e[i][0] % 2 == 0)] for each (e in data)]; Logger.log(c) GAS can use JavaScript 1.7.
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/04/17/comprehension-of-gas">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/04/15/creating-spreadsheet-from-excel-file">Creating Spreadsheet from Excel file</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15 Apr 2017, 10:39</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  These scripts can be executed on Script Editor. But, in order to use these, you have to enable Drive API of Advanced Google services and of Google API Console. &ldquo;Drive API v2&rdquo; can be used at Google Apps Script by enabling Drive API of Advanced Google services and of Google API Console. How to use it is as follows. In the script editor, select Resources &gt; Advanced Google services In the dialog that appears, click the on/off switch for Drive API v2.
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/04/15/creating-spreadsheet-from-excel-file">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/04/14/creating-downloaded-excel-file-as-spreadsheet">Creating Downloaded Excel file as Spreadsheet</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>14 Apr 2017, 18:03</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  This is a sample GAS script to create an Excel file, which was downloaded from web, as Spreadsheet. By using Drive API, it can be achieved without access token. Script : function downloadFile(fileURL, folder) { var filename = fileURL.match(&quot;.+/(.+?)([\?#;].*)?$&quot;)[1]; var response = UrlFetchApp.fetch(fileURL); var rc = response.getResponseCode(); var blob = response.getBlob(); var resource = { &quot;mimeType&quot;: &quot;application/vnd.google-apps.spreadsheet&quot;, &quot;parents&quot;: [{id: folder}], &quot;title&quot;: filename }; var res = Drive.Files.insert(resource, blob); var fileInfo
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/04/14/creating-downloaded-excel-file-as-spreadsheet">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/04/09/removes-duplicate-json-elements-for-a-value-of-a-certain-key">Removes Duplicate JSON Elements for a Value of a Certain Key</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Apr 2017, 14:24</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  This sample removes duplicate JSON elements for a value of a certain key. When the value of the certain key is removed, only a first duplicate element is left. Also I had wanted to be used for Google Apps Script. So it became like this. Script : function removeDup(arr, key){ var temp = []; var out = []; arr.forEach( function (e, i) { temp[i] = (temp.indexOf(e[key]) === -1) ? e[key]
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/04/09/removes-duplicate-json-elements-for-a-value-of-a-certain-key">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/03/31/flattening-nested-array-using-coffeescript">Flattening Nested Array using CoffeeScript</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>31 Mar 2017, 10:48</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/coffeescript">CoffeeScript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  This sample flattens a nested array using CoffeeScript. flatten = (array) -&gt; array.reduce(((x, y) -&gt; if Array.isArray(y) then x.concat(flatten(y)) else x.concat(y)), []) console.log flatten [1, [2, 3, [4, 5]], 6, [7, [8, [9], 10] ,11 , 12], 13] &gt;&gt;&gt; [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13 ]
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/03/30/how-to-use-fields-of-drive-apis">How to use &#34;fields&#34; of Drive APIs</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Mar 2017, 08:53</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  There are a lot of APIs on Google. When we use Google Drive APIs, they usually have &ldquo;fields&rdquo; as a resource. The parameter &ldquo;fields&rdquo; gives various information which is selected to us. This is one of important parameters. And this can be used at Google Apps Script (GAS) although that version is v2. About how to use it, there are some documents. But it is difficult to find how to use it at GAS.
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/03/30/how-to-use-fields-of-drive-apis">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/03/29/retrieve-old-revision-file-from-google-drive">Retrieve old revision file from Google Drive</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>29 Mar 2017, 16:00</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/curl">curl</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/wget">wget</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  I introduce 2 kinds of methods. One is to use curl. Another is to use wget. At this time, I could know that wget can be also used as same as curl. 1. File ID Retrieve file id from file name. curl -X GET -sSL \ -H 'Authorization: Bearer ### Access token ###' \ 'https://www.googleapis.com/drive/v3/files?q=name=&quot;### FileName ###&quot;&amp;fields=files(id,name)' wget -q --header='Authorization: Bearer ### Access token ###' \ 'https://www.googleapis.com/drive/v3/files?q=name=&quot;### FileName ###&quot;&amp;fields=files(id,name)' \ -O out.txt Reference : https://developers.google.com/drive/v3/reference/files/list 2.
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/03/29/retrieve-old-revision-file-from-google-drive">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/03/29/put-a-channel-to-a-channel-for-golang">Put a channel to a channel for golang</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>29 Mar 2017, 07:53</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/go">go</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  I have never heard this. I would like to use this from now. package main import &quot;fmt&quot; type st struct { data1 int data2 int } func main() { c1 := make(chan *st, 1) c2 := make(chan *st, 1) c1 &lt;- &amp;st{1, 2} c2 &lt;- &lt;-c1 close(c1) close(c2) res, _ := &lt;-c2 fmt.Println(res.data2) } &gt;&gt;&gt; 2
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/03/23/retrieving-file-id-from-file-name-using-gas">Retrieving File ID from File Name using GAS</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>23 Mar 2017, 14:24</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  This is a sample script of GAS for converting file name to file id on Google Drive. Drive API is used for this. So please enable Drive API at Advanced Drive Services and Google API Console. function nameToId(filename){ return [i.id for each (i in Drive.Files.list({q: &quot;title='&quot; + filename + &quot;' and trashed=false&quot;}).items)]; }
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/03/21/transposing-array-from-n-x-m-to-m-x-n">Transposing Array From (n x m) To (m x n)</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>21 Mar 2017, 08:55</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  This script transposes from an array with n rows x m columns to the array with m rows x n columns. In this script, you can use array of n != m. array = [ [a1, b1, c1, d1, e1], [a2, b2, c2, d2, e2], [a3, b3, c3, d3, e3], [a4, b4, c4, d4, e4], [a5, b5, c5, d5, e5], [a6, b6, c6, d6, e6], [a7, b7, c7, d7, e7],
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/03/21/transposing-array-from-n-x-m-to-m-x-n">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/03/20/download-files-without-authorization-from-google-drive">Download Files Without Authorization From Google Drive</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>20 Mar 2017, 14:30</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  Overview In this article, files can be downloaded without authorization. Description When we download files from Google Drive, it usually has to use Drive API. In order to use Drive API, access token is required. If you want to make your friends download files from your Google Drive, the authorization process is to take time. Also Web Link for each files can be used. But it has to set for each files.
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/03/20/download-files-without-authorization-from-google-drive">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/03/13/create-folder-tree-on-google-drive">Create Folder Tree on Google Drive</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Mar 2017, 13:27</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  This is a sample script for creating a folder tree including all folders in Google Drive. For each element, parent folder and sub folder are retrieved. Script : var results = (function(folder, folderSt, results){ var ar = []; var folders = folder.getFolders(); while(folders.hasNext()) ar.push(folders.next()); folderSt += folder.getName() + &quot;(&quot; + folder.getId() + &quot;)-&quot;; var array_folderSt = folderSt.split(&quot;-&quot;); array_folderSt.pop() results.push(array_folderSt); ar.length == 0 &amp;&amp; (folderSt = &quot;&quot;); for (var i in ar) arguments.callee(ar[i], folderSt, results); return results; })(DriveApp.getRootFolder(),&quot;&quot;,[]); Result : [ [foldername1(folder1 id)], [foldername1(folder1 id), sub foldername1s(sub folde1s id)], [foldername1(folder2 id)], [foldername2(folder2 id), sub foldername2s1(sub folde2s1 id)], [foldername2(folder2 id), sub foldername2s1(sub folde2s1 id), sub foldername2s2(sub folde2s2 id)] ] By the way : ar.length == 0 &amp;&amp; (folderSt = &quot;&quot;); if (ar.length == 0) { folderSt = &quot;&quot;; } Both scripts are the same meaning.
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/24/gogauth">gogauth</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>24 Feb 2017, 12:29</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/golang">golang</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google">Google</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/cli">CLI</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  Released a CLI tool for easily retrieving accesstoken from Google OAuth2. The title is gogauth. When I have seen stackoverflow, I knew that it is difficult to retrieve accesstoken from Google OAuth2. So I made this. Features of this CLI tool are as follows. Retrieves easily accesstoken from Google OAuth2 for using Drive API. If you have PhantomeJS, this retrieves &ldquo;code&rdquo; from Google using it. So you don&rsquo;t need to launch your browser for retrieving &ldquo;code&rdquo;.
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/02/24/gogauth">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/20/export-csv-file-from-spreadsheet-and-make-download-button">Export CSV File from Spreadsheet and Make Download Button</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>20 Feb 2017, 10:00</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/"></a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/"></a>
    
  </div>
  
  

</div>

  </header>

  <p>
  This is a script to export a CSV file from spreadsheet and make an user download it. When the users download it, they can download by push a button made by this script. In order to use this script, put both HTML and script in a GAS project. html : This file name is &ldquo;download.html&rdquo;. &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;body&gt; Download CSV? &lt;form&gt; &lt;input type=&quot;button&quot; value=&quot;ok&quot; onclick=&quot;google.script.run .withSuccessHandler(executeDownload) .saveAsCSV();&quot; /&gt; &lt;/form&gt; &lt;/body&gt; &lt;script&gt; function executeDownload(url) { window.location.href = url; } &lt;/script&gt; &lt;/html&gt; Script : function onOpen() { SpreadsheetApp.getUi() .createMenu('csv') .addItem('export as csv files', 'dialog') .addToUi(); } function dialog() { var html = HtmlService.createHtmlOutputFromFile('download'); SpreadsheetApp.getUi().showModalDialog(html, 'CSV download dialog'); } function saveAsCSV() { var filename = &quot;#####&quot;; // CSV file name var folder = &quot;#####&quot;; // Folder ID var csv = &quot;&quot;; var v = SpreadsheetApp .getActiveSpreadsheet() .getActiveSheet() .getDataRange() .getValues(); v.forEach(function(e) { csv += e.join(&quot;,&quot;) + &quot;\n&quot;; }); var url = DriveApp.getFolderById(folder) .createFile(filename, csv, MimeType.CSV) .getDownloadUrl() .replace(&quot;?e=download&amp;gd=true&quot;,&quot;&quot;); return url; } Process : Using &ldquo;onOpen()&rdquo;, it addes menu for launching a dialog.
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/02/20/export-csv-file-from-spreadsheet-and-make-download-button">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/20/send-e-mail-with-xlsx-file-converted-from-spreadsheet">Send E-mail with xlsx File Converted from Spreadsheet</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>20 Feb 2017, 09:56</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/mail">mail</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  This is a script to send e-mail with a xlsx file converted from spreadsheet as an attachment file. Access token is necessary to use this script. function excelSender() { var accesstoken = &quot;[your accesstoken]&quot;; var sheetID = &quot;[sheet id]&quot;; var xlsxName = &quot;[output xlsx file name]&quot; var params = { &quot;headers&quot; : {Authorization: &quot;Bearer &quot; + accesstoken}, &quot;muteHttpExceptions&quot; : true }; var dUrl = &quot;https://www.googleapis.com/drive/v3/files/&quot; + sheetID + &quot;/export?mimeType=application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot; var
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/02/20/send-e-mail-with-xlsx-file-converted-from-spreadsheet">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/17/retrieving-access-token-for-google-drive-api-using-gas">Retrieving Access Token for Google Drive API using GAS</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Feb 2017, 17:25</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/oauth2">OAuth2</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">Drive API</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  These GASs retrieve an access token for using Google Drive API. There are 3 parts. Before you use this, please retrieve client ID, client secret and redirect uri from Google , and choose scopes. 1. Retrieving code from web This is a script to output URL for retrieving &ldquo;code&rdquo; from web. Please retrieve &ldquo;code&rdquo; by import this URL to your browser. After you run this script, using &ldquo;url&rdquo; got from this script, it retrieves &ldquo;code&rdquo;.
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/02/17/retrieving-access-token-for-google-drive-api-using-gas">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/16/send-e-mail-with-excel-file-converted-from-spreadsheet">Send E-mail with Excel file converted from Spreadsheet</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>16 Feb 2017, 11:53</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  This sample script sends an e-mail with an Excel file exported from Spreadsheet as an attachment file. function excelSender() { var sheetID = [Sheet ID]; var xlsxName = [Excel file name]; var params = { &quot;headers&quot; : {Authorization: &quot;Bearer [Retrieved AccessToken]&quot;}, &quot;muteHttpExceptions&quot; : true }; var dUrl = &quot;https://www.googleapis.com/drive/v3/files/&quot; + sheetID + &quot;/export?mimeType=application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot; var xlsxlFile = UrlFetchApp.fetch(dUrl, params).getBlob().setName(xlsxName); MailApp.sendEmail({ to: [Mail address], subject: &quot;sample subject&quot;, body: &quot;sample body&quot;, attachments: [xlsxlFile] }); } Is ScriptApp.getOAuthToken() unstable?
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/02/16/send-e-mail-with-excel-file-converted-from-spreadsheet">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/16/download-a-csv-file-from-spreadsheet-using-google-html-service">Download a CSV File from Spreadsheet Using Google HTML Service</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>16 Feb 2017, 10:31</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  Here, I introduce how to download a CSV file from spreadsheet using Google HTML Service. Using &ldquo;onOpen()&rdquo;, it addes menu for launching a dialog. After launching the dialog, &ldquo;getFileUrl()&rdquo; is launched by pushing a button. &ldquo;getFileUrl()&rdquo; exports a CSV file and outputs download URL. The CSV file is downloaded by &ldquo;executeDownload()&rdquo;. Please put both HTML and GAS to a GAS project. HTML : download.html &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;body&gt; Download CSV? &lt;form&gt; &lt;input type=&quot;button&quot; value=&quot;ok&quot; onclick=&quot;google.script.run .withSuccessHandler(executeDownload) .getFileUrl();&quot; /&gt; &lt;/form&gt; &lt;/body&gt; &lt;script&gt; function executeDownload(url) { window.location.href = url; } &lt;/script&gt; &lt;/html&gt; GAS : function onOpen() { SpreadsheetApp.getUi() .createMenu('export') .addItem('export csv files', 'dialog') .addToUi(); } function dialog() { var html = HtmlService.createHtmlOutputFromFile('download'); SpreadsheetApp.getUi().showModalDialog(html, 'CSV download dialog'); } function getFileUrl() { var filename = &quot;#####&quot;; // CSV file name var folder = &quot;#####&quot;; // Folder ID var csv = &quot;&quot;; var v = SpreadsheetApp // Now spreadsheet is an active sheet.
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/02/16/download-a-csv-file-from-spreadsheet-using-google-html-service">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/13/making-charts-at-spreadsheet">Making charts at spreadsheet</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Feb 2017, 08:57</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/chart">chart</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet(); var chart = sheet.newChart() .setChartType(Charts.ChartType.LINE) .asLineChart() .addRange(sheet.getRange('a1:a21')) .addRange(sheet.getRange('b1:b21')) .addRange(sheet.getRange('c1:c21')) .setColors([&quot;green&quot;, &quot;red&quot;]) .setBackgroundColor(&quot;black&quot;) .setPosition(5, 5, 0, 0) .setPointStyle(Charts.PointStyle.MEDIUM) .setOption('useFirstColumnAsDomain', true) .setOption('height', 280) .setOption('width', 480) .setOption('title', 'Sample chart') .setOption('hAxis', { title: 'x axis', minValue: 0, maxValue: 20, titleTextStyle: { color: '#c0c0c0', fontSize: 20, italic: false, bold: false }, textStyle: { color: '#c0c0c0', fontSize: 12, bold: false, italic: false }, baselineColor: '#c0c0c0', gridlines: { color: '#c0c0c0', count: 4 } }) .setOption('vAxis', {title: 'y axis', minValue: 0, maxValue: 800, titleTextStyle: { color: '#c0c0c0', fontSize: 20, italic: false, bold: false }, textStyle: { color: '#c0c0c0', fontSize: 12, bold: false, italic: false }, baselineColor: '#c0c0c0', gridlines: { color: '#c0c0c0', count: 4 } }) .setOption('legend', { position: 'right', textStyle: { color: 'yellow', fontSize: 16 } }) .build(); sheet.insertChart(chart); Reference pages are here and here.
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/08/file-upload-and-download-with-file-convert-for-curl-using-drive-api">File Upload and Download with File Convert For curl using Drive API</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>08 Feb 2017, 15:50</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google">Google</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">Drive API</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/curl">curl</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  It is necessary to retrieve access token on Google. Scope is as follows. https://www.googleapis.com/auth/drive Other mimetypes can be seen here. Download and convert from Spreadsheet to Excel curl -X GET -sSL \ -H &quot;Authorization: Bearer [Your access token]&quot; \ -o &quot;Excel file name&quot; \ &quot;https://www.googleapis.com/drive/v3/files/[File ID]/export?mimeType=application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot; Upload and convert from Excel to Spreadsheet curl -X POST -sSL \ -H &quot;Authorization: Bearer [Your access token]&quot; \ -F &quot;metadata={ \ name :
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/02/08/file-upload-and-download-with-file-convert-for-curl-using-drive-api">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/08/sample-array-script-for-spreadsheet">Sample Array Script for Spreadsheet</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>08 Feb 2017, 08:50</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  This is a Sample Array Script for Spreadsheet. It makes an 2D array filled by strings and number. The strings and number are column strings and row number, respectively. However, because this is a sample, the maximum column number is 26. function sa(row, col){ if (col &gt; 26) return; var ar = new Array(row); for(var i = 0; i &lt; row; i++) ar[i] = new Array(col); for (var i = 0; i &lt; row; i++){ for (var j = 0; j &lt; col; j++){ ar[i][j] = String.fromCharCode(i + 97) + String(j + 1); } } return ar.map(function(x, i){return x.map(function(y, j){return ar[j][i]})}); } When &ldquo;sa(10,10)&rdquo; is given, following array can be output.
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/02/08/sample-array-script-for-spreadsheet">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/07/event-of-onedit-for-google-spreadsheet">Event of onEdit() for Google spreadsheet</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>07 Feb 2017, 11:03</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  About Event Objects For example, it thinks the situation of input text of &lsquo;test&rsquo; to &lsquo;A1&rsquo; on a sheet. When you use only &lsquo;onEdit(e)&rsquo; without an installing trigger, &lsquo;e&rsquo; has following parameters. {authMode=LIMITED, range=Range, source=Spreadsheet, user=, value=test} In this case, the event cannot send an e-mail because of &lsquo;authMode=LIMITED&rsquo;. When you use &ldquo;onEdit(e)&rdquo; with an installing trigger of &ldquo;Edit&rdquo;, &lsquo;e&rsquo; has following parameters. {authMode=FULL, range=Range, source=Spreadsheet, value=test, triggerUid=#####} In this case, the event can send an e-mail because of &lsquo;authMode=FULL&rsquo;.
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/02/07/event-of-onedit-for-google-spreadsheet">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/05/file-upload-using-dopost-on-google-web-apps">File upload using doPost on Google Web Apps</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>05 Feb 2017, 11:40</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  File upload using HTML form in GAS project Rule Following scripts have to be made into a project of Google Apps Script. Deploy the GAS project as a web application. Ref After updated the script, it has to be updated as a new version. Form.html : &lt;html&gt; &lt;body&gt; &lt;form&gt; &lt;input type=&quot;file&quot; name=&quot;imageFile&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;ok&quot; onclick=&quot;google.script.run.upload(this.parentNode)&quot;&gt; &lt;/form&gt; &lt;/body&gt; &lt;/html&gt; GAS : function doGet() { return HtmlService.createHtmlOutputFromFile('Form.html'); } function upload(e) { var destination_id = '#####'; // Folder ID of destination folder // Reference : https://developers.google.com/apps-script/reference/base/blob#getAs(String) // You can use 'application/pdf', 'image/bmp', 'image/gif', 'image/jpeg' and 'image/png'.
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/02/05/file-upload-using-dopost-on-google-web-apps">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/05/add-next-row-to-current-row-using-awk">Add next row to current row using AWK</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>05 Feb 2017, 11:03</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/one-liner">one-liner</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/awk">awk</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  File.txt : a1 a2 a3 a4 a5 a6 Code : awk '{array[NR]=$0} END {for (i in array) {if (i&gt;1) {{print array[i-1]&quot;,&quot;array[i]}}}}' File.txt Result : a1,a2 a2,a3 a3,a4 a4,a5 a5,a6 After the all rows are imported to an array, it shows next row to current row under a condition of row &gt; 1.
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/03/retrieving-cells-without-blank-using-gas">Retrieving cells without blank using GAS</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>03 Feb 2017, 10:14</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  This is a sample script for retrieving cells without blank cells. Figure 1 shows the sample spreadsheet. In this sheet, the row 14 has one space. Fig. 1: Sample spreadsheet. Data is retrieved as follows. var data = SpreadsheetApp .getActiveSpreadsheet() .getActiveSheet() .getRange('a1:a30') .getValues(); 1. Retrieving cells with spaces and no blank cells. var Result = [i for each (i in data)if (i)].join(''); Result : Hello World 2. Retrieving cells without both spaces and blank cells.
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/02/03/retrieving-cells-without-blank-using-gas">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/01/11/one-liner-code-for-netatmo">One Liner Code for Netatmo</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>11 Jan 2017, 15:00</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/one-liner">one-liner</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/netatmo">netatmo</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/curl">curl</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  I made One Liner Code to retrieve data using Netatmo API. There are 2 ways. One is for windows dos. Another is for unix bash. Requirement tools are curl and jq. windows dos &gt; setlocal &amp; curl -s -d &quot;grant_type=password&amp;client_id='#####'&amp;client_secret='#####'&amp;username='#####'&amp;password='#####'&amp;scope=read_station&quot; &quot;https://api.netatmo.net/oauth2/token&quot; | for /f &quot;usebackq tokens=*&quot; %a in (`jq -r &quot;.access_token&quot;`) do @set a=&quot;%a&quot; | curl -s -d &quot;access_token=%a&amp;device_id='#####'&quot; &quot;https://api.netatmo.net/api/getstationsdata&quot; &gt; dat.txt &amp; for /f &quot;usebackq tokens=*&quot; %b in (`jq -r &quot;.body.devices[0].dashboard_data.Temperature&quot; dat.txt`) do @set b=&quot;%b&quot; | echo: &amp; set /p nb=Indoor: Temperature %b [degree C],&lt;nul &amp; for /f &quot;usebackq tokens=*&quot; %b in (`jq -r &quot;.body.devices[0].dashboard_data.Humidity&quot; dat.txt`) do @set b=&quot;%b&quot; | set /p nb=Humidity %b [%],&lt;nul &amp; for /f &quot;usebackq tokens=*&quot; %b in (`jq -r &quot;.body.devices[0].dashboard_data.Pressure&quot; dat.txt`) do @set b=&quot;%b&quot; | set /p nb=Pressure %b [hPa]&lt;nul &amp; for /f &quot;usebackq tokens=*&quot; %b in (`jq -r &quot;.body.devices[0].modules[0].dashboard_data.Temperature&quot; dat.txt`) do @set b=&quot;%b&quot; | echo: &amp; set /p nb=Outdoor: Temperature %b [degree C],&lt;nul &amp; for /f &quot;usebackq tokens=*&quot; %b in (`jq -r &quot;.body.devices[0].modules[0].dashboard_data.Humidity&quot; dat.txt`) do @set b=&quot;%b&quot; | set /p nb=Humidity %b [%]&lt;nul &amp; del dat.txt Indoor: Temperature 12 [degree C], Humidity 56 [%], Pressure 1000.2 [hPa] Outdoor: Temperature 12.3 [degree C], Humidity 56 [%] unix bash $ curl -s -d &quot;grant_type=password&amp;client_id='#####'&amp;client_secret='#####'&amp;username='#####'&amp;password='#####'&amp;scope=read_station&quot; &quot;https://api.netatmo.net/oauth2/token&quot;|curl -s -d &quot;access_token=`jq -r '.access_token'`&amp;device_id='#####'&quot; &quot;https://api.netatmo.net/api/getstationsdata&quot;|jq -r '&quot;\nIndoor: Temperature &quot;+(.body.devices[0].dashboard_data.Temperature|tostring)+&quot; [degree C], Humidity &quot;+(.body.devices[0].dashboard_data.Humidity|tostring)+&quot; [%], Pressure &quot;+(.body.devices[0].dashboard_data.Pressure|tostring)+&quot; [hPa]\nOutdoor: Temperature &quot;+(.body.devices[0].modules[0].dashboard_data.Temperature|tostring)+&quot; [degree C], Humidity &quot;+(.body.devices[0].modules[0].dashboard_data.Humidity|tostring)+&quot; [%]&quot;' Indoor: Temperature 12 [degree C], Humidity 56 [%], Pressure 1000.2 [hPa] Outdoor: Temperature 12.3 [degree C], Humidity 56 [%] If you want to use these One Liner Codes, you can use following code.
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/01/11/one-liner-code-for-netatmo">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2016/10/21/elements-duplicate-number-in-array-at-python">Element&#39;s Duplicate Number in Array at Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>21 Oct 2016, 12:29</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">Python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/sample">sample</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  Suddenly I had to need this. This script can get the duplicate number of each element in array at Python. In this script, the duplicate number of each element is obtained and sorted by the duplicate number. This was expressed by the comprehension. data = ['a', 'b', 'c', 'd', 'b', 'c', 'd', 'b', 'c', 'b'] result = sorted({i: data.count(i) for i in set(data)}.items(), key=lambda x: x[1], reverse=True) print(result) &gt;&gt;&gt; [('b',
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2016/10/21/elements-duplicate-number-in-array-at-python">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2016/10/20/coffeescript">CoffeeScript</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>20 Oct 2016, 14:34</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/coffeescript">CoffeeScript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  I may be slow a bit, but I could notice much convenience of CoffeeScript just now. I didn&rsquo;t know that scripts of GAS can be made by CoffeeScript up until now. This will have me work more effectively! :D
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2016/09/18/1stpost">1stpost</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>18 Sep 2016, 15:02</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/etc">etc</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/etc">etc</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  This is a first post. Today this blog was launched. I would like to introduce some of my experimental results. I&rsquo;m Japanese. So I&rsquo;ll use both English and Japanese here. Thank you.
  </p>

  
</article>

  
</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    }
  });
</script>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>
<meta http-equiv="X-UA-Compatible" CONTENT="IE=EmulateIE7" />


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-84325623-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>

