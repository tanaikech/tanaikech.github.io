<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="Official profile of Kanshi Tanaike, a Google Developer Expert (GDE) in Google Workspace and Physicist. Specializing in Google Apps Script, Gemini API, and innovative IT solutions.">
  <meta name="generator" content="Hugo 0.157.0">

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tanaikech.github.io/img/og-main.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>tanaike - Google Apps Script, Gemini API Expert & Physicist</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  
  <link rel="alternate" type="application/rss+xml" title="tanaike - Google Apps Script, Gemini API, and Developer Tips"
    href='https://tanaikech.github.io/topics/jstips/index.xml' />
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Kanshi Tanaike",
  "alternateName": "tanaike",
  "url": "https://tanaikech.github.io/",
  "image": "https://tanaikech.github.io/img/og-main.png",
  "jobTitle": "Google Developer Expert",
  "honorificPrefix": "Ph.D.",
  "description": "Japanese scientist, Physicist and Google Developer Expert for Google Workspace.",
  "award": "First place in the Outstanding GDE Award 2025",
  "sameAs": [
    "https://twitter.com/tanaikech",
    "https://github.com/tanaikech",
    "https://stackoverflow.com/users/7108653/tanaike",
    "https://developers.google.com/community/experts/directory?text=tanaike",
    "https://zenn.dev/tanaike",
    "https://medium.com/@tanaike"
  ]
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href='https://tanaikech.github.io/topics/jstips/index.xml'><i
          class="fas fa-rss fa-fw"></i>RSS</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://www.youtube.com/@tanaike" rel="me" target="_blank"><i class="fab fa-youtube-square fa-fw"></i>YouTube</a>
    </li>
    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2026. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>JsTips</h1>
</div>

<div class="content">
  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2025/12/12/updated-gas-library-utlapp/">Updated: GAS Library - UtlApp</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>12 Dec 2025, 16:03</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="utlapp-was-updated-to-v1012">UtlApp was updated to v1.0.12.</h2>
<ul>
<li>
<p>v1.0.12 (December 12, 2025)</p>
<ol>
<li>Updated the method <a href="https://github.com/tanaikech/UtlApp?tab=readme-ov-file#consolidatea1notations">consolidateA1Notations</a>. In the current version, the result is returned as an array. The array includes the combinations of the calculated result. The 1st element of the array is the best calculated result.</li>
</ol>
</li>
</ul>
<p><strong>You can see the detail information here <a href="https://github.com/tanaikech/UtlApp">https://github.com/tanaikech/UtlApp</a></strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2025/06/26/a-practical-analysis-of-the-gemini-apis-url-context-tool/">A Practical Analysis of the Gemini API&#39;s URL Context Tool</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>26 Jun 2025, 11:49</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/6cd666838572f478d69ec8ae660968d9">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20250626a/fig1.jpg" alt=""></p>
<h1 id="introduction">Introduction</h1>
<p>The Gemini API recently introduced the URL context tool, a feature designed to allow the model to directly fetch and utilize content from specified URLs to ground its responses. <a href="https://developers.googleblog.com/en/gemini-api-io-updates/">Ref</a></p>
<p>This report provides a practical demonstration of this tool&rsquo;s capabilities. We will investigate its impact on two critical aspects of AI model interaction: the accuracy of the generated response and the total token consumption, which directly affects API costs.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2025/06/26/a-practical-analysis-of-the-gemini-apis-url-context-tool/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2025/06/14/updated-gas-library-utlapp/">Updated: GAS Library - UtlApp</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>14 Jun 2025, 15:20</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="utlapp-was-updated-to-v1011">UtlApp was updated to v1.0.11.</h2>
<ul>
<li>
<p>v1.0.11 (June 14, 2025)</p>
<ol>
<li>The method <a href="https://github.com/tanaikech/UtlApp?tab=readme-ov-file#getinffromblob">getInfFromBlob</a> was added.</li>
</ol>
</li>
</ul>
<p><strong>You can see the detail information here <a href="https://github.com/tanaikech/UtlApp">https://github.com/tanaikech/UtlApp</a></strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2025/06/13/updated-gas-library-utlapp/">Updated: GAS Library - UtlApp</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Jun 2025, 11:04</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="utlapp-was-updated-to-v1010">UtlApp was updated to v1.0.10.</h2>
<ul>
<li>
<p>v1.0.10 (June 13, 2025)</p>
<ol>
<li>The method <a href="https://github.com/tanaikech/UtlApp?tab=readme-ov-file#getmp3tag">getMP3Tag</a> was added.</li>
</ol>
</li>
</ul>
<p><strong>You can see the detail information here <a href="https://github.com/tanaikech/UtlApp">https://github.com/tanaikech/UtlApp</a></strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2025/06/13/updated-gas-library-utlapp/">Updated: GAS Library - UtlApp</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Jun 2025, 09:53</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="utlapp-was-updated-to-v109">UtlApp was updated to v1.0.9.</h2>
<ul>
<li>
<p>v1.0.9 (June 13, 2025)</p>
<ol>
<li>The method <a href="https://github.com/tanaikech/UtlApp#convertl16towav">convertL16ToWav</a> was added.</li>
</ol>
</li>
</ul>
<p><strong>You can see the detail information here <a href="https://github.com/tanaikech/UtlApp">https://github.com/tanaikech/UtlApp</a></strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/10/12/place-rows-from-a-sheet-to-multiple-sheets-on-google-spreadsheet-using-new-javascript-methods-with-google-apps-script/">Place Rows from a Sheet to Multiple Sheets on Google Spreadsheet using New Javascript Methods with Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>12 Oct 2024, 16:08</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/641d9ff0989951b98eaeca10559932d8">Gists</a></p>
<h1 id="abstract">Abstract</h1>
<p>This report showcases a practical application of Google Apps Script, demonstrating how new JavaScript methods can be used to create a script that automatically transfers selected rows between sheets in a Google Sheet.</p>
<h1 id="introduction">Introduction</h1>
<p>JavaScript, a fundamental pillar of contemporary web development, has experienced a significant rise in popularity due to its versatility and widespread adoption. As JavaScript&rsquo;s influence has expanded, so too has Google Apps Script, a cloud-based scripting language constructed on the V8 JavaScript engine. This evolution has led to the introduction of novel methods and features, thereby expanding the capabilities of developers working within the Google Workspace ecosystem.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2024/10/12/place-rows-from-a-sheet-to-multiple-sheets-on-google-spreadsheet-using-new-javascript-methods-with-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/09/04/updated-gas-library-utlapp/">Updated: GAS Library - UtlApp</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>04 Sep 2024, 10:07</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="utlapp-was-updated-to-v107">UtlApp was updated to v1.0.7.</h2>
<ul>
<li>
<p>v1.0.7 (September 4, 2024)</p>
<ol>
<li>Following 3 methods were added.</li>
</ol>
<ul>
<li><a href="https://github.com/tanaikech/UtlApp#snakecasetocamelcase">snake_caseToCamelCase</a>: This method is used for converting a string of the snake case to the camel case.</li>
<li><a href="https://github.com/tanaikech/UtlApp#camelcasetosnakecase">camelCaseTosnake_case</a>: This method is used for converting a string of the camel case to the snake case.</li>
<li><a href="https://github.com/tanaikech/UtlApp#createformdataobject">createFormDataObject</a>: This method is used for creating the form data to HTTP request from an object.</li>
</ul>
</li>
</ul>
<p><strong>You can see the detail information here <a href="https://github.com/tanaikech/UtlApp">https://github.com/tanaikech/UtlApp</a></strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/08/16/uploading-multiple-files-with-split-asynchronous-processes-and-resumable-upload-in-google-spreadsheets/">Uploading Multiple Files with Split Asynchronous Processes and Resumable Upload in Google Spreadsheets</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>16 Aug 2024, 15:08</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/resumable-upload">resumable upload</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/42925de7efc497b5e8eb21f9dae6260d">Gists</a></p>
<h1 id="overview">Overview</h1>
<p>This sample script demonstrates uploading multiple files using split asynchronous processes with resumable upload. It leverages JavaScript and HTML within Google Spreadsheets.</p>
<h1 id="description">Description</h1>
<p>In my previous report, &ldquo;<a href="https://github.com/tanaikech/AsynchronousResumableUploadForGoogleDrive">Resumable Upload of Multiple Files with Asynchronous Process for Google Drive</a>&rdquo;, I presented an approach for uploading files asynchronously.</p>
<p>This script builds upon that concept, introducing a method for uploading multiple files with split asynchronous processes that utilize resumable upload.</p>
<p>Here&rsquo;s the process breakdown:</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2024/08/16/uploading-multiple-files-with-split-asynchronous-processes-and-resumable-upload-in-google-spreadsheets/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/05/23/updated-javascript-library-resumableuploadforgoogledrive_js/">Updated: Javascript library - ResumableUploadForGoogleDrive_js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>23 May 2024, 15:47</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/resumable-upload">resumable upload</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://github.com/tanaikech/ResumableUploadForGoogleDrive_js">ResumableUploadForGoogleDrive_js</a> was updated to v2.0.2.</p>
<ul>
<li>
<p>v2.0.2 (May 23, 2024)</p>
<ol>
<li>From this version, the files could be also uploaded to the shared drive.</li>
</ol>
</li>
</ul>
<h2 id="cdn">CDN</h2>
<h3 id="class-resumableuploadtogoogledrive">Class ResumableUploadToGoogleDrive</h3>
<p>This Class can achieve the resumable upload of a file by reading the file to the memory.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/gh/tanaikech/ResumableUploadForGoogleDrive_js@2.0.2/resumableupload_js.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><h3 id="class-resumableuploadtogoogledrive2">Class ResumableUploadToGoogleDrive2</h3>
<p>This Class can achieve the resumable upload of a file by directly reading partially the file from the local Disk. By this, the large file which is over the memory of the local PC can be uploaded.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2024/05/23/updated-javascript-library-resumableuploadforgoogledrive_js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/05/15/adding-page-numbers-to-pdf-using-google-apps-script/">Adding Page Numbers to PDF using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15 May 2024, 09:18</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/pdf">PDF</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/05834ac8e605922637af9a4cfdecc152">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20240515a/fig1.png" alt=""></p>
<h1 id="description">Description</h1>
<p>This is a simple sample script for adding the page numbers to PDF data using Google Apps Script.</p>
<p>When you use this script, please copy and paste the following script to the script editor of Google Apps Script. And, please set the file ID of the PDF file.</p>
<h3 id="sample-script">Sample script</h3>
<p>In this script, <a href="https://pdf-lib.js.org/">pdf-lib</a> is used.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Add page numbers to PDF.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param {Object} blob PDF blob.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param {Object} pageFormat Format of page number.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @returns {Blob} Updated PDF blob.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">addPageNumbers_</span>(<span style="color:#a6e22e">blob</span>, <span style="color:#a6e22e">pageFormat</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">blob</span>.<span style="color:#a6e22e">getContentType</span>() <span style="color:#f92672">!=</span> <span style="color:#a6e22e">MimeType</span>.<span style="color:#a6e22e">PDF</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Blob is not PDF.&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Load pdf-lib
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cdnjs</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/npm/pdf-lib/dist/pdf-lib.min.js&#34;</span>;
</span></span><span style="display:flex;"><span>  eval(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">cdnjs</span>)
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">getContentText</span>()
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">replace</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">/setTimeout\(.*?,.*?(\d*?)\)/g</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Utilities.sleep($1);return t();&#34;</span>
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Uint8Array</span>(<span style="color:#a6e22e">blob</span>.<span style="color:#a6e22e">getBytes</span>());
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pdfData</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">PDFLib</span>.<span style="color:#a6e22e">PDFDocument</span>.<span style="color:#a6e22e">load</span>(<span style="color:#a6e22e">data</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pdfDoc</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">PDFLib</span>.<span style="color:#a6e22e">PDFDocument</span>.<span style="color:#a6e22e">create</span>();
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">await</span> <span style="color:#a6e22e">pdfDoc</span>.<span style="color:#a6e22e">copyPages</span>(<span style="color:#a6e22e">pdfData</span>, <span style="color:#a6e22e">pdfData</span>.<span style="color:#a6e22e">getPageIndices</span>())).<span style="color:#a6e22e">forEach</span>(
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">page</span>, <span style="color:#a6e22e">i</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">width</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">page</span>.<span style="color:#a6e22e">getSize</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">center</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">width</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>, <span style="color:#a6e22e">left</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">20</span>, <span style="color:#a6e22e">right</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">width</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">20</span> };
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pageFormatObj</span> <span style="color:#f92672">=</span> { ...<span style="color:#a6e22e">pageFormat</span> };
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">pageFormatObj</span>.<span style="color:#a6e22e">x</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">obj</span>[<span style="color:#a6e22e">pageFormat</span>.<span style="color:#a6e22e">x</span>];
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">page</span>.<span style="color:#a6e22e">drawText</span>(<span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>, <span style="color:#a6e22e">pageFormatObj</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">pdfDoc</span>.<span style="color:#a6e22e">addPage</span>(<span style="color:#a6e22e">page</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">bytes</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">pdfDoc</span>.<span style="color:#a6e22e">save</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">newBlob</span>(
</span></span><span style="display:flex;"><span>    [...<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Int8Array</span>(<span style="color:#a6e22e">bytes</span>)],
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">MimeType</span>.<span style="color:#a6e22e">PDF</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">`new_</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">blob</span>.<span style="color:#a6e22e">getName</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Please run this function.
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample1</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fileId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the file ID of the PDF file.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pdfBlob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">fileId</span>).<span style="color:#a6e22e">getBlob</span>(); <span style="color:#75715e">// Of course, you can directly give the PDF blob.
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pageFormat</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">size</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">10</span>, <span style="color:#a6e22e">x</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;center&#34;</span>, <span style="color:#a6e22e">y</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">10</span> };
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">addPageNumbers_</span>(<span style="color:#a6e22e">pdfBlob</span>, <span style="color:#a6e22e">pageFormat</span>).<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">newBlob</span>) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">newBlob</span>)
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// This function is a simple demonstration script.
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample2</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Create a sample Google Document.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tempDoc</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DocumentApp</span>.<span style="color:#a6e22e">create</span>(<span style="color:#e6db74">&#34;tempDoc&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">body</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tempDoc</span>.<span style="color:#a6e22e">getBody</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">p</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">p</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">5</span>; <span style="color:#a6e22e">p</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">appendParagraph</span>(<span style="color:#e6db74">`sample text </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">p</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>).<span style="color:#a6e22e">appendPageBreak</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tempDoc</span>.<span style="color:#a6e22e">saveAndClose</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pdfBlob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tempDoc</span>.<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Add page numbers.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pageFormat</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">size</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">10</span>, <span style="color:#a6e22e">x</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;center&#34;</span>, <span style="color:#a6e22e">y</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">10</span> };
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">addPageNumbers_</span>(<span style="color:#a6e22e">pdfBlob</span>, <span style="color:#a6e22e">pageFormat</span>).<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">newBlob</span>) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">newBlob</span>)
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>When you run the function <code>sample1</code>, the page numbers are added to the center of each page.</li>
<li>When you run the function <code>sample2</code>, a new Google Document is created including 5 pages. And, the page numbers are added to the center of each page.</li>
<li>In this sample, a simple format like <code>{ size: 10, x: &quot;center&quot;, y: 10 }</code> is used for the page numbers. Here, the page numbers are put to only &ldquo;left&rdquo;, &ldquo;center&rdquo;, and &ldquo;right&rdquo; of the bottom of the page. But, there are various parameters in DrawTextOptions. <a href="https://pdf-lib.js.org/docs/api/interfaces/drawtextoptions">Ref</a> So, when you want to customize more, please modify the script.</li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/05/04/updated-gas-library-utlapp/">Updated: GAS Library - UtlApp</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>04 May 2024, 20:05</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="utlapp-was-updated-to-v106">UtlApp was updated to v1.0.6.</h2>
<ul>
<li>
<p>v1.0.6 (May 4, 2024)</p>
<ol>
<li>Methods of <a href="https://github.com/tanaikech/UtlApp?tab=readme-ov-file#blobtodataurl">blobToDataUrl</a> was added. When this method is used, the Blob data can be converted to the data URL.</li>
</ol>
</li>
</ul>
<p><strong>You can see the detail information here <a href="https://github.com/tanaikech/UtlApp">https://github.com/tanaikech/UtlApp</a></strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/04/16/updated-gas-library-utlapp/">Updated: GAS Library - UtlApp</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>16 Apr 2024, 15:38</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="utlapp-was-updated-to-v105">UtlApp was updated to v1.0.5.</h2>
<ul>
<li>
<p>v1.0.5 (April 16, 2024)</p>
<ol>
<li>Methods of <a href="https://github.com/tanaikech/UtlApp?tab=readme-ov-file#consolidatea1notations">consolidateA1Notations</a> was added. When this method is used, the scattered A1Notations can be consolidated.</li>
</ol>
</li>
</ul>
<p><strong>You can see the detail information here <a href="https://github.com/tanaikech/UtlApp">https://github.com/tanaikech/UtlApp</a></strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/04/13/updated-gas-library-utlapp/">Updated: GAS Library - UtlApp</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Apr 2024, 10:10</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="utlapp-was-updated-to-v104">UtlApp was updated to v1.0.4.</h2>
<ul>
<li>
<p>v1.0.4 (April 13, 2024)</p>
<ol>
<li>Updated the methods of <a href="https://github.com/tanaikech/UtlApp#convgridrangetoa1Notation">convGridRangeToA1Notation</a>. When the sheet name is not given, only the A1Notation is returned.</li>
</ol>
</li>
</ul>
<p><strong>You can see the detail information here <a href="https://github.com/tanaikech/UtlApp">https://github.com/tanaikech/UtlApp</a></strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/02/05/updated-gas-library-utlapp/">Updated: GAS Library - UtlApp</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>05 Feb 2024, 09:27</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="utlapp-was-updated-to-v103">UtlApp was updated to v1.0.3.</h2>
<ul>
<li>
<p>v1.0.3 (February 5, 2024)</p>
<ol>
<li>Methods of <a href="https://github.com/tanaikech/UtlApp?tab=readme-ov-file#addqueryparameters">addQueryParameters</a> was updated.</li>
</ol>
</li>
</ul>
<p><strong>You can see the detail information here <a href="https://github.com/tanaikech/UtlApp">https://github.com/tanaikech/UtlApp</a></strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/01/25/updated-gas-library-utlapp/">Updated: GAS Library - UtlApp</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>25 Jan 2024, 13:59</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="utlapp-was-updated-to-v102">UtlApp was updated to v1.0.2.</h2>
<ul>
<li>
<p>v1.0.2 (January 25, 2024)</p>
<ol>
<li>2 methods of <a href="https://github.com/tanaikech/UtlApp?tab=readme-ov-file#dotproduct">dotProduct</a> and <a href="https://github.com/tanaikech/UtlApp?tab=readme-ov-file#cosinesimilarity">cosineSimilarity</a> were added.</li>
</ol>
</li>
</ul>
<p><strong>You can see the detail information here <a href="https://github.com/tanaikech/UtlApp">https://github.com/tanaikech/UtlApp</a></strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/10/25/inserting-html-including-javascript-on-web-apps-created-by-google-apps-script/">Inserting HTML including Javascript on Web Apps Created by Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>25 Oct 2023, 16:12</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/webapps">WebApps</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/a5b5b5646b97934578fbb22ee503e6aa">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20231025a/fig1.gif" alt=""></p>
<h2 id="abstract">Abstract</h2>
<p>One day, you might have a situation where you are required to create a Web Apps with Google Apps Script and are required to load another HTML created by Javascript on the Web Apps. This report will help achieve such a situation.</p>
<h2 id="introduction">Introduction</h2>
<p>Google Apps Script can create Web Apps. <a href="https://developers.google.com/apps-script/guides/web">Ref</a> When you access the Web Apps using your browser, you can see the HTML. When your browser can run Javascript, you can see the HTML reflecting the Javascript. The Web Apps created by Google Apps Script is one of the important and useful cloud applications. About the Web Apps, you have a situation where it is required to insert another HTML to the current HTML. And, another HTML might be required to be created by Javascript including the HTML. However, it is difficult a little to find detailed information about this. This report introduces a simple sample script for achieving such a situation.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/10/25/inserting-html-including-javascript-on-web-apps-created-by-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/08/28/report-values-to-transfer-between-javascript-and-google-apps-script-with-google.script.run/">Report: Values to transfer between Javascript and Google Apps Script with google.script.run</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>28 Aug 2023, 10:40</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/html">HTML</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/9927dc5c12ebca118ff8f3f4d539c95d">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230828a/fig1.png" alt=""></p>
<p>At the Google Apps Script project, the values can be transferred from HTML to Google Apps Script using <code>google.script.run</code> with Javascript. In this case, unfortunately, the values of all types cannot be transferred. In the official document, it says as follows. <a href="https://developers.google.com/apps-script/guides/html/reference/run#parameters">Ref</a></p>
<blockquote>
<p>Most types are legal, but not Date, Function, or DOM element besides form; see description</p>
</blockquote>
<blockquote>
<p>Legal parameters are JavaScript primitives like a Number, Boolean, String, or null, as well as JavaScript objects and arrays that are composed of primitives, objects, and arrays. A form element within the page is also legal as a parameter, but it must be the functions only parameter. Requests fail if you attempt to pass a Date, Function, DOM element besides a form, or other prohibited type, including prohibited types inside objects or arrays. Objects that create circular references will also fail, and undefined fields within arrays become null. Note that an object passed to the server becomes a copy of the original. If a server function receives an object and changes its properties, the properties on the client are not affected.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/08/28/report-values-to-transfer-between-javascript-and-google-apps-script-with-google.script.run/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/08/21/add-header-and-footer-to-exported-pdf-from-google-spreadsheet-using-google-apps-script/">Add Header and Footer to Exported PDF from Google Spreadsheet using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>21 Aug 2023, 12:08</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/pdf">PDF</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/1aac9139666963cb9268082763494218">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230821a/fig1.png" alt=""></p>
<p>This is a sample script for adding header and footer to PDF using Google Apps Script.</p>
<p>In the current stage, when Google Spreadsheet is manually exported as a PDF file at &ldquo;Print settings&rdquo; on the UI of Spreadsheet, the custom header and footer can be added as shown in the following image.</p>
<p><img src="https://tanaikech.github.io/image-storage/20230821a/fig2.png" alt=""></p>
<p>But, unfortunately, in the current stage, this cannot be directly achieved by Google Apps Script. So, I created this sample script. This sample script uses <a href="https://pdf-lib.js.org/">pdf-lib</a> of Javasscript library.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/08/21/add-header-and-footer-to-exported-pdf-from-google-spreadsheet-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/08/17/gas-library-pdfapp/">GAS Library - PDFApp</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Aug 2023, 14:46</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/pdf">PDF</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p>This is a Google Apps Script library for managing PDFs.</p>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig1.png" alt=""></p>
<h2 id="description">Description</h2>
<p>Google Apps Script is one of the most powerful tools for cloud computing. When Google Apps Script is used, the result can be obtained even when the user doesn&rsquo;t stay in front of the PC and mobile phone by the triggers. One day, there might be a case where it is required to manage PDF data using Google Apps Script. The combination of Google Docs (Document, Spreadsheet, and Slide) and PDFs is useful for various situations. However, unfortunately, there are no built-in methods for directly managing PDFs using Google Apps Script. Fortunately, it seems that <a href="https://pdf-lib.js.org/">pdf-lib</a> of the Javascript library can be used with Google Apps Script. By this, PDF data can be managed with Google Apps Script using this library. This Google Apps Script library manages PDFs by using it as a wrapper between Google Apps Script and pdf-lib.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/08/17/gas-library-pdfapp/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/08/17/cooking-pdf-over-google-apps-script/">Cooking PDF over Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Aug 2023, 14:42</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/pdf">PDF</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/42ad6a83322364d0b99ad11260862f04">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig1.png" alt=""></p>
<h2 id="abstract">Abstract</h2>
<p>When PDF file can be managed with Google Apps Script, that will lead to the automation process on cloud. In this report, the method for cooking PDF over Google Apps Script.</p>
<h2 id="introduction">Introduction</h2>
<p>Google Apps Script is one of the strong tools for achieving the automation process. When Google Apps Script can be used for the situation, it can be processed with cloud computing. By this, the users are not required to stay on the desks with the PC. One day, there might be a case where you are required to manage PDF files using Google Apps Script. When PDF files can be managed with Google Apps Script, that will be very important for achieving the automation process. Unfortunately, there are no built-in methods for directly managing PDF data using Google Apps Script. Fortunately, after the V8 runtime has been released, several raw Javascript libraries could be used with Google Apps Script. <a href="https://pdf-lib.js.org/">pdf-lib</a> is also one of them. When this is used, PDF data can be cooked over Google Apps Script. In this report, I would like to introduce achieving this using a Google Apps Script library.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/08/17/cooking-pdf-over-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/08/07/embedding-objects-in-pdf-using-google-apps-script/">Embedding Objects in PDF using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>07 Aug 2023, 17:06</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/pdf">PDF</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/b085cb08d573afa2294e2a8f887cdbd2">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230807a/fig1.png" alt=""></p>
<p>This is a sample script for embedding the objects in PDF using Google Apps Script.</p>
<p>Recently, I had a situation where it is required to manage PDFs using Google Apps Script. At that time, I had a situation where it is required to embed objects of texts and images in PDF using Google Apps Script. So, I created the following Class with Google Apps Script. When this Class is used, the objects of texts and images can embed in PDF.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/08/07/embedding-objects-in-pdf-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/08/05/creating-pdf-forms-from-google-slide-template-using-google-apps-script/">Creating PDF Forms from Google Slide Template using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>05 Aug 2023, 16:34</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/pdf">PDF</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/682dec95002f8cc25f1c5f2349966b8c">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230805a/fig1.png" alt=""></p>
<p>This is a sample script for creating PDF forms from a Google Slide template using Google Apps Script.</p>
<p>Recently, I had a situation where it is required to create a custom PDF form. In that case, I thought that when a PDF form can be created from a template, it might be useful. So, I created the following Class with Google Apps Script. When this Class is used, a custom PDF form can be easily created from a Google Slide as a template.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/08/05/creating-pdf-forms-from-google-slide-template-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/08/02/retrieving-and-putting-values-for-pdf-forms-using-google-apps-script/">Retrieving and Putting Values for PDF Forms using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>02 Aug 2023, 12:17</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/pdf">PDF</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/a8a387614410b8c6c2c1addbce4dd23c">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230802a/fig1.png" alt=""></p>
<p>This is a sample script for retrieving and putting values for PDF Forms using Google Apps Script.</p>
<p>PDF can have the PDF Form for inputting the values in the PDF by the user. <a href="https://helpx.adobe.com/acrobat/using/pdf-forms-basics.html">Ref</a> Recently, I had a situation that required me to retrieve and put the values to the PDF Form using Google Apps Script. In order to achieve this, I created a Class object with Google Apps Script. That is as follows.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/08/02/retrieving-and-putting-values-for-pdf-forms-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/07/27/changing-order-of-pages-in-pdf-file-using-google-apps-script/">Changing Order of Pages in PDF file using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>27 Jul 2023, 11:51</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/pdf">PDF</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/9de62573049e72b44a069fc31348524b">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230727a/fig1.png" alt=""></p>
<p>This is a sample script for changing the order of pages in a PDF file using Google Apps Script.</p>
<h2 id="sample-script">Sample script</h2>
<p>Before you run this script, please set the variables in the function <code>main</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Changing order of pages in a PDF file.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param {Object} fileId is file ID of PDF file. newOrderOfpages is new order of pages. About &#34;ignoreSkippedPages&#34;, if this is false, when the PDF has 5 pages and &#34;newOrderOfpages&#34; is &#34;[3, 2]&#34;, the exported PDF file has 5 pages of 3, 2, 1, 4, 5. If this is true, when the PDF has 5 pages and &#34;newOrderOfpages&#34; is &#34;[3, 2]&#34;, the exported PDF file has only 2 pages of 3 and 2.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @return {void}
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">changeOrderOfPDFPages_</span>({
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fileId</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">newOrderOfpages</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ignoreSkippedPages</span>,
</span></span><span style="display:flex;"><span>}) {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Load pdf-lib
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cdnjs</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/npm/pdf-lib/dist/pdf-lib.min.js&#34;</span>;
</span></span><span style="display:flex;"><span>  eval(<span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">cdnjs</span>).<span style="color:#a6e22e">getContentText</span>()); <span style="color:#75715e">// Load pdf-lib
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">setTimeout</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">f</span>, <span style="color:#a6e22e">t</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">sleep</span>(<span style="color:#a6e22e">t</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">f</span>();
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">fileId</span>).<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pdfData</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">PDFLib</span>.<span style="color:#a6e22e">PDFDocument</span>.<span style="color:#a6e22e">load</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Uint8Array</span>(<span style="color:#a6e22e">blob</span>.<span style="color:#a6e22e">getBytes</span>())
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">numberOfPages</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">pdfData</span>.<span style="color:#a6e22e">getPageCount</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">maxPage</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">max</span>(...<span style="color:#a6e22e">newOrderOfpages</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">numberOfPages</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">maxPage</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">numberOfPages</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">newOrderOfpages</span>.<span style="color:#a6e22e">length</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;Maximum page in the order of pages is over than the maximum page of the original PDF file.&#34;</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">skippedPages</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">ignoreSkippedPages</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">numberOfPages</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">newOrderOfpages</span>.<span style="color:#a6e22e">length</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">skippedPages</span> <span style="color:#f92672">=</span> [...Array(<span style="color:#a6e22e">numberOfPages</span>)]
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">i</span>) =&gt; <span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">filter</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#f92672">!</span><span style="color:#a6e22e">newOrderOfpages</span>.<span style="color:#a6e22e">includes</span>(<span style="color:#a6e22e">e</span>));
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pdfDoc</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">PDFLib</span>.<span style="color:#a6e22e">PDFDocument</span>.<span style="color:#a6e22e">create</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pages</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">pdfDoc</span>.<span style="color:#a6e22e">copyPages</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">pdfData</span>,
</span></span><span style="display:flex;"><span>    [...Array(<span style="color:#a6e22e">numberOfPages</span>)].<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">i</span>) =&gt; <span style="color:#a6e22e">i</span>)
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  [...<span style="color:#a6e22e">newOrderOfpages</span>, ...<span style="color:#a6e22e">skippedPages</span>].<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">e</span>) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">pdfDoc</span>.<span style="color:#a6e22e">addPage</span>(<span style="color:#a6e22e">pages</span>[<span style="color:#a6e22e">e</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">bytes</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">pdfDoc</span>.<span style="color:#a6e22e">save</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">newBlob</span>(
</span></span><span style="display:flex;"><span>    [...<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Int8Array</span>(<span style="color:#a6e22e">bytes</span>)],
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">MimeType</span>.<span style="color:#a6e22e">PDF</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;sample.pdf&#34;</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fileId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set a file ID of your a PDF file or a file ID of Google Docs files (Document, Spreadsheet, Slide).
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">newOrderOfpages</span> <span style="color:#f92672">=</span> [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">4</span>]; <span style="color:#75715e">// Please set new order of the pages in a PDF file. In this sample, the order of pages of the original PDF file is changed to 3, 1, 2, 5, 4.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ignoreSkippedPages</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>; <span style="color:#75715e">// If this is false, when the PDF has 5 pages and &#34;newOrderOfpages&#34; is &#34;[3, 2]&#34;, the exported PDF file has 5 pages of 3, 2, 1, 4, 5. If this is true, when the PDF has 5 pages and &#34;newOrderOfpages&#34; is &#34;[3, 2]&#34;, the exported PDF file has only 2 pages of 3 and 2.
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">changeOrderOfPDFPages_</span>({ <span style="color:#a6e22e">fileId</span>, <span style="color:#a6e22e">newOrderOfpages</span>, <span style="color:#a6e22e">ignoreSkippedPages</span> }).<span style="color:#a6e22e">then</span>(
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">blob</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">blob</span>.<span style="color:#a6e22e">setName</span>(<span style="color:#e6db74">&#34;sample.pdf&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When this script is run, a new PDF file is created with the new order of pages.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/07/27/changing-order-of-pages-in-pdf-file-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/07/24/management-of-pdf-metadata-using-google-apps-script/">Management of PDF Metadata using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>24 Jul 2023, 14:45</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/pdf">PDF</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/9ee06b508624e252dd0e32efc348a59a">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230724b/fig1.png" alt=""></p>
<p>This is a sample script for managing the metadata of PDF data using Google Apps Script.</p>
<p>There might be a case in that you want to retrieve and update the metadata of PDF data using Google Apps Script. In this post, I would like to introduce achieving this.</p>
<h2 id="class-managepdfmetadata">Class ManagePdfMetadata</h2>
<p>This is a Class ManagePdfMetadata. This Class is used for managing the metadata of PDF files using Google Apps Script. And, in this Class, a Javascript library of <a href="https://pdf-lib.js.org/">pdf-lib</a> is used for managing the PDF metadata. This Javascript library is loaded in this Class.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/07/24/management-of-pdf-metadata-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/07/14/exporting-specific-pages-from-a-pdf-as-a-new-pdf-using-google-apps-script/">Exporting Specific Pages From a PDF as a New PDF Using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>14 Jul 2023, 14:21</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/pdf">PDF</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/9d77f7d634d2d31914396d7dc84b79c3">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230714a/fig1.png" alt=""></p>
<p>This is a sample script for exporting the specific pages from a PDF as a new PDF using Google Apps Script.</p>
<p>In this sample script, <a href="https://pdf-lib.js.org/">pdf-lib</a> is used. In the current stage, it seems that this Javascript can be directly used with Google Apps Script.</p>
<h2 id="sample-script">Sample script</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Retrieve PDF data.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fileId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set a file ID of your a PDF file or a file ID of Google Docs files (Document, Spreadsheet, Slide).
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pageNumbers</span> <span style="color:#f92672">=</span> [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>]; <span style="color:#75715e">// In this sample, 2 and 4 pages are exported as a PDF.
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">fileId</span>).<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Merge PDFs.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cdnjs</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/npm/pdf-lib/dist/pdf-lib.min.js&#34;</span>;
</span></span><span style="display:flex;"><span>  eval(<span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">cdnjs</span>).<span style="color:#a6e22e">getContentText</span>()); <span style="color:#75715e">// Load pdf-lib
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">setTimeout</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">f</span>, <span style="color:#a6e22e">t</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">sleep</span>(<span style="color:#a6e22e">t</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">f</span>();
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pdfDoc</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">PDFLib</span>.<span style="color:#a6e22e">PDFDocument</span>.<span style="color:#a6e22e">create</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pdfData</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">PDFLib</span>.<span style="color:#a6e22e">PDFDocument</span>.<span style="color:#a6e22e">load</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Uint8Array</span>(<span style="color:#a6e22e">blob</span>.<span style="color:#a6e22e">getBytes</span>())
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pages</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">pdfDoc</span>.<span style="color:#a6e22e">copyPages</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">pdfData</span>,
</span></span><span style="display:flex;"><span>    [...Array(<span style="color:#a6e22e">pdfData</span>.<span style="color:#a6e22e">getPageCount</span>())].<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">i</span>) =&gt; <span style="color:#a6e22e">i</span>)
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pages</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">page</span>, <span style="color:#a6e22e">i</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">pageNumbers</span>.<span style="color:#a6e22e">includes</span>(<span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">pdfDoc</span>.<span style="color:#a6e22e">addPage</span>(<span style="color:#a6e22e">page</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">bytes</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">pdfDoc</span>.<span style="color:#a6e22e">save</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Create a PDF file.
</span></span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">newBlob</span>([...<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Int8Array</span>(<span style="color:#a6e22e">bytes</span>)], <span style="color:#a6e22e">MimeType</span>.<span style="color:#a6e22e">PDF</span>, <span style="color:#e6db74">&#34;sample.pdf&#34;</span>)
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>
<p>When this script is run, the specific pages (In this sample, 2 and 4 pages.) in <code>pageNumbers</code> of a PDF file of <code>fileId</code> are exported as a new PDF file.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/07/14/exporting-specific-pages-from-a-pdf-as-a-new-pdf-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/05/13/gas-library-utlapp/">GAS Library - UtlApp</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 May 2023, 15:52</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p>This is a Google Apps Script library including useful scripts for supporting to development of applications by Google Apps Script. In the current stage, the 3 categories &ldquo;For array processing&rdquo;, &ldquo;For binary processing&rdquo;, and &ldquo;For string processing&rdquo; are included in this library.</p>
<p><img src="https://tanaikech.github.io/image-storage/20230513a/fig1.png" alt=""></p>
<h2 id="description">Description</h2>
<p>When I create applications using Google Apps Script, there are useful scripts for often use. At that time, I thought that when those scripts can be simply used, they will be useful not only to me but also to other users. From this motivation, I created a Google Apps Script library including those scripts. But, I have been using these useful scripts only in my development before.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/05/13/gas-library-utlapp/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/02/15/february-15-2023-decrypting-salted-base64-of-finance.yahoo.com-using-google-apps-script/">February 15, 2023: Decrypting Salted Base64 of finance.yahoo.com using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15 Feb 2023, 11:40</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/yahoo-finance">Yahoo Finance</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/84213e047bc64b50deb7295758e0d971">Gists</a></p>
<p>This sample script decrypts the salted base64 data of finance.yahoo.com using Google Apps Script.</p>
<p>Recently, it seems that the specification of the key for decrypting the data has been changed on the server side, again. In this update, I looked for the logic for retrieving the key value. But, I cannot still find it. So, in this post, I would like to use a workaround discussed in <a href="https://github.com/ranaroussi/yfinance/issues/1407">this thread</a>. In this thread, the valid keys are listed in a text file. Using this, I updated the script as follows.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/02/15/february-15-2023-decrypting-salted-base64-of-finance.yahoo.com-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/01/27/january-27-2023-decrypting-salted-base64-of-finance.yahoo.com-using-google-apps-script/">January 27, 2023: Decrypting Salted Base64 of finance.yahoo.com using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>27 Jan 2023, 10:33</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/yahoo-finance">Yahoo Finance</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/2b1c008d7f8e873cc738d75c7fefaf71">Gists</a></p>
<p>This sample script decrypts the salted base64 data of finance.yahoo.com using Google Apps Script.</p>
<p>Recently, it seems that the specification of the key for decrypting the data has been changed at the server side. So. from <a href="https://github.com/ranaroussi/yfinance/blob/e1184f745be695ab21e8b969b8e6912da548debd/yfinance/data.py">this script</a>, I updated the script as follows.</p>
<h2 id="sample-script">Sample script</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Load crypto-js.min.js.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cdnjs</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js&#34;</span>;
</span></span><span style="display:flex;"><span>  eval(<span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">cdnjs</span>).<span style="color:#a6e22e">getContentText</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Retrieve HTML and retrieve salted base64.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://finance.yahoo.com/quote/PGEN/press-releases&#34;</span>; <span style="color:#75715e">// This is a sample URL.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">html</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">url</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getContentText</span>()
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">match</span>(<span style="color:#e6db74">/root.App.main = ([\s\S\w]+?);\n/</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">html</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">html</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tempObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">html</span>[<span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">trim</span>());
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">obj</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">tempObj</span>.<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">dispatcher</span>.<span style="color:#a6e22e">stores</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;string&#34;</span> <span style="color:#f92672">||</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tempObj</span>.<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">dispatcher</span>.<span style="color:#a6e22e">stores</span> <span style="color:#66d9ef">instanceof</span> String
</span></span><span style="display:flex;"><span>  ) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Decrypt the salted base64.
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>      ...<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Map</span>(
</span></span><span style="display:flex;"><span>        Object.<span style="color:#a6e22e">entries</span>(<span style="color:#a6e22e">tempObj</span>)
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">filter</span>(([<span style="color:#a6e22e">k</span>]) =&gt; <span style="color:#f92672">!</span>[<span style="color:#e6db74">&#34;context&#34;</span>, <span style="color:#e6db74">&#34;plugins&#34;</span>].<span style="color:#a6e22e">includes</span>(<span style="color:#a6e22e">k</span>))
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">splice</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>      ).<span style="color:#a6e22e">values</span>(),
</span></span><span style="display:flex;"><span>    ].<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">key</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Specification at the server side might be changed. Please check it.&#34;</span>
</span></span><span style="display:flex;"><span>      );
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">enc</span>.<span style="color:#a6e22e">Utf8</span>.<span style="color:#a6e22e">stringify</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">AES</span>.<span style="color:#a6e22e">decrypt</span>(<span style="color:#a6e22e">tempObj</span>.<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">dispatcher</span>.<span style="color:#a6e22e">stores</span>, <span style="color:#a6e22e">key</span>)
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tempObj</span>.<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">dispatcher</span>.<span style="color:#a6e22e">stores</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">obj</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>About the value of <code>context.dispatcher.stores</code>, this script can be used for both the salted base64 and the JSON object.</li>
</ul>
<h2 id="note">Note</h2>
<ul>
<li>In this sample, in order to load <code>crypto-js</code>, <code>eval(UrlFetchApp.fetch(cdnjs).getContentText())</code> is used. But, if you don&rsquo;t want to use it, you can also use this script by copying and pasting the script of <code>https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js</code> to the script editor of Google Apps Script. By this, the process cost can be reduced.</li>
</ul>
<h2 id="important">IMPORTANT</h2>
<ul>
<li><strong>I can confirm that this method can be used for the current situation (January 27, 2023). But, when the specification in the data and HTML is changed in the future update on the server side, this script might not be able to be used. Please be careful about this.</strong></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/brix/crypto-js">crypto-js</a></li>
<li><a href="https://cdnjs.com/libraries/crypto-js">crypto-js of cdnjs.com</a></li>
<li><a href="https://tanaikech.github.io/2022/12/21/encrypting-and-decrypting-with-aes-using-crypto-js-with-google-apps-script/">Encrypting and Decrypting with AES using crypto-js with Google Apps Script</a></li>
<li>I answered this method to the following threads on Stackoverflow.
<ul>
<li><a href="https://stackoverflow.com/q/75250562">https://stackoverflow.com/q/75250562</a></li>
</ul>
</li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/01/23/replacing-u-00a0-with-u-0020-as-unicode-using-google-apps-script/">Replacing U&#43;00A0 with U&#43;0020 as Unicode using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>23 Jan 2023, 08:45</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/cc470a3b6c49b32e06d908e6d3f96f66">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230123a/fig1.png" alt=""></p>
<p>This is a sample script for checking and replacing a character of U+00A0 (no-break space) with U+0020 (space) as Unicode using Google Apps Script.</p>
<p>When I&rsquo;m seeing the questions on Stackoverflow, I sometimes saw the situation that the script doesn&rsquo;t work while the script is correct. In this case, there is the case that the reason is due to U+00A0 being used as the spaces. When U+00A0 is used as the spaces, Google Apps Script and formulas cannot be correctly run. I thought that when this information is published, it might be useful for a lot of users.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/01/23/replacing-u-00a0-with-u-0020-as-unicode-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/01/14/decrypting-salted-base64-of-finance.yahoo.com-using-google-apps-script/">Decrypting Salted Base64 of finance.yahoo.com using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>14 Jan 2023, 10:17</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/yahoo-finance">Yahoo Finance</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/82fdd9be47a0b73437b66889ce6a8913">Gists</a></p>
<p>This sample script decrypts the salted base64 data of finance.yahoo.com using Google Apps Script.</p>
<p>Recently, it seems that the specification of the key for decrypting the data has been changed at the server side. So. in this post, <a href="https://tanaikech.github.io/2022/12/21/decrypting-salted-base64-of-finance.yahoo.com-using-google-apps-script/">this post</a> is updated. About this specification, I checked <a href="https://github.com/ranaroussi/yfinance/issues/1291">this thread</a>.</p>
<h2 id="sample-script">Sample script</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Load crypto-js.min.js.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cdnjs</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js&#34;</span>;
</span></span><span style="display:flex;"><span>  eval(<span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">cdnjs</span>).<span style="color:#a6e22e">getContentText</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Retrieve HTML and retrieve salted base64.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://finance.yahoo.com/quote/PGEN/press-releases&#34;</span>; <span style="color:#75715e">// This is a sample URL.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">html</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">url</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getContentText</span>()
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">match</span>(<span style="color:#e6db74">/root.App.main = ([\s\S\w]+?);\n/</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">html</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">html</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tempObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">html</span>[<span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">trim</span>());
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">obj</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">tempObj</span>.<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">dispatcher</span>.<span style="color:#a6e22e">stores</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;string&#34;</span> <span style="color:#f92672">||</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tempObj</span>.<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">dispatcher</span>.<span style="color:#a6e22e">stores</span> <span style="color:#66d9ef">instanceof</span> String
</span></span><span style="display:flex;"><span>  ) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Decrypt the salted base64.
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> Object.<span style="color:#a6e22e">entries</span>(<span style="color:#a6e22e">tempObj</span>).<span style="color:#a6e22e">find</span>(
</span></span><span style="display:flex;"><span>      ([<span style="color:#a6e22e">k</span>]) =&gt; <span style="color:#f92672">!</span>[<span style="color:#e6db74">&#34;context&#34;</span>, <span style="color:#e6db74">&#34;plugins&#34;</span>].<span style="color:#a6e22e">includes</span>(<span style="color:#a6e22e">k</span>)
</span></span><span style="display:flex;"><span>    )[<span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">key</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Specification at the server side might be changed. Please check it.&#34;</span>
</span></span><span style="display:flex;"><span>      );
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">enc</span>.<span style="color:#a6e22e">Utf8</span>.<span style="color:#a6e22e">stringify</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">AES</span>.<span style="color:#a6e22e">decrypt</span>(<span style="color:#a6e22e">tempObj</span>.<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">dispatcher</span>.<span style="color:#a6e22e">stores</span>, <span style="color:#a6e22e">key</span>)
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tempObj</span>.<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">dispatcher</span>.<span style="color:#a6e22e">stores</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">obj</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>About the value of <code>context.dispatcher.stores</code>, this script can be used for both the salted base64 and the JSON object.</li>
</ul>
<h2 id="note">Note</h2>
<ul>
<li>In this sample, in order to load <code>crypto-js</code>, <code>eval(UrlFetchApp.fetch(cdnjs).getContentText())</code> is used. But, if you don&rsquo;t want to use it, you can also use this script by copying and pasting the script of <code>https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js</code> to the script editor of Google Apps Script. By this, the process cost can be reduced.</li>
</ul>
<h2 id="important">IMPORTANT</h2>
<ul>
<li><strong>I can confirm that this method can be used for the current situation (January 14, 2023). But, when the specification in the data and HTML is changed in the future update on the server side, this script might not be able to be used. Please be careful about this.</strong></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/brix/crypto-js">crypto-js</a></li>
<li><a href="https://cdnjs.com/libraries/crypto-js">crypto-js of cdnjs.com</a></li>
<li><a href="https://tanaikech.github.io/2022/12/21/encrypting-and-decrypting-with-aes-using-crypto-js-with-google-apps-script/">Encrypting and Decrypting with AES using crypto-js with Google Apps Script</a></li>
<li>I answered this method to the following threads on Stackoverflow.
<ul>
<li><a href="https://stackoverflow.com/q/75114850">https://stackoverflow.com/q/75114850</a></li>
</ul>
</li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/01/10/merging-multiple-pdf-files-as-a-single-pdf-file-using-google-apps-script/">Merging Multiple PDF Files as a Single PDF File using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>10 Jan 2023, 10:19</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/pdf">PDF</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/449ff906b85be18977e47e0d5ea173d5">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230110a/fig1.png" alt=""></p>
<p>This is a sample script for merging multiple PDF files as a single PDF file using Google Apps Script.</p>
<p>In this sample script, <a href="https://pdf-lib.js.org/">pdf-lib</a> is used. In the current stage, it seems that this Javascript can be directly used with Google Apps Script.</p>
<h2 id="sample-script-1">Sample script 1</h2>
<p>As a sample situation, please put multiple PDF files in your Google Drive. This sample merges those PDF files as a single PDF file.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/01/10/merging-multiple-pdf-files-as-a-single-pdf-file-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/01/04/retrieving-start-and-end-of-month-in-year-using-google-apps-script-and-javascript/">Retrieving Start and End of Month in Year using Google Apps Script and Javascript</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>04 Jan 2023, 10:48</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/1153792b17ce29ae86c865e53c999375">Gists</a></p>
<p>This is a sample script for retrieving the start and end of the month in a year using Google Apps Script and Javascript.</p>
<h2 id="sample-script">Sample script</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">year</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2023</span>; <span style="color:#75715e">// Please set year you expect.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> [...Array(<span style="color:#ae81ff">12</span>)].<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">i</span>) =&gt;
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#66d9ef">new</span> Date(<span style="color:#a6e22e">year</span>, <span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">e</span>, <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">e</span>))
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">map</span>(([<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>]) =&gt; [<span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">toDateString</span>(), <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">toDateString</span>()]));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="testing">Testing</h2>
<p><a href="https://jsfiddle.net/mLrhqwgo/">https://jsfiddle.net/mLrhqwgo/</a></p>
<p>When this script is run, the following value is obtained with <code>console.log(res.map(([a, b]) =&gt; [a.toDateString(), b.toDateString()]))</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;Sun Jan 01 2023&#34;</span>, <span style="color:#e6db74">&#34;Tue Jan 31 2023&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;Wed Feb 01 2023&#34;</span>, <span style="color:#e6db74">&#34;Tue Feb 28 2023&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;Wed Mar 01 2023&#34;</span>, <span style="color:#e6db74">&#34;Fri Mar 31 2023&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;Sat Apr 01 2023&#34;</span>, <span style="color:#e6db74">&#34;Sun Apr 30 2023&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;Mon May 01 2023&#34;</span>, <span style="color:#e6db74">&#34;Wed May 31 2023&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;Thu Jun 01 2023&#34;</span>, <span style="color:#e6db74">&#34;Fri Jun 30 2023&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;Sat Jul 01 2023&#34;</span>, <span style="color:#e6db74">&#34;Mon Jul 31 2023&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;Tue Aug 01 2023&#34;</span>, <span style="color:#e6db74">&#34;Thu Aug 31 2023&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;Fri Sep 01 2023&#34;</span>, <span style="color:#e6db74">&#34;Sat Sep 30 2023&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;Sun Oct 01 2023&#34;</span>, <span style="color:#e6db74">&#34;Tue Oct 31 2023&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;Wed Nov 01 2023&#34;</span>, <span style="color:#e6db74">&#34;Thu Nov 30 2023&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;Fri Dec 01 2023&#34;</span>, <span style="color:#e6db74">&#34;Sun Dec 31 2023&#34;</span>]
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/12/21/decrypting-salted-base64-of-finance.yahoo.com-using-google-apps-script/">Decrypting Salted Base64 of finance.yahoo.com using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>21 Dec 2022, 16:15</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/yahoo-finance">Yahoo Finance</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/2c13c70e932e84adcf658ca8334f25ab">Gists</a></p>
<p>This sample script decrypts the salted base64 data of finance.yahoo.com using Google Apps Script.</p>
<p>Recently, when I saw the HTML of finance.yahoo.com, I noticed that the data is converted by the salted base64. In order to decrypt the data, it is required to use the key data. But, unfortunately, I couldn&rsquo;t find the key data from the HTML. When I searched for it, I found <a href="https://github.com/ranaroussi/yfinance/issues/1246">this thread</a>. From the thread, I could retrieve the key data. By this, I could a script for decrypting the salted base64.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/12/21/decrypting-salted-base64-of-finance.yahoo.com-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/12/21/encrypting-and-decrypting-with-aes-using-crypto-js-with-google-apps-script/">Encrypting and Decrypting with AES using crypto-js with Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>21 Dec 2022, 15:16</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/1038c73f028b7595f4e070a0e7d48ff1">Gists</a></p>
<p>This is a sample script for encrypting and decrypting with AES using crypto-js with Google Apps Script.</p>
<p>Unfortunately, in the current stage, Google Apps Script cannot encrypt and decrypt AES using the built-in functions. In this post, in order to achieve this, &ldquo;crypto-js&rdquo; is used from cdnjs.com ( <a href="https://cdnjs.com/libraries/crypto-js">https://cdnjs.com/libraries/crypto-js</a> ). In the current stage, it seems that the main functions of <code>crypto-js.min.js</code> can be directly used with Google Apps Script. But, unfortunately, all functions cannot be used. Please be careful about this.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/12/21/encrypting-and-decrypting-with-aes-using-crypto-js-with-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/12/16/retrieving-values-from-publicly-shared-google-spreadsheet-using-api-key-with-javascript/">Retrieving Values from Publicly Shared Google Spreadsheet using API key with Javascript</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>16 Dec 2022, 10:33</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/aeb1a21e1e51a902f903e6363cd1a5db">Gsits</a></p>
<p>This is a sample script for retrieving the values from a publicly shared Google Spreadsheet using an API key with Javascript.</p>
<h2 id="sample-script">Sample script</h2>
<p>In this sample script, googleapis for Javascript is used.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">defer</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://apis.google.com/js/api.js&#34;</span> <span style="color:#a6e22e">onload</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;handleClientLoad()&#34;</span><span style="color:#f92672">&gt;&lt;</span><span style="color:#960050;background-color:#1e0010">/script&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">handleClientLoad</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set your API key.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheetId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set your Spreadsheet ID.
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">gapi</span>.<span style="color:#a6e22e">load</span>(<span style="color:#e6db74">&#39;client&#39;</span>, <span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">gapi</span>.<span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">init</span>({ <span style="color:#a6e22e">apiKey</span>, <span style="color:#a6e22e">discoveryDocs</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;https://sheets.googleapis.com/$discovery/rest?version=v4&#34;</span>] });
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">result</span> } <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">gapi</span>.<span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">sheets</span>.<span style="color:#a6e22e">spreadsheets</span>.<span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">get</span>({ <span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">range</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Sheet1&#34;</span> });
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">result</span>);
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>
<p>In this sample, I used <a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values/get">Method: spreadsheets.values.get</a>. Of course, in this case, you can use the methods of <a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/get">Method: spreadsheets.get</a>, <a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values/batchGet">Method: spreadsheets.values.batchGet</a>.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/12/16/retrieving-values-from-publicly-shared-google-spreadsheet-using-api-key-with-javascript/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/10/04/updating-array1-with-array2-using-google-apps-script/">Updating Array1 with Array2 using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>04 Oct 2022, 10:00</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/fb7149425069ad1138f36162698385df">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20221004a/fig1.png" alt=""></p>
<p>This is a sample script for updating Array1 with Array2 using Google Apps Script.</p>
<p>As a sample situation, there are 2 arrays (Array1 and Array2) of the 2-dimensional array. The sample situation can be seen in the above sample Spreadsheet.</p>
<ul>
<li>Conditions
<ul>
<li>When the values of column &ldquo;A&rdquo; of Array2 are existing in column &ldquo;A&rdquo; of Array1, the rows of Array1 are updated by that of Array2.</li>
<li>When the values of column &ldquo;A&rdquo; of Array2 are not existing in column &ldquo;A&rdquo; of Array1, the rows of Array2 are appended to Array1.</li>
<li>When the values of column &ldquo;A&rdquo; of Array1 are not existing in column &ldquo;A&rdquo; of Array2, the rows of Array1 are deleted.</li>
</ul>
</li>
</ul>
<p>I sometimes see such questions on Stackoverflow. So, I thought that when this sample script is posted, it might be useful for users.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/10/04/updating-array1-with-array2-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/09/02/report-rule-of-item-ids-for-questions-of-google-forms/">Report: Rule of Item IDs for Questions of Google Forms</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>02 Sep 2022, 09:29</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/form">form</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/forms-api">forms-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/f391fd4d596d45bb846d374ff0ded695">Gists</a></p>
<p>This is a report related to the rule of item IDs for questions of Google Forms.</p>
<p>When the questions are created using the method of batchUpdate with Google Forms API, the created questions have the item IDs when the item IDs are not given in the request body. ( <a href="https://developers.google.com/forms/api/reference/rest/v1/forms#item">https://developers.google.com/forms/api/reference/rest/v1/forms#item</a> ) For example, when you want to create a question and update the created question in one API call, it is required to include the custom item ID in the request body. But, it seems that in the current stage, the information of the item ID has never been published. So, in this report, I would like to consider the rule of item IDs of questions for Google Forms API.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/09/02/report-rule-of-item-ids-for-questions-of-google-forms/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/08/09/javascript-library-cropimagebyborder_js/">Javascript library - CropImageByBorder_js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Aug 2022, 16:44</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/image">image</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="javascript-library-for-cropping-image-by-border">Javascript Library for Cropping Image by Border</h2>
<h3 id="overview">Overview</h3>
<p>This is a Javascript library for cropping images by the border.</p>
<h3 id="description">Description</h3>
<p>When an image is used, there is a case where I wanted to simply crop the image by a script. In this Javascript library, the image is cropped by a border. The sample situation is as follows.</p>
<p><img src="https://tanaikech.github.io/image-storage/20220809a/fig1.png" alt=""></p>
<p>In this sample situation, a red rectangle is enclosed by a border (1 pixel) with &ldquo;#000000&rdquo;. By this border, this library crops the red rectangle. In this case, the 1-pixel border is not included in the resulting image.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/08/09/javascript-library-cropimagebyborder_js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/05/21/splitting-and-processing-an-array-every-n-length-using-google-apps-script/">Splitting and Processing an Array every n length using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>21 May 2022, 09:02</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/9e6276edb67d0ebde80ea378b6f79e20">Gists</a></p>
<p>This is a sample script for splitting and processing an array every <code>n</code> length using Google Apps Script. When I prepare a sample script with Google Apps Script, I sometimes have the situation that it is required to split and process an array every <code>n</code> length. This sample script is for achieving this situation.</p>
<p>Please set <code>limit</code>. This sample script splits the sample array every 3 length.</p>
<p>When you use this script with Google Apps Script, please enable V8 runtime.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/05/21/splitting-and-processing-an-array-every-n-length-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/05/01/increasing-column-letter-by-one-using-google-apps-script/">Increasing Column Letter by One using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>01 May 2022, 09:49</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/13fc8683114c5ff62b8144c338a1d574">Gists</a></p>
<p>This is a sample script for increasing the column letter by one using Google Apps Script.</p>
<h2 id="sample-script">Sample script</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">increase</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">ar</span>) =&gt;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">idx</span> <span style="color:#f92672">=</span> [...<span style="color:#a6e22e">e</span>].<span style="color:#a6e22e">reduce</span>(
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">c</span>, <span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">i</span>, <span style="color:#a6e22e">a</span>) =&gt;
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">c</span> <span style="color:#f92672">+=</span> (<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">64</span>) <span style="color:#f92672">*</span> Math.<span style="color:#a6e22e">pow</span>(<span style="color:#ae81ff">26</span>, <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)),
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Ref: https://stackoverflow.com/a/53678158
</span></span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">columnIndexToLetter</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">n</span>) =&gt;
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">a</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">floor</span>(<span style="color:#a6e22e">n</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">26</span>)) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">?</span> <span style="color:#a6e22e">columnIndexToLetter</span>(<span style="color:#a6e22e">a</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> String.<span style="color:#a6e22e">fromCharCode</span>(<span style="color:#ae81ff">65</span> <span style="color:#f92672">+</span> (<span style="color:#a6e22e">n</span> <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">columnIndexToLetter</span>(<span style="color:#a6e22e">idx</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">samples</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;A&#34;</span>, <span style="color:#e6db74">&#34;Z&#34;</span>, <span style="color:#e6db74">&#34;AA&#34;</span>, <span style="color:#e6db74">&#34;AZ&#34;</span>, <span style="color:#e6db74">&#34;ZZ&#34;</span>];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">increase</span>(<span style="color:#a6e22e">samples</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>); <span style="color:#75715e">// &lt;--- [ &#39;B&#39;, &#39;AA&#39;, &#39;AB&#39;, &#39;BA&#39;, &#39;AAA&#39; ]
</span></span></span></code></pre></div><ul>
<li>When this script is used, the column letters of <code>[&quot;A&quot;, &quot;Z&quot;, &quot;AA&quot;, &quot;AZ&quot;, &quot;ZZ&quot;]</code> is increased by one. As the result, <code>[ 'B', 'AA', 'AB', 'BA', 'AAA' ]</code> is obtained.</li>
</ul>
<h2 id="testing">Testing</h2>
<ul>
<li><a href="https://jsfiddle.net/r5ngtxj2/">jsfiddle.net</a></li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/01/11/update-javascript-library-htmlformobjectparserforgoogleappsscript_js/">Update: Javascript library - HtmlFormObjectParserForGoogleAppsScript_js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>11 Jan 2022, 17:00</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/form">form</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This is a Javascript library for sending the HTML form object to Google Apps Script using google.script.run.</p>
<p>HtmlFormObjectParserForGoogleAppsScript_js was updated to v1.0.1.</p>
<ul>
<li>
<p>v1.0.1 (January 11, 2022)</p>
<ol>
<li>A new argument of <code>includeOrder</code> was added as the 4th argument. This library returns the parsed form object as a JSON object. By this, the order of HTML form object is not saved. From this version, this order can be included. This argument includes the order of each input tag in form. The default value is <code>false</code>. When this value is <code>true</code>, a property of <code>orderOfFormObject</code> is included in the returned object. This value is the order of HTML form object. Using this value, you can retrieve the parsed form object in order of HTML form.</li>
</ol>
</li>
</ul>
<p><strong>You can see the detail of this at <a href="https://github.com/tanaikech/HtmlFormObjectParserForGoogleAppsScript_js">https://github.com/tanaikech/HtmlFormObjectParserForGoogleAppsScript_js</a></strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2021/11/15/updated-javascript-library-resumableuploadforgoogledrive_js/">Updated: Javascript library - ResumableUploadForGoogleDrive_js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15 Nov 2021, 15:38</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/resumable-upload">resumable upload</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://github.com/tanaikech/ResumableUploadForGoogleDrive_js">ResumableUploadForGoogleDrive_js</a> was updated to v2.0.0.</p>
<ul>
<li>
<p>v2.0.0 (November 15, 2021)</p>
<ol>
<li>New Class ResumableUploadToGoogleDrive2 was added. By this, the large file which is over the memory in the local PC can be uploaded by the resumable upload.</li>
</ol>
</li>
</ul>
<h2 id="overview">Overview</h2>
<p>This is a Javascript library to achieve the resumable upload for Google Drive.</p>
<h2 id="description">Description</h2>
<p>When a file more than 5 MB is uploaded to Google Drive with Drive API, <a href="https://developers.google.com/drive/api/v3/manage-uploads#resumable">the resumable upload</a> is required to be used. I have already published the sample script for &ldquo;Resumable Upload for Web Apps using Google Apps Script&rdquo;. <a href="https://github.com/tanaikech/Resumable_Upload_For_WebApps">Ref</a> In this case, Web Apps is used. Here, I would like to introduce the script for the resumable upload created by only Javascript. Unfortunately, in the current stage, at <a href="https://github.com/google/google-api-javascript-client">google-api-javascript-client</a>, there are no methods for the resumable upload. And, I thought that when this function is created as a Javascript library, it might be useful for users. Also that library is also useful for me. So I created this. If this was useful for your situation, I&rsquo;m glad.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2021/11/15/updated-javascript-library-resumableuploadforgoogledrive_js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2021/10/08/compiling-continuous-numbers-using-google-apps-script/">Compiling Continuous Numbers using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>08 Oct 2021, 21:01</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/5a43281964b739ead2b7ae2401400630">Gists</a></p>
<p>This is a sample script for compiling the continuous numbers using Google Apps Script. For example, the values of <code>[4, 5, 9, 3, 10, 5, 11, 7, 7, 13, 1]</code> are converted to <code>[&quot;1&quot;,&quot;3-5&quot;,&quot;7&quot;,&quot;9-11&quot;,&quot;13&quot;]</code>.</p>
<h2 id="sample-script">Sample script</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">compilingNumbers</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">ar</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">values</span> } <span style="color:#f92672">=</span> [...<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Set</span>(<span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">sort</span>((<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) =&gt; <span style="color:#a6e22e">a</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">b</span>))].<span style="color:#a6e22e">reduce</span>(
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">o</span>, <span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">i</span>, <span style="color:#a6e22e">a</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span>
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">e</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>[<span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>      ) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">e</span>);
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">push</span>({ <span style="color:#a6e22e">start</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>[<span style="color:#ae81ff">0</span>], <span style="color:#a6e22e">end</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>[<span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] });
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> [<span style="color:#a6e22e">e</span>];
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">push</span>(
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">?</span> { <span style="color:#a6e22e">start</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>[<span style="color:#ae81ff">0</span>], <span style="color:#a6e22e">end</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>[<span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] }
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">:</span> { <span style="color:#a6e22e">start</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">end</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span> }
</span></span><span style="display:flex;"><span>        );
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">o</span>;
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">temp</span><span style="color:#f92672">:</span> [], <span style="color:#a6e22e">values</span><span style="color:#f92672">:</span> [] }
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">values</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Please run this function.
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ar</span> <span style="color:#f92672">=</span> [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>]; <span style="color:#75715e">// This is sample values.
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">compilingNumbers</span>(<span style="color:#a6e22e">ar</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">values</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">map</span>(({ <span style="color:#a6e22e">start</span>, <span style="color:#a6e22e">end</span> }) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">start</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">end</span> <span style="color:#f92672">?</span> <span style="color:#a6e22e">start</span>.<span style="color:#a6e22e">toString</span>() <span style="color:#f92672">:</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">start</span><span style="color:#e6db74">}</span><span style="color:#e6db74">-</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">end</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When this script is run, <code>console.log(values)</code> and <code>console.log(res)</code> show <code>[{&quot;start&quot;:1,&quot;end&quot;:1},{&quot;start&quot;:3,&quot;end&quot;:5},{&quot;start&quot;:7,&quot;end&quot;:7},{&quot;start&quot;:9,&quot;end&quot;:11},{&quot;start&quot;:13,&quot;end&quot;:13}]</code> and <code>[&quot;1&quot;,&quot;3-5&quot;,&quot;7&quot;,&quot;9-11&quot;,&quot;13&quot;]</code>, respectively. From this result, it is found that the continuous numbers were compiled.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2021/10/08/compiling-continuous-numbers-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2021/05/27/using-google-api-client-library-gapi-for-javascript-with-service-account/">Using Google API Client Library (gapi) for JavaScript with Service Account</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>27 May 2021, 15:08</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/service-account">Service Account</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/603102a64587cb9bff2e165994f6b6a1">Gists</a></p>
<p>This is a sample script for using Google API Client Library (gapi) for JavaScript with the service account. Unfortunately, in the current stage, gapi cannot directly use the service account. So, in this case, it is required to implement the script for retrieving the access token from the service account. In this report, I would like to introduce the method for using gapi with the service account using a Javascript library.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2021/05/27/using-google-api-client-library-gapi-for-javascript-with-service-account/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2021/05/27/javascript-library-getaccesstokenfromserviceaccount_js/">Javascript library - GetAccessTokenFromServiceAccount_js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>27 May 2021, 15:03</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/service-account">Service Account</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p>This is a Javascript library to retrieve the access token from the Google Service Account. <a href="https://cloud.google.com/iam/docs/service-accounts">Ref</a></p>
<h2 id="description">Description</h2>
<p>I have already posted the sample script for retrieving the access token from the Google Service Account. <a href="https://tanaikech.github.io/2020/12/19/retrieving-access-token-for-service-account-using-javascript/">Ref</a> But, when I use this script, I thought that when this was published as the Javascript library, it will be useful. So I created this.</p>
<h2 id="install">Install</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;getaccesstokengromserviceaccount_js.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><p>Or, using jsdelivr cdn</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/gh/tanaikech/GetAccessTokenFromServiceAccount_js@master/getaccesstokengromserviceaccount_js.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><p><strong>You can see the detail of this at <a href="https://github.com/tanaikech/GetAccessTokenFromServiceAccount_js">https://github.com/tanaikech/GetAccessTokenFromServiceAccount_js</a></strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2021/02/13/javascript-library-htmlformobjectparserforgoogleappsscript_js/">Javascript library - HtmlFormObjectParserForGoogleAppsScript_js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Feb 2021, 17:11</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/form">form</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="parser-for-sending-html-form-object-to-google-apps-script-using-googlescriptrun">Parser for Sending HTML Form Object to Google Apps Script using google.script.run</h2>
<h3 id="overview">Overview</h3>
<p>This is a Javascript library for sending the HTML form object to Google Apps Script using <code>google.script.run</code>.</p>
<p><img src="https://tanaikech.github.io/img/20210213a-fig1.png" alt=""></p>
<h3 id="description">Description</h3>
<p>HTML form object is parsed by this library, and the object can be sent to Google Apps Script using <code>google.script.run</code>. After the V8 runtime got to be able to be used for Google Apps Script, when the file input tag is included in the HTML form object, the object sent to Google Apps Script using <code>google.script.run</code> cannot be directly used. Because it seems that the binary file data cannot be parsed when it is sent with <code>google.script.run</code>. <a href="https://stackoverflow.com/a/60748334">Ref</a> In the current stage, as the workaround, the file data is required to be sent to Google Apps Script using <code>google.script.run</code> after it was converted to the byte array and the base64 data. I think that this might be resolved in the future update. But I thought that as the current workaround, when the parser for converting this is prepared, it might be useful for users, because I saw the several questions which have this issue at Stackoverflow.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2021/02/13/javascript-library-htmlformobjectparserforgoogleappsscript_js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/12/29/safe-uploading-for-google-drive-by-html-in-external-server-using-google-apps-script/">Safe-Uploading for Google Drive by HTML in External Server using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>29 Dec 2020, 11:13</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">JsTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/service-account">Service Account</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p>This is a report for safe-uploading files to Google Drive by HTML put in the external server using Google Apps Script.</p>
<h2 id="description">Description</h2>
<p>When you want to make the user upload a file to your own Google Drive using the HTML put in the external server of Google side, when the file size is smaller than 50 MB, this can be achieved without using the access token. <a href="https://tanaikech.github.io/2020/08/13/uploading-file-to-google-drive-from-external-html-without-authorization/">Ref</a> (When the HTML is put in the internal server of Google side, you can also use <a href="https://tanaikech.github.io/2020/02/18/uploading-file-to-google-drive-using-html-and-google-apps-script/"><code>google.script.run</code></a>.) But, when the file size is over 50 MB, it is required to upload the file with the resumable upload. In this case, the access token is required to be used. In this case that the user uploads to your own Google Drive, when the access token is used in the upload, it is considered that this is the weak point of the security. In this report, I would like to propose the method for safe-uploading files to Google Drive by HTML put in the external server using Google Apps Script. Please think of this as one of several methods.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/12/29/safe-uploading-for-google-drive-by-html-in-external-server-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/12/22/javascript-library-batchrequest_js/">Javascript library - BatchRequest_js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>22 Dec 2020, 11:50</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/batch-request">batch request</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/googleapi">googleapi</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p>This is a library for running Batch Requests for Google APIs using Javascript.</p>
<p><a name="description"></a></p>
<h2 id="description">Description</h2>
<p>When users use Google&rsquo;s APIs, one quota is used for one API call. When the batch request is used, several APIs can be called by one quota, although there are some limitations in the batch request.</p>
<p><code>google-api-javascript-client</code> can run the batch request. <a href="https://github.com/google/google-api-javascript-client/blob/master/docs/batch.md">Ref</a> But, I created this for my self study. This library can achieve the batch request using <code>fetch</code> without using <code>google-api-javascript-client</code>.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/12/22/javascript-library-batchrequest_js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/12/19/retrieving-access-token-for-service-account-using-javascript/">Retrieving Access Token for Service Account using Javascript</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>19 Dec 2020, 14:09</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">JsTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/service-account">Service Account</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/accesstoken">accesstoken</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/3c7f208cb352a807b3d30b9c1dcf0c82">Gists</a></p>
<p>This is a sample script for retrieving the access token for Service Account using Javascript. The flow for using this script is as follows.</p>
<ol>
<li>At first, please create the Service Account and retrieve JSON file.</li>
<li>Put Scopes, <code>private_key</code> and <code>client_email</code> to the script.</li>
<li>Run the script.</li>
</ol>
<h2 id="sample-script">Sample script</h2>
<p>In this script, 2 libraries of <a href="https://github.com/travist/jsencrypt">jsencrypt</a> and <a href="https://github.com/brix/crypto-js">crypto-js</a> are used.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdnjs.cloudflare.com/ajax/libs/jsencrypt/3.0.0-rc.1/jsencrypt.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">private_key</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// private_key of JSON file retrieved by creating Service Account
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">client_email</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// client_email of JSON file retrieved by creating Service Account
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">scopes</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;https://www.googleapis.com/auth/drive.readonly&#34;</span>]; <span style="color:#75715e">// Scopes
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://www.googleapis.com/oauth2/v4/token&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">header</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">alg</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;RS256&#34;</span>, <span style="color:#a6e22e">typ</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;JWT&#34;</span> };
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">now</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">floor</span>(Date.<span style="color:#a6e22e">now</span>() <span style="color:#f92672">/</span> <span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">claim</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">iss</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">client_email</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">scope</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">scopes</span>.<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34; &#34;</span>),
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">aud</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">url</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">exp</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">now</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">3600</span>).<span style="color:#a6e22e">toString</span>(),
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">iat</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">now</span>.<span style="color:#a6e22e">toString</span>(),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">signature</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">btoa</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">header</span>)) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">btoa</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">claim</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sign</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">JSEncrypt</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sign</span>.<span style="color:#a6e22e">setPrivateKey</span>(<span style="color:#a6e22e">private_key</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">jwt</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">signature</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">sign</span>.<span style="color:#a6e22e">sign</span>(<span style="color:#a6e22e">signature</span>, <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">SHA256</span>, <span style="color:#e6db74">&#34;sha256&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">params</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;POST&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> { <span style="color:#e6db74">&#34;Content-Type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json&#34;</span> },
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">assertion</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">jwt</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">grant_type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;urn:ietf:params:oauth:grant-type:jwt-bearer&#34;</span>,
</span></span><span style="display:flex;"><span>      }),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">url</span>, <span style="color:#a6e22e">params</span>)
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">res</span>) =&gt; <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>())
</span></span><span style="display:flex;"><span>      .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">err</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">obj</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sample</span>();
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><p>If the access token retrieved at above is used for retrieving file list, the sample script is as follows.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/12/19/retrieving-access-token-for-service-account-using-javascript/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/12/07/uploading-image-files-to-google-photos-using-axios/">Uploading Image Files to Google Photos using axios</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>07 Dec 2020, 10:38</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">JsTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/axios">axios</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-photos">Google photos</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-photos-api">Google Photos API</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/426345c24e46da3ac7268f31b76bb3e4">Gists</a></p>
<p>This is a sample script for uploading the image files to the specific album in Google Photos using axios.</p>
<p>Before you use this script, please retrieve the access token for uploading the files using Google Photos API.</p>
<h2 id="sample-script">Sample script</h2>
<p>In this sample script, several image files can be uploaded.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;files&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#a6e22e">multiple</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;button&#34;</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;main()&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;upload&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">upload</span>({ <span style="color:#a6e22e">files</span>, <span style="color:#a6e22e">albumId</span>, <span style="color:#a6e22e">accessToken</span> }) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">description</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Date().<span style="color:#a6e22e">toISOString</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">promises</span> <span style="color:#f92672">=</span> Array.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">files</span>).<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">file</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Promise((<span style="color:#a6e22e">r</span>) =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">axios</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">post</span>(<span style="color:#e6db74">&#34;https://photoslibrary.googleapis.com/v1/uploads&#34;</span>, <span style="color:#a6e22e">file</span>, {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>              <span style="color:#e6db74">&#34;Content-Type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/octet-stream&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#e6db74">&#34;X-Goog-Upload-File-Name&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">name</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#e6db74">&#34;X-Goog-Upload-Protocol&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;raw&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">Authorization</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Bearer </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">accessToken</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>          })
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">then</span>(({ <span style="color:#a6e22e">data</span> }) =&gt; {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">r</span>({
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">description</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">simpleMediaItem</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">fileName</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">uploadToken</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">data</span> },
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>          });
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Promise.<span style="color:#a6e22e">all</span>(<span style="color:#a6e22e">promises</span>).<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Promise((<span style="color:#a6e22e">resolve</span>, <span style="color:#a6e22e">reject</span>) =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">e</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">axios</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">post</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;https://photoslibrary.googleapis.com/v1/mediaItems:batchCreate&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ <span style="color:#a6e22e">albumId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">albumId</span>, <span style="color:#a6e22e">newMediaItems</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span> }),
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;Content-type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Authorization</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Bearer </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">accessToken</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>              },
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          )
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">resolve</span>)
</span></span><span style="display:flex;"><span>          .<span style="color:#66d9ef">catch</span>(<span style="color:#a6e22e">reject</span>);
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// This function is run.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">files</span><span style="color:#f92672">:</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;files&#34;</span>).<span style="color:#a6e22e">files</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">albumId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span>, <span style="color:#75715e">// Please set the album ID.
</span></span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">accessToken</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span>, <span style="color:#75715e">// Please set your access token.
</span></span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">upload</span>(<span style="color:#a6e22e">obj</span>)
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">e</span>))
</span></span><span style="display:flex;"><span>      .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">err</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>));
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><h2 id="references">References</h2>
<ul>
<li><a href="https://developers.google.com/photos">Google Photos APIs</a></li>
<li><a href="https://developers.google.com/photos/library/guides/upload-media">Upload media</a></li>
<li><a href="https://developers.google.com/photos/library/reference/rest/v1/mediaItems/batchCreate">Method: mediaItems.batchCreate</a></li>
<li>Related question in Stackoverflow.
<ul>
<li><a href="https://stackoverflow.com/q/65171851">Error in newMediaItemResults in Google Photos API</a></li>
</ul>
</li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/12/03/sample-scripts-for-creating-new-event-with-google-meet-link-to-google-calendar-using-various-languages/">Sample Scripts for Creating New Event with Google Meet Link to Google Calendar using Various Languages</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>03 Dec 2020, 16:04</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gotips">GoTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/rubytips">RubyTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/curltips">CurlTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/golang">golang</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/ruby">ruby</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/curl">curl</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/calendar">Calendar</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/94791d48823e9659aa376cf7f0161d9b">Gists</a></p>
<p>This is the sample scripts for creating new event with Google Meet link to Google Calendar using various languages. When I saw <a href="https://developers.google.com/calendar/create-events#conferencing">the official document</a> of &ldquo;Add video and phone conferences to events&rdquo;, in the current stage, I can see only the sample script for Javascript. But I saw the several questions related to this for various languages. So I published the sample scripts for creating new event with Google Meet link to Google Calendar using various languages.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/12/03/sample-scripts-for-creating-new-event-with-google-meet-link-to-google-calendar-using-various-languages/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/07/29/workaround-showing-log-in-web-apps-to-apps-script-dashboard-using-javascript/">Workaround: Showing Log in Web Apps to Apps Script Dashboard using Javascript</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>29 Jul 2020, 09:24</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/webapps">WebApps</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/log">Log</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/e27581278f8cb464dff1dd83d6f887a7">Gists</a></p>
<p>I have already reported for showing the log to &ldquo;Apps Script Dashboard&rdquo; when it requests to the Web Apps. <a href="https://tanaikech.github.io/2020/07/26/logs-in-web-apps-for-google-apps-script/">Ref</a> In order to show the log to &ldquo;Apps Script Dashboard&rdquo; when it requests to the Web Apps, it is required to use the access token. But in the current stage, when the access token is used for <code>XMLHttpRequest</code> and <code>fetch</code> of Javascript in the request headers, the error related to CORS occurs. So, in this report, I would like to propose the workaround for resolving this issue.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/07/29/workaround-showing-log-in-web-apps-to-apps-script-dashboard-using-javascript/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/06/19/retrieving-difference-between-2-arrays-using-google-apps-script/">Retrieving Difference Between 2 Arrays using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>19 Jun 2020, 16:18</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/cc7bdfe67c3b72c48c290fc11c231e72">Gists</a></p>
<p>This is a sample script for retrieving the difference between 2 arrays, which are the old values and the new values, using Google Apps Script. In my environment, I sometimes have the situation that it is required to retrieve the difference between 2 arrays. So I prepared this as a sample script. I think that this can be also used at Javascript and Node.js. If this was also useful for your situation, I&rsquo;m glad.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/06/19/retrieving-difference-between-2-arrays-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/06/01/updated-getfilelist-for-golang-javascript-node.js-and-python/">Updated: GetFileList for golang, Javascript, Node.js and Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>01 Jun 2020, 14:12</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gotips">GoTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/module">module</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/golang">golang</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/module">module</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/foldertree">folderTree</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/filelist">filelist</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>Updated: GetFileList for golang, Javascript, Node.js and Python</p>
<p>This is the libraries to retrieve the file list with the folder tree from the specific folder of own Google Drive and shared Drives.</p>
<ul>
<li>Golang: <a href="https://github.com/tanaikech/go-getfilelist">https://github.com/tanaikech/go-getfilelist</a>
<ul>
<li>Updated to v1.0.4.</li>
</ul>
</li>
<li>Javascript: <a href="https://github.com/tanaikech/GetFileList_js">https://github.com/tanaikech/GetFileList_js</a>
<ul>
<li>Updated to v1.0.3.</li>
</ul>
</li>
<li>Node.js: <a href="https://github.com/tanaikech/node-getfilelist">https://github.com/tanaikech/node-getfilelist</a>
<ul>
<li>Updated to v1.0.5.</li>
</ul>
</li>
<li>Python: <a href="https://github.com/tanaikech/getfilelistpy">https://github.com/tanaikech/getfilelistpy</a>
<ul>
<li>Updated to v1.0.6.</li>
</ul>
</li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/05/15/updated-javascript-library-getfilelist_js/">Updated: Javascript library - GetFileList_js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15 May 2020, 12:15</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/foldertree">folderTree</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/filelist">filelist</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="getfilelist_-was-updated-to-v102"><a href="https://github.com/tanaikech/GetFileList_js">GetFileList_js</a> was updated to v1.0.2.</h2>
<ul>
<li>
<p>v1.0.2 (May 15, 2020)</p>
<ol>
<li>
<p>Shared drive got to be able to be used. The file list can be retrieved from both your Google Drive and the shared drive.</p>
<ul>
<li>For example, when the folder ID in the shared Drive is used <code>id</code> of <code>resource</code>, you can retrieve the file list from the folder in the shared Drive.</li>
</ul>
</li>
</ol>
</li>
</ul>
<p><strong>You can see the detail information here <a href="https://github.com/tanaikech/GetFileList_js">https://github.com/tanaikech/GetFileList_js</a></strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2019/10/11/javascript-library-resumableuploadforgoogledrive_js/">Javascript library - ResumableUploadForGoogleDrive_js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>11 Oct 2019, 13:07</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/resumable-upload">resumable upload</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p>This is a Javascript library to achieve the resumable upload for Google Drive.</p>
<h2 id="description">Description</h2>
<p>When a file more than 5 MB is uploaded to Google Drive with Drive API, <a href="https://developers.google.com/drive/api/v3/manage-uploads#resumable">the resumable upload</a> is required to be used. I have already published the sample script for &ldquo;Resumable Upload for Web Apps using Google Apps Script&rdquo;. <a href="https://github.com/tanaikech/Resumable_Upload_For_WebApps">Ref</a> In this case, Web Apps is used. Here, I would like to introduce the script for the resumable upload created by only Javascript. Unfortunately, in the current stage, at <a href="https://github.com/google/google-api-javascript-client">google-api-javascript-client</a>, there are no methods for the resumable upload. And, I thought that when this function is created as a Javascript library, it might be useful for users. Also that library is also useful for me. So I created this. If this was useful for your situation, I&rsquo;m glad.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2019/10/11/javascript-library-resumableuploadforgoogledrive_js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2019/09/30/updated-javascript-library-getfilelist_js/">Updated: Javascript library - GetFileList_js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Sep 2019, 11:35</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/foldertree">folderTree</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/filelist">filelist</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="getfilelist_-was-updated-to-v101"><a href="https://github.com/tanaikech/GetFileList_js">GetFileList_js</a> was updated to v1.0.1.</h2>
<ul>
<li>
<p>v1.0.1 (September 30, 2019)</p>
<ol>
<li>A bug related to the scope of variables was removed.</li>
</ol>
</li>
</ul>
<p><strong>You can see the detail information here <a href="https://github.com/tanaikech/GetFileList_js">https://github.com/tanaikech/GetFileList_js</a></strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2019/09/13/javascript-library-syncgooglescriptrun/">Javascript library - syncGoogleScriptRun</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Sep 2019, 14:54</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google.script.run">google.script.run</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/synchronous">synchronous</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h1 id="overview">Overview</h1>
<p>This is a Javascript library to use &ldquo;google.script.run&rdquo; with the synchronous process.</p>
<h1 id="description">Description</h1>
<p>When I create Web Apps, add-on using a side bar and dialog, there is the case that I want to use <code>google.script.run</code> with the synchronous process. As you know, <a href="https://developers.google.com/apps-script/guides/html/reference/run"><code>google.script.run</code> works with the asynchronous process</a>. So in order to use it as the synchronous process, the script is required to be prepared. I also saw several issues for such situation at Stackoverflow and other sites. I thought that when the script for achieving this was prepared as a library, it might be useful for users. So I created this.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2019/09/13/javascript-library-syncgooglescriptrun/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2019/09/12/javascript-library-getfilelist_js/">Javascript library - GetFileList_js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>12 Sep 2019, 14:44</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/foldertree">folderTree</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/filelist">filelist</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p>This is a Javascript library to retrieve the file list with the folder tree from the specific folder (publicly shared folders and own folders) of Google Drive.</p>
<h2 id="description">Description</h2>
<p>The library for retrieving the file list with the folder tree from the specific folder of Google Drive has already been published for Google Apps Script, golang, node.js and python as GetFileList. <a href="https://gist.github.com/tanaikech/4fca197b8ec45c8ac6300b1531c2489d">Ref</a> Here, this GetFileList was released as the library of Javascript.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2019/09/12/javascript-library-getfilelist_js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/07/12/adding-query-parameters-to-url-using-google-apps-script/">Adding Query Parameters to URL using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>12 Jul 2018, 08:53</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/70503e0ea6998083fcb05c6d2a857107">Gists</a></p>
<h1 id="updated-on-february-5-2024">Updated on February 5, 2024</h1>
<p>This is for adding the query parameters to the URL. These scripts can be also used for Javascript. When I created an endpoint with some query parameters, I had used the scripts of various patterns every time. Today, I prepared this sample script to unify them. If this is also useful for you, I&rsquo;m glad.</p>
<h2 id="sample-script-with-v8-runtime">Sample script (With V8 runtime):</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>String.<span style="color:#a6e22e">prototype</span>.<span style="color:#a6e22e">addQuery</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">obj</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">this</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#66d9ef">this</span><span style="color:#e6db74">}</span><span style="color:#e6db74">?`</span>) <span style="color:#f92672">+</span> Object.<span style="color:#a6e22e">entries</span>(<span style="color:#a6e22e">obj</span>).<span style="color:#a6e22e">flatMap</span>(([<span style="color:#a6e22e">k</span>, <span style="color:#a6e22e">v</span>]) =&gt; Array.<span style="color:#a6e22e">isArray</span>(<span style="color:#a6e22e">v</span>) <span style="color:#f92672">?</span> <span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">e</span> =&gt; <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">k</span><span style="color:#e6db74">}</span><span style="color:#e6db74">=</span><span style="color:#e6db74">${</span>encodeURIComponent(<span style="color:#a6e22e">e</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>) <span style="color:#f92672">:</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">k</span><span style="color:#e6db74">}</span><span style="color:#e6db74">=</span><span style="color:#e6db74">${</span>encodeURIComponent(<span style="color:#a6e22e">v</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>).<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;&amp;&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction1</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://sampleUrl&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">query</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">query1</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;value1A&#34;</span>, <span style="color:#e6db74">&#34;value1B&#34;</span>, <span style="color:#e6db74">&#34;value1C&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">query2</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value2A, value2B&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">query3</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value3A/value3B&#34;</span>,
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">endpoint</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">addQuery</span>(<span style="color:#a6e22e">query</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">endpoint</span>); <span style="color:#75715e">// https://sampleUrl?query1=value1A&amp;query1=value1B&amp;query1=value1C&amp;query2=value2A%2C%20value2B&amp;query3=value3A%2Fvalue3B
</span></span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// In this case, only the query parameter is exported. This value can be used for requesting with Form data.
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction2</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">query</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">query1</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;value1A&#34;</span>, <span style="color:#e6db74">&#34;value1B&#34;</span>, <span style="color:#e6db74">&#34;value1C&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">query2</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value2A, value2B&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">query3</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value3A/value3B&#34;</span>,
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">endpoint</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">addQuery</span>(<span style="color:#a6e22e">query</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">endpoint</span>); <span style="color:#75715e">// query1=value1A&amp;query1=value1B&amp;query1=value1C&amp;query2=value2A%2C%20value2B&amp;query3=value3A%2Fvalue3B
</span></span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li><a href="https://jsfiddle.net/f92arp5m/">https://jsfiddle.net/f92arp5m/</a></li>
</ul>
<h2 id="sample-script-without-v8-runtime">Sample script (Without V8 runtime):</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>String.<span style="color:#a6e22e">prototype</span>.<span style="color:#a6e22e">addQuery</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">obj</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span> <span style="color:#f92672">+</span> Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">obj</span>).<span style="color:#a6e22e">reduce</span>(<span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">p</span>, <span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">i</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">p</span> <span style="color:#f92672">+</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;?&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&amp;&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>      (Array.<span style="color:#a6e22e">isArray</span>(<span style="color:#a6e22e">obj</span>[<span style="color:#a6e22e">e</span>]) <span style="color:#f92672">?</span> <span style="color:#a6e22e">obj</span>[<span style="color:#a6e22e">e</span>].<span style="color:#a6e22e">reduce</span>(<span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">str</span>, <span style="color:#a6e22e">f</span>, <span style="color:#a6e22e">j</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">str</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">e</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;=&#34;</span> <span style="color:#f92672">+</span> encodeURIComponent(<span style="color:#a6e22e">f</span>) <span style="color:#f92672">+</span> (<span style="color:#a6e22e">j</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">obj</span>[<span style="color:#a6e22e">e</span>].<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;&amp;&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>      }, <span style="color:#e6db74">&#34;&#34;</span>) <span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;=&#34;</span> <span style="color:#f92672">+</span> encodeURIComponent(<span style="color:#a6e22e">obj</span>[<span style="color:#a6e22e">e</span>]));
</span></span><span style="display:flex;"><span>  }, <span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://sampleUrl&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">query</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">query1</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;value1A&#34;</span>, <span style="color:#e6db74">&#34;value1B&#34;</span>, <span style="color:#e6db74">&#34;value1C&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">query2</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value2A, value2B&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">query3</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value3A/value3B&#34;</span>,
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">endpoint</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">addQuery</span>(<span style="color:#a6e22e">query</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Logger</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">endpoint</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li><a href="https://jsfiddle.net/jka8u3wx/">https://jsfiddle.net/jka8u3wx/</a></li>
</ul>
<h2 id="result">Result:</h2>
<p>Both sample scripts return the following URL including the query parameters.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/07/12/adding-query-parameters-to-url-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/06/15/retrieving-a-key-with-maximum-value-from-object/">Retrieving a Key with Maximum Value from Object</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15 Jun 2018, 08:22</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/max-value">Max value</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/fcbc0204e92d8f1cdde74dc5ac820753">Gists</a></p>
<p>This sample script is for retrieving a key with the maximum value from an object. This can be also used by Google Apps Script.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">5</span>, <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#34;c&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#34;d&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#34;e&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">obj</span>).<span style="color:#a6e22e">reduce</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">c</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">obj</span>[<span style="color:#a6e22e">a</span>] <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">obj</span>[<span style="color:#a6e22e">c</span>] <span style="color:#f92672">?</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">c</span>;
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Logger</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>); <span style="color:#75715e">// &gt;&gt;&gt; a
</span></span></span></code></pre></div>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/12/03/mixing-2-array-objects-included-dictionary-object-by-javascript/">Mixing 2 Array Objects Included Dictionary Object by Javascript</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>03 Dec 2017, 15:45</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/coffeescripttips">CoffeeScriptTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/coffeescript">CoffeeScript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/object">Object</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/8141f8a063984a111124cd2f0e36f7fb">Gists</a></p>
<p>This is a sample script for combining and mixing 2 objects. Each object is an array which included a dictionary type. When the key of the dictionary object is the same, the values are mixed.</p>
<p><strong>This can be also used for Google Apps Script.</strong></p>
<h2 id="input">Input</h2>
<pre tabindex="0"><code>var obj1 = [
    {&#34;key1&#34;: [&#34;value1a1&#34;, &#34;value1a2&#34;]},
    {&#34;key1&#34;: [&#34;value1aa1&#34;, &#34;value1aa2&#34;]},
    {&#34;key2&#34;: [&#34;value2a1&#34;, &#34;value2a2&#34;]},
    {&#34;key3&#34;: [&#34;value3a1&#34;, &#34;value3a2&#34;]},
];
var obj2 = [
    {&#34;key1&#34;: [&#34;value1b1&#34;, &#34;value1b2&#34;]},
    {&#34;key3&#34;: [&#34;value3b1&#34;, &#34;value3b2&#34;]},
    {&#34;key3&#34;: [&#34;value3bb1&#34;, &#34;value3bb2&#34;]},
    {&#34;key4&#34;: [&#34;value4b1&#34;, &#34;value4b2&#34;]},
];
</code></pre><h2 id="output">Output</h2>
<pre tabindex="0"><code>[
    {&#34;key1&#34;: [&#34;value1a1&#34;, &#34;value1a2&#34;, &#34;value1b1&#34;, &#34;value1b2&#34;, &#34;value1aa1&#34;, &#34;value1aa2&#34;]},
    {&#34;key2&#34;: [&#34;value2a1&#34;, &#34;value2a2&#34;]},
    {&#34;key3&#34;: [&#34;value3a1&#34;, &#34;value3a2&#34;, &#34;value3b1&#34;, &#34;value3b2&#34;, &#34;value3bb1&#34;, &#34;value3bb2&#34;]},
    {&#34;key4&#34;: [&#34;value4b1&#34;, &#34;value4b2&#34;]}
]
</code></pre><h2 id="sample-script-">Sample script :</h2>
<h3 id="javascript-">Javascript :</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">mixture</span>(<span style="color:#a6e22e">obj1</span>, <span style="color:#a6e22e">obj2</span>) {
</span></span><span style="display:flex;"><span>    Array.<span style="color:#a6e22e">prototype</span>.<span style="color:#a6e22e">push</span>.<span style="color:#a6e22e">apply</span>(<span style="color:#a6e22e">obj1</span>, <span style="color:#a6e22e">obj2</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">obj1</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">i</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">temp</span>[<span style="color:#a6e22e">i</span>] <span style="color:#f92672">=</span> <span style="color:#f92672">!~</span><span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">indexOf</span>(Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">e</span>)[<span style="color:#ae81ff">0</span>]) <span style="color:#f92672">?</span> Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">e</span>)[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">temp</span>[<span style="color:#a6e22e">i</span>]) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">e</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">f</span>, <span style="color:#a6e22e">j</span>){
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">f</span>)[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">e</span>)[<span style="color:#ae81ff">0</span>]) {
</span></span><span style="display:flex;"><span>                    Array.<span style="color:#a6e22e">prototype</span>.<span style="color:#a6e22e">push</span>.<span style="color:#a6e22e">apply</span>(<span style="color:#a6e22e">res</span>[<span style="color:#a6e22e">j</span>][Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">f</span>)[<span style="color:#ae81ff">0</span>]], <span style="color:#a6e22e">e</span>[Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">e</span>)[<span style="color:#ae81ff">0</span>]]);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj1</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;key1&#34;</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;value1a1&#34;</span>, <span style="color:#e6db74">&#34;value1a2&#34;</span>]},
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;key1&#34;</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;value1aa1&#34;</span>, <span style="color:#e6db74">&#34;value1aa2&#34;</span>]},
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;key2&#34;</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;value2a1&#34;</span>, <span style="color:#e6db74">&#34;value2a2&#34;</span>]},
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;key3&#34;</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;value3a1&#34;</span>, <span style="color:#e6db74">&#34;value3a2&#34;</span>]},
</span></span><span style="display:flex;"><span>];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj2</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;key1&#34;</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;value1b1&#34;</span>, <span style="color:#e6db74">&#34;value1b2&#34;</span>]},
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;key3&#34;</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;value3b1&#34;</span>, <span style="color:#e6db74">&#34;value3b2&#34;</span>]},
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;key3&#34;</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;value3bb1&#34;</span>, <span style="color:#e6db74">&#34;value3bb2&#34;</span>]},
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;key4&#34;</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;value4b1&#34;</span>, <span style="color:#e6db74">&#34;value4b2&#34;</span>]},
</span></span><span style="display:flex;"><span>];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">mixture</span>(<span style="color:#a6e22e">obj1</span>, <span style="color:#a6e22e">obj2</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">res</span>))
</span></span></code></pre></div><h3 id="coffeescript-">CoffeeScript :</h3>
<p>This is a sample script for coffeescript.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/12/03/mixing-2-array-objects-included-dictionary-object-by-javascript/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/12/01/adding-object-to-object-by-javascript/">Adding Object to Object by Javascript</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>01 Dec 2017, 12:12</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/object">Object</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/7bd06771e627afd9957ef4f13c9661d5">Gists</a></p>
<p>This sample script is for adding object to object by javascript.</p>
<h3 id="script-">Script :</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">key1</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value1&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">key2</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value2&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">key3</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value3&#34;</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj1</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">key4</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value4&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">key5</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value5&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">key6</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value6&#34;</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>Object.<span style="color:#a6e22e">assign</span>(<span style="color:#a6e22e">obj</span>, <span style="color:#a6e22e">obj1</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">obj</span>);
</span></span></code></pre></div><h2 id="result-">Result :</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{ <span style="color:#960050;background-color:#1e0010">key1:</span> <span style="color:#960050;background-color:#1e0010">&#39;value1&#39;,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">key2:</span> <span style="color:#960050;background-color:#1e0010">&#39;value2&#39;,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">key3:</span> <span style="color:#960050;background-color:#1e0010">&#39;value3&#39;,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">key4:</span> <span style="color:#960050;background-color:#1e0010">&#39;value4&#39;,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">key5:</span> <span style="color:#960050;background-color:#1e0010">&#39;value5&#39;,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">key6:</span> <span style="color:#960050;background-color:#1e0010">&#39;value6&#39;</span> }
</span></span></code></pre></div><p><a href="https://jsfiddle.net/896feLjk/">jsfiddle demo</a></p>
<h2 id="reference-">Reference :</h2>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign">Object.assign()</a></li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/04/09/removes-duplicate-json-elements-for-a-value-of-a-certain-key/">Removes Duplicate JSON Elements for a Value of a Certain Key</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Apr 2017, 14:24</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">JsTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This sample removes duplicate JSON elements for a value of a certain key. When the value of the certain key is removed, only a first duplicate element is left. Also I had wanted to be used for Google Apps Script. So it became like this.</p>
<p><strong>Script :</strong></p>
<pre tabindex="0"><code>function removeDup(arr, key){
    var temp = [];
    var out = [];
    arr.forEach( function (e, i) {
        temp[i] = (temp.indexOf(e[key]) === -1) ? e[key] : false;
        if (temp[i]) out.push(e);
    });
    return out;
}
</code></pre><p><strong>JSON :</strong></p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/04/09/removes-duplicate-json-elements-for-a-value-of-a-certain-key/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/03/21/transposing-array-from-n-x-m-to-m-x-n-for-javascript/">Transposing Array From (n x m) To (m x n) for javascript</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>21 Mar 2017, 08:55</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">JsTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This script transposes from an array with n rows x m columns to the array with m rows x n columns. In this script, you can use array of <code>n != m </code>.</p>
<pre tabindex="0"><code>array = [
    [a1, b1, c1, d1, e1],
    [a2, b2, c2, d2, e2],
    [a3, b3, c3, d3, e3],
    [a4, b4, c4, d4, e4],
    [a5, b5, c5, d5, e5],
    [a6, b6, c6, d6, e6],
    [a7, b7, c7, d7, e7],
    [a8, b8, c8, d8, e8],
    [a9, b9, c9, d9, e9],
    [a10, b10, c10, d10, e10]
]
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#a6e22e">i</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">array</span>[<span style="color:#ae81ff">0</span>]){
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">array</span>.<span style="color:#a6e22e">map</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e</span>,<span style="color:#a6e22e">j</span>){<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">e</span>[<span style="color:#a6e22e">i</span>]}));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><pre tabindex="0"><code>result = [
    [a1, a2, a3, a4, a5, a6, a7, a8, a9, a10],
    [b1, b2, b3, b4, b5, b6, b7, b8, b9, b10],
    [c1, c2, c3, c4, c5, c6, c7, c8, c9, c10],
    [d1, d2, d3, d4, d5, d6, d7, d8, d9, d10],
    [e1, e2, e3, e4, e5, e6, e7, e8, e9, e10]
]
</code></pre>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/08/sample-array-script-for-spreadsheet/">Sample Array Script for Spreadsheet</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>08 Feb 2017, 08:50</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">JsTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This is a Sample Array Script for Spreadsheet. It makes an 2D array filled by strings and number. The strings and number are column strings and row number, respectively.</p>
<p><strong>However, because this is a sample, the maximum column number is 26.</strong></p>
<pre tabindex="0"><code>function sa(row, col){
  if (col &gt; 26) return;

  var ar = new Array(row);
  for(var i = 0; i &lt; row; i++) ar[i] = new Array(col);
  for (var i = 0; i &lt; row; i++){
    for (var j = 0; j &lt; col; j++){
      ar[i][j] = String.fromCharCode(i + 97) + String(j + 1);
    }
  }
  return ar.map(function(x, i){return x.map(function(y, j){return ar[j][i]})});
}
</code></pre><p>When &ldquo;sa(10,10)&rdquo; is given, following array can be output.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/02/08/sample-array-script-for-spreadsheet/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>
