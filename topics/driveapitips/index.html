<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="Official profile of Kanshi Tanaike, a Google Developer Expert (GDE) in Google Workspace and Physicist. Specializing in Google Apps Script, Gemini API, and innovative IT solutions.">
  <meta name="generator" content="Hugo 0.157.0">

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tanaikech.github.io/img/og-main.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>tanaike - Google Apps Script, Gemini API Expert & Physicist</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  
  <link rel="alternate" type="application/rss+xml" title="tanaike - Google Apps Script, Gemini API, and Developer Tips"
    href='https://tanaikech.github.io/topics/driveapitips/index.xml' />
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Kanshi Tanaike",
  "alternateName": "tanaike",
  "url": "https://tanaikech.github.io/",
  "image": "https://tanaikech.github.io/img/og-main.png",
  "jobTitle": "Google Developer Expert",
  "honorificPrefix": "Ph.D.",
  "description": "Japanese scientist, Physicist and Google Developer Expert for Google Workspace.",
  "award": "First place in the Outstanding GDE Award 2025",
  "sameAs": [
    "https://twitter.com/tanaikech",
    "https://github.com/tanaikech",
    "https://stackoverflow.com/users/7108653/tanaike",
    "https://developers.google.com/community/experts/directory?text=tanaike",
    "https://zenn.dev/tanaike",
    "https://medium.com/@tanaike"
  ]
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href='https://tanaikech.github.io/topics/driveapitips/index.xml'><i
          class="fas fa-rss fa-fw"></i>RSS</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://www.youtube.com/@tanaike" rel="me" target="_blank"><i class="fab fa-youtube-square fa-fw"></i>YouTube</a>
    </li>
    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2026. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>DriveAPITips</h1>
</div>

<div class="content">
  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/01/09/transferring-owner-of-file-to-other-user-using-google-apps-script/">Transferring Owner of File to Other User using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Jan 2023, 15:04</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/685929fd4e739c943ab0b4c53348a4af">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230109a/fig1a.png" alt=""></p>
<p>This is a sample script for transferring the ownership of a file to another user using Google Apps Script.</p>
<p>In the current stage, about the consumer account (gmail.com) the specification for transferring the ownership of a file has been changed as follows. <a href="https://developers.google.com/drive/api/guides/manage-sharing#transfer-consumer-account">Ref</a></p>
<blockquote>
<ol>
<li>The current owner initiates an ownership transfer by creating or updating the prospective new owner&rsquo;s file permission. The permission must include these settings: role=writer, type=user, and pendingOwner=true. If the new owner is creating a permission for the prospective owner, an email notification is sent to the prospective new owner indicating that they&rsquo;re being asked to assume ownership of the file.</li>
</ol>
</blockquote>
<blockquote>
<ol start="2">
<li>The new owner accepts the ownership transfer request by creating or updating their file permission. The permission must include these settings: role=owner and transferOwnership=true. If the new owner is creating a new permission, an email notification is sent to the previous owner indicating that ownership has been transferred.</li>
</ol>
</blockquote>
<p>When this flow is reflected in the sample script, it becomes as follows.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/01/09/transferring-owner-of-file-to-other-user-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/10/19/workaround-createddate-cannot-be-used-with-searchfiles-of-driveapp-in-google-apps-script/">Workaround: createdDate cannot be used with searchFiles of DriveApp in Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>19 Oct 2022, 10:42</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/2b9d86a7db01f72e88090116cb5fee1f">Gists</a></p>
<p>Unfortunately, in the current stage, in order to retrieve the file list using the created date, the search query of <code>createdDate</code> cannot be used with <code>searchFiles</code> method of <code>DriveApp</code> in Google Apps Script. This has already been reported at <a href="https://issuetracker.google.com/issues/79355545">this issue tracker</a> In this post, I would like to introduce a workaround for searching the files using the created date.</p>
<h2 id="issue-and-workaround">Issue and workaround</h2>
<ul>
<li>
<p>The parameter of &ldquo;searchFiles&rdquo; method of <code>DriveApp</code> uses the search query for Drive API v2. When I tested <code>createdDate &gt; '####-##-##'</code> for &ldquo;searchFiles&rdquo; and &ldquo;Files: list&rdquo; of Drive API v2, I confirmed errors like <code>Invalid argument: q</code> and <code>Invalid query</code> occurred, respectively.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/10/19/workaround-createddate-cannot-be-used-with-searchfiles-of-driveapp-in-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/07/31/gas-library-gasprojectapp/">GAS Library - GASProjectApp</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>31 Jul 2020, 16:22</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p><strong>This is a Google Apps Script library for creating, updating and exporting Google Apps Script project of the standalone type using Drive API. In this case, Apps Script API is not used.</strong></p>
<h2 id="description">Description</h2>
<p>I had reported &ldquo;Drive API cannot create Google Apps Script project no longer&rdquo; before. <a href="https://gist.github.com/tanaikech/0609f2cd989c28d6bd49d211b70b453d">Ref</a> About this, I had reported the future request. <a href="https://issuetracker.google.com/issues/151165846">Ref</a> At July 30, 2020, I could confirm that the Google Apps Script project of the standalone type got to be able to be created by <code>multipart/form-data</code> using Drive API again. <a href="https://gist.github.com/tanaikech/36821c7d70f9ce376d043c3d682d404e">Ref</a> This is a good news for me. By this, in order to use this with Google Apps Script, I created this library. Because in this case, when the update method is used, the special scope of <code>https://www.googleapis.com/auth/drive.scripts</code> is required. So I thought that when this is published as the Google Apps Script library, this will be useful for users.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/07/31/gas-library-gasprojectapp/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/07/30/drive-api-got-to-be-able-to-create-google-apps-script-project-again/">Drive API got to be able to create Google Apps Script project again</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Jul 2020, 17:23</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/news">news</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/36821c7d70f9ce376d043c3d682d404e">Gists</a></p>
<p>I have reported &ldquo;Drive API cannot create Google Apps Script project no longer&rdquo;. <a href="https://gist.github.com/tanaikech/0609f2cd989c28d6bd49d211b70b453d">Ref</a> About this, I had reported the future request. <a href="https://issuetracker.google.com/issues/151165846">Ref</a> Today, I could confirm that the Google Apps Script project of the standalone type got to be able to be created by <code>multipart/form-data</code> using Drive API. This is a good news for me. By this, the following 2 patterns can be used from now.</p>
<h2 id="pattern-1">Pattern 1:</h2>
<ol>
<li>Create new standalone GAS project by Apps Script API.</li>
<li>Put the local script to the created GAS project by updating the project with Apps Script API.</li>
<li>Move the GAS project from the root folder to the specific folder using Drive API.</li>
</ol>
<p>In this pattern, 3 API calls are required.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/07/30/drive-api-got-to-be-able-to-create-google-apps-script-project-again/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/07/30/uploading-files-of-multipart/form-data-to-google-drive-using-drive-api-with-node.js/">Uploading Files of multipart/form-data to Google Drive using Drive API with Node.js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Jul 2020, 11:13</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/33563b6754e5054f3a5832667100fe91">Gists</a></p>
<p>These are the sample scripts for uploading files of <code>multipart/form-data</code> to Google Drive using Drive API with Node.js. In this case, <a href="https://github.com/googleapis/google-api-nodejs-client">googleapis for Node.js</a> is not used.</p>
<p>In these sample script, the maximum file size is 5 MB. Please be careful this. When you want to upload the files more than 5 MB, please check <a href="https://gist.github.com/tanaikech/ae451679e8220f3b2d48edb3f8c1a8d3">this report</a>.</p>
<h2 id="sample-script-1">Sample script 1</h2>
<p>This sample script uploads a file using the modules of <code>fs</code> and <code>request</code>. Before you use this script, please prepare your access token for uploading the file.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/07/30/uploading-files-of-multipart/form-data-to-google-drive-using-drive-api-with-node.js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/07/13/gas-library-ownershiptransfer/">GAS Library - OwnershipTransfer</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Jul 2020, 13:39</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p><strong>This is a Google Apps Script library for achieving the ownership-transfer of the specific folder including the files and sub-folders using Drive API.</strong></p>
<p><img src="https://github.com/tanaikech/OwnershipTransfer/raw/master/images/fig1.png" alt=""></p>
<p><a name="description"></a></p>
<h2 id="important-please-be-careful-this">IMPORTANT: PLEASE BE CAREFUL THIS.</h2>
<h3 id="at-first-please-read-this-section"><strong>At first, please read this section</strong></h3>
<h3><strong><u>I cannot take responsibility for the problems occurred by this library. So when you use this library, please use it by according to your own decision and at your own responsibility.</u></strong></h3>
<p><img src="https://github.com/tanaikech/OwnershipTransfer/raw/master/images/fig2.png" alt=""></p>
<h4 id="this-gas-library-transfers-the-ownership-of-files-and-folders-for-example-when-the-ownership-of-a-file-is-transferred-to-other-account-the-file-cannot-be-managed-by-the-original-user-and-also-when-the-ownership-of-the-specific-folder-is-transferred-to-other-account-all-files-ans-sub-folders-in-the-specific-folder-cannot-be-managed-by-the-original-user-please-be-careful-this-so-when-you-use-this-library-at-first-please-test-this-library-using-a-sample-file-and-folder-please-be-careful-this"><strong>This GAS library transfers the ownership of files and folders. For example, when the ownership of a file is transferred to other account, the file cannot be managed by the original user. And also, when the ownership of the specific folder is transferred to other account, all files ans sub-folders in the specific folder cannot be managed by the original user. PLEASE BE CAREFUL THIS. So when you use this library, at first, please test this library using a sample file and folder. PLEASE BE CAREFUL THIS.</strong></h4>
<h4 id="and-also-the-specification-of-ownership-transfer-might-be-updated-by-google-side-in-the-future-update-because-when-i-had-tested-this-library-i-could-notice-that-the-specification-had-been-changed"><strong>And also, the specification of ownership transfer might be updated by Google side in the future update. Because when I had tested this library, I could notice that the specification had been changed. <a href="https://tanaikech.github.io/2020/07/10/transfer-of-owner-of-files-got-to-be-able-to-be-achieved-with-batch-requests-of-drive-api/">Ref</a> By this, I noticed that the transferred files had no parent folders, and also, the script was required to be modified. From this situation, when you use this script for your important files and folders, please be careful this. At first, PLEASE TEST THIS LIBRARY USING A SIMPLE FILE AND FOLDER.</strong></h4>
<h2 id="description">Description</h2>
<p>Recently, I had the situation that it is required to transfer the ownership of a folder including the files and sub-folders. When I manually transferred the ownership of the top folder from my account to other user&rsquo;s account, although the ownership of top folder could be transferred, my account is left as the writer. And also, the ownership of the files and sub-folders in the top folder was not changed, while the user is the writer. Although I do the same situation using the method of create.permissions in Drive API, the same result was obtained. In the current stage, unfortunately, by the simple method, the complete ownership-transfer of the file including the files and sub-folders cannot be achieved. From this situation, I created the script for achieving the complete ownership-transfer of the files and folders as a Google Apps Script library.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/07/13/gas-library-ownershiptransfer/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/07/09/specification-of-files-copy-in-drive-api-was-changed/">Specification of Files: copy in Drive API was changed</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Jul 2020, 17:03</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/news">news</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>I noticed that the specification of Files: copy in Drive API was changed. About <a href="https://developers.google.com/drive/api/v3/reference/files/copy">the method of Files: copy in Drive API v3</a>, this method could be used with the scope of <code>https://www.googleapis.com/auth/drive.readonly</code> until July 5, 2020. But I confirmed that in the current stage, the scope is required to be changed to the following scopes.</p>
<ul>
<li><code>https://www.googleapis.com/auth/drive</code></li>
<li><code>https://www.googleapis.com/auth/drive.file</code></li>
<li><code>https://www.googleapis.com/auth/drive.appdata</code></li>
<li><code>https://www.googleapis.com/auth/drive.photos.readonly</code></li>
</ul>
<p>Please be careful this.</p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/05/28/creating-shortcut-on-google-drive-using-google-apps-script/">Creating Shortcut on Google Drive using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>28 May 2020, 14:49</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/shortcut">shortcut</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/4639cccc8130cea10d753fee9f900041">Gists</a></p>
<p>This is a sample script for creating a shortcut on Google Drive using Google Apps Script.</p>
<h2 id="sample-script">Sample script</h2>
<p>Before you run the script, <a href="https://developers.google.com/apps-script/guides/services/advanced#enabling_advanced_services">please enable Drive API at Advanced Google services</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">createShortcut</span>(<span style="color:#a6e22e">targetId</span>, <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">folderId</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">resource</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">shortcutDetails</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">targetId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">targetId</span> },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">name</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mimeType</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/vnd.google-apps.shortcut&#34;</span>,
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">folderId</span>) <span style="color:#a6e22e">resource</span>.<span style="color:#a6e22e">parents</span> <span style="color:#f92672">=</span> [{ <span style="color:#a6e22e">id</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">folderId</span> }];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">shortcut</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">insert</span>(<span style="color:#a6e22e">resource</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">shortcut</span>.<span style="color:#a6e22e">id</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Please run this function.
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">targetId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the ID of target file or folder.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">shortcutName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the shortcut name.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">folderId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the folder ID for putting the created shortcut.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">id</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">createShortcut</span>(<span style="color:#a6e22e">targetId</span>, <span style="color:#a6e22e">shortcutName</span>, <span style="color:#a6e22e">folderId</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">id</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="references">References</h2>
<ul>
<li>
<p><a href="https://developers.google.com/apps-script/guides/services/advanced">Advanced Google services</a></p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/05/28/creating-shortcut-on-google-drive-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/05/26/gas-library-copyfolder/">GAS Library - CopyFolder</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>26 May 2020, 07:53</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/copy">copy</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p><strong>This is Google Apps Script library for copying folder on Google Drive.</strong></p>
<p><img src="https://github.com/tanaikech/CopyFolder/blob/master/images/fig1.png" alt=""></p>
<h2 id="description">Description</h2>
<p>I have sometimes the situation that it is required to back up the folder on Google Drive to Google Drive. But unfortunately, the method of <a href="https://developers.google.com/apps-script/reference/drive/file#makecopy"><code>makeCopy()</code></a> of Class File and the method of <a href="https://developers.google.com/drive/api/v3/reference/files/copy"><code>Files: copy</code></a> of Drive API cannot be used for directly copying the folder on Google Drive. So I created this as a library. This library can copy the folder on Google Drive. All files in the folder can be copied to Google Drive with keeping the folder structure. When there are the files with newer modified time in the source folder than those in the destination folder, the files in the destination folder are overwritten by the newer files in the source folder. Also, in this library, the folders in the shared Drive and the publicly shared folders can be used as the source and destination folder.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/05/26/gas-library-copyfolder/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/04/20/updating-a-file-with-resumable-upload-using-drive-api/">Updating a File with Resumable Upload using Drive API</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>20 Apr 2020, 14:41</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/curltips">CurlTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/resumable-upload">resumable-upload</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/bc33a83ac648911d00b43c59a24268fc">Gists</a></p>
<p>This is a sample flow for updating a file with the resumable upload using Drive API.</p>
<h2 id="sample-situation">Sample situation:</h2>
<p>In this answer, as a sample situation, it supposes that a text file in Google Drive is updated by the resumable upload with the multiple chunks. And as the method for requesting, I use the curl command.</p>
<p>I prepared 2 files for 2 chunks. As the test situation, the 2 chunks of <strong>262,144 bytes</strong> and <strong>37,856 bytes</strong> are uploaded. So total upload size is <strong>300,000 bytes</strong>. Those filenames are <code>data1.txt</code> and <code>data2.txt</code>, respectively.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/04/20/updating-a-file-with-resumable-upload-using-drive-api/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/03/13/retrieving-files-and-folders-without-parents-in-google-drive/">Retrieving Files and Folders without Parents in Google Drive</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Mar 2020, 17:00</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/459089e678bad943f0f33e497e04c36f">Gists</a></p>
<p>This is a sample script for retrieving the files and folders which have no parents in own Google Drive.</p>
<p>When you use this script, please enable Drive API at Advanced Google services.</p>
<h2 id="sample-script">Sample script</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">myFunction</span> <span style="color:#f92672">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">token</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">getOAuthToken</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fields</span> <span style="color:#f92672">=</span> decodeURIComponent(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;nextPageToken,files(name,id,mimeType,parents)&#34;</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">q</span> <span style="color:#f92672">=</span> decodeURIComponent(<span style="color:#e6db74">&#34;&#39;me&#39; in owners and trashed = false&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">files</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">pageToken</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`https://www.googleapis.com/drive/v3/files?pageSize=1000&amp;fields=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">fields</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&amp;q=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">q</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&amp;pageToken=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">pageToken</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>      { <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">authorization</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Bearer </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">token</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span> } }
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">res</span>);
</span></span><span style="display:flex;"><span>    Array.<span style="color:#a6e22e">prototype</span>.<span style="color:#a6e22e">push</span>.<span style="color:#a6e22e">apply</span>(<span style="color:#a6e22e">files</span>, <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">files</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">pageToken</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">nextPageToken</span>;
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">pageToken</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">filter</span>(({ <span style="color:#a6e22e">parents</span> }) =&gt; <span style="color:#f92672">!</span><span style="color:#a6e22e">parents</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">result</span>);
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>When you run the script, the files and folders which have no parents in own Google Drive are retrieved.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/03/13/retrieving-files-and-folders-without-parents-in-google-drive/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/03/09/drive-api-cannot-create-google-apps-script-project-no-longer/">Drive API cannot create Google Apps Script project no longer</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Mar 2020, 15:09</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/news">news</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/0609f2cd989c28d6bd49d211b70b453d">Gists</a></p>
<p>Today, I noticed that new Google Apps Script project of the standalone script type cannot be created by the method of Files: create in Drive API. From now, in order to manage the Google Apps Script project, only Google Apps Script API is required to be used. By this, the following issues are brought.</p>
<ul>
<li>When the new standalone GAS project is created in the specific folder by uploading the local script, the following flow is required to be run.
<ol>
<li>Create new standalone GAS project by Apps Script API.</li>
<li>Put the local script to the created GAS project by updating the project with Apps Script API.</li>
<li>Move the GAS project from the root folder to the specific folder using Drive API.</li>
</ol>
</li>
</ul>
<p>From now, 3 API calls are required to be used like above. By the way, this had been able to be achieved by one API call of the method of files.create in Drive API before.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/03/09/drive-api-cannot-create-google-apps-script-project-no-longer/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2019/11/20/moving-file-to-specific-folder-using-google-apps-script/">Moving File to Specific Folder using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>20 Nov 2019, 15:45</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/googledrive">GoogleDrive</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/84dd9e9f79cad87bedb45e21342c0121">Gists</a></p>
<p>These are 3 sample scripts for moving a file to the specific folder in Google Drive using Google Apps Script.</p>
<h2 id="sample-script-1">Sample script 1</h2>
<p>In this script, only Drive Service is used.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">sourceFileId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">destinationFolderId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">sourceFileId</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFolderById</span>(<span style="color:#a6e22e">destinationFolderId</span>).<span style="color:#a6e22e">addFile</span>(<span style="color:#a6e22e">file</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">file</span>
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getParents</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">next</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">removeFile</span>(<span style="color:#a6e22e">file</span>);
</span></span></code></pre></div><h2 id="sample-script-2">Sample script 2</h2>
<p>In this script, only Drive API at Advanced Google services. (In this case, it&rsquo;s Drive API v2.)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">sourceFileId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">destinationFolderId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">update</span>({ <span style="color:#a6e22e">parents</span><span style="color:#f92672">:</span> [{ <span style="color:#a6e22e">id</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">destinationFolderId</span> }] }, <span style="color:#a6e22e">sourceFileId</span>);
</span></span></code></pre></div><h2 id="sample-script-3">Sample script 3</h2>
<p>In this script, only Drive API v3 is used.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2019/11/20/moving-file-to-specific-folder-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2019/10/04/one-time-download-for-google-drive/">One Time Download for Google Drive</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>04 Oct 2019, 11:59</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/download">download</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p>This is a sample script for downloading files from Google Drive by the one time download method.</p>
<h2 id="description">Description</h2>
<p>When you download a file from Google Drive, in generally, the login and the access token are required. If you want to download the file without the authorization for the simple situation, the file is required to be publicly shared. But the file might not be able to be shared publicly, because of various reasons.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2019/10/04/one-time-download-for-google-drive/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2019/03/30/uploading-file-to-shared-folder-using-ggsrun/">Uploading File to Shared Folder using ggsrun</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Mar 2019, 16:42</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/ggsrun">ggsrun</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/ggsrun">ggsrun</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/608f71fb1fccd19d30d597d0f2c345f8">Gists</a></p>
<p><a href="https://github.com/tanaikech/ggsrun">ggsrun</a> is also a CLI application for using Google Drive.</p>
<p>Here, I would like to introduce a sample command. This is a sample command for uploading a file to a shared folder using ggsrun.</p>
<p>This situation supposes that the shared folder is <code>https://drive.google.com/drive/folders/abcdefg?usp=sharing</code> and the folder has the edit permission.</p>
<h3 id="sample-command">Sample command:</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ggsrun u -f <span style="color:#e6db74">&#34;sample.txt&#34;</span> -p <span style="color:#e6db74">&#34;abcdefg&#34;</span> --serviceaccount <span style="color:#e6db74">&#34;###JSON file of Service Account###&#34;</span>
</span></span></code></pre></div><ul>
<li>If you have already used OAuth2, you can upload the file by <code>ggsrun u -f &quot;sample.txt&quot; -p &quot;###folderId###&quot;</code>.</li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/07/12/new-retrieve-old-revision-file-from-google-drive/">(NEW) Retrieve old revision file from Google Drive</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>12 Jul 2017, 13:21</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/curl">curl</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This method was updated at July 12, 2017.</p>
<p>In order to use this, at first, please retrieve your access token and enable Drive API.</p>
<h3 id="1-file-id">1. File ID</h3>
<p>Retrieve file id from file name.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X GET -sSL <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -H <span style="color:#e6db74">&#39;Authorization: Bearer ### Access token ###&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;https://www.googleapis.com/drive/v3/files?q=name=&#34;### FileName ###&#34;&amp;fields=files(id,name)&#39;</span>
</span></span></code></pre></div><p>Reference : <a href="https://developers.google.com/drive/v3/reference/files/list">https://developers.google.com/drive/v3/reference/files/list</a></p>
<h3 id="2-revision-id">2. Revision ID</h3>
<p>Retrieve revision id from file id.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X GET -sSL <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -H <span style="color:#e6db74">&#39;Authorization: Bearer ### Access token ###&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;https://www.googleapis.com/drive/v3/files/### FileID ###/revisions?fields=revisions(id%2CmodifiedTime)&#39;</span>
</span></span></code></pre></div><p>Reference : <a href="https://developers.google.com/drive/v3/reference/revisions/list">https://developers.google.com/drive/v3/reference/revisions/list</a></p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/07/12/new-retrieve-old-revision-file-from-google-drive/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/03/29/retrieve-old-revision-file-from-google-drive/">Retrieve old revision file from Google Drive</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>29 Mar 2017, 16:00</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/curl">curl</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/wget">wget</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>I introduce 2 kinds of methods. One is to use <code>curl</code>. Another is to use <code>wget</code>. At this time, I could know that <code>wget</code> can be also used as same as <code>curl</code>.</p>
<p>In order to use this, at first, please retrieve your access token and enable Drive API.</p>
<h3 id="1-file-id">1. File ID</h3>
<p>Retrieve file id from file name.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X GET -sSL <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -H <span style="color:#e6db74">&#39;Authorization: Bearer ### Access token ###&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;https://www.googleapis.com/drive/v3/files?q=name=&#34;### FileName ###&#34;&amp;fields=files(id,name)&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget -q --header<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Authorization: Bearer ### Access token ###&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;https://www.googleapis.com/drive/v3/files?q=name=&#34;### FileName ###&#34;&amp;fields=files(id,name)&#39;</span> <span style="color:#ae81ff">\
</span></span></span></code></pre></div><p>Reference : <a href="https://developers.google.com/drive/v3/reference/files/list">https://developers.google.com/drive/v3/reference/files/list</a></p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/03/29/retrieve-old-revision-file-from-google-drive/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>
