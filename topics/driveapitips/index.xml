<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Driveapitips on tanaike</title>
    <link>https://tanaikech.github.io/topics/driveapitips/</link>
    <description>Recent content in Driveapitips on tanaike</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja</language>
    <copyright>&amp;copy; 2016. All rights reserved.</copyright>
    <lastBuildDate>Wed, 29 Mar 2017 16:00:06 +0900</lastBuildDate>
    <atom:link href="https://tanaikech.github.io/topics/driveapitips/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Retrieve old revision file from Google Drive</title>
      <link>https://tanaikech.github.io/2017/03/29/retrieve-old-revision-file-from-google-drive</link>
      <pubDate>Wed, 29 Mar 2017 16:00:06 +0900</pubDate>
      
      <guid>https://tanaikech.github.io/2017/03/29/retrieve-old-revision-file-from-google-drive</guid>
      <description>

&lt;p&gt;I introduce 2 kinds of methods. One is to use &lt;code&gt;curl&lt;/code&gt;. Another is to use &lt;code&gt;wget&lt;/code&gt;. At this time, I could know that &lt;code&gt;wget&lt;/code&gt; can be also used as same as &lt;code&gt;curl&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;In order to use this, at first, please retrieve your access token and enable Drive API.&lt;/p&gt;

&lt;h3 id=&#34;1-file-id&#34;&gt;1. File ID&lt;/h3&gt;

&lt;p&gt;Retrieve file id from file name.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;curl -X GET -sSL \
    -H &#39;Authorization: Bearer ### Access token ###&#39; \
    &#39;https://www.googleapis.com/drive/v3/files?q=name=&amp;quot;### FileName ###&amp;quot;&amp;amp;fields=files(id,name)&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;wget -q --header=&#39;Authorization: Bearer ### Access token ###&#39; \
    &#39;https://www.googleapis.com/drive/v3/files?q=name=&amp;quot;### FileName ###&amp;quot;&amp;amp;fields=files(id,name)&#39; \
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Reference : &lt;a href=&#34;https://developers.google.com/drive/v3/reference/files/list&#34;&gt;https://developers.google.com/drive/v3/reference/files/list&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;2-revision-id&#34;&gt;2. Revision ID&lt;/h3&gt;

&lt;p&gt;Retrieve revision id from file id.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;curl -X GET -sSL \
    -H &#39;Authorization: Bearer ### Access token ###&#39; \
    &#39;https://www.googleapis.com/drive/v3/files/### FileID ###/revisions?fields=revisions(id%2CmodifiedTime)&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;wget -q --header=&#39;Authorization: Bearer ### Access token ###&#39; \
    &#39;https://www.googleapis.com/drive/v3/files/### FileID ###/revisions?fields=revisions(id%2CmodifiedTime)&#39; \
    -O out.txt
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Reference : &lt;a href=&#34;https://developers.google.com/drive/v3/reference/revisions/list&#34;&gt;https://developers.google.com/drive/v3/reference/revisions/list&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;3-file-for-revision-id&#34;&gt;3. File for Revision ID&lt;/h3&gt;

&lt;p&gt;Retrieve a file from revision id.&lt;/p&gt;

&lt;h4 id=&#34;for-google-docs&#34;&gt;For Google Docs&lt;/h4&gt;

&lt;p&gt;This sample downloads spreadsheet using revision ID. For URL query, both &lt;code&gt;revisions=### RevisionID ###&lt;/code&gt; and &lt;code&gt;revision=### RevisionID ###&lt;/code&gt; can be used.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;curl -sSLG \
    -d &amp;quot;mimeType=application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&amp;quot; \
    -H &#39;Authorization: Bearer ### Access token ###&#39; \
    &amp;quot;https://www.googleapis.com/drive/v3/files/### FileID ###/export?revisions=### RevisionID ###&amp;quot; \
    -o outputfilename.xlsx
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;wget -q --header=&#39;Authorization: Bearer ### Access token ###&#39; \
    &amp;quot;https://www.googleapis.com/drive/v3/files/### FileID ###/export?revisions=### RevisionID ###&amp;amp;mimeType=application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&amp;quot; \
    -O outputfilename.xlsx
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;This method hasn&amp;rsquo;t been shown in Google, as you say. Although I don&amp;rsquo;t know why, I investigated how to download revision files by trial and error. Finally, I could find it.&lt;/strong&gt; As a result, the method was very simple. But I spent to find this for a lot of time.&lt;/p&gt;

&lt;h4 id=&#34;except-for-google-docs&#34;&gt;Except for Google Docs&lt;/h4&gt;

&lt;p&gt;In the case of except for Google Docs, the revision ID is just file ID. So you can download not only using revision ID, but also as a normal file.&lt;/p&gt;

&lt;h5 id=&#34;pattern-1&#34;&gt;Pattern 1&lt;/h5&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;curl -sSLG \
    -H &#39;Authorization: Bearer ### Access token ###&#39; \
    &amp;quot;https://www.googleapis.com/drive/v3/files/### FileID ###/revisions/### RevisionID ###?alt=media&amp;quot; \
    -o outputfilename
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;pattern-2&#34;&gt;Pattern 2&lt;/h5&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;curl -sSLG \
    -H &#39;Authorization: Bearer ### Access token ###&#39; \
    &amp;quot;https://www.googleapis.com/drive/v3/files/### FileID ###?alt=media&amp;quot; \
    -o outputfilename
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Reference : &lt;a href=&#34;https://developers.google.com/drive/v3/reference/revisions/get&#34;&gt;https://developers.google.com/drive/v3/reference/revisions/get&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>