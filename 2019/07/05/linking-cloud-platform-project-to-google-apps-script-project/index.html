<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.61.0" />

  <title>Linking Cloud Platform Project to Google Apps Script Project &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Linking Cloud Platform Project to Google Apps Script Project</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>05 Jul 2019, 09:17</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/specification">Specification</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/project">Project</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/e945c10917fac34a9d5d58cad768832c">Gists</a></p>
<h2 id="introduction">Introduction</h2>
<p>At April 8, 2019, the specification of Google Apps Script Project was changed. You can see this at <a href="https://developers.google.com/apps-script/guides/cloud-platform-projects">Google Cloud Platform Projects</a>. The official document says as follows.</p>
<blockquote>
<p>Warning: Starting on or after April 8, 2019, the Google Cloud Platform Console won't be able to access the default GCP projects created for new Apps Script projects. Older, existing scripts may have default GCP projects that are still accessible, however. If you have a new script and require access to its GCP project from the Google Cloud Platform Console, you must use a standard GCP project.</p>
</blockquote>
<p>And then,</p>
<blockquote>
<p>When a new Apps Script project is created, a default GCP project is also created behind the scenes. This GCP project is hidden, meaning most users aren't able to directly locate, view, or update the project in the Google Cloud Platform Console. However, admins and domain users that have the resourcemanager.projects.list permission on the parenting GCP folder are able to view and configure default projects.</p>
</blockquote>
<p>By this, when users create new Google Apps Script Project (the container-bound script and the standalone script) after April 8, 2019, it is required to link Cloud Platform Project to the created Google Apps Script Project (GAS project). In this document, I would like to introduce the flow for linking Cloud Platform Project to GAS project.</p>
<h2 id="linking-cloud-platform-project-to-google-apps-script-project">Linking Cloud Platform Project to Google Apps Script Project</h2>
<p>In this section, by creating new Cloud Platform Project and new GAS project, the flow for linking Cloud Platform Project to GAS project is explained.</p>
<h3 id="1-create-new-gas-project">1. Create new GAS project.</h3>
<ol>
<li>In this case, you can create the projects of the container-bound script type and the standalone script type. When the GAS project is created after April 8, 2019, when you see &ldquo;Resource&rdquo; -&gt; &ldquo;Cloud Platform Project&rdquo; at the script editor, the following screen can be seen.
<ul>
<li><img src="https://tanaikech.github.io/img/20190705a-fig1.png" alt=""></li>
</ul>
</li>
<li>By this <strong>This script has an Apps Scriptâ€“managed Cloud Platform project.</strong>, when users want to use Google APIs except for Advanced Google Services, it is required to link Cloud Platform Project to this GAS project.</li>
</ol>
<h3 id="2-create-new-cloud-platform-project">2. Create new Cloud Platform Project</h3>
<ol>
<li>Access to <a href="https://console.cloud.google.com/cloud-resource-manager">Manage resources of Google Cloud Platform</a>. And click &ldquo;CREATE PROJECT&rdquo; like below.
<ul>
<li>If you want to use the existing Cloud Platform Project, please use this.</li>
<li><img src="https://tanaikech.github.io/img/20190705a-fig2.png" alt=""></li>
</ul>
</li>
<li>Input the project name and click &ldquo;CREATE&rdquo; button.</li>
<li>You can see the created Cloud Platform Project by reloading &ldquo;Manage resources of Google Cloud Platform&rdquo;.</li>
<li>For the cerated Cloud Platform Project, open the setting page by clicking &ldquo;Settings&rdquo; like below.
<ul>
<li><img src="https://tanaikech.github.io/img/20190705a-fig3.png" alt=""></li>
</ul>
</li>
</ol>
<h3 id="3-retrieve-the-project-number">3. Retrieve the project number.</h3>
<ol>
<li>You can retrieve the project number like below. In this case, it's <code>123456789012</code>.
<ul>
<li><img src="https://tanaikech.github.io/img/20190705a-fig4.png" alt=""></li>
</ul>
</li>
</ol>
<h3 id="4-create-new-credential">4. Create new credential.</h3>
<p><strong>When new Cloud Platform Project is created, there are no credentials. So when users want to use Google API from outside, it is required to create new credentials.</strong> In the most cases, this situation is required. So here, I would like to introduce to create new credentials. On the other hand, the GAS project linked to Cloud Platform Project automatically creates the credential.</p>
<ol>
<li>From the navigation menu like below, and jump to &ldquo;Credentials&rdquo;
<ul>
<li><img src="https://tanaikech.github.io/img/20190705a-fig5.png" alt=""></li>
<li><img src="https://tanaikech.github.io/img/20190705a-fig6.png" alt=""></li>
</ul>
</li>
<li>Before create the credential, open &ldquo;OAuth concent screen&rdquo; like below. And input &ldquo;Application name&rdquo; and click &ldquo;Save&rdquo; button.
<ul>
<li><img src="https://tanaikech.github.io/img/20190705a-fig7.png" alt=""></li>
</ul>
</li>
<li>Create new credential. Create OAuth client ID like below.
<ul>
<li><img src="https://tanaikech.github.io/img/20190705a-fig8.png" alt=""></li>
</ul>
</li>
<li>Select &ldquo;Web application&rdquo; and input &ldquo;Name&rdquo;. Then, click &ldquo;Create&rdquo; button.
<ul>
<li><img src="https://tanaikech.github.io/img/20190705a-fig9.png" alt=""></li>
</ul>
</li>
<li>By this, new credential could be created.</li>
</ol>
<h3 id="5-link-cloud-platform-project-to-gas-project">5. Link Cloud Platform Project to GAS project.</h3>
<ol>
<li>Open the script editor which is the created new GAS project.</li>
<li>Open a dialog by &ldquo;Resource&rdquo; -&gt; &ldquo;Cloud Platform Project&rdquo; at the script editor. You can see below dialog.
<ul>
<li><img src="https://tanaikech.github.io/img/20190705a-fig1.png" alt=""></li>
</ul>
</li>
<li>Put the retrieved project number to &ldquo;Enter Project Number here&rdquo;.</li>
<li>Click &ldquo;Set Project&rdquo;. And click &ldquo;Confirm&rdquo; button.</li>
<li>When &ldquo;Success! Project Changed&rdquo; is shown, it means that Cloud Platform Project was linked to GAS project.
<ul>
<li><img src="https://tanaikech.github.io/img/20190705a-fig10.png" alt=""></li>
</ul>
</li>
<li>At this time, if &ldquo;Close&rdquo; button cannot be used, you can close the dialog by clicking &ldquo;X&rdquo; button at the top right.</li>
</ol>
<h2 id="note">Note:</h2>
<ul>
<li>In my environment, as a test case, I could confirm that <a href="https://developers.google.com/apps-script/api/reference/rest/v1/scripts/run">the method of scripts.run in Google Apps Script API</a> worked fine using the created credentials and the GAS project linked with Cloud Platform Project.</li>
</ul>
<h2 id="reference">Reference:</h2>
<ul>
<li><a href="https://developers.google.com/apps-script/guides/cloud-platform-projects">Google Cloud Platform Projects</a></li>
</ul>

  


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2019/06/25/dynamically-retrieving-keys-and-values-from-struct-property/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2019/06/25/dynamically-retrieving-keys-and-values-from-struct-property/">Dynamically Retrieving Keys and Values from Struct Property</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2019/07/17/protecting-cells-of-spreadsheet-that-users-copied-from-your-google-drive-to-users-google-drive-using-google-apps-script/">Protecting Cells of Spreadsheet that Users Copied from Your Google Drive to User&#39;s Google Drive using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2019/07/17/protecting-cells-of-spreadsheet-that-users-copied-from-your-google-drive-to-users-google-drive-using-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    }
  });
</script>


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-84325623-1', 'auto');
    ga('send', 'pageview');
  }
</script>







</body>
</html>

