<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.49.2" />

  <title>Figma to Google Slides using Google Apps Script &middot; tanaike</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" target="_blank"><i class="fa fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Figma to Google Slides using Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>11 Nov 2019, 14:43</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/figma">Figma</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/figma">Figma</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/slides">Slides</a>
    
  </div>
  
  

</div>

  

<p><a href="https://gist.github.com/tanaikech/6aeb3ff13765cfba465862e2e2c3dd3b">Gists</a></p>

<p>In this sample script, all pages in the Figma file are retrieved and the retrieved pages are put to new Google Slides as the image.</p>

<h2 id="usage">Usage</h2>

<h3 id="1-retrieve-access-token">1. Retrieve access token</h3>

<p>You can see the method for retrieving the access token at <a href="https://www.figma.com/developers/api#access-tokens">here</a>. Although there is also OAuth2 for retrieving the access token, in your situation, I thought that the method for directly generating the access token on the site might be suitable. So in this answer, the generated access token on the site is used. Please retrieve the access token as follows.</p>

<blockquote>
<p><strong>Generate a personal access token</strong></p>

<ol>
<li>Login to your Figma account.</li>
<li>Head to the Account Settings from the top-left menu inside Figma.</li>
<li>Find the Personal Access Tokens section.</li>
<li>Click Create new token.</li>
<li>A token will be generated. This will be your only chance to copy the token, so make sure you keep a copy of this in a secure place.</li>
</ol>
</blockquote>

<p>The access token is like <code>#####-########-####-####-####-############</code>. At Google Apps Script, the authorization is done by <code>headers: {&quot;X-Figma-Token&quot;: accessToken}</code>.</p>

<h3 id="2-retrieve-file-key">2. Retrieve file key</h3>

<p>In order to retrieve the Figma file using Figma API, the file key is required. You can retrieve the file key from the URL of the file.</p>

<p>The URL of the file is like <code>https://www.figma.com/file/###/sampleFilename</code>. In this case, <code>###</code> is the file key.</p>

<h3 id="3-run-script">3. Run script</h3>

<p>The sample script is as follows. Before you run the script, please set the variables of <code>accessToken</code> and <code>fileKey</code>.</p>

<pre><code class="language-javascript">function myFunction() {
  var accessToken = &quot;###&quot;; // Please set your access token.
  var fileKey = &quot;###&quot;; // Please set the file key.

  var baseUrl = &quot;https://api.figma.com/v1&quot;;
  var params = {
    method: &quot;get&quot;,
    headers: { &quot;X-Figma-Token&quot;: accessToken },
    muteHttpExceptions: true
  };
  var fileInfo = JSON.parse(
    UrlFetchApp.fetch(baseUrl + &quot;/files/&quot; + fileKey, params)
  );
  var children = JSON.parse(
    UrlFetchApp.fetch(
      baseUrl +
        &quot;/images/&quot; +
        fileKey +
        &quot;?format=jpg&amp;scale=3&amp;ids=&quot; +
        fileInfo.document.children
          .map(function(c) {
            return c.id;
          })
          .join(&quot;,&quot;),
      params
    )
  );
  if (!children.err) {
    var s = SlidesApp.create(&quot;sampleSlide&quot;);
    var slide = s.getSlides()[0];
    var keys = Object.keys(children.images);
    keys.forEach(function(c, i) {
      slide.insertImage(children.images[c]);
      if (i != keys.length - 1) slide = s.insertSlide(i + 1);
    });
  } else {
    throw new Error(children);
  }
}
</code></pre>

<ul>
<li>When <code>myFunction()</code> is run, at first, the file information is retrieved with the file key <code>fileKey</code>. Then, all pages are retrieved from the retrieved file information, and the retrieved pages are put to each slide of new Google Slides.</li>
<li>I think that the action of this script is similar to <a href="https://github.com/alyssaxuu/figma-to-google-slides/blob/master/Chrome%20Extension/background.js">the script</a> which is shown at the bottom of your question.</li>
</ul>

<h2 id="note">Note</h2>

<ul>
<li>This is a sample script. So please modify it for your actual situation.</li>
</ul>

<h2 id="references">References</h2>

<ul>
<li><a href="https://www.figma.com/developers/api">Figma API</a></li>
<li><a href="https://developers.google.com/apps-script/reference/url-fetch/url-fetch-app">Class UrlFetchApp</a></li>
<li><a href="https://developers.google.com/apps-script/reference/slides/slides-app">Class SlidesApp</a></li>
<li><a href="https://stackoverflow.com/q/58792786">How do I get Figma API to work with the Google App-script API?</a>

<ul>
<li>I answered this script to the question.</li>
</ul></li>
</ul>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2019/11/08/retrieving-values-from-sheet-filtered-by-slicer-in-spreadsheet-using-google-apps-script/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2019/11/08/retrieving-values-from-sheet-filtered-by-slicer-in-spreadsheet-using-google-apps-script/">Retrieving Values from Sheet Filtered by Slicer in Spreadsheet using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    }
  });
</script>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>
<meta http-equiv="X-UA-Compatible" CONTENT="IE=EmulateIE7" />


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-84325623-1', 'auto');
    ga('send', 'pageview');
  }
</script>





</body>
</html>

