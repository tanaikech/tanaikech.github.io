<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="Official profile of Kanshi Tanaike, a Google Developer Expert (GDE) in Google Workspace and Physicist. Specializing in Google Apps Script, Gemini API, and innovative IT solutions.">
  <meta name="generator" content="Hugo 0.157.0">

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tanaikech.github.io/img/og-main.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>tanaike - Google Apps Script, Gemini API Expert & Physicist</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  
  <link rel="alternate" type="application/rss+xml" title="tanaike - Google Apps Script, Gemini API, and Developer Tips"
    href='https://tanaikech.github.io/index.xml' />
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Kanshi Tanaike",
  "alternateName": "tanaike",
  "url": "https://tanaikech.github.io/",
  "image": "https://tanaikech.github.io/img/og-main.png",
  "jobTitle": "Google Developer Expert",
  "honorificPrefix": "Ph.D.",
  "description": "Japanese scientist, Physicist and Google Developer Expert for Google Workspace.",
  "award": "First place in the Outstanding GDE Award 2025",
  "sameAs": [
    "https://twitter.com/tanaikech",
    "https://github.com/tanaikech",
    "https://stackoverflow.com/users/7108653/tanaike",
    "https://developers.google.com/community/experts/directory?text=tanaike",
    "https://zenn.dev/tanaike",
    "https://medium.com/@tanaike"
  ]
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href='https://tanaikech.github.io/index.xml'><i
          class="fas fa-rss fa-fw"></i>RSS</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://www.youtube.com/@tanaike" rel="me" target="_blank"><i class="fab fa-youtube-square fa-fw"></i>YouTube</a>
    </li>
    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2026. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>tanaike - Google Apps Script, Gemini API, and Developer Tips</h1>
  <h2>The Thinker</h2>
</div>

<div class="content">
  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/11/05/user-runs-script-for-range-protected-by-owner-using-google-apps-script/">User Runs Script for Range Protected by Owner using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>05 Nov 2020, 11:57</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/5ebf492b53de40fe254dba63c8520391">Gists</a></p>
<p>There is a situation that it wants to make users run a script for the range protected by the owner using Google Apps Script. This is a sample script that an user runs a script for the range protected by the owner using Google Apps Script.</p>
<h2 id="demo">Demo</h2>
<p><img src="https://tanaikech.github.io/img/20201105a-img.gif" alt=""></p>
<p>This demonstration shows the following situations.</p>
<ul>
<li>
<p>Spreadsheet is shared with an user.</p>
</li>
<li>
<p>The cell &ldquo;A1&rdquo; is protected by the owner. Other users cannot be edited.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/11/05/user-runs-script-for-range-protected-by-owner-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/10/23/benchmark-process-costs-for-retrieving-values-from-arrays-for-spreadsheet-using-google-apps-script/">Benchmark: Process Costs for Retrieving Values from Arrays for Spreadsheet using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>23 Oct 2020, 16:37</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/benchmark">Benchmark</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/6333d797149ab9d69382d1b368f96e80">Gists</a></p>
<h2 id="introduction">Introduction</h2>
<p>Here, I would like to report the process costs for retrieving the values from the arrays for Spreadsheet using Google Apps Script (GAS). When Spreadsheet is used with Google Apps Script, we have the following situations.</p>
<ol>
<li>
<p>Retrieve values from the multiple rows in a column.</p>
</li>
<li>
<p>Retrieve values from the multiple columns in a row.</p>
</li>
</ol>
<p>When the values are retrieved from above situations, it is required to retrieve the values from 1 dimensional array in the 2 dimensional array. In this report, the process costs for retrieving the values from the 2 dimensional array of above situations have been measured.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/10/23/benchmark-process-costs-for-retrieving-values-from-arrays-for-spreadsheet-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/10/21/creating-multiple-buttons-on-google-spreadsheet-using-google-apps-script/">Creating Multiple Buttons on Google Spreadsheet using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>21 Oct 2020, 11:37</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/17d48dbcf4c1a39663424cae658e50cb">Gists</a></p>
<p>This is a sample script for creating the multiple buttons on Google Spreadsheet using Google Apps Script.</p>
<p>Recently, I have got several contacts about this. I thought that when this is published, it might be useful for other users. So I published this sample script.</p>
<p><img src="https://tanaikech.github.io/img/20201021a-fig1.gif" alt=""></p>
<h2 id="sample-script">Sample script</h2>
<p>Please copy and paste the following script to the script editor of the container-bound script of Google Spreadsheet. And, please set the variables and run the function <code>createButtons</code>. By this, the buttons are created to the cells.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/10/21/creating-multiple-buttons-on-google-spreadsheet-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/10/17/request-of-multipart/form-data-with-simple-request-body-using-google-apps-script/">Request of multipart/form-data with Simple Request Body using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Oct 2020, 11:00</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/multipart">multipart</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/5cd0dc9ea7d75e4a2ff65049ed3d78c3">Gists</a></p>
<p>This is a sample script of the request of <code>multipart/form-data</code> with a simple request body using Google Apps Script. I hope that the users will easy to use Class UrlFetchApp by this report.</p>
<p>This report is the updated post of &ldquo;<a href="https://tanaikech.github.io/2017/07/21/multipart-post-request-using-google-apps-script/">Multipart-POST Request Using Google Apps Script</a>&rdquo;.</p>
<h2 id="description">Description</h2>
<p>I had already reported about this at <a href="https://tanaikech.github.io/2017/07/21/multipart-post-request-using-google-apps-script/">this report</a>. In that case, it was required to create a bit complicated request body to request <code>multipart/form-data</code>. Today, by <a href="https://stackoverflow.com/questions/64382781/api-post-request-in-google-app-script-not-working/64382970?noredirect=1#comment113873694_64382970">a comment</a>, I could notice the sample script of Class UrlFetchApp in the official document had been updated. By this, I thought that <code>multipart/form-data</code> will be requested with a simple request body. In this report, I would like to introduce a sample script for requesting <code>multipart/form-data</code> with a simple request body. But I&rsquo;m not sure whether this request got to be able to be done by the internal update of Class UrlFetchApp.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/10/17/request-of-multipart/form-data-with-simple-request-body-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/10/13/retrieving-all-values-from-all-sheets-from-url-of-2pacx-of-web-published-google-spreadsheet-using-python/">Retrieving All Values from All Sheets from URL of 2PACX- of Web Published Google Spreadsheet using Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Oct 2020, 14:59</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/51628e5e0a2c017329457afdb1936912">Gists</a></p>
<p>This is a sample script for retrieving all values from all sheets from URL of 2PACX- of Web Published Google Spreadsheet using Python.</p>
<p>In this post, it supposes that the Google Spreadsheet has already been published for Web. <a href="https://support.google.com/docs/answer/183965?co=GENIE.Platform%3DDesktop&amp;hl=en">Ref</a></p>
<h2 id="flow">Flow</h2>
<p>The flow of this method is as follows.</p>
<ol>
<li>Retrieve XLSX data from the URL of web published Google Spreadsheet as <code>BytesIO</code> data.
<ul>
<li>The URL is like <code>https://docs.google.com/spreadsheets/d/e/2PACX-###/pubhtml</code>.</li>
</ul>
</li>
<li>XLSX data is parsed with openpyxl.</li>
<li>Retrieve all values from all sheets.</li>
</ol>
<h2 id="sample-script">Sample script</h2>
<p>Please set <code>spreadsheetUrl</code>.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/10/13/retrieving-all-values-from-all-sheets-from-url-of-2pacx-of-web-published-google-spreadsheet-using-python/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/10/13/inserting-text-on-image-using-google-apps-script/">Inserting Text on Image using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Oct 2020, 08:23</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/image">image</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/835642df109731a559e52d831bd3342d">Gists</a></p>
<p>This is a sample script for inserting a text on an image using Google Apps Script.</p>
<h2 id="demo">Demo</h2>
<p><img src="https://tanaikech.github.io/img/20201013a-fig1.gif" alt=""></p>
<p>In this demonstration, &ldquo;sample text&rdquo; is inserted to the image. The image is from <a href="https://www.deviantart.com/k3-studio/art/Rainbow-painting-281090729">https://www.deviantart.com/k3-studio/art/Rainbow-painting-281090729</a>.</p>
<h2 id="preparation">Preparation</h2>
<p>When you use this script, please install the following 2 Google Apps Script libraries.</p>
<ol>
<li><a href="https://github.com/tanaikech/DocsServiceApp">DocsServiceApp</a></li>
<li><a href="https://github.com/tanaikech/ImgApp">ImgApp</a></li>
</ol>
<p>And, <a href="https://developers.google.com/apps-script/guides/services/advanced#enabling_advanced_services">please enable Slides API at Advanced Google services</a>.</p>
<h2 id="flow">Flow</h2>
<p>The flow of this sample script is as follows.</p>
<ol>
<li>Retrieve the image size using ImgApp.</li>
<li>Create new Google Slides with the custom page size using DocsServiceApp.</li>
<li>Put the image and text.</li>
<li>Export the result image.</li>
</ol>
<h2 id="sample-script">Sample script</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fileId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the file ID of image file.
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Please set the text.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">text</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample text&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">left</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">top</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">120</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">width</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">180</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">height</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">60</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fontSize</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">30</span>,
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 1. Retrieve the image size using ImgApp.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">fileId</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">size</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ImgApp</span>.<span style="color:#a6e22e">getSize</span>(<span style="color:#a6e22e">blob</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 2. Create new Google Slides with the custom page size using DocsServiceApp.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample title&#34;</span>, <span style="color:#75715e">// Title of created Slides.
</span></span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">width</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">unit</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;pixel&#34;</span>, <span style="color:#a6e22e">size</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">size</span>.<span style="color:#a6e22e">width</span> },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">height</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">unit</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;pixel&#34;</span>, <span style="color:#a6e22e">size</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">size</span>.<span style="color:#a6e22e">height</span> },
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">presentationId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DocsServiceApp</span>.<span style="color:#a6e22e">createNewSlidesWithPageSize</span>(<span style="color:#a6e22e">object</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 3. Put the image and text.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SlidesApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">presentationId</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">slide</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">getSlides</span>()[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">slide</span>.<span style="color:#a6e22e">insertImage</span>(<span style="color:#a6e22e">blob</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">slide</span>
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">insertTextBox</span>(<span style="color:#a6e22e">text</span>.<span style="color:#a6e22e">text</span>, <span style="color:#a6e22e">text</span>.<span style="color:#a6e22e">left</span>, <span style="color:#a6e22e">text</span>.<span style="color:#a6e22e">top</span>, <span style="color:#a6e22e">text</span>.<span style="color:#a6e22e">width</span>, <span style="color:#a6e22e">text</span>.<span style="color:#a6e22e">height</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getText</span>()
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getTextStyle</span>()
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">setFontSize</span>(<span style="color:#a6e22e">text</span>.<span style="color:#a6e22e">fontSize</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">saveAndClose</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 4. Export the result image.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Slides</span>.<span style="color:#a6e22e">Presentations</span>.<span style="color:#a6e22e">Pages</span>.<span style="color:#a6e22e">getThumbnail</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">presentationId</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">slide</span>.<span style="color:#a6e22e">getObjectId</span>(),
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;thumbnailProperties.thumbnailSize&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;LARGE&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;thumbnailProperties.mimeType&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;PNG&#34;</span>,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">contentUrl</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/=s\d+/</span>, <span style="color:#e6db74">&#34;=s&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">size</span>.<span style="color:#a6e22e">width</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">resultBlob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">url</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getBlob</span>()
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">setName</span>(<span style="color:#e6db74">&#34;Result_&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getName</span>());
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">resultBlob</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">presentationId</span>).<span style="color:#a6e22e">setTrashed</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="note">Note</h2>
<ul>
<li>This is a simple sample script. When you want to add more texts and change the text style, please modify the section 3 of above script.</li>
<li>In this sample, the maximum size of image is <code>25,000,000 pixels^2</code>. <a href="https://gist.github.com/tanaikech/9414d22de2ff30216269ca7be4bce462">Ref</a> Please be careful this.</li>
</ul>
<h2 id="testing">Testing</h2>
<ul>
<li>February 6, 2021: When I tested above sample script, I could confirm that the script worked.</li>
<li>January 3, 2023: When I tested above sample script, I could confirm that the script worked.</li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/10/12/retrieving-all-values-from-all-sheets-from-url-of-2pacx-of-web-published-google-spreadsheet-using-node.js/">Retrieving All Values from All Sheets from URL of 2PACX- of Web Published Google Spreadsheet using Node.js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>12 Oct 2020, 14:23</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/49e1e6515225d810e849b3487142a90d">Gists</a></p>
<p>This is a sample script for retrieving all values from all sheets from URL of 2PACX- of Web Published Google Spreadsheet using Node.js.</p>
<p>In this post, it supposes that the Google Spreadsheet has already been published for Web. <a href="https://support.google.com/docs/answer/183965?co=GENIE.Platform%3DDesktop&amp;hl=en">Ref</a></p>
<p>Before you use this sample script, please install <a href="https://www.npmjs.com/package/xlsx">SheetJS js-xlsx</a>.</p>
<h2 id="flow">Flow</h2>
<p>The flow of this method is as follows.</p>
<ol>
<li>Retrieve XLSX data from the URL of web published Google Spreadsheet as the buffer data.
<ul>
<li>The URL is like <code>https://docs.google.com/spreadsheets/d/e/2PACX-###/pubhtml</code>.</li>
</ul>
</li>
<li>XLSX data is parsed with <a href="https://www.npmjs.com/package/xlsx">SheetJS js-xlsx</a>.</li>
<li>Retrieve all values from all sheets.</li>
</ol>
<h2 id="sample-script">Sample script</h2>
<p>Please set <code>spreadsheetUrl</code>.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/10/12/retrieving-all-values-from-all-sheets-from-url-of-2pacx-of-web-published-google-spreadsheet-using-node.js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/10/12/retrieving-all-values-from-all-sheets-from-url-of-2pacx-of-web-published-google-spreadsheet-using-google-apps-script-and-javascript/">Retrieving All Values from All Sheets from URL of 2PACX- of Web Published Google Spreadsheet using Google Apps Script and Javascript</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>12 Oct 2020, 13:42</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/1876f19638e329253cf352225bd180cd">Gists</a></p>
<p>This is a sample script for retrieving all values from all sheets from URL of 2PACX- of Web Published Google Spreadsheet using Google Apps Script and Javascript.</p>
<p>In this post, it supposes that the Google Spreadsheet has already been published for Web. <a href="https://support.google.com/docs/answer/183965?co=GENIE.Platform%3DDesktop&amp;hl=en">Ref</a></p>
<h2 id="flow">Flow</h2>
<p>The flow of this method is as follows.</p>
<ol>
<li>From the client side, send the URL of web published Google Spreadsheet to the Web Apps created by Google Apps Script.
<ul>
<li>The URL is like <code>https://docs.google.com/spreadsheets/d/e/2PACX-###/pubhtml</code>.</li>
</ul>
</li>
<li>Return the byte array of XLSX data from the Web Apps to the client side.</li>
<li>At the client side, the XLSX data is parsed with <a href="https://github.com/SheetJS/sheetjs">SheetJS js-xlsx</a>.</li>
<li>Retrieve all values from all sheets.</li>
</ol>
<h2 id="usage">Usage</h2>
<h3 id="1-prepare-script">1. Prepare script.</h3>
<p>Please copy and paste the following script to the script editor and save it.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/10/12/retrieving-all-values-from-all-sheets-from-url-of-2pacx-of-web-published-google-spreadsheet-using-google-apps-script-and-javascript/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/10/09/sorting-cells-on-google-spreadsheet-with-background-colors-using-google-apps-script/">Sorting Cells on Google Spreadsheet with Background colors using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Oct 2020, 12:46</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/8e531fdb4125c843b58cf7bef6165786">Gists</a></p>
<p>This is a sample script for sorting the cells on Google Spreadsheet with the background colors using Google Apps Script.</p>
<p>Unfortunately, in the current stage, it seems that <code>sort(sortSpecObj)</code> of Class Range cannot directly sort by the background colors of cells. But when Sheets API is used, this goal can be achieved. Here, &ldquo;SortRangeRequest&rdquo; of the method of &ldquo;spreadsheets.batchUpdate&rdquo; in Sheets API is used.</p>
<p><img src="https://tanaikech.github.io/img/20201009a-fig1.png" alt=""></p>
<h2 id="flow">Flow</h2>
<p>The flow of this sample script is as follows.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/10/09/sorting-cells-on-google-spreadsheet-with-background-colors-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/10/07/statistical-analysis-of-duplicated-questions-for-google-apps-script-tag-in-stackoverflow/">Statistical Analysis of Duplicated Questions for google-apps-script tag in Stackoverflow</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>07 Oct 2020, 13:51</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/stackoverflow">Stackoverflow</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/statistics">Statistics</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/trend">Trend</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/fa8e7002678a377748ae35a33fa5b6eb">Gists</a></p>
<h2 id="introduction">Introduction</h2>
<p>At Stackoverflow, a lot of people post the questions and answer to the questions every day. By this, there are a lot of important information in Stackoverflow. I have already reported &ldquo;Trend of google-apps-script Tag on Stackoverflow&rdquo; using the data retrieved from Stackoverflow. <a href="#references">Ref. 1</a> It is found that the important statistical result can be obtained by analyzing the data on Stackoverflow. In this report, I would like to introduce the statistical analysis of duplicated questions for the <code>google-apps-script</code> tag in Stackoverflow. When the duplicated question is analyzed, it is considered that the important issues for users can be known. As the result, it was found that there are the trend that the duplicated questions related to Javascript, Google Spreadsheet , the process cost and the cooperation with HTML and Javascript are posted.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/10/07/statistical-analysis-of-duplicated-questions-for-google-apps-script-tag-in-stackoverflow/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  

  


<nav class="pagination" role="pagination">
  
  <a href="https://tanaikech.github.io/page/52/"><i class="fa fa-chevron-left"></i></a>
  
  <span>&nbsp;53 / 98&nbsp;</span>
  
  <a href="https://tanaikech.github.io/page/54/"><i class="fa fa-chevron-right"></i></a>
  
</nav>



</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

