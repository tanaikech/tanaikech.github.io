<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="Official profile of Kanshi Tanaike, a Google Developer Expert (GDE) in Google Workspace and Physicist. Specializing in Google Apps Script, Gemini API, and innovative IT solutions.">
  <meta name="generator" content="Hugo 0.157.0">

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tanaikech.github.io/img/og-main.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>tanaike - Google Apps Script, Gemini API Expert & Physicist</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  
  <link rel="alternate" type="application/rss+xml" title="tanaike - Google Apps Script, Gemini API, and Developer Tips"
    href='https://tanaikech.github.io/index.xml' />
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Kanshi Tanaike",
  "alternateName": "tanaike",
  "url": "https://tanaikech.github.io/",
  "image": "https://tanaikech.github.io/img/og-main.png",
  "jobTitle": "Google Developer Expert",
  "honorificPrefix": "Ph.D.",
  "description": "Japanese scientist, Physicist and Google Developer Expert for Google Workspace.",
  "award": "First place in the Outstanding GDE Award 2025",
  "sameAs": [
    "https://twitter.com/tanaikech",
    "https://github.com/tanaikech",
    "https://stackoverflow.com/users/7108653/tanaike",
    "https://developers.google.com/community/experts/directory?text=tanaike",
    "https://zenn.dev/tanaike",
    "https://medium.com/@tanaike"
  ]
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href='https://tanaikech.github.io/index.xml'><i
          class="fas fa-rss fa-fw"></i>RSS</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://www.youtube.com/@tanaike" rel="me" target="_blank"><i class="fab fa-youtube-square fa-fw"></i>YouTube</a>
    </li>
    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2026. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>tanaike - Google Apps Script, Gemini API, and Developer Tips</h1>
  <h2>The Thinker</h2>
</div>

<div class="content">
  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/05/11/updated-goodls-to-v102/">Updated goodls to v102</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>11 May 2018, 20:32</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/clitool">CLITool</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/goodls">goodls</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/cli">CLI</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/golang">golang</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/googledrive">GoogleDrive</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h1 id="goodls-was-updated-to-v102">goodls was updated to v.1.0.2</h1>
<ul>
<li>
<p>v1.0.2 (May 10, 2018)</p>
<ol>
<li>Files with large size has gotten to be able to be used.
<ul>
<li>In order to download files with large size (several gigabytes), files are saved by chunks.</li>
</ul>
</li>
</ol>
</li>
</ul>
<p><font color="#3366CC"><strong>The detail information and how to get this are <a href="https://github.com/tanaikech/goodls">https://github.com/tanaikech/goodls</a>.</strong></font></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/05/07/retrieve-difference-between-2-dimensional-arrays-using-google-apps-script/">Retrieve Difference Between 2 Dimensional Arrays using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>07 May 2018, 09:41</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/compare">compare</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/array">array</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/2abf57eefc667d6c71310db6aa95a44d">Gists</a></p>
<p>This sample script retrieves the difference elements between 2 dimensional arrays using Google Apps Script. In Google Apps Script, 2 dimensional arrays are often used at Google Docs and Google APIs. And from <a href="https://gist.github.com/tanaikech/848aeafaac1ec676900bb78e3ce220b6">my recent report</a>, it has already found that the process cost of <code>filter()</code> is the lowest in the other loop methods. So I use the script like this.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ar1</span> <span style="color:#f92672">=</span> [[<span style="color:#e6db74">&#34;a1&#34;</span>, <span style="color:#e6db74">&#34;b1&#34;</span>, <span style="color:#e6db74">&#34;c1&#34;</span>], [<span style="color:#e6db74">&#34;a2&#34;</span>, <span style="color:#e6db74">&#34;b2&#34;</span>, <span style="color:#e6db74">&#34;c2&#34;</span>], [<span style="color:#e6db74">&#34;a3&#34;</span>, <span style="color:#e6db74">&#34;b3&#34;</span>, <span style="color:#e6db74">&#34;c3&#34;</span>], [<span style="color:#e6db74">&#34;a4&#34;</span>, <span style="color:#e6db74">&#34;b4&#34;</span>, <span style="color:#e6db74">&#34;c4&#34;</span>], [<span style="color:#e6db74">&#34;a5&#34;</span>, <span style="color:#e6db74">&#34;b5&#34;</span>, <span style="color:#e6db74">&#34;c5&#34;</span>]];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ar2</span> <span style="color:#f92672">=</span> [[<span style="color:#e6db74">&#34;a2&#34;</span>, <span style="color:#e6db74">&#34;b2&#34;</span>, <span style="color:#e6db74">&#34;c2&#34;</span>], [<span style="color:#e6db74">&#34;a5&#34;</span>, <span style="color:#e6db74">&#34;b5&#34;</span>, <span style="color:#e6db74">&#34;c5&#34;</span>], [<span style="color:#e6db74">&#34;a1&#34;</span>, <span style="color:#e6db74">&#34;b2&#34;</span>, <span style="color:#e6db74">&#34;c3&#34;</span>]];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ar1</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e</span>) {<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ar2</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">f</span>) {<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">toString</span>() <span style="color:#f92672">==</span> <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">toString</span>()}).<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Logger</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>); <span style="color:#75715e">// [[&#34;a1&#34;,&#34;b1&#34;,&#34;c1&#34;],[&#34;a3&#34;,&#34;b3&#34;,&#34;c3&#34;],[&#34;a4&#34;,&#34;b4&#34;,&#34;c4&#34;]]
</span></span></span></code></pre></div><p>For above script, when it changes from <code>== 0</code> to <code>&gt; 0</code>, the duplication elements can be retrieved as follows.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/05/07/retrieve-difference-between-2-dimensional-arrays-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/05/02/gas-library-batchrequest/">GAS Library - BatchRequest</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>02 May 2018, 15:55</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/concurrent-processes">concurrent-processes</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h1 id="overview">Overview</h1>
<p><strong>This is a library for running Batch Requests using Google Apps Script (GAS).</strong></p>
<h1 id="description">Description</h1>
<p>When users use Google&rsquo;s APIs, one quota is used for one API call. When the batch request is used, several APIs can be called by one quota, although there are some limitations in the batch request. For example, in GAS, Drive API can be used be <code>DriveApp</code>. In this case, the quota is not used for using Drive API. (When <code>Drive</code> of Advanced Google Services is used, the quota is used.) But this is Drive API v2. If users want to use Drive API v3, it is required to directly request each endpoint of Drive API v3. The batch request is much useful for this situation. However, it is a bit difficult for users to use the batch request. Because the batch request is requested by <code>multipart/mixed</code>. I thought that the script may become a bit complicated, because of the request of <code>multipart/mixed</code> using <code>UrlFetchApp</code>. And although I had been looking for the libraries for the batch request, I couldn&rsquo;t find them. So I created this.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/05/02/gas-library-batchrequest/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/04/27/clean-method-for-google-apps-script/">CLEAN method for Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>27 Apr 2018, 09:11</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/vba">VBA</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/clean">clean</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/585597adda7954ba1cde3e724582bac5">Gists</a></p>
<p>This is a sample script which works the same action with the <a href="https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-clean-method-excel">CLEAN method of VBA</a>. The CLEAN method of VBA removes the characters of <code>0-31, 127, 129, 141, 143, 144, 157</code>. Although I had looked for such method for Google Apps Script, I couldn&rsquo;t find it. So I created this. If this is useful for you, I&rsquo;m glad.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">cleanForGAS</span>(<span style="color:#a6e22e">str</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">str</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;string&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">escaped</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">escape</span>(<span style="color:#a6e22e">str</span>.<span style="color:#a6e22e">trim</span>());
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">31</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">i</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#ae81ff">16</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">re</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> RegExp(<span style="color:#e6db74">&#34;%&#34;</span> <span style="color:#f92672">+</span> (<span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">s</span>).<span style="color:#a6e22e">toUpperCase</span>(), <span style="color:#e6db74">&#34;g&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">escaped</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">escaped</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#a6e22e">re</span>, <span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">remove</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;%7F&#34;</span>, <span style="color:#e6db74">&#34;%81&#34;</span>, <span style="color:#e6db74">&#34;%8D&#34;</span>, <span style="color:#e6db74">&#34;%8F&#34;</span>, <span style="color:#e6db74">&#34;%90&#34;</span>, <span style="color:#e6db74">&#34;%9D&#34;</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">remove</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">re</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> RegExp(<span style="color:#a6e22e">e</span>, <span style="color:#e6db74">&#34;g&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">escaped</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">escaped</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#a6e22e">re</span>, <span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">unescape</span>(<span style="color:#a6e22e">escaped</span>).<span style="color:#a6e22e">trim</span>();
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">str</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">cleanForGAS</span>(<span style="color:#a6e22e">str</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/04/26/taking-advantage-of-web-apps-with-google-apps-script/">Taking advantage of Web Apps with Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>26 Apr 2018, 08:35</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/webapps">WebApps</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h1 id="overview">Overview</h1>
<p><strong>This is a report to take advantage of Web Apps with Google Apps Script (GAS).</strong></p>
<h1 id="description">Description</h1>
<p>There is <a href="https://developers.google.com/apps-script/guides/web">Web Apps</a> as one of applications using Google Apps Script (GAS). I sometimes use this Web Apps. But I have only a little the information for the specification of Web Apps. So in order to take more advantage of Web Apps, I investigated and summarized about this. The aim of this report is to become one of the basic information for creating various applications using Web Apps with GAS.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/04/26/taking-advantage-of-web-apps-with-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/04/25/retrieves-all-named-ranges-in-spreadsheet-as-a1notation/">Retrieves All Named Ranges in Spreadsheet as a1Notation</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>25 Apr 2018, 11:34</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/sheets-api">Sheets API</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/namedrange">namedRange</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/aa744c9a15818c002d90eaea6b4efd03">Gists</a></p>
<p>This is a sample script for Google Apps Script (GAS). This script retrieves all named ranges in Spreadsheet. The names and range of the retrieved named ranges are output as the keys and the values of JSON object, respectively. The sample output is <code>{&quot;name1&quot;: &quot;Sheet1!A1:B2&quot;, &quot;name2&quot;: &quot;Sheet2!B1:C2&quot;,,,}</code>. The name of named range has to be only one in the spreadsheet. This was used.</p>
<p><code>Sheets.Spreadsheets.get()</code> of Sheets API can retrieve all named ranges. But the retrieved range is the grid range. So in this sample script, the grid range was converted to a1Notation. The main part of this sample script is here.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/04/25/retrieves-all-named-ranges-in-spreadsheet-as-a1notation/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/04/24/gas-library-runall/">GAS Library - RunAll</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>24 Apr 2018, 08:45</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/concurrent-processes">concurrent-processes</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h1 id="overview">Overview</h1>
<p><strong>This is a library for running the concurrent processing using only native Google Apps Script (GAS).</strong></p>
<h1 id="description">Description</h1>
<p>Have you ever thought about the concurrent processing using only native Google Apps Script (GAS)? So far, I had run the concurrent processing using golang, javascript and python. But the script cannot be used by the trigger event, because these are not native GAS. Recently, it was found that <a href="https://developers.google.com/apps-script/reference/url-fetch/url-fetch-app#fetchAll(Object)">the fetchAll method</a> added by the Google&rsquo;s update at January 19, 2018 is <a href="https://gist.github.com/tanaikech/c0f383034045ab63c19604139ecb0728">worked by the asynchronous processing</a>. By this, the concurrent processing using the native GAS got to be able to be achieved. This library makes users work the concurrent processing of functions using the fetchAll method and the execution API. This can drastically reduce the process cost in the script. And also this can be used under the trigger event. So it is considered that it will be useful for both the limit executing time of 6 minutes for GAS and the limit total executing time of 1 hour/day for the trigger event.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/04/24/gas-library-runall/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/04/19/benchmark-fetchall-method-in-urlfetch-service-for-google-apps-script/">Benchmark: fetchAll method in UrlFetch service for Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>19 Apr 2018, 14:24</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/benchmark">Benchmark</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/urlfetch">UrlFetch</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/c0f383034045ab63c19604139ecb0728">Gists</a></p>
<p>By Google&rsquo;s update at January 19, 2018, <a href="https://developers.google.com/apps-script/reference/url-fetch/url-fetch-app#fetchAll(Object)">fetchAll method</a> was added to the UrlFetch service. When I saw the usage, I couldn&rsquo;t find the detail information about the actual running state. So I investigated about it.</p>
<p>As the result, it was found that the fetchAll method is worked by the asynchronous processing. The returned data is reordered by the order of requests. By this, it was also found that if you want to retrieve the data from the several URL, the process cost of <code>UrlFetchApp.fetchAll()</code> is much lower than that of <code>UrlFetchApp.fetch()</code> using for loop.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/04/19/benchmark-fetchall-method-in-urlfetch-service-for-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/04/16/benchmark-loop-for-array-processing-using-google-apps-script/">Benchmark: Loop for Array Processing using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>16 Apr 2018, 08:27</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/benchmark">Benchmark</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/848aeafaac1ec676900bb78e3ce220b6">Gists</a></p>
<p><a name="TOP"></a></p>
<h1 id="benchmark-loop-for-array-processing-using-google-apps-script">Benchmark: Loop for Array Processing using Google Apps Script</h1>
<center>
April 16, 2018
    Published.
<p>July 26, 2018
Updated.
Result of reduce was added.</p>
<p>Kanshi Tanaike</p>
</center>
<h1 id="introduction">Introduction</h1>
<p><strong>Please be careful! This result can be only used for Google Apps Script.</strong></p>
<p>There are a limit executing time for Google Apps Script (GAS). That is 6 minutes.<a href="#References"><sup>1</sup></a> So users always have to pay attention to reducing the process cost of the scripts. Especially, it is very important to know the process cost for the array processing, because the array processing is often used for spreadsheet and Google APIs. I have already reported &ldquo;Improved Algorithms for Summation of Array Elements&rdquo; as a method for reducing the process cost.<a href="#References"><sup>2</sup></a> In this report, the process cost of &ldquo;loop&rdquo; for the array processing using GAS has been investigated.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/04/16/benchmark-loop-for-array-processing-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/04/14/benchmark-event-objects-for-google-apps-script/">Benchmark: Event Objects for Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>14 Apr 2018, 14:45</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/benchmark">Benchmark</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/4892c97df7ac0504ffd715c2dd6cd546">Gists</a></p>
<h1 id="introduction">Introduction</h1>
<p>There are event objects at Google Apps Script. Typically, users which use Spreadsheet often use <code>onEdit(event)</code>. Here, I would like to introduce the process costs for the event objects using this <code>onEdit(event)</code>.</p>
<p>When <code>onEdit(event)</code> is used for the spreadsheet, <code>event</code> of <code>onEdit(event)</code> has the following structure.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;authMode&#34;</span>: {},
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;range&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;columnStart&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;rowStart&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;rowEnd&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;columnEnd&#34;</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;source&#34;</span>: {},
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;oldValue&#34;</span>: <span style="color:#e6db74">&#34;old sample text&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;user&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;nickname&#34;</span>: <span style="color:#e6db74">&#34;sampleName&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;email&#34;</span>: <span style="color:#e6db74">&#34;sample email&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;sample text&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In this structure, for example, the range of active cell is <code>&quot;range&quot;: {&quot;columnStart&quot;: 1, &quot;rowStart&quot;: 1, &quot;rowEnd&quot;: 1, &quot;columnEnd&quot;: 1 }</code>. Namely, it&rsquo;s &ldquo;A1&rdquo;. Users can use the range of active cell using this event object. In this report, I have investigated the process cost for retrieving the range of active cell as a sample.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/04/14/benchmark-event-objects-for-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  

  


<nav class="pagination" role="pagination">
  
  <a href="https://tanaikech.github.io/page/78/"><i class="fa fa-chevron-left"></i></a>
  
  <span>&nbsp;79 / 98&nbsp;</span>
  
  <a href="https://tanaikech.github.io/page/80/"><i class="fa fa-chevron-right"></i></a>
  
</nav>



</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

