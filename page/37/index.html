<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="Official profile of Kanshi Tanaike, a Google Developer Expert (GDE) in Google Workspace and Physicist. Specializing in Google Apps Script, Gemini API, and innovative IT solutions.">
  <meta name="generator" content="Hugo 0.157.0">

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tanaikech.github.io/img/og-main.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>tanaike - Google Apps Script, Gemini API Expert & Physicist</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  
  <link rel="alternate" type="application/rss+xml" title="tanaike - Google Apps Script, Gemini API, and Developer Tips"
    href='https://tanaikech.github.io/index.xml' />
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Kanshi Tanaike",
  "alternateName": "tanaike",
  "url": "https://tanaikech.github.io/",
  "image": "https://tanaikech.github.io/img/og-main.png",
  "jobTitle": "Google Developer Expert",
  "honorificPrefix": "Ph.D.",
  "description": "Japanese scientist, Physicist and Google Developer Expert for Google Workspace.",
  "award": "First place in the Outstanding GDE Award 2025",
  "sameAs": [
    "https://twitter.com/tanaikech",
    "https://github.com/tanaikech",
    "https://stackoverflow.com/users/7108653/tanaike",
    "https://developers.google.com/community/experts/directory?text=tanaike",
    "https://zenn.dev/tanaike",
    "https://medium.com/@tanaike"
  ]
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href='https://tanaikech.github.io/index.xml'><i
          class="fas fa-rss fa-fw"></i>RSS</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://www.youtube.com/@tanaike" rel="me" target="_blank"><i class="fab fa-youtube-square fa-fw"></i>YouTube</a>
    </li>
    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2026. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>tanaike - Google Apps Script, Gemini API, and Developer Tips</h1>
  <h2>The Thinker</h2>
</div>

<div class="content">
  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/08/20/report-efficiently-creating-web-apps-using-a-google-apps-script-library/">Report: Efficiently Creating Web Apps using a Google Apps Script library</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>20 Aug 2022, 14:00</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/90ac88cf1a74989e649a4e49a5ed1ab9">Gists</a></p>
<p>This is a sample script for efficiently creating Web Apps using a Google Apps Script library.</p>
<p>When a Google Apps Script library is used for creating Web Apps, the following advantage can be obtained.</p>
<ul>
<li>The script of the client-side can be simpler. Because most scripts for constructing Web Apps are included in the Google Apps Script library.</li>
<li>When the script of Web Apps (In this case, the script of Google Apps Script library is modified.) is modified, the latest script is reflected in the Web Apps, immediately. Because when the Google Apps Script library is used as the latest version when the script of the library is modified, the client can use the latest script of the library, immediately. So, the downtime of Web Apps can be reduced.
<ul>
<li>By this, it is not required to manually reflect the latest version of the script to the Web Apps.</li>
</ul>
</li>
<li>When you can change the script of Web Apps by changing the deployed version of the library.</li>
</ul>
<p>The sample script for explaining this is as follows.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/08/20/report-efficiently-creating-web-apps-using-a-google-apps-script-library/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/08/19/benchmark-high-efficiency-finding-and-replacing-many-values-in-google-spreadsheet-with-low-process-cost-using-google-apps-script/">Benchmark: High-Efficiency Finding and Replacing Many Values in Google Spreadsheet with Low Process Cost using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>19 Aug 2022, 15:11</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/benchmark">Benchmark</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/benchmark">Benchmark</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/6fc2f3ea6d09ce2906e7922c76c0b238">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20220819a/fig1.png" alt=""></p>
<p>This is a sample script for high-efficiency finding and replacing many values in Google Spreadsheet with the low process cost using Google Apps Script.</p>
<p>When the various values are replaced in Google Spreadsheet using Google Apps Script, I&rsquo;m worried about the process cost. So, in this report, I would like to introduce a sample script for high-efficiency achieving this.</p>
<p>As the result, using a sample situation, when the process cost of the sample script using Sheets API is compared with that of the sample script using Spreadsheet services (SpreadsheetApp), it was found that the above script using Sheets API could reduce the process cost by about 70 % from the script using Spreadsheet service.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/08/19/benchmark-high-efficiency-finding-and-replacing-many-values-in-google-spreadsheet-with-low-process-cost-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/08/18/updating-destination-sheet-by-source-sheet-in-google-spreadsheet-using-google-apps-script/">Updating Destination Sheet by Source Sheet in Google Spreadsheet using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>18 Aug 2022, 14:50</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/9970ebf1bd3c7475df57126f5d544f89">Gists</a></p>
<p>This is a sample script for updating the destination sheet by the source sheet in Google Spreadsheet using Google Apps Script.</p>
<p>The sample situation is as follows.</p>
<p><img src="https://tanaikech.github.io/image-storage/20220818a/fig1.png" alt=""></p>
<h2 id="sample-script">Sample script</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetNames</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;Sheet1&#34;</span>, <span style="color:#e6db74">&#34;Sheet2&#34;</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Retrieve values from source and destination sheets.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">srcSheet</span>, <span style="color:#a6e22e">dstSheet</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheetNames</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">s</span>) =&gt; <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">s</span>));
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">srcValues</span>, <span style="color:#a6e22e">dstValues</span>] <span style="color:#f92672">=</span> [<span style="color:#a6e22e">srcSheet</span>, <span style="color:#a6e22e">dstSheet</span>].<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">s</span>) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">getDataRange</span>().<span style="color:#a6e22e">getValues</span>()
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Create an array for updating the destination sheet.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">srcObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">srcValues</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">o</span>, <span style="color:#a6e22e">r</span>) =&gt; ((<span style="color:#a6e22e">o</span>[<span style="color:#a6e22e">r</span>[<span style="color:#ae81ff">0</span>]] <span style="color:#f92672">=</span> <span style="color:#a6e22e">r</span>), <span style="color:#a6e22e">o</span>), {});
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    ...<span style="color:#a6e22e">dstValues</span>.<span style="color:#a6e22e">map</span>(([<span style="color:#a6e22e">a</span>, ...<span style="color:#a6e22e">v</span>]) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">srcObj</span>[<span style="color:#a6e22e">a</span>]) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">srcObj</span>[<span style="color:#a6e22e">a</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">delete</span> <span style="color:#a6e22e">srcObj</span>[<span style="color:#a6e22e">a</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">temp</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> [<span style="color:#a6e22e">a</span>, ...<span style="color:#a6e22e">v</span>];
</span></span><span style="display:flex;"><span>    }),
</span></span><span style="display:flex;"><span>    ...Object.<span style="color:#a6e22e">values</span>(<span style="color:#a6e22e">srcObj</span>),
</span></span><span style="display:flex;"><span>  ];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Update the destination sheet.
</span></span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">dstSheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span>, <span style="color:#a6e22e">values</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">length</span>).<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">values</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>
<p>In this sample script, &ldquo;Sheet1&rdquo; and &ldquo;Sheet2&rdquo; are the source and destination sheets, respectively.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/08/18/updating-destination-sheet-by-source-sheet-in-google-spreadsheet-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/08/17/moving-cell-detection-on-google-spreadsheet-using-google-apps-script/">Moving Cell Detection on Google Spreadsheet using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Aug 2022, 11:05</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/5939e3de5e24ce389beade94158bdb7d">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20220817b/fig1.gif" alt=""></p>
<p>This is a sample script for detecting whether the specific cells on Google Spreadsheet are manually moved using Google Apps Script.</p>
<p>In this case, the named range, OnChange trigger, and PropertiesService are used.</p>
<h2 id="usage">Usage:</h2>
<h3 id="1-create-a-named-range">1. Create a named range.</h3>
<p>As a sample, please create a named range to the cells &ldquo;A2:B2&rdquo; as &ldquo;sampleNamedRange1&rdquo;. <a href="https://support.google.com/docs/answer/63175">Ref</a></p>
<h3 id="2-prepare-sample-script">2. Prepare sample script.</h3>
<p>Please copy and paste the following script to the script editor of Spreadsheet. And, <a href="https://developers.google.com/apps-script/guides/triggers/installable#managing_triggers_manually">please install OnChange trigger to the function <code>installedOnChange</code></a>.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/08/17/moving-cell-detection-on-google-spreadsheet-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/08/17/using-richtextvalues-with-custom-function-on-google-spreadsheet/">Using RichTextValues with Custom Function on Google Spreadsheet</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Aug 2022, 09:11</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/1d63fcd5152688da68e9974167ca744f">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20220817a/fig1.gif" alt=""></p>
<p>In this post, I would like to introduce the method for using RichTextValue with a custom function of Google Apps Script.</p>
<p>This sample is for <a href="https://stackoverflow.com/q/73367517/7108653">this thread in Stackoverflow</a>.</p>
<p>In this thread, the OP&rsquo;s goal is as follows.</p>
<ul>
<li>Put a text to a cell. In this case, use a hyperlink in a part of the text.</li>
<li>This is required to be achieved using a custom function.</li>
</ul>
<p>In the current stage, in order to reflect the hyperlink in a part of the text, it is required to use <code>setRichTextValue</code> of Google Apps Script. In this case, this method cannot be used with the custom function. This is the current specification.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/08/17/using-richtextvalues-with-custom-function-on-google-spreadsheet/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/08/13/retrieving-icons-of-each-mimetype-on-google-drive-using-google-apps-script/">Retrieving Icons of each mimeType on Google Drive using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Aug 2022, 16:24</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/1c0bd1e88b67f19b77d79c9f631b001d">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20220813a/fig1.png" alt=""></p>
<p>This is a sample script for retrieving icons of each mimeType on Google Drive using Google Apps Script.</p>
<h2 id="sample-script">Sample script</h2>
<p>Sample list of <code>mimeType</code> is from <a href="https://developers.google.com/drive/api/guides/mime-types">this official document</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getIcons</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">iconSize</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">256</span>; <span style="color:#75715e">// Pixels
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">mimeTypes</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.audio&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.document&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.drive-sdk&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.drawing&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.file&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.folder&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.form&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.fusiontable&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.jam&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.map&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.photo&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.presentation&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.script&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.shortcut&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.site&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.spreadsheet&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.unknown&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application/vnd.google-apps.video&#34;</span>,
</span></span><span style="display:flex;"><span>  ];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">imageUrls</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">mimeTypes</span>.<span style="color:#a6e22e">map</span>(
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">e</span>) =&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`https://drive-thirdparty.googleusercontent.com/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">iconSize</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/type/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">e</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blobs</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetchAll</span>(<span style="color:#a6e22e">imageUrls</span>).<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">r</span>, <span style="color:#a6e22e">i</span>) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">getBlob</span>().<span style="color:#a6e22e">setName</span>(<span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">mimeTypes</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">.png`</span>)
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">zip</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">zip</span>(<span style="color:#a6e22e">blobs</span>, <span style="color:#e6db74">&#34;sampleIcons.zip&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">zip</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>
<p>When this script is run, a ZIP file including icons is created to the root folder.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/08/13/retrieving-icons-of-each-mimetype-on-google-drive-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/08/10/report-challenging-exporting-selected-cells-on-spreadsheet-as-image-using-google-apps-script-and-javascript/">Report: Challenging Exporting Selected Cells on Spreadsheet as Image using Google Apps Script and Javascript</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>10 Aug 2022, 10:57</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/fbf47fe7b8e3e57ee49f24563550c113">Gists</a></p>
<h1 id="updated-on-january-25-2024">Updated on January 25, 2024</h1>
<h2 id="overview">Overview:</h2>
<p>This is a report for challenging exporting the selected cells on Spreadsheet as an image using Google Apps Script and Javascript.</p>
<p><img src="https://tanaikech.github.io/image-storage/20220810a/fig1.gif" alt=""></p>
<h2 id="description">Description:</h2>
<p>This report is based on <a href="https://stackoverflow.com/q/73204237/7108653">this question by Max Makhrov</a>. When I saw this question, I remembered that there are many questions for asking this in Stackoverflow. And, I thought that when this is achieved, it will be useful for the owner of this question and a lot of users. So, I have discussed this in his question.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/08/10/report-challenging-exporting-selected-cells-on-spreadsheet-as-image-using-google-apps-script-and-javascript/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/08/09/javascript-library-cropimagebyborder_js/">Javascript library - CropImageByBorder_js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Aug 2022, 16:44</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/image">image</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="javascript-library-for-cropping-image-by-border">Javascript Library for Cropping Image by Border</h2>
<h3 id="overview">Overview</h3>
<p>This is a Javascript library for cropping images by the border.</p>
<h3 id="description">Description</h3>
<p>When an image is used, there is a case where I wanted to simply crop the image by a script. In this Javascript library, the image is cropped by a border. The sample situation is as follows.</p>
<p><img src="https://tanaikech.github.io/image-storage/20220809a/fig1.png" alt=""></p>
<p>In this sample situation, a red rectangle is enclosed by a border (1 pixel) with &ldquo;#000000&rdquo;. By this border, this library crops the red rectangle. In this case, the 1-pixel border is not included in the resulting image.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/08/09/javascript-library-cropimagebyborder_js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/08/08/clearing-discrete-cell-values-on-multiple-sheets-using-google-apps-script/">Clearing Discrete Cell Values on Multiple Sheets using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>08 Aug 2022, 08:57</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/6b1ce61475e35416ce0e728a7fd3018c">Gists</a></p>
<p>This is a sample script for clearing the discrete cell values on multiple sheets using Google Apps Script.</p>
<p>There might be a case where you want to clear the values of the discrete cells in the multiple sheets using Google Apps Script. In this post, I would like to introduce the efficient script for achieving this.</p>
<h2 id="sample-script-1">Sample script 1</h2>
<p>Please copy and paste the following script to the script editor of the Google Spreadsheet you want to use.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/08/08/clearing-discrete-cell-values-on-multiple-sheets-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/08/07/sample-script-for-resumable-upload-to-google-drive-using-axios-with-node.js/">Sample Script for Resumable Upload to Google Drive using Axios with Node.js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>07 Aug 2022, 09:26</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/axios">Axios</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/resumable-upload">resumable-upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/5212f2a8127e1c0a70c8642e298ae661">Gists</a></p>
<p>This is a sample script for the resumable upload using Axios with Node.js.</p>
<h2 id="sample-script">Sample script</h2>
<p>In this sample script, as a sample situation in order to explain the resumable upload, the file data is loaded from the local PC, and the data is uploaded to Google Drive with the resumable upload.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">axios</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;axios&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fs</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;fs&#34;</span>).<span style="color:#a6e22e">promises</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">filepath</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./###&#34;</span>; <span style="color:#75715e">// Please set the filename and file path of the upload file.
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">new_access_token</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set your access token.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the filename on Google Drive.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">mimeType</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the mimeType of the uploading file. I thought that when this might not be required to be used.
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 1. Prepare chunks from loaded file data.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">split</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">262144</span>; <span style="color:#75715e">// This is a sample chunk size.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">readFile</span>(<span style="color:#a6e22e">filepath</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fileSize</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">array</span> <span style="color:#f92672">=</span> [...<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Int8Array</span>(<span style="color:#a6e22e">data</span>)];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">chunks</span> <span style="color:#f92672">=</span> [...Array(Math.<span style="color:#a6e22e">ceil</span>(<span style="color:#a6e22e">array</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">/</span> <span style="color:#a6e22e">split</span>))].<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">_</span>) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Int8Array</span>(<span style="color:#a6e22e">array</span>.<span style="color:#a6e22e">splice</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">split</span>)))
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 2. Retrieve endpoint for uploading a file.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res1</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">axios</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;POST&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">url</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://www.googleapis.com/upload/drive/v3/files?uploadType=resumable&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">Authorization</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Bearer </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">new_access_token</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;Content-Type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json&#34;</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">data</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">mimeType</span> }),
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">location</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">res1</span>.<span style="color:#a6e22e">headers</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 3. Upload the data using chunks.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">start</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">chunks</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">end</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">start</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">chunks</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res2</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">axios</span>({
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;PUT&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">url</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">location</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> { <span style="color:#e6db74">&#34;Content-Range&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`bytes </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">start</span><span style="color:#e6db74">}</span><span style="color:#e6db74">-</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">end</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">fileSize</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span> },
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">data</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">chunks</span>[<span style="color:#a6e22e">i</span>],
</span></span><span style="display:flex;"><span>    }).<span style="color:#66d9ef">catch</span>(({ <span style="color:#a6e22e">response</span> }) =&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>({ <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">status</span>, <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">data</span> })
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">start</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">end</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">res2</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">data</span>) <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res2</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">data</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">sample</span>();
</span></span></code></pre></div><h2 id="testing">Testing</h2>
<p>When this sample script is run, the following result is obtained.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/08/07/sample-script-for-resumable-upload-to-google-drive-using-axios-with-node.js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  

  


<nav class="pagination" role="pagination">
  
  <a href="https://tanaikech.github.io/page/36/"><i class="fa fa-chevron-left"></i></a>
  
  <span>&nbsp;37 / 98&nbsp;</span>
  
  <a href="https://tanaikech.github.io/page/38/"><i class="fa fa-chevron-right"></i></a>
  
</nav>



</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

