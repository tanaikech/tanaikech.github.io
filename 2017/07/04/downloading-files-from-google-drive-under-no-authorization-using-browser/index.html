<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Downloading Files From Google Drive Under No Authorization Using Browser &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Downloading Files From Google Drive Under No Authorization Using Browser</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>04 Jul 2017, 15:57</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/download">download</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/webapps">webapps</a>
    
  </div>
  
  

</div>

  <p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><a href="https://gist.github.com/tanaikech/c5b2811bce01cbcc26ffa357df496379">Gist</a></p>
<p>This is a sample script for downloading files from Google Drive under no authorization using browser. By using this sample, you can make other users download files from your Google Drive. Even if the other users are not Google users, they can download the files.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h2 id="demo">Demo</h2>
<p><img src="https://tanaikech.github.io/img/20170704-demo_simple.gif" alt=""></p>
<p>This is a demonstration for downloading files from Google Drive under no authorization using browser. From the top document, You can see that an user who is not owner of Google Drive is downloading files.</p>
<h2 id="problems-and-workaround">Problems and Workaround</h2>
<p>In order to download files from Google Drive under no authorization, there are some problems. When files are downloaded from Google Drive, it is necessary to use Download Link and Drive API.</p>
<ol>
<li>In the case of use the Download Link for each file, only owner of Google Drive can download the files, even if the permission of files are changed as the ANYONE.</li>
<li>In the case of use the Drive API, users have to authorize at Google using OAuth2 process.</li>
</ol>
<p>I have already known that files can download under no authorization using <a href="https://tanaikech.github.io/2017/03/20/download-files-without-authorization-from-google-drive/">base64</a> and <a href="https://tanaikech.github.io/2017/05/10/file-transfer-for-google-drive-without-authorization/">byte array</a>. For these problems, I solved this using base64.</p>
<h2 id="sample-script">Sample Script</h2>
<p>In order to use this sample script, it is necessary to deploy Web Apps. The how to deploy Web Apps is as follows.</p>
<ul>
<li>On the Script Editor
<ul>
<li>File</li>
<li>-&gt; Manage Versions</li>
<li>-&gt; Save New Version</li>
<li>Publish</li>
<li>-&gt; Deploy as Web App</li>
<li>-&gt; At Execute the app as, select <strong>&ldquo;your account&rdquo;</strong></li>
<li>-&gt; At Who has access to the app, select <strong>&ldquo;Anyone, even anonymous&rdquo;</strong></li>
<li>-&gt; Click &ldquo;Deploy&rdquo;</li>
<li>-&gt; Copy <strong>&ldquo;Current web app URL&rdquo;</strong></li>
<li>-&gt; Click &ldquo;OK&rdquo;</li>
</ul>
</li>
</ul>
<p>And then, please copy and paste following respective HTML and GAS to your script editor. You can use the sample for the script of both container-bound script and standalone script. Following image is the project pasted the sample script. You can see the 2 files in the project.</p>
<p><img src="https://tanaikech.github.io/img/20170704-project.png" alt=""></p>
<h3 id="script">Script</h3>
<h4 id="html">HTML</h4>
<p>Filename is <code>index.html</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">http-equiv</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Content-Type&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/html; charset=UTF-8&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://code.jquery.com/jquery-3.2.1.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;files&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">table</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;table table-striped table-hover&#34;</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">thead</span>&gt;
</span></span><span style="display:flex;"><span>                    &lt;<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>                        &lt;<span style="color:#f92672">th</span>&gt;Download&lt;/<span style="color:#f92672">th</span>&gt;
</span></span><span style="display:flex;"><span>                        &lt;<span style="color:#f92672">th</span>&gt;FileName&lt;/<span style="color:#f92672">th</span>&gt;
</span></span><span style="display:flex;"><span>                        &lt;<span style="color:#f92672">th</span>&gt;Size[byte]&lt;/<span style="color:#f92672">th</span>&gt;
</span></span><span style="display:flex;"><span>                        &lt;<span style="color:#f92672">th</span>&gt;Parents&lt;/<span style="color:#f92672">th</span>&gt;
</span></span><span style="display:flex;"><span>                        &lt;<span style="color:#f92672">th</span>&gt;Updated&lt;/<span style="color:#f92672">th</span>&gt;
</span></span><span style="display:flex;"><span>                        &lt;<span style="color:#f92672">th</span>&gt;Created&lt;/<span style="color:#f92672">th</span>&gt;
</span></span><span style="display:flex;"><span>                    &lt;/<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;/<span style="color:#f92672">thead</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">tbody</span>&gt;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">&lt;? for (var i = 0; i &lt; data.length; i++) { ?&gt;</span>
</span></span><span style="display:flex;"><span>                        &lt;<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>                            &lt;<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>                                &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;checkbox&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;checkbox&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;fileId&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&lt;?= data[i].file_id  ?&gt;&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>                            &lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>                            &lt;<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>                                <span style="color:#75715e">&lt;?= data[i].file_name ?&gt;</span>
</span></span><span style="display:flex;"><span>                            &lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>                            &lt;<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>                                <span style="color:#75715e">&lt;?= data[i].file_size ?&gt;</span>
</span></span><span style="display:flex;"><span>                            &lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>                            &lt;<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>                                <span style="color:#75715e">&lt;?= data[i].folder_tree ?&gt;</span>
</span></span><span style="display:flex;"><span>                            &lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>                            &lt;<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>                                <span style="color:#75715e">&lt;?= data[i].file_updated ?&gt;</span>
</span></span><span style="display:flex;"><span>                            &lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>                            &lt;<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>                                <span style="color:#75715e">&lt;?= data[i].file_created ?&gt;</span>
</span></span><span style="display:flex;"><span>                            &lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>                        &lt;/<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>                        <span style="color:#75715e">&lt;? } ?&gt;</span>
</span></span><span style="display:flex;"><span>                &lt;/<span style="color:#f92672">tbody</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;/<span style="color:#f92672">table</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;allchk&#34;</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;checkbox&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;allCheck01&#34;</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">label</span> <span style="color:#a6e22e">for</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;allCheck01&#34;</span>&gt;Check All&lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;button&#34;</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;create&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Download&#34;</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;google.script.run.withSuccessHandler(executeDownload).getparams(this.parentNode)&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dl&#34;</span> <span style="color:#a6e22e">target</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;_blank&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#&#34;</span>&gt;&lt;/<span style="color:#f92672">a</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">$</span>(<span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">$</span>(<span style="color:#e6db74">&#39;.table tr&#39;</span>).<span style="color:#a6e22e">click</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">event</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">type</span> <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#39;checkbox&#39;</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">$</span>(<span style="color:#e6db74">&#39;:checkbox&#39;</span>, <span style="color:#66d9ef">this</span>).<span style="color:#a6e22e">trigger</span>(<span style="color:#e6db74">&#39;click&#39;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">$</span>(<span style="color:#e6db74">&#39;.allchk input&#39;</span>).<span style="color:#a6e22e">click</span>(<span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">files</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">$</span>(<span style="color:#e6db74">&#39;.files&#39;</span>).<span style="color:#a6e22e">find</span>(<span style="color:#e6db74">&#39;input&#39;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">$</span>(<span style="color:#66d9ef">this</span>).<span style="color:#a6e22e">is</span>(<span style="color:#e6db74">&#39;:checked&#39;</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">$</span>(<span style="color:#a6e22e">files</span>).<span style="color:#a6e22e">prop</span>(<span style="color:#e6db74">&#39;checked&#39;</span>, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">$</span>(<span style="color:#a6e22e">files</span>).<span style="color:#a6e22e">prop</span>(<span style="color:#e6db74">&#39;checked&#39;</span>, <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">executeDownload</span>(<span style="color:#a6e22e">base64dat</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">$</span>(<span style="color:#e6db74">&#34;#dl&#34;</span>).<span style="color:#a6e22e">prop</span>(<span style="color:#e6db74">&#34;href&#34;</span>, window.<span style="color:#a6e22e">URL</span>.<span style="color:#a6e22e">createObjectURL</span>(<span style="color:#a6e22e">toBlob</span>(<span style="color:#a6e22e">base64dat</span>))).<span style="color:#a6e22e">prop</span>(<span style="color:#e6db74">&#34;download&#34;</span>, <span style="color:#e6db74">&#34;dl_&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">getfmtDate</span>() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.zip&#34;</span>)[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">click</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">toBlob</span>(<span style="color:#a6e22e">base64</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">bin</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">atob</span>(<span style="color:#a6e22e">base64</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/^.*,/</span>, <span style="color:#e6db74">&#39;&#39;</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">buffer</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Uint8Array</span>(<span style="color:#a6e22e">bin</span>.<span style="color:#a6e22e">length</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">bin</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">buffer</span>[<span style="color:#a6e22e">i</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">bin</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#a6e22e">i</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Blob</span>([<span style="color:#a6e22e">buffer</span>.<span style="color:#a6e22e">buffer</span>], {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/zip&#39;</span>
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">blob</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getfmtDate</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">dt</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Date();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">dt</span>.<span style="color:#a6e22e">getFullYear</span>().<span style="color:#a6e22e">toString</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cd</span>((<span style="color:#a6e22e">dt</span>.<span style="color:#a6e22e">getMonth</span>() <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">toString</span>()) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cd</span>(<span style="color:#a6e22e">dt</span>.<span style="color:#a6e22e">getDate</span>().<span style="color:#a6e22e">toString</span>()) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;_&#34;</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cd</span>(<span style="color:#a6e22e">dt</span>.<span style="color:#a6e22e">getHours</span>().<span style="color:#a6e22e">toString</span>()) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cd</span>(<span style="color:#a6e22e">dt</span>.<span style="color:#a6e22e">getMinutes</span>().<span style="color:#a6e22e">toString</span>()) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cd</span>(<span style="color:#a6e22e">dt</span>.<span style="color:#a6e22e">getSeconds</span>().<span style="color:#a6e22e">toString</span>());
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">cd</span>(<span style="color:#a6e22e">dat</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">dat</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">dat</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">dat</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><h4 id="google-apps-script">Google Apps Script</h4>
<p>Filename is <code>code.gs</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">folderId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;### Folder ID ###&#34;</span>; <span style="color:#75715e">// &lt;--- Your shared folder ID
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">doGet</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">t</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">HtmlService</span>.<span style="color:#a6e22e">createTemplateFromFile</span>(<span style="color:#e6db74">&#39;index&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">getFileList</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">evaluate</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getparams</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">zipping</span>(<span style="color:#66d9ef">typeof</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">fileId</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;string&#34;</span> <span style="color:#f92672">?</span> [<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">fileId</span>] <span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">fileId</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getFileList</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">folderlist</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">folder</span>, <span style="color:#a6e22e">folderSt</span>, <span style="color:#a6e22e">results</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ar</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">folders</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">folder</span>.<span style="color:#a6e22e">getFolders</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">folders</span>.<span style="color:#a6e22e">hasNext</span>()) <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">folders</span>.<span style="color:#a6e22e">next</span>());
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">folderSt</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">folder</span>.<span style="color:#a6e22e">getId</span>() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;#_aabbccddee_#&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">array_folderSt</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">folderSt</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;#_aabbccddee_#&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">array_folderSt</span>.<span style="color:#a6e22e">pop</span>()
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">results</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">array_folderSt</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> (<span style="color:#a6e22e">folderSt</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">ar</span>) <span style="color:#a6e22e">arguments</span>.<span style="color:#a6e22e">callee</span>(<span style="color:#a6e22e">ar</span>[<span style="color:#a6e22e">i</span>], <span style="color:#a6e22e">folderSt</span>, <span style="color:#a6e22e">results</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">results</span>;
</span></span><span style="display:flex;"><span>    })(<span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFolderById</span>(<span style="color:#a6e22e">folderId</span>), <span style="color:#e6db74">&#34;&#34;</span>, []);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">localTimeZone</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Session</span>.<span style="color:#a6e22e">getScriptTimeZone</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">filelist</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> {};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">folderlist</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">folderid</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">folderlist</span>[<span style="color:#a6e22e">i</span>][<span style="color:#a6e22e">folderlist</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">folder</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFolderById</span>(<span style="color:#a6e22e">folderid</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">files</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">folder</span>.<span style="color:#a6e22e">getFiles</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">hasNext</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">next</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">folder_tree</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">folderlist</span>, <span style="color:#a6e22e">i</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> [<span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFolderById</span>(<span style="color:#a6e22e">folderlist</span>[<span style="color:#a6e22e">i</span>][<span style="color:#a6e22e">j</span>]).<span style="color:#a6e22e">getName</span>() <span style="color:#66d9ef">for</span> (<span style="color:#a6e22e">j</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">folderlist</span>[<span style="color:#a6e22e">i</span>])
</span></span><span style="display:flex;"><span>                            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">j</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>)].<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;/&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span>;
</span></span><span style="display:flex;"><span>                    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;/&#34;</span>;
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }(<span style="color:#a6e22e">folderlist</span>, <span style="color:#a6e22e">i</span>),
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">file_id</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getId</span>(),
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">file_name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getName</span>(),
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">file_size</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getBlob</span>().<span style="color:#a6e22e">getBytes</span>().<span style="color:#a6e22e">length</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">file_created</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">formatDate</span>(<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getDateCreated</span>(), <span style="color:#a6e22e">localTimeZone</span>, <span style="color:#e6db74">&#34;yyyy/MM/dd HH:mm:ss&#34;</span>),
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">file_updated</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">formatDate</span>(<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getLastUpdated</span>(), <span style="color:#a6e22e">localTimeZone</span>, <span style="color:#e6db74">&#34;yyyy/MM/dd HH:mm:ss&#34;</span>),
</span></span><span style="display:flex;"><span>            };
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">filelist</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">temp</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">sortedlist</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">filelist</span>.<span style="color:#a6e22e">sort</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e1</span>, <span style="color:#a6e22e">e2</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (<span style="color:#a6e22e">e1</span>.<span style="color:#a6e22e">folder_tree</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">e2</span>.<span style="color:#a6e22e">folder_tree</span> <span style="color:#f92672">?</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) });
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">sortedlist</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">zipping</span>(<span style="color:#a6e22e">fileId</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">blobs</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">mimeInf</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fileId</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">e</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">mime</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getMimeType</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getName</span>();
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">e</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Logger</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">mime</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">blob</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">mime</span>.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#39;google-apps&#39;</span>) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">mimeInf</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mime</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;application/vnd.google-apps.spreadsheet&#34;</span> <span style="color:#f92672">?</span> [<span style="color:#e6db74">&#34;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#34;</span>, <span style="color:#a6e22e">name</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.xlsx&#34;</span>] <span style="color:#f92672">:</span> <span style="color:#a6e22e">mime</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;application/vnd.google-apps.document&#34;</span> <span style="color:#f92672">?</span> [<span style="color:#e6db74">&#34;application/vnd.openxmlformats-officedocument.wordprocessingml.document&#34;</span>, <span style="color:#a6e22e">name</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.docx&#34;</span>] <span style="color:#f92672">:</span> <span style="color:#a6e22e">mime</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;application/vnd.google-apps.presentation&#34;</span> <span style="color:#f92672">?</span> [<span style="color:#e6db74">&#34;application/vnd.openxmlformats-officedocument.presentationml.presentation&#34;</span>, <span style="color:#a6e22e">name</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.pptx&#34;</span>] <span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;application/pdf&#34;</span>, <span style="color:#a6e22e">name</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.pdf&#34;</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;https://www.googleapis.com/drive/v3/files/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">e</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/export?mimeType=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">mimeInf</span>[<span style="color:#ae81ff">0</span>], {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;GET&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> { <span style="color:#e6db74">&#34;Authorization&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Bearer &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">getOAuthToken</span>() },
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">muteHttpExceptions</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>            }).<span style="color:#a6e22e">getBlob</span>().<span style="color:#a6e22e">setName</span>(<span style="color:#a6e22e">mimeInf</span>[<span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;https://www.googleapis.com/drive/v3/files/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">e</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;?alt=media&#34;</span>, {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;GET&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> { <span style="color:#e6db74">&#34;Authorization&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Bearer &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">getOAuthToken</span>() },
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">muteHttpExceptions</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>            }).<span style="color:#a6e22e">getBlob</span>().<span style="color:#a6e22e">setName</span>(<span style="color:#a6e22e">name</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">blobs</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">blob</span>);
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zip</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">zip</span>(<span style="color:#a6e22e">blobs</span>, <span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">formatDate</span>(<span style="color:#66d9ef">new</span> Date(), <span style="color:#a6e22e">Session</span>.<span style="color:#a6e22e">getScriptTimeZone</span>(), <span style="color:#e6db74">&#34;yyyyMMdd_HHmmss&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;.zip&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">bytedat</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">zip</span>).<span style="color:#a6e22e">getBlob</span>().<span style="color:#a6e22e">getBytes</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">base64Encode</span>(<span style="color:#a6e22e">bytedat</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="flow-of-sample-script">Flow of sample script</h4>
<ol>
<li>All files in a folder that owner of Google Drive decided display as a list using <a href="https://developers.google.com/apps-script/guides/web">Web Apps</a>.</li>
<li>Users access to the site which was used by Web Apps using own browser.</li>
<li>When users clicked the files from the list and pushed DOWNLOAD button, the files are converted to base64 using Google Apps Script.</li>
<li>The converted-base64 data are transfered to the site and are converted to blob using Javascript in HTML.</li>
<li>The blob data are compressed by ZIP, and then they are downloaded.</li>
<li>Google Spreadsheet, Google Document and Google Slide are converted to Microsoft Excel, Word and Powerpoint, respectively. Images and PDF are not converted to other format.</li>
</ol>
<h4 id="sample-folder-structure">Sample Folder Structure</h4>
<p>The folder structure as a sample is as follows. <code>sharedFolder</code> is the top directory that owner was set. All of files and directories in the directory that owner defined is displayed as a list. At the <a href="#demo">demonstration</a>, you can see it.</p>
<p><img src="https://tanaikech.github.io/img/20170704-samplestructure.png" alt=""></p>
<h4 id="references">References</h4>
<ul>
<li><a href="https://stackoverflow.com/questions/2228382/select-all-checkboxes-with-jquery">Select all checkboxes with jQuery</a></li>
<li><a href="https://stackoverflow.com/questions/18296850/click-table-rows-to-select-checkbox-using-jquery">Click table rows to select checkbox using jQuery</a></li>
<li><a href="http://qiita.com/uin010bm/items/150003f016287750cf34">Converting from base64 to blob</a></li>
</ul>
<p><a href="#TOP">TOP</a></p>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2017%2f07%2f04%2fdownloading-files-from-google-drive-under-no-authorization-using-browser%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2017%2f07%2f04%2fdownloading-files-from-google-drive-under-no-authorization-using-browser%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2017%2f07%2f04%2fdownloading-files-from-google-drive-under-no-authorization-using-browser%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2017%2f07%2f04%2fdownloading-files-from-google-drive-under-no-authorization-using-browser%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2017%2f07%2f04%2fdownloading-files-from-google-drive-under-no-authorization-using-browser%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2017%2f07%2f04%2fdownloading-files-from-google-drive-under-no-authorization-using-browser%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2017/06/30/updated-cli-tool-gislack/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2017/06/30/updated-cli-tool-gislack/">Updated: CLI Tool - gislack</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2017/07/05/pseudo-browser-with-google-spreadsheet/">Pseudo Browser with Google Spreadsheet</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2017/07/05/pseudo-browser-with-google-spreadsheet/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

