<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.24.1" />

  <title>Taking Advantage of Manifests by GAS Library &middot; tanaike</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.2/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.2/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.2/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://plus.google.com/+KanshiTanaike" target="_blank"><i class="fa fa-google-plus-square fa-fw"></i>Google+</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" target="_blank"><i class="fa fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Taking Advantage of Manifests by GAS Library</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>23 Nov 2017, 20:21</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/manifests">manifests</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>
    
  </div>
  
  

</div>

  

<p><a href="https://gist.github.com/tanaikech/23ddf599a4155b66f1029978bba8153b">Gists</a></p>

<h2 id="introduction">Introduction</h2>

<p>By recent Google update (<a href="https://developers.google.com/apps-script/">Google update at October 24, 2017</a>), various new winds to GAS developers were blown. There is &ldquo;<a href="https://developers.google.com/apps-script/concepts/manifests">Manifests</a>&rdquo; as one of the new winds. &ldquo;Manifests&rdquo; makes us manage the project using JSON. Especially, the special scopes which have to use OAuth2 process can be used by only setting them to the Manifests. I think that this is the largest modification. However, when scopes are added to a project using Manifests, users who use the project can use only added scopes. This means that when users create scripts in the project, if there are some scopes which is required to be added, such scopes cannot be automatically added. So the error of &ldquo;Insufficient Permission&rdquo; occurs.</p>

<p>In this report, I would like to introduce the workaround for avoiding this problem.</p>

<h2 id="workaround">Workaround</h2>

<p>I found the workaround for avoiding the problem by using a library as follows.</p>

<ul>
<li><strong>By installing the library which was given &ldquo;oauthScopes&rdquo; of Manifests, the new project can automatically have those scopes as the default scopes.</strong>

<ul>
<li>This can be seen at <code>On script editor -&gt; File -&gt; Project properties -&gt; Scopes</code>.</li>
</ul></li>
<li><strong>When users develop scripts in the project which installed the library, the scopes depended on the scripts are automatically installed to the project as the additional scopes.</strong>

<ul>
<li>This means that the above problem is avoided.</li>
</ul></li>
</ul>

<p>By this workaround, users can use various scopes by only installing a library. Furthermore, also users can develop scripts in the project which installed the library, while they don&rsquo;t worry about the permission error by scopes.</p>

<p>I think that this workaround can be applied to various applications. I have already applied this to my applications (<a href="https://github.com/tanaikech/ProjectApp">ProjectApp</a>, <a href="https://github.com/tanaikech/ManifestsApp">ManifestsApp</a>, <a href="https://github.com/tanaikech/RearrangeScripts">RearrangeScripts</a>).</p>

<h2 id="sample">Sample</h2>

<p>Here, I prepared a sample library for demonstrating the install of scopes using a library. The library has no script. But there are the following scopes in the Manifests.</p>

<pre><code class="language-json">&quot;oauthScopes&quot;: [
  &quot;https://www.googleapis.com/auth/analytics.readonly&quot;,
  &quot;https://www.googleapis.com/auth/blogger.readonly&quot;,
  &quot;https://www.googleapis.com/auth/calendar.readonly&quot;,
  &quot;https://www.googleapis.com/auth/drive.readonly&quot;,
  &quot;https://www.googleapis.com/auth/gmail.readonly&quot;,
  &quot;https://www.googleapis.com/auth/presentations.readonly&quot;,
  &quot;https://www.googleapis.com/auth/spreadsheets.readonly&quot;,
  &quot;https://www.googleapis.com/auth/youtube.readonly&quot;
]
</code></pre>

<p>As a demonstration, you can experience the workaround of this report. Please try as follows.</p>

<ol>
<li>Create a new project on your Google Drive.</li>
<li>Confirm that there are no scopes on the new project at <code>On script editor -&gt; File -&gt; Project properties -&gt; Scopes</code>.</li>
<li>Install a sample library.

<ul>
<li>library&rsquo;s project key is <code>1TYEitZm7SsAGPDI1PMfeZhIDqRrpLF8a5H9AlhGddCjJMOyHS4EBRH1c</code></li>
</ul></li>
<li>Confirm that there are 8 scopes on the new project at <code>On script editor -&gt; File -&gt; Project properties -&gt; Scopes</code>. You can see like the below demonstration.

<ul>
<li>This means that you can use the access token which included these scopes using <code>ScriptApp.getOAuthToken()</code>.</li>
</ul></li>
</ol>

<p><strong>By this workaround, the other scopes depended on the developed scripts can be automatically added.</strong></p>

<p><img src="https://tanaikech.github.io/img/20171123-demo.gif" alt="" /></p>

<h1 id="references">References</h1>

<ul>
<li><a href="https://developers.google.com/apps-script/concepts/manifests">Manifests</a></li>
</ul>

<h1 id="acknowledgements">Acknowledgements</h1>

<ul>
<li><a href="https://github.com/mhawksey">mhawksey</a></li>
</ul>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2017/11/21/retrieving-size-of-tables-in-google-slides-using-google-apps-script/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2017/11/21/retrieving-size-of-tables-in-google-slides-using-google-apps-script/">Retrieving Size of Tables in Google Slides using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    }
  });
</script>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>
<meta http-equiv="X-UA-Compatible" CONTENT="IE=EmulateIE7" />


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-84325623-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>

