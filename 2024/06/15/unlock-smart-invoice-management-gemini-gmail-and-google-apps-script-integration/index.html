<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Unlock Smart Invoice Management: Gemini, Gmail, and Google Apps Script Integration &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Unlock Smart Invoice Management: Gemini, Gmail, and Google Apps Script Integration</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15 Jun 2024, 14:58</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/application">application</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/9c8fca16c2de5ee943f39adbd67c34db">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20240615a/fig1.jpg" alt=""></p>
<p>You can see the presentation of this application at <a href="https://www.youtube.com/watch?v=Dc2WPQkovZE">https://www.youtube.com/watch?v=Dc2WPQkovZE</a>.</p>
<h1 id="abstract">Abstract</h1>
<p>This report describes an invoice processing application built with Google Apps Script. It leverages Gemini, a large language model, to automatically parse invoices received as email attachments and automates the process using time-driven triggers.</p>
<h1 id="introduction">Introduction</h1>
<p>The emergence of large language models (LLMs) like ChatGPT and Gemini has significantly impacted various aspects of our daily lives. One such example is their ability to automate tasks previously requiring manual effort. In my case, Gemini has streamlined the processing of invoices I receive as email attachments in PDF format.</p>
<p>Before Gemini, I manually reviewed each invoice, extracting crucial information. However, with Gemini&rsquo;s release, this tedious process transformed. As previously reported, Gemini can automatically parse invoices. <a href="https://medium.com/google-cloud/parsing-invoices-using-gemini-1-5-api-with-google-apps-script-1f32af1678f2">Ref</a> Furthermore, my subsequent reports explored the ability to:</p>
<ul>
<li>Return parsed invoice data in JSON format <a href="https://medium.com/google-cloud/taming-the-wild-output-effective-control-of-gemini-api-response-formats-with-response-mime-type-da273c08be85">Ref</a> <a href="https://medium.com/google-cloud/taming-the-wild-output-effective-control-of-gemini-api-response-formats-with-response-schema-ae0097b97502">Ref</a></li>
<li>Upload files to Gemini for content generation, as demonstrated through my creation of a dedicated library <a href="https://github.com/tanaikech/GeminiWithFiles">Ref</a></li>
</ul>
<p>These advancements allowed me to expand a simple invoice parsing script into a full-fledged application. This report details an application built using Google Apps Script. The application retrieves emails containing invoices from Gmail, utilizes the Gemini API to parse the extracted invoices, and leverages time-driven triggers for automatic execution. This approach ensures seamless processing of all invoice-related emails.</p>
<h1 id="repository-of-this-application">Repository of this application</h1>
<p><a href="https://github.com/tanaikech/UnlockSmartInvoiceManagementWithGeminiAPI">https://github.com/tanaikech/UnlockSmartInvoiceManagementWithGeminiAPI</a></p>
<h1 id="why-google-apps-script">Why Google Apps Script?</h1>
<p>I chose Google Apps Script to create this application for several reasons:</p>
<ul>
<li>Ease of Use: Google Apps Script is a low-code platform, making it accessible to users with no coding experience.</li>
<li>Seamless Integration: It integrates effortlessly with Gmail, Google Docs (including Docs, Sheets, Slides, and more), and various Google APIs.</li>
<li>Cloud-Based Automation: As a cloud-based scripting language, Google Apps Script can be triggered to run by time-based triggers.- Personal opinion: I would like to introduce the advantages of Google Apps Script.</li>
</ul>
<h1 id="origin-for-constructing-this-application">Origin for constructing this application</h1>
<p>The origin for constructing this application is as follows.</p>
<ul>
<li>Apr 3, 2024: <a href="https://medium.com/google-cloud/parsing-invoices-using-gemini-1-5-api-with-google-apps-script-1f32af1678f2">Parsing Invoices using Gemini 1.5 API with Google Apps Script</a></li>
<li>Apr 10, 2024: <a href="https://medium.com/google-cloud/specifying-output-types-for-gemini-api-with-google-apps-script-c2f6a753c8d7">Specifying Output Types for Gemini API with Google Apps Script</a></li>
<li>Apr 26, 2024: <a href="https://github.com/tanaikech/GeminiWithFiles">GeminiWithFiles of a Google Apps Script library</a></li>
<li>May 1, 2024: <a href="https://medium.com/google-cloud/taming-the-wild-output-effective-control-of-gemini-api-response-formats-with-response-mime-type-da273c08be85">Taming the Wild Output: Effective Control of Gemini API Response Formats with response_mime_type</a></li>
<li>May 21, 2024: <a href="https://medium.com/google-cloud/taming-the-wild-output-effective-control-of-gemini-api-response-formats-with-response-schema-ae0097b97502">Taming the Wild Output: Effective Control of Gemini API Response Formats with response_schema</a></li>
</ul>
<p>This application was created by integrating those sources.</p>
<h2 id="comments">Comments:</h2>
<p>Before the <code>response_mime_type</code> property was released, I used function calls to control the output format. However, after the release of <code>response_mime_type</code>, it became the preferred method for controlling the output format. I also tested using the <code>response_schema</code> property when it was released, but found that the combination of <code>response_mime_type</code> and a JSON schema in the prompt provides the most control over the output format. As a result, this application parses invoices using the combination of <code>response_mime_type</code> and a JSON schema in the prompt.</p>
<h1 id="usage">Usage</h1>
<h2 id="1-copy-google-spreadsheet">1. Copy Google Spreadsheet</h2>
<p>Please copy a Google Spreadsheet including this application to your Google Drive. So, please access the following URL.</p>
<p><a href="https://docs.google.com/spreadsheets/d/17UjnOcz8vyrpDI6pNhms4d2ZXAy6aWTYgmTkvZcuqaA/copy">https://docs.google.com/spreadsheets/d/17UjnOcz8vyrpDI6pNhms4d2ZXAy6aWTYgmTkvZcuqaA/copy</a></p>
<p>When you open the script editor of this Spreadsheet, you can see the following script files.</p>
<ul>
<li><code>main.gs</code>: This includes the main methods.</li>
<li><code>InvoiceManager.gs</code>: This includes the main class object.</li>
<li><code>GeminiWithFiles.gs</code>: This is from <a href="https://github.com/tanaikech/GeminiWithFiles">GeminiWithFiles (Author: me)</a>.</li>
<li><code>PDFApp.gs</code>: This is from <a href="https://github.com/tanaikech/PDFApp">PDFApp (Author: me)</a>.</li>
</ul>
<h2 id="2-create-an-api-key">2. Create an API key</h2>
<p>Please access <a href="https://ai.google.dev/gemini-api/docs/api-key">https://ai.google.dev/gemini-api/docs/api-key</a> and create your API key. At that time, please enable Generative Language API at the API console. This API key is used for this sample script.</p>
<p>This official document can be also seen. <a href="https://ai.google.dev/">Ref</a>.</p>
<p>Of course, if you can link the Google Cloud Platform Project to the Google Apps Script Project in the copied Spreadsheet, you can also use the access token.</p>
<h2 id="3-setup">3. Setup</h2>
<p>Open the &ldquo;configuration&rdquo; sheet and enter your API key. If you want to use the access token, leave the API key field blank and set useAccessToken to TRUE. You can also set other parameters as needed.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240615a/fig2.png" alt=""></p>
<p>By default, this application checks emails in the &ldquo;INBOX&rdquo; label that include invoices. To search emails from specific labels, set the label containing invoices to labelName. The script will then search for emails with that label.</p>
<h2 id="4-testing">4. Testing</h2>
<p>Clicking the &ldquo;START&rdquo; button on the &ldquo;Configuration&rdquo; sheet runs the application&rsquo;s script. However, you might see &ldquo;No emails were processed&rdquo; in the dialog even after running the script. In this case, to test the application, please send an email to your account that includes an invoice as a PDF attachment. Then, click the &ldquo;START&rdquo; button again.</p>
<p>The script execution triggers a time-driven trigger, which automatically runs the application based on the <code>cycleMinTimeDrivenTrigger</code> interval.</p>
<h3 id="sample-invoice-1">Sample invoice 1</h3>
<p><img src="https://tanaikech.github.io/image-storage/20240615a/fig3.png" alt=""></p>
<p>This sample invoice is from <a href="https://create.microsoft.com/en-us/template/service-invoice-with-tax-calculations-9330a1fe-20ae-4590-ac01-54c53ed1f3ba">here</a>. When this application parses this invoice, the following JSON is returned.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;check&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invoice&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invalidCheck&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invalidPoints&#34;</span>: <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;parse&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;invoice1.png&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invoiceTitle&#34;</span>: <span style="color:#e6db74">&#34;INVOICE&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invoiceDate&#34;</span>: <span style="color:#e6db74">&#34;6æœˆ 4, 2024&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invoiceNumber&#34;</span>: <span style="color:#e6db74">&#34;100&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invoiceDestinationName&#34;</span>: <span style="color:#e6db74">&#34;Nazar Neill&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invoiceDestinationAddress&#34;</span>: <span style="color:#e6db74">&#34;Downtown Pets\n123 South Street\nManhattan, NY 15161&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;totalCost&#34;</span>: <span style="color:#e6db74">&#34;$4350&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;table&#34;</span>: [
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;DESCRIPTION&#34;</span>, <span style="color:#e6db74">&#34;HOURS&#34;</span>, <span style="color:#e6db74">&#34;RATE&#34;</span>, <span style="color:#e6db74">&#34;AMOUNT&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;Pour cement foundation&#34;</span>, <span style="color:#e6db74">&#34;4.00&#34;</span>, <span style="color:#e6db74">&#34;$150.00&#34;</span>, <span style="color:#e6db74">&#34;$600&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;Framing and drywall&#34;</span>, <span style="color:#e6db74">&#34;16.00&#34;</span>, <span style="color:#e6db74">&#34;$150.00&#34;</span>, <span style="color:#e6db74">&#34;$2400&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;Tiling and flooring install&#34;</span>, <span style="color:#e6db74">&#34;9.00&#34;</span>, <span style="color:#e6db74">&#34;$150.00&#34;</span>, <span style="color:#e6db74">&#34;$1350&#34;</span>]
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When you see this JSON, you can see that the values <code>invalidCheck</code> and <code>invalidPoints</code> are <code>false</code> and <code>null</code>, respectively. From this, it is found that this invoice has no issues.</p>
<h3 id="sample-invoice-2">Sample invoice 2</h3>
<p><img src="https://tanaikech.github.io/image-storage/20240615a/fig4.png" alt=""></p>
<p>This sample invoice is from <a href="https://create.microsoft.com/en-us/template/simple-invoice-7c5c0318-8bc0-4ec9-8be3-2683dbf8adae">here</a>. When this application parses this invoice, the following JSON is returned.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;check&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invoice&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invalidCheck&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invalidPoints&#34;</span>: <span style="color:#e6db74">&#34;The total amount calculated is incorrect. The total amount should be a summation of prices, but it&#39;s not. In addition, the table has an item without item number and description.&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;parse&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;invoice2.png&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invoiceTitle&#34;</span>: <span style="color:#e6db74">&#34;INVOICE&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invoiceDate&#34;</span>: <span style="color:#e6db74">&#34;2024/6/7&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invoiceNumber&#34;</span>: <span style="color:#e6db74">&#34;10654&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invoiceDestinationName&#34;</span>: <span style="color:#66d9ef">null</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;invoiceDestinationAddress&#34;</span>: <span style="color:#e6db74">&#34;123 Avenue A,\nBurbank, CA 56789&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;totalCost&#34;</span>: <span style="color:#e6db74">&#34;$1,077.25&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;table&#34;</span>: [
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;Item #&#34;</span>, <span style="color:#e6db74">&#34;Description&#34;</span>, <span style="color:#e6db74">&#34;Qty&#34;</span>, <span style="color:#e6db74">&#34;Unit price&#34;</span>, <span style="color:#e6db74">&#34;Discount&#34;</span>, <span style="color:#e6db74">&#34;Price&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;A875&#34;</span>, <span style="color:#e6db74">&#34;Peonies&#34;</span>, <span style="color:#e6db74">&#34;35&#34;</span>, <span style="color:#e6db74">&#34;$1.05&#34;</span>, <span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;$36.75&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;K245&#34;</span>, <span style="color:#e6db74">&#34;Tulips&#34;</span>, <span style="color:#e6db74">&#34;25&#34;</span>, <span style="color:#e6db74">&#34;$2.00&#34;</span>, <span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;$50.00&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;U123&#34;</span>, <span style="color:#e6db74">&#34;Buttercup&#34;</span>, <span style="color:#e6db74">&#34;30&#34;</span>, <span style="color:#e6db74">&#34;$1.35&#34;</span>, <span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;$40.50&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;sample&#34;</span>, <span style="color:#e6db74">&#34;sample item&#34;</span>, <span style="color:#e6db74">&#34;10&#34;</span>, <span style="color:#e6db74">&#34;$10.00&#34;</span>, <span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;$1,000.00&#34;</span>]
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When you see this JSON, you can see that the values <code>invalidCheck</code> and <code>invalidPoints</code> are <code>true</code> and <code>The total amount calculated is incorrect. The total amount should be a summation of prices, but it's not. In addition, the table has an item without item number and description.</code>, respectively. From this, it is found that this invoice has issues and the modification points are suggested.</p>
<h2 id="log">Log</h2>
<p>After processing the two invoices mentioned above, the application displays the following information in the &ldquo;log&rdquo; sheet:</p>
<p><img src="https://tanaikech.github.io/image-storage/20240615a/fig5.png" alt=""></p>
<ul>
<li>Valid invoices: These will be displayed in green.</li>
<li>Invalid invoices: These will be displayed in red.</li>
</ul>
<p>For invalid invoices, the application can automatically send an email response containing the necessary corrections. However, during my testing with various invoices, I encountered instances where the <code>invalidCheck</code> value was flagged as <code>true</code> even for invoices without errors. Due to this, I have temporarily set the <code>notifyModificationPointsToSender</code> value to <code>FALSE</code> by default. I anticipate the content generation accuracy to improve in future updates.</p>
<p>Also, when you want to directly see the target mail, you can see it by clicking the &ldquo;searchUrl&rdquo;. When you click this link, Gmail is opened and you can see the target mail.</p>
<h1 id="future-update">Future update</h1>
<ul>
<li>Currently, Gemini 1.5 API cannot directly use PDF data. As a workaround, this sample converts each page of the PDF data to PNG images. When direct PDF processing is available in a future update, I expect the accuracy for generating content to improve.
<ul>
<li>On July 23, 2024, I confirmed that this was achieved. By this, I updated the script for directly using PDF data. You can confirm the latest script at <a href="https://github.com/tanaikech/UnlockSmartInvoiceManagementWithGeminiAPI">my repository</a>.</li>
</ul>
</li>
</ul>
<h1 id="note">Note</h1>
<ul>
<li>The top abstract image was created by <a href="https://gemini.google.com/app">Gemini</a>.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2024%2f06%2f15%2funlock-smart-invoice-management-gemini-gmail-and-google-apps-script-integration%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2024%2f06%2f15%2funlock-smart-invoice-management-gemini-gmail-and-google-apps-script-integration%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f06%2f15%2funlock-smart-invoice-management-gemini-gmail-and-google-apps-script-integration%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2024%2f06%2f15%2funlock-smart-invoice-management-gemini-gmail-and-google-apps-script-integration%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f06%2f15%2funlock-smart-invoice-management-gemini-gmail-and-google-apps-script-integration%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f06%2f15%2funlock-smart-invoice-management-gemini-gmail-and-google-apps-script-integration%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2024/06/07/updated-gas-library-geminiwithfiles/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2024/06/07/updated-gas-library-geminiwithfiles/">Updated: GAS Library - GeminiWithFiles</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2024/06/15/updated-gas-library-geminiwithfiles/">Updated: GAS Library - GeminiWithFiles</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2024/06/15/updated-gas-library-geminiwithfiles/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

