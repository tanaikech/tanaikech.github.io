<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Report: How to Run Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Report: How to Run Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>12 Jan 2024, 11:15</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/f03ab0d9eff7182a57e699fb3fbb32b8">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20240112a/fig1.png" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>Google Apps Script is one of the strong tools with cloud computing, and it is very useful for various situations. Google Apps Script can be run by various methods. This report introduces how to execute Google Apps Script.</p>
<p>Recently, generative AI has given a lot of new users a chance to use Google Apps Script. If this report helps the users develop applications using Google Apps Script, I&rsquo;m glad.</p>
<h1 id="introduction">Introduction</h1>
<p>The recent evolution of AI technology brings people many applications and useful situations. Also, it is useful for developing Google Apps Script. The official document says about Google Apps Script as follows. Google Apps Script is a cloud-based JavaScript platform that lets you integrate with and automate tasks across Google products. <a href="https://developers.google.com/apps-script">Ref</a> Recently, I felt that when I saw Stackoverflow, many new users joined as users of Google Apps Script. This is a welcome. When I saw the questions of the new users, I thought that there were relatively many questions related to the method for running Google Apps Script. In fact, there are various methods for running Google Apps Script. So, it is considered that when such various methods for running Google Apps Script are explained in detail, it will be useful for not only new users but also the users who have already used Google Apps Script. Here, I would like to details explain how to run Google Apps Script.</p>
<p>Here, the following 8 methods are introduced.</p>
<ol>
<li><a href="#scripteditor">Script editor</a></li>
<li><a href="#triggers">Triggers</a></li>
<li><a href="#custommenu">Custom menu</a></li>
<li><a href="#ui">UI</a></li>
<li><a href="#customfunction">Custom function on Spreadsheet</a></li>
<li><a href="#button">Button on Spreadsheet</a></li>
<li><a href="#webapps">Web Apps</a></li>
<li><a href="#appsscriptapi">Google Apps Script API</a></li>
<li><a href="#addon">Add-on</a></li>
</ol>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="1-script-editor">1. Script editor</h1>
<h2 id="who-does-the-script-run">Who does the script run?</h2>
<p>When the script is run with the script editor, the script is run by the user who clicks the run button.</p>
<h2 id="important">Important</h2>
<ul>
<li>
<p>At a Google Apps Script project, several script files and HTML files are included. But, for example, when you use 2 script files like <code>Code1.gs</code> and <code>Code2.gs</code> in a Google Apps Script project, all functions are managed as a single project. So, when a function <code>myFunction</code> is created in both Code1.gs<code>and</code>Code2.gs<code>and you try to run</code>myFunction`, the script might not be able to be correctly run, because the same function name exists. Please be careful about this.</p>
</li>
<li>
<p>About the global variables, when a function <code>sample</code> is run, the function <code>sample</code> is run after all global variables are run. So, for example, when a function is run as a custom function, if the methods cannot be run by the custom function are included in the global variables, even when the script of the custom function doesn&rsquo;t include the methods cannot be run by the custom function, an error occurs. Because the global variables are run before the custom function is run. Please be careful about this.</p>
</li>
</ul>
<h2 id="how-to-use">How to use</h2>
<p>When you want to simply run Google Apps Script, you can do it using the script editor of Google Apps Script with your browser.</p>
<p>When you access <a href="https://script.new">https://script.new</a>, a new Google Apps Script project is created as a standalone type on your Google Drive.</p>
<p>As a simple script, please copy and paste the following script to the script editor.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction1</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;ok1&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction2</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;ok2&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When you run <code>myFunction1</code> with the script editor, you can see the value of <code>ok1</code> in the log. You can see the demonstration of this in Fig. 1.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240112a/fig2.gif" alt="">
Fig. 1. Run a script with the script editor.</p>
<!-- raw HTML omitted -->
<p>In the case of the above functions, no scopes are used. So, you can simply run the script. But, when the methods for using the scopes are included in the script, it is required to authorize the scopes. The sample demonstration is shown in Fig. 2.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240112a/fig3.gif" alt="">
Fig. 2. Run a script including a scope with the script editor.</p>
<!-- raw HTML omitted -->
<p>Figure 2 shows the process for authorizing the scopes. In this script, in order to run the script <code>SpreadsheetApp.getActiveSpreadsheet()</code>, it is required to use a scope of <code>https://www.googleapis.com/auth/spreadsheets</code>. By this, when you run the script for the first time, it is required to authorize the scope. In this case, when you run the script, when the scopes for requiring authorization are included in the script, a dialog is opened. When you authorize the scopes as shown in Fig. 2, the script is run. This process is required to run only one time. But, when you add more methods for using other scopes, it is required to authorize them when the script is run. Please be careful about this.</p>
<h2 id="related-errors">Related errors</h2>
<ul>
<li>When you want to use the methods of <code>getActiveSpreadsheet</code> of Class SpreadsheetApp, <code>getActiveDocument</code> of Class DocumentApp, <code>getActivePresentation</code> of Clas SlidesApp, and <code>getActiveForm</code> of Class FormApp, it is required to use the methods in the container-bound script of Spreadsheet, Document, Slide, and Form, respectively. When those methods are used in the standalone script, <code>null</code> is returned instead of an error. Please be careful about this.</li>
</ul>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="2-triggers">2. Triggers</h1>
<p>The triggers of Google Apps Script can be used for automatically running Google Apps Script by an event. <a href="https://developers.google.com/apps-script/guides/triggers">Ref</a> In the current stage, there are 2 kinds of triggers as follows.</p>
<ul>
<li>Simple triggers</li>
<li>Installable triggers</li>
</ul>
<h2 id="a-simple-triggershttpsdevelopersgooglecomapps-scriptguidestriggers">A. <a href="https://developers.google.com/apps-script/guides/triggers">Simple triggers</a></h2>
<h3 id="who-does-the-script-run-1">Who does the script run?</h3>
<p>In the case of the simple trigger, when the owner of Google Docs file fires the simple trigger, <code>e.user.email</code> where <code>e</code> is the event object, <code>Session.getActiveUser().getEmail()</code>, <code>Session.getEffectiveUser().getEmail()</code> returns the email of the owner of Google Docs file. On the other hand, when a shared user fires the simple trigger, <code>e.user.email</code> where <code>e</code> is the event object, <code>Session.getActiveUser().getEmail()</code>, <code>Session.getEffectiveUser().getEmail()</code> return no value.</p>
<h3 id="important-1">Important</h3>
<ul>
<li>
<p>When you use the simple trigger, please confirm the restrictions. <a href="https://developers.google.com/apps-script/guides/triggers#restrictions">Ref</a> For example, in the case of <code>onEdit</code>, GmailApp, MailApp, and UrlFetchApp cannot be used.</p>
</li>
<li>
<p>If you want to use the installable trigger, please don&rsquo;t use the reserved function names like <code>onOpen</code>, <code>onEdit</code>, and so on. Because, for example, when you install the OnEdit trigger to the function of <code>onEdit</code> and a cell is edited, the function <code>onEdit</code> is run 2 times by the simple trigger and the installable trigger with the asynchronous process. <a href="https://tanaikech.github.io/2018/09/21/asynchronous-processing-using-event-triggers/">Ref</a> Please be careful about this.</p>
</li>
</ul>
<p>At the simple triggers, the reserved function names are used as follows.</p>
<h3 id="onopen"><code>onOpen</code></h3>
<blockquote>
<p>When Google Docs files (Spreadsheet, Document, Slide, and Form) are opened, this function is automatically run.</p>
</blockquote>
<p>For example, when you open Google Spreadsheet and want to create a custom menu, you can achieve this using this trigger. <a href="https://developers.google.com/apps-script/guides/menus">Ref</a></p>
<h3 id="oninstall"><code>onInstall</code></h3>
<blockquote>
<p>When the Add-on is installed on Google Docs files, this function is automatically run.</p>
</blockquote>
<p>About the add-on, you can see the official document. <a href="https://developers.google.com/apps-script/add-ons/overview">Ref</a></p>
<h3 id="onedit"><code>onEdit</code></h3>
<blockquote>
<p>When the Spreadsheet is manually edited, this function is automatically run.</p>
</blockquote>
<p>For example, when you edit a cell on Google Spreadsheet and want to run a script, you can achieve this using this trigger. The sample script is as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">onEdit</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">range</span>, <span style="color:#a6e22e">source</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">source</span>.<span style="color:#a6e22e">getActiveSheet</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getSheetName</span>() <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;Sheet1&#34;</span> <span style="color:#f92672">||</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">columnStart</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">||</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">columnEnd</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">columnStart</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">offset</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">setValue</span>(<span style="color:#66d9ef">new</span> Date());
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In this case, you copy and paste the above script to the script editor of Google Spreadsheet and save the script. And, when you edit a cell of column &ldquo;A&rdquo; of &ldquo;Sheet1&rdquo;, a date object is put into column &ldquo;B&rdquo; of the edited row as follows.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240112a/fig4.gif" alt="">
Fig. 3. Run <code>onEdit</code> function by the simple trigger.</p>
<h4 id="important-2">Important</h4>
<ul>
<li>As additional information, when the checkbox and the OnEdit trigger are used, a script can be run by checking the checkbox like a button.</li>
</ul>
<h3 id="onselectionchange"><code>onSelectionChange</code></h3>
<blockquote>
<p>When the selection on the Spreadsheet is changed, this function is automatically run.</p>
</blockquote>
<p>For example, when you want to detect the change of a tab on Google Spreadsheet, you can achieve this using this trigger. <a href="https://tanaikech.github.io/2020/05/18/change-tab-detection-on-google-spreadsheet-using-onselectionchange-event-trigger-with-google-apps-script/">Ref</a></p>
<p>And, when want to highlight row and column at the selected cell, you can achieve this using this trigger. <a href="https://tanaikech.github.io/2020/06/11/highlighting-row-and-column-of-selected-cell-using-google-apps-script/">Ref</a></p>
<p>And, when this trigger is used, a cell can be used as a button. <a href="https://gist.github.com/tanaikech/17d48dbcf4c1a39663424cae658e50cb">Ref</a></p>
<h4 id="important-3">Important</h4>
<ul>
<li>In the current stage, onSelectionChange trigger cannot be used as the installable trigger. So, for example, when you want to open a sidebar and a dialog when a cell is selected, unfortunately, in the current stage, this cannot be achieved by the current specification of onSelectionChange.</li>
</ul>
<p>As another important point, when <code>onSelectionChange</code> is not run even when you create a function <code>onSelectionChange</code> and save the script, please try to reopen the Spreadsheet and test it again.</p>
<h3 id="doget"><code>doGet</code></h3>
<blockquote>
<p>When an HTTP request with the GET method requests Web Apps, this function is automatically run.</p>
</blockquote>
<p>The detail of this is introduced in the section <a href="#webapps">Web Apps</a>.</p>
<h3 id="dopost"><code>doPost</code></h3>
<blockquote>
<p>When an HTTP request with the POST method requests Web Apps, this function is automatically run.</p>
</blockquote>
<p>The detail of this is introduced in the section <a href="#webapps">Web Apps</a>.</p>
<h3 id="related-errors-for-simple-triggers">Related errors for simple triggers</h3>
<p>When the event object is <code>e</code>,</p>
<ul>
<li>
<p><code>TypeError: Cannot destructure property '###' of 'e' as it is undefined.</code>: It is considered that you might directly run the function without giving the event object to the script editor. In the case of triggers, when the event object <code>e</code> is used in the script, please run the function by firing the trigger. By this, the function is automatically run with the event object <code>e</code>.</p>
</li>
<li>
<p><code>Exception: The script does not have permission to perform that action. Required permissions: (### || ###,,,)</code>: It is considered that the methods that cannot run with the trigger are included in the script. Please confirm your script and confirm the restrictions, again. [Ref](<a href="https://developers.google.com/apps-script/guides/triggers#restrictionsagain">https://developers.google.com/apps-script/guides/triggers#restrictionsagain</a>.</p>
</li>
<li>
<p>In the case of triggers, most cases run the script using the event object. So, for example, when the following sample script is created,</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">onEdit</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">range</span>, <span style="color:#a6e22e">source</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getA1Notation</span>());
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">source</span>.<span style="color:#a6e22e">getActiveSheet</span>().<span style="color:#a6e22e">getSheetName</span>());
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>the event object is <code>e</code>. When this function is run with the simple trigger, the function <code>onEdit</code> is run by giving the event object <code>e</code>. So, when you directly run the function <code>onEdit</code>, an error like <code>TypeError: Cannot destructure property 'range' of 'e' as it is undefined.</code> occurs. Please be careful about this. The questions related to this issue are often seen on Stackoverflow. If you want to run the function executing with the trigger with both the action for firing the trigger and the script editor, please create the script without using the event object.</li>
</ul>
<h2 id="b-installable-triggershttpsdevelopersgooglecomapps-scriptguidestriggersinstallable">B. <a href="https://developers.google.com/apps-script/guides/triggers/installable">Installable triggers</a></h2>
<h3 id="who-does-the-script-run-2">Who does the script run?</h3>
<p>In the case of the installable trigger, when the owner of Google Docs file fires the simple trigger, <code>e.user.email</code> where <code>e</code> is the event object, <code>Session.getActiveUser().getEmail()</code>, <code>Session.getEffectiveUser().getEmail()</code> returns the email of the owner of Google Docs file. On the other hand, when a shared user fires the installable trigger installed by the owner, <code>e.user.email</code> where <code>e</code> is the event object and <code>Session.getActiveUser().getEmail()</code> returns no value. And, <code>Session.getEffectiveUser().getEmail()</code> returns the email of the owner of the Google Docs file.</p>
<h3 id="important-4">Important</h3>
<ul>
<li>
<p>The basic important points are the same as the simple trigger.</p>
</li>
<li>
<p>When you use the installable trigger, please confirm the restrictions. <a href="https://developers.google.com/apps-script/guides/triggers/installable">Ref</a></p>
</li>
<li>
<p>As another piece of information, the installable trigger can be also installed from outside of the script. <a href="https://medium.com/google-cloud/workaround-detecting-change-of-importrange-using-onedit-trigger-with-google-apps-script-92748e25df60">Ref</a></p>
</li>
</ul>
<p>At the installable triggers, there is no reserved function name.</p>
<h3 id="time-driven-trigger">Time-driven trigger</h3>
<blockquote>
<p>A time-driven trigger (also called a clock trigger) is similar to a cron job in Unix. Time-driven triggers let scripts execute at a particular time or on a recurring interval, as frequently as every minute or as infrequently as once per month. (Note that an add-on can use a time-driven trigger once per hour at most.) The time might be slightly randomized—for example, if you create a recurring 9 AM trigger, Apps Script chooses a time between 9 AM and 10 AM, then keeps that timing consistent from day to day so that 24 hours elapse before the trigger fires again. <a href="https://developers.google.com/apps-script/guides/triggers/installable#time-driven_triggers">Ref</a></p>
</blockquote>
<p>When you use the time-driven trigger, please confirm the current limitations. <a href="https://developers.google.com/apps-script/guides/services/quotas#current_limitations">Ref</a></p>
<p>In the case of the time-driven trigger, when the function is run, the event object is given.</p>
<p>I have published a Google Apps Script library for simply using the time-driven trigger. <a href="https://github.com/tanaikech/TriggerApp">Ref</a></p>
<h3 id="onopen-trigger">OnOpen trigger</h3>
<blockquote>
<p>An installable open trigger runs when a user opens a spreadsheet, document, or form that they have permission to edit.</p>
</blockquote>
<p>The basic process of the installable OnOpen trigger is the same as the OnOpen simple trigger while the restrictions are different.</p>
<h4 id="important-5">Important</h4>
<ul>
<li>In the current stage, the installable OnOpen trigger cannot be used to Google Slides.</li>
</ul>
<h3 id="onedit-trigger">OnEdit trigger</h3>
<blockquote>
<p>An installable edit trigger runs when a user modifies a value in a spreadsheet.</p>
</blockquote>
<p>The basic process of the installable OnEdit trigger is the same as the OnEdit simple trigger while the restrictions are different.</p>
<h4 id="important-6">Important</h4>
<ul>
<li>The installable trigger can be installed from outside of the script. So, for example, when the installable OnEdit trigger is used, detecting the change of IMPORTRANGE can be achieved. <a href="https://medium.com/google-cloud/workaround-detecting-change-of-importrange-using-onedit-trigger-with-google-apps-script-92748e25df60">Ref</a></li>
<li>Also, automatically installing the OnEdit trigger to the copied Google Spreadsheet using Google Apps Script can be achieved. <a href="https://tanaikech.github.io/2023/04/10/workaround-automatically-installing-onedit-trigger-to-copied-google-spreadsheet-using-google-apps-script/">Ref</a></li>
<li>In the current stage, unfortunately, the OnEdit trigger can be used to only Google Spreadsheet. If you want to use this with Google Document, this report might be useful. <a href="https://gist.github.com/tanaikech/f27d427f07b20ca9fedec21e643c4a3e">Ref</a></li>
</ul>
<h3 id="onchange-trigger">OnChange trigger</h3>
<blockquote>
<p>An installable change trigger runs when a user modifies the structure of a spreadsheet itself—for example, by adding a new sheet or removing a column.</p>
</blockquote>
<p>For example, when you want to run a script by changing the background of the cell, this trigger can be used.</p>
<p>And, when the cell value is updated by Sheets API, this trigger is fired. So, when you want to run Google Apps Script by updating the cell values by Sheets API with another language (node.js, python, and so on), this trigger can be also used.</p>
<h3 id="onsubmit-trigger">OnSubmit trigger</h3>
<blockquote>
<p>An installable form submit trigger runs when a user responds to a form. There are two versions of the form-submit trigger, one for Google Forms itself and one for Sheets if the form submits to a spreadsheet.</p>
</blockquote>
<p>2 event sources can be selected for the OnSubmit trigger.</p>
<ol>
<li>Google Form: When the OnSubmit trigger is installed as the event source of Google Form, the event object can be seen at <a href="https://developers.google.com/apps-script/guides/triggers/events#form-submit_1">this official document</a>. When you use the container-bound script of Google Form and open the installable trigger dialog, this is selected.</li>
<li>Google Spreadsheet: When the OnSubmit trigger is installed as the event source of Google Spreadsheet, the event object can be seen at <a href="https://developers.google.com/apps-script/guides/triggers/events#form-submit">this official document</a>. When you use the container-bound script of Google Spreadsheet and open the installable trigger dialog, this is selected.</li>
</ol>
<h3 id="calendarevent-trigger">CalendarEvent trigger</h3>
<blockquote>
<p>An installable calendar event trigger runs when a user&rsquo;s calendar events are updated—created, edited, or deleted.</p>
</blockquote>
<p>For example, when you want to run a script by creating and updating an event on Google Calendar, you can use this trigger. When you install this trigger, it is required to set the calendar ID.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="3-custom-menu">3. Custom menu</h1>
<h2 id="who-does-the-script-run-3">Who does the script run?</h2>
<p>When the script is run with the custom menu, the script is run by the user who clicks the menu.</p>
<h2 id="how-to-use-1">How to use</h2>
<p>The details of the custom menu can be seen in <a href="https://developers.google.com/apps-script/guides/menus">the official document</a>.</p>
<p>In the case of Google Documents, Google Spreadsheets, Google Slides, and Google Forms, the users can create a custom menu and can run Google Apps Script from the custom menu. The sample script is as follows.</p>
<p>In this case, when Google Spreadsheet is opened, the custom menu is automatically created by the simple trigger of OnOpen.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// ref: https://developers.google.com/apps-script/guides/menus#custom_menus_inor
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">onOpen</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ui</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getUi</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Or DocumentApp, SlidesApp or FormApp.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">createMenu</span>(<span style="color:#e6db74">&#34;Custom Menu&#34;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">addItem</span>(<span style="color:#e6db74">&#34;First item&#34;</span>, <span style="color:#e6db74">&#34;menuItem1&#34;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">addSeparator</span>()
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">addSubMenu</span>(<span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">createMenu</span>(<span style="color:#e6db74">&#34;Sub-menu&#34;</span>).<span style="color:#a6e22e">addItem</span>(<span style="color:#e6db74">&#34;Second item&#34;</span>, <span style="color:#e6db74">&#34;menuItem2&#34;</span>))
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">addToUi</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">menuItem1</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getUi</span>() <span style="color:#75715e">// Or DocumentApp, SlidesApp or FormApp.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    .<span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">&#34;You clicked the first menu item!&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">menuItem2</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getUi</span>() <span style="color:#75715e">// Or DocumentApp, SlidesApp or FormApp.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    .<span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">&#34;You clicked the second menu item!&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>If you want to dynamically create the custom menu, you can see the sample script at <a href="https://gist.github.com/tanaikech/1232a8fd1ffbd84c96ebbb97051c5b59">here</a>.</li>
</ul>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="4-ui">4. UI</h1>
<h2 id="who-does-the-script-run-4">Who does the script run?</h2>
<p>In this case, the user for executing the script depends on the method for executing the script.</p>
<h2 id="important-7">Important</h2>
<p>About UI of dialog, sidebar, and so on, the official document says as follows. <a href="https://developers.google.com/apps-script/guides/dialogs">Ref</a></p>
<blockquote>
<p>Scripts that are bound to Google Docs, Sheets, or Forms can display several types of user-interface elements — pre-built alerts and prompts, plus dialogs and sidebars that contain custom HTML service pages. Typically, these elements are opened from menu items. (Note that in Google Forms, user-interface elements are visible only to an editor who opens the form to modify it, not to a user who opens the form to respond.)</p>
</blockquote>
<p>The users can use the following 4 patterns.</p>
<ol>
<li>Alert</li>
<li>Prompt</li>
<li>Dialog</li>
<li>Sidebar</li>
</ol>
<p>The official document of Class UI is <a href="https://developers.google.com/apps-script/reference/base/ui">here</a>. In the following sample scripts, a Google Spreadsheet is used.</p>
<p>In the case of custom dialog and sidebar using HTML, the Google Apps Script is run with the server side of Google. But, HTML and Javascript are run with your browser.</p>
<p>As additional information, when you open the dialog on the user&rsquo;s browser by a trigger, please use the installable triggers instead of the simple trigger.</p>
<h2 id="1-alert">1. Alert</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ui</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getUi</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">&#34;sample&#34;</span>, <span style="color:#e6db74">&#34;Yes or No&#34;</span>, <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">ButtonSet</span>.<span style="color:#a6e22e">YES_NO</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">alert</span>((<span style="color:#a6e22e">res</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">Button</span>.<span style="color:#a6e22e">YES</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;Yes&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;No&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; was clicked.&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When this function is run, a dialog is opened. When you click &ldquo;Yes&rdquo;, &ldquo;Yes was clicked&rdquo; is shown in a new dialog.</p>
<h2 id="2-prompt">2. Prompt</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ui</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getUi</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">prompt</span>(<span style="color:#e6db74">&#34;sample&#34;</span>, <span style="color:#e6db74">&#34;Yes or No&#34;</span>, <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">ButtonSet</span>.<span style="color:#a6e22e">YES_NO</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">alert</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">`Inputted text is </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">getResponseText</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">. </span><span style="color:#e6db74">${</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">getSelectedButton</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">Button</span>.<span style="color:#a6e22e">YES</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;Yes&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;No&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">}</span><span style="color:#e6db74"> was clicked.`</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When this function is run, a dialog including a text input is opened. When you input &ldquo;sample&rdquo; in the text input and click &ldquo;Yes&rdquo;, &ldquo;Inputted text is a sample. No was clicked.&rdquo; is shown in a new dialog.</p>
<h2 id="3-dialog">3. Dialog</h2>
<p>Please copy and paste the following HTML to the HTML file of <code>index.html</code> in the container-bound script of the Spreadsheet.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">base</span> <span style="color:#a6e22e">target</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;_top&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;main(this); return false;&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">google</span>.<span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">run</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">withSuccessHandler</span>(<span style="color:#a6e22e">google</span>.<span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">host</span>.<span style="color:#a6e22e">close</span>)
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">sample</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">parentNode</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>Please copy and paste the following script to the script file of <code>Code.gs</code> in the container-bound script of Spreadsheet.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Browser</span>.<span style="color:#a6e22e">msgBox</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">text</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">openDialog</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getUi</span>().<span style="color:#a6e22e">showModalDialog</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">HtmlService</span>.<span style="color:#a6e22e">createHtmlOutputFromFile</span>(<span style="color:#e6db74">&#34;index&#34;</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;sample&#34;</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When the function <code>openDialog</code> is run, a dialog including a text input is opened. When you input &ldquo;sample&rdquo; in the text input and click &ldquo;submit&rdquo; button, &ldquo;sample&rdquo; is shown in a new dialog.</p>
<h3 id="important-8">Important</h3>
<ul>
<li>The values on the HTML side can be sent to the Google Apps Script side with <a href="https://developers.google.com/apps-script/guides/html/reference/run"><code>google.script.run</code></a>. This is run with the asynchronous process. Please be careful about this.</li>
<li>When you want to run <code>google.script.run</code> with the synchronous process, this repository might be useful. <a href="https://github.com/tanaikech/syncGoogleScriptRun">Ref</a></li>
<li>When you want to put the values from Google Apps Script to HTML when the HTML is opened, you can also use the HTML template. <a href="https://developers.google.com/apps-script/guides/html/templates">Ref</a></li>
</ul>
<h2 id="4-sidebar">4. Sidebar</h2>
<p>Please copy and paste the following HTML to the HTML file of <code>index.html</code> in the container-bound script of the Spreadsheet.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">base</span> <span style="color:#a6e22e">target</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;_top&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;main(this); return false;&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">google</span>.<span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">run</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">withSuccessHandler</span>(<span style="color:#a6e22e">google</span>.<span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">host</span>.<span style="color:#a6e22e">close</span>)
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">sample</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">parentNode</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>Please copy and paste the following script to the script file of <code>Code.gs</code> in the container-bound script of Spreadsheet.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Browser</span>.<span style="color:#a6e22e">msgBox</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">text</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">openSidebar</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getUi</span>().<span style="color:#a6e22e">showSidebar</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">HtmlService</span>.<span style="color:#a6e22e">createHtmlOutputFromFile</span>(<span style="color:#e6db74">&#34;index&#34;</span>)
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When the function <code>openSidebar</code> is run, a sidebar including a text input is opened. When you input &ldquo;sample&rdquo; in the text input and click &ldquo;submit&rdquo; button, &ldquo;sample&rdquo; is shown in a new dialog.</p>
<h3 id="important-9">Important</h3>
<ul>
<li>The values on the HTML side can be sent to the Google Apps Script side with <a href="https://developers.google.com/apps-script/guides/html/reference/run"><code>google.script.run</code></a>. This is run with the asynchronous process. Please be careful about this.</li>
<li>When you want to run <code>google.script.run</code> with the synchronous process, this repository might be useful. <a href="https://github.com/tanaikech/syncGoogleScriptRun">Ref</a></li>
<li>When you want to put the values from Google Apps Script to HTML when the HTML is opened, you can also use the HTML template. <a href="https://developers.google.com/apps-script/guides/html/templates">Ref</a></li>
</ul>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="5-custom-function-on-spreadsheet">5. Custom function on Spreadsheet</h1>
<h2 id="who-does-the-script-run-5">Who does the script run?</h2>
<p>When the script is run with the custom function, the script is run by the owner of Spreadsheet.</p>
<h2 id="important-10">Important</h2>
<ul>
<li>
<p>Before you use the custom function, I would like to recommend to read the official document. <a href="https://developers.google.com/apps-script/guides/sheets/functions">Ref</a></p>
</li>
<li>
<p>When I see questions on Stackoverflow, I think that the questions related to permission are sometimes seen. In the current stage, the custom function cannot use all methods of Google Apps Script. For example, the custom function can use UrlFetchApp. But, it cannot use DriveApp, GmailApp, MailApp, SpreadsheetApp.openById(), and so on. When you see an error like <code>Exception: You do not have permission to call ###. Required permissions: (###)</code>, please confirm your script again.</p>
</li>
<li>
<p>The custom function cannot export a formula. Please be careful about this.</p>
</li>
</ul>
<h2 id="how-to-use-2">How to use</h2>
<p>About the custom function, the official document says as follows. <a href="https://developers.google.com/apps-script/guides/sheets/functions">Ref</a></p>
<blockquote>
<p>Google Sheets offers hundreds of built-in functions like AVERAGE, SUM, and VLOOKUP. When these aren’t enough for your needs, you can use Google Apps Script to write custom functions — say, to convert meters to miles or fetch live content from the Internet — then use them in Google Sheets just like a built-in function.</p>
</blockquote>
<p>As a simple sample script, please copy and paste the following script to the script editor of the container-bound script of Google Spreadsheet, and save the script.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">SAMPLE</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSheet</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetName</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getSheetName</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">sheetName</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When this script is used as the custom function, the following result is obtained.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240112a/fig5.gif" alt="">
Fig. 4. Sample of the custom function.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="6-button-on-spreadsheet">6. Button on Spreadsheet</h1>
<h2 id="who-does-the-script-run-6">Who does the script run?</h2>
<p>In this case, the script is run by the user who clicks the button. So, when you want to make the user create a file in a folder on your Google Drive, it is required to share the folder with the user. Please be careful about this.</p>
<h2 id="important-11">Important</h2>
<ul>
<li>
<p>When I see questions on Stackoverflow, I think that the questions are related to the arguments of the function for executing by the button. In the current stage, the function for executing by a button cannot be executed with the arguments. But, this sample script might be useful. <a href="https://gist.github.com/tanaikech/5eedf04fa0f7727570b8e4c45b84a1f1">Ref</a></p>
</li>
<li>
<p>When you want to create a switching button, this report might be useful. <a href="https://gist.github.com/tanaikech/2e6cadc1f65d42aa161bcbd24e6cadb7">Ref</a></p>
</li>
<li>
<p>When you want to disable a button, this report might be useful. <a href="https://gist.github.com/tanaikech/28102d28b929e102f6fe88e7d42e2d64">Ref</a></p>
</li>
</ul>
<h2 id="how-to-use-3">How to use</h2>
<p>The simple flow for executing a function of Google Apps Script by clicking the button is as follows.</p>
<p>First, please copy and paste the following script to the script editor of the container-bound script of Google Spreadsheet, and save the script.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveRange</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">setValue</span>(<span style="color:#e6db74">&#34;sample&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The demonstration for executing this function using a button is as follows.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240112a/fig6.gif" alt="">
Fig. 5. Demonstration for using a button.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="7-web-apps">7. Web Apps</h1>
<h2 id="who-does-the-script-run-7">Who does the script run?</h2>
<p>In this case, you can select the user who runs Google Apps Script. In order to confirm this, please do the following flow.</p>
<ol>
<li>
<p>On the script editor, at the top right of the script editor, please click &ldquo;click Deploy&rdquo; -&gt; &ldquo;New deployment&rdquo;.</p>
</li>
<li>
<p>Please click &ldquo;Select type&rdquo; -&gt; &ldquo;Web App&rdquo;.</p>
</li>
</ol>
<p>By this flow, you can see the following dialog.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240112a/fig7.png" alt="">
Fig. 6. Dialog for setting Web Apps.</p>
<p>You can select the user who runs the script here.</p>
<ul>
<li>When &ldquo;Execute as: Me&rdquo; is selected, the script runs as the owner of Web Apps.</li>
<li>When &ldquo;Execute as: User accessing the web app&rdquo; is selected, the script runs as each user.</li>
</ul>
<p>The details of this can be seen in <a href="https://github.com/tanaikech/taking-advantage-of-Web-Apps-with-google-apps-script?tab=readme-ov-file#deploy-web-apps">my report</a>.</p>
<h2 id="important-12">Important</h2>
<ul>
<li>
<p>When you modify the Google Apps Script of Web Apps, please modify the deployment as a new version. By this, the modified script is reflected in Web Apps. You can see the details of this in my report &ldquo;<a href="https://gist.github.com/tanaikech/ebf92d8f427d02d53989d6c3464a9c43">Redeploying Web Apps without Changing URL of Web Apps for new IDE (Author: me)</a>&rdquo;.</p>
</li>
<li>
<p>In the case of setting of &ldquo;Execute as: Me&rdquo; and &ldquo;Who has access to the app: Anyone&rdquo;, the Web Apps can be accessed without authorization. But, in the case of other settings, in order to access Web Apps, it is required to use the access token. Please be careful about this. About this situation, you can see the detailed information in <a href="https://github.com/tanaikech/taking-advantage-of-Web-Apps-with-google-apps-script?tab=readme-ov-file#5-situations-for-web-apps">my report</a>.</p>
</li>
</ul>
<h2 id="how-to-use-4">How to use</h2>
<p>I think that in order to take advantage of Web Apps, <a href="https://github.com/tanaikech/taking-advantage-of-Web-Apps-with-google-apps-script">my report</a> will be useful.</p>
<p>Also, the sample situations can be seen using Web Apps at <a href="https://github.com/tanaikech/taking-advantage-of-Web-Apps-with-google-apps-script#samplesituations">my report</a>.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="8-google-apps-script-api">8. Google Apps Script API</h1>
<h2 id="who-does-the-script-run-8">Who does the script run?</h2>
<p>In this case, you can select the user who runs Google Apps Script by selecting &ldquo;Only myself&rdquo; or &ldquo;Anyone with Google account&rdquo;. <a href="https://developers.google.com/apps-script/api/how-tos/execute">Ref</a></p>
<h2 id="important-13">Important</h2>
<ul>
<li>
<p>In the current stage, Google Apps Script API cannot be used for Advanced Google services. So, when you want to use this, it is required to link the Google Apps Script project with the Google Cloud Platform Project. The flow of this can be seen in <a href="https://github.com/tanaikech/Linking-Google-Cloud-Platform-Project-to-Google-Apps-Script-Project-for-New-IDE">my report</a>. This report also introduces a sample script for using Google Apps Script API.</p>
</li>
<li>
<p>About &ldquo;Method: scripts.run&rdquo; of Google Apps Script API, in the current stage, this cannot be used with the service account. The official document says <code>Warning: The Apps Script API does not work with service accounts.</code>. <a href="https://developers.google.com/apps-script/api/concepts">Ref</a> Please be careful about this. If you want to run Google Apps Script with the service account, there is a workaround. <a href="https://medium.com/google-cloud/executing-google-apps-script-with-service-account-3752f4e3df8c">Ref</a></p>
</li>
</ul>
<h2 id="how-to-use-5">How to use</h2>
<p>Google Apps Script API can be used for managing and executing Google Apps Script. <a href="https://developers.google.com/apps-script/api/reference/rest">Ref</a></p>
<p>In this case, this report will help in understanding the setting of Google Apps Script API and the sample script. <a href="https://github.com/tanaikech/Linking-Google-Cloud-Platform-Project-to-Google-Apps-Script-Project-for-New-IDE">Ref</a></p>
<p>As a sample script, when Google Apps Script API is used, the history of Google Apps Script project can be also managed. <a href="https://github.com/tanaikech/ScriptHistoryApp">Ref</a></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="9-add-on">9. Add-on</h1>
<p>About the add-on, I think that the official document will be useful for understanding it. <a href="https://developers.google.com/apps-script/add-ons/overview">Ref</a></p>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2024%2f01%2f12%2freport-how-to-run-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2024%2f01%2f12%2freport-how-to-run-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f01%2f12%2freport-how-to-run-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2024%2f01%2f12%2freport-how-to-run-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f01%2f12%2freport-how-to-run-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f01%2f12%2freport-how-to-run-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2024/01/06/trend-of-google-apps-script-tag-on-stackoverflow-2024/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2024/01/06/trend-of-google-apps-script-tag-on-stackoverflow-2024/">Trend of google-apps-script Tag on Stackoverflow 2024</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

