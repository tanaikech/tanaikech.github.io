<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Simplifying Spreadsheet Management: Introducing a Google Apps Script Automation &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Simplifying Spreadsheet Management: Introducing a Google Apps Script Automation</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Sep 2024, 11:02</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  <p><img src="https://tanaikech.github.io/image-storage/20240917a/fig1.png" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>This post introduces a Google Apps Script solution that automates the creation, sharing, and monitoring of multiple Google Spreadsheets, providing a more efficient and streamlined approach to managing user data.</p>
<h1 id="introduction">Introduction</h1>
<p>I&rsquo;ve often encountered requests from clients who need to manage multiple Google Spreadsheets for various users, often by copying a template spreadsheet. In these situations, I typically propose the following approach:</p>
<ol>
<li>Create a Template Spreadsheet: This spreadsheet serves as a blueprint, containing essential elements like custom functions implemented using Google Apps Script.</li>
<li>Develop a Dashboard Spreadsheet: This centralized hub provides an overview of all user spreadsheets.</li>
<li>Clone and Share Spreadsheets: For each user, a copy of the template spreadsheet is created and shared with them. The URLs of these individual spreadsheets are then recorded in the dashboard.</li>
<li>Import Data Using IMPORTRANGE: The dashboard utilizes the IMPORTRANGE function to fetch data from individual user spreadsheets. This enables real-time updates on the dashboard as users edit their respective sheets.</li>
</ol>
<p>While this manual process can be effective, it can become cumbersome and time-consuming, especially as the number of users and spreadsheets grows. To streamline this workflow and enhance efficiency, I&rsquo;ve developed a Google Apps Script solution that automates many of these steps.</p>
<p>By leveraging Google Apps Script, we can take advantage of Google APIs for seamless authorization and access to Google services. This allows for more robust and scalable solutions. Moreover, Google Apps Script&rsquo;s user-friendly interface makes it accessible to a wide range of users, from novice to experienced developers.</p>
<p>In this post, I&rsquo;ll introduce the Google Apps Script that automates the process of creating, sharing, and monitoring multiple Google Spreadsheets, providing a more efficient and streamlined solution for managing user data.</p>
<h1 id="usage">Usage</h1>
<h2 id="1-prepare-a-template-spreadsheet">1. Prepare a template Spreadsheet</h2>
<p>Please prepare the template Spreadsheet. As a sample situation, the following sample spreadsheet has been created.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240917a/fig2.png" alt=""></p>
<ol>
<li>Create a new Spreadsheet. Here, only the 1st tab is used.</li>
<li>Copy and paste a script <code>const SAMPLE = e =&gt; e + 1;</code> to the script editor and save the script.</li>
<li>Put a custom function <code>=SAMPLE(1)</code> into &ldquo;A1&rdquo; of the 1st tab. This is used as the sample cell value.</li>
</ol>
<p>This is used as the template Spreadsheet.</p>
<h2 id="2-create-a-dashboard-spreadsheet">2. Create a dashboard Spreadsheet</h2>
<p>Here, the dashboard Spreadsheet is created. Please do the following flow.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240917a/fig3.png" alt=""></p>
<ol>
<li>Create a new Spreadsheet and rename the 1st sheet to &ldquo;dashboard&rdquo;.</li>
<li>Put the template Spreadsheet ID and the folder ID you want to put the copied template Spreadsheet to &ldquo;B2&rdquo; and &ldquo;B3&rdquo;, respectively.</li>
<li>Put email addresses to &ldquo;A6:A&rdquo;. These email addresses are the user&rsquo;s email addresses. When the template Spreadsheet is copied, the copied Spreadsheet is shared with this email.</li>
<li>Copy and paste the following script as shown in the next section.</li>
</ol>
<h2 id="3-script-for-managing-spreadsheets">3. Script for managing Spreadsheets</h2>
<h4 id="1-enable-apis">1. Enable APIs</h4>
<p>Please enable Drive API and Sheets API at Advanced Google services. <a href="https://developers.google.com/apps-script/guides/services/advanced#enable_advanced_services">Ref</a></p>
<h4 id="2-install-library">2. Install library</h4>
<p>Please install <a href="https://github.com/tanaikech/BatchRequest">BatchRequest</a> of the Google Apps Script library. You can see how to install it <a href="https://github.com/tanaikech/BatchRequest?tab=readme-ov-file#how-to-install">here</a>.</p>
<h4 id="3-script">3. Script</h4>
<p>Please copy and paste the following script to the script editor of the dashboard Spreadsheet and save the script.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;--- Retrieve values from the dashboard sheet.&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ssId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getId</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">dashboard</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#e6db74">&#34;dashboard&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">templateSpreadsheetId</span>, <span style="color:#a6e22e">folderId</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">dashboard</span>
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getRange</span>(<span style="color:#e6db74">&#34;A2:B3&#34;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getValues</span>()
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">o</span>, [<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>]) =&gt; ((<span style="color:#a6e22e">o</span>[<span style="color:#a6e22e">a</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">b</span>), <span style="color:#a6e22e">o</span>), {});
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">dashboard</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#e6db74">&#34;A6:B&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">dashboard</span>.<span style="color:#a6e22e">getLastRow</span>());
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getValues</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getSheets</span>().<span style="color:#a6e22e">some</span>((<span style="color:#a6e22e">s</span>) =&gt; <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">flat</span>().<span style="color:#a6e22e">includes</span>(<span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">getSheetName</span>()))) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;The same sheet names with your inputted email addresses are existing. Please rename the sheet names.&#34;</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">headers</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">authorization</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Bearer &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">getOAuthToken</span>() };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;--- Copy template Spreadsheet.&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">reqs1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">map</span>(([<span style="color:#a6e22e">name</span>]) =&gt; ({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;POST&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">endpoint</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`https://www.googleapis.com/drive/v3/files/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">templateSpreadsheetId</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/copy?supportsAllDrives=true`</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">requestBody</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">parents</span><span style="color:#f92672">:</span> [<span style="color:#a6e22e">folderId</span>], <span style="color:#a6e22e">name</span> },
</span></span><span style="display:flex;"><span>  }));
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">BatchRequest</span>.<span style="color:#a6e22e">EDo</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">batchPath</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;batch/drive/v3&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">requests</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">reqs1</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">`--- </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">res1</span>.<span style="color:#a6e22e">length</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> Spreadsheets were created by copying the template Spreadsheet.`</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;--- Create 3 batch requests.&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">v</span>, <span style="color:#a6e22e">reqs2</span>, <span style="color:#a6e22e">reqs3</span>, <span style="color:#a6e22e">reqs4</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">res1</span>.<span style="color:#a6e22e">reduce</span>(
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">o</span>, { <span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">name</span> }, <span style="color:#a6e22e">i</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`https://docs.google.com/spreadsheets/d/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">id</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/edit`</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">push</span>([<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">url</span>]);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">reqs2</span>.<span style="color:#a6e22e">push</span>({
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;POST&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">endpoint</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`https://www.googleapis.com/drive/v3/files/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">id</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/permissions?supportsAllDrives=true`</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">requestBody</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">role</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;writer&#34;</span>, <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;user&#34;</span>, <span style="color:#a6e22e">emailAddress</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">name</span> },
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">reqs3</span>.<span style="color:#a6e22e">push</span>({
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">url</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`https://docs.google.com/spreadsheets/d/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">ssId</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/externaldata/addimportrangepermissions?donorDocId=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">id</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;post&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">headers</span>,
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#ae81ff">123456789</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">i</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">reqs4</span>.<span style="color:#a6e22e">push</span>(
</span></span><span style="display:flex;"><span>        { <span style="color:#a6e22e">addSheet</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">properties</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">sheetId</span> } } },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">updateCells</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">range</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">sheetId</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">startRowIndex</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">endRowIndex</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">startColumnIndex</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">endColumnIndex</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">rows</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>              {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">values</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>                  {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">userEnteredValue</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>                      <span style="color:#a6e22e">formulaValue</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`=IMPORTRANGE(&#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">url</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;,&#34;A1:ZZZ&#34;)`</span>,
</span></span><span style="display:flex;"><span>                    },
</span></span><span style="display:flex;"><span>                  },
</span></span><span style="display:flex;"><span>                ],
</span></span><span style="display:flex;"><span>              },
</span></span><span style="display:flex;"><span>            ],
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">fields</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;userEnteredValue&#34;</span>,
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      );
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">o</span>;
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">v</span><span style="color:#f92672">:</span> [], <span style="color:#a6e22e">reqs2</span><span style="color:#f92672">:</span> [], <span style="color:#a6e22e">reqs3</span><span style="color:#f92672">:</span> [], <span style="color:#a6e22e">reqs4</span><span style="color:#f92672">:</span> [] }
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;--- Share the copied template Spreadsheet with each user.&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">BatchRequest</span>.<span style="color:#a6e22e">EDo</span>({ <span style="color:#a6e22e">batchPath</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;batch/drive/v3&#34;</span>, <span style="color:#a6e22e">requests</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">reqs2</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Ref: https://medium.com/google-cloud/allowing-access-by-importhtml-importdata-importfeed-importxml-and-importrange-on-google-3f4f5d7e6b1e
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;--- Authorize IMPORTRANGE between the dashboard Spreadsheet and the copied tempate Spreadsheets.&#34;</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetchAll</span>(<span style="color:#a6e22e">reqs3</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;--- Add sheets to the dashboard Spreadsheet and put formulas.&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Sheets</span>.<span style="color:#a6e22e">Spreadsheets</span>.<span style="color:#a6e22e">batchUpdate</span>({ <span style="color:#a6e22e">requests</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">reqs4</span> }, <span style="color:#a6e22e">ssId</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;--- Update dashboard sheet.&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">v</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="4-testing">4. Testing</h2>
<p>When <code>myFunction</code> is run under the above settings have been finished, the following steps are run.</p>
<ol>
<li>Copy the template Spreadsheet for the number of email addresses.</li>
<li>Share the copied Spreadsheet with each email address.</li>
<li>Add sheets for the number of email addresses to the dashboard Spreadsheet.</li>
<li>A formula of <code>IMPORTRANGE</code> to cell &ldquo;A1&rdquo; of the added sheets.</li>
<li>Authorize to use <code>IMPORTRANGE</code>. <a href="https://medium.com/google-cloud/allowing-access-by-importhtml-importdata-importfeed-importxml-and-importrange-on-google-3f4f5d7e6b1e">Ref</a></li>
<li>Put the URLs of the copied Spreadsheet for each user into the dashboard sheet.</li>
</ol>
<p>By this flow, when the user edit the sheet, you who is the owner of the dashboard Spreadsheet can see the cell values of the user&rsquo;s sheet in one of the sheets in the dashboard Spreadsheet. Also, you can see the URLs of each user&rsquo;s Spreadsheet.</p>
<h1 id="note">Note</h1>
<ul>
<li>Unfortunately, I do not know the maximum number of users using this script. So, when under a large number of users, an error occurs or the script doesn&rsquo;t work, please split the users into multiple groups and run the script in every group.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2024%2f09%2f17%2fsimplifying-spreadsheet-management-introducing-a-google-apps-script-automation%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2024%2f09%2f17%2fsimplifying-spreadsheet-management-introducing-a-google-apps-script-automation%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f09%2f17%2fsimplifying-spreadsheet-management-introducing-a-google-apps-script-automation%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2024%2f09%2f17%2fsimplifying-spreadsheet-management-introducing-a-google-apps-script-automation%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f09%2f17%2fsimplifying-spreadsheet-management-introducing-a-google-apps-script-automation%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f09%2f17%2fsimplifying-spreadsheet-management-introducing-a-google-apps-script-automation%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2024/09/12/gemini-powered-dynamic-pseudo-rag-for-efficient-script-generation/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2024/09/12/gemini-powered-dynamic-pseudo-rag-for-efficient-script-generation/">Gemini-Powered Dynamic Pseudo-RAG for Efficient Script Generation</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2024/09/19/flexible-labeling-for-gmail-using-gemini-api-with-google-apps-script-part-3/">Flexible Labeling for Gmail using Gemini API with Google Apps Script Part 3</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2024/09/19/flexible-labeling-for-gmail-using-gemini-api-with-google-apps-script-part-3/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

