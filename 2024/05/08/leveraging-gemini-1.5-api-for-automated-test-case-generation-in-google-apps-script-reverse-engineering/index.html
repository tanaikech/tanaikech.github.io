<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Leveraging Gemini 1.5 API for Automated Test Case Generation in Google Apps Script Reverse Engineering &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fab fa-medium fa-fw"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Leveraging Gemini 1.5 API for Automated Test Case Generation in Google Apps Script Reverse Engineering</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>08 May 2024, 14:24</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/ai">AI</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/llm">LLM</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/fc51414e16faa2a26aa39eea487d64a5">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20240508a/fig1.jpg" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>This report examines leveraging Gemini 1.5 API with Google Apps Script to automate sample input creation during script reverse engineering. Traditionally, this process is manual and time-consuming, especially for functions with numerous test cases. Gemini 1.5 API&rsquo;s potential to streamline development by automating input generation is explored through applying reverse engineering techniques to Google Apps Script samples.</p>
<h1 id="introduction">Introduction</h1>
<p>With the release of Gemini 1.5 API, users gained the ability to process more complex data, opening doors for various application developments. This report explores the potential of using Gemini 1.5 API in conjunction with Google Apps Script to achieve reverse engineering for script development and improvement.</p>
<p>Traditionally, script development involves manually crafting sample input values. This process can be time-consuming, especially when creating functions or testing code retrieved from online resources like Stack Overflow. Each function might require numerous test cases, and manually generating these inputs can be a bottleneck.</p>
<p>Gemini 1.5 API offers a potential solution by automating sample input value creation. This could significantly reduce development time and effort. This report investigates this possibility by applying reverse engineering techniques to various Google Apps Script samples using Gemini 1.5 API.</p>
<p>Here, we will explore how Gemini 1.5 API can be used to automate sample input value generation for reverse engineering scripts written in Google Apps Script.</p>
<h1 id="usage">Usage</h1>
<p>In order to test this script, please do the following flow.</p>
<h2 id="1-create-an-api-key">1. Create an API key</h2>
<p>Please access <a href="https://ai.google.dev/gemini-api/docs/api-key">https://ai.google.dev/gemini-api/docs/api-key</a> and create your API key. At that time, please enable Generative Language API at the API console. This API key is used for this sample script.</p>
<p>This official document can be also seen. <a href="https://ai.google.dev/">Ref</a>.</p>
<h2 id="2-create-a-google-apps-script-project">2. Create a Google Apps Script project</h2>
<p>In this report, Google Apps Script is used. Of course, the method introducing this report can be also used in other languages.</p>
<p>Here, in order to test the following sample scripts, please create a standalone Google Apps Script project. Of course, this script can be also used with the container-bound script.</p>
<p>And, please open the script editor of the Google Apps Script project.</p>
<h2 id="3-install-google-apps-script-library">3. Install Google Apps Script library</h2>
<p>In order to easily access Gemini API, I created a Google Apps Script library <a href="https://github.com/tanaikech/GeminiWithFiles">GeminiWithFiles</a>. In the following sample scripts, this library is used. So, please install it. You can see how to install it at <a href="https://github.com/tanaikech/GeminiWithFiles?tab=readme-ov-file#1-use-geminiwithfiles-as-a-google-apps-script-library">here</a>.</p>
<h2 id="4-sample-script-1">4. Sample script 1</h2>
<p>The sample functions were selected from <a href="https://github.com/tanaikech/UtlApp">my repository</a>.</p>
<ul>
<li><a href="https://github.com/tanaikech/UtlApp?tab=readme-ov-file#transpose">transpose</a>: Transpose 2 dimensional array.</li>
<li><a href="https://github.com/tanaikech/UtlApp?tab=readme-ov-file#removeduplicatedvalues">removeDuplicatedValues</a>: Remove duplicated values from 1 dimensional array.</li>
<li><a href="https://github.com/tanaikech/UtlApp?tab=readme-ov-file#compilingnumbers">compilingNumbers</a>: Compiling Continuous Numbers using Google Apps Script.</li>
<li><a href="https://github.com/tanaikech/UtlApp?tab=readme-ov-file#unpivot">unpivot</a>: Converting 2-dimensional array as unpivot (reverse pivot).</li>
<li><a href="https://github.com/tanaikech/UtlApp?tab=readme-ov-file#expanda1notations">expandA1Notations</a>: This method is used for expanding A1Notations.</li>
</ul>
<p>The sample script demonstrating these functions is provided below. In this example, all functions can be executed in a single API call. When I ran this script, it returned a total of 2,880 tokens.</p>
<p>The sample first creates input values using Gemini. To test these values, the script then uses them with the function implemented in Google Apps Script. Finally, both the input and output values are printed.</p>
<p>JSON schema is employed here to generate content. This ensures the stable generation of complex JSON objects by Gemini. <a href="https://medium.com/google-cloud/taming-the-wild-output-effective-control-of-gemini-api-response-formats-with-response-mime-type-da273c08be85">Ref</a> As a result, I opted to use it in this instance.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set your API key.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">functionObj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">transpose</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">transpose</span>(<span style="color:#a6e22e">array</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * When the inputted array is 2 dimensional array, true is returned.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @param {Array} array 2 dimensional array.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @return {Boolean} When the inputted array is 2 dimensional array, true is returned.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">is2DimensionalArray</span>(<span style="color:#a6e22e">array</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">array</span>.<span style="color:#a6e22e">every</span>((<span style="color:#a6e22e">r</span>) =&gt; Array.<span style="color:#a6e22e">isArray</span>(<span style="color:#a6e22e">r</span>));
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * Transpose 2 dimensional array.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @param {Array} array 2 dimensional array.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @param {Boolean} check Check whether the inputted array is 2 dimensional array. Default is true.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @return {Array} Transposed array.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">transpose</span>(<span style="color:#a6e22e">array</span>, <span style="color:#a6e22e">check</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">check</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">is2DimensionalArray</span>(<span style="color:#a6e22e">array</span>)) {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Please use 2 dimensional array.&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">array</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">col</span>) =&gt; <span style="color:#a6e22e">array</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">row</span>) =&gt; <span style="color:#a6e22e">row</span>[<span style="color:#a6e22e">col</span>] <span style="color:#f92672">||</span> <span style="color:#66d9ef">null</span>));
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">transpose</span>(<span style="color:#a6e22e">array</span>);
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">removeDuplicatedValues</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">removeDuplicatedValues</span>(<span style="color:#a6e22e">array</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * Remove duplicated values from 1 dimensional array.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @param {Array} array 1 dimensional array.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @return {Object} Object including removeDuplicatedValues, duplicatedValues and numberOfDuplicate.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">removeDuplicatedValues</span>(<span style="color:#a6e22e">array</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>Array.<span style="color:#a6e22e">isArray</span>(<span style="color:#a6e22e">array</span>)) {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Please use 1 dimensional array.&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">array</span>.<span style="color:#a6e22e">reduce</span>(
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">m</span>, <span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">set</span>(<span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">has</span>(<span style="color:#a6e22e">e</span>) <span style="color:#f92672">?</span> <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">get</span>(<span style="color:#a6e22e">e</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Map</span>()
</span></span><span style="display:flex;"><span>        );
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">e</span> <span style="color:#f92672">=</span> [...<span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">entries</span>()];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">removeDuplicatedValues</span><span style="color:#f92672">:</span> [...<span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">keys</span>()],
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">duplicatedValues</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">ar</span>, [<span style="color:#a6e22e">k</span>, <span style="color:#a6e22e">v</span>]) =&gt; {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">v</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>) <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">k</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ar</span>;
</span></span><span style="display:flex;"><span>          }, []),
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">numberOfDuplicate</span><span style="color:#f92672">:</span> Object.<span style="color:#a6e22e">fromEntries</span>(<span style="color:#a6e22e">e</span>),
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">removeDuplicatedValues</span>(<span style="color:#a6e22e">array</span>);
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">compilingNumbers</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">compilingNumbers</span>(<span style="color:#a6e22e">array</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * Compiling Continuous Numbers using Google Apps Script.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @param {Array} array Input array.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @return {Array} Array including object like [{&#34;start&#34;:1,&#34;end&#34;:1},{&#34;start&#34;:3,&#34;end&#34;:5},{&#34;start&#34;:7,&#34;end&#34;:7},{&#34;start&#34;:9,&#34;end&#34;:11},{&#34;start&#34;:13,&#34;end&#34;:13}].
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">compilingNumbers</span>(<span style="color:#a6e22e">array</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>(Array.<span style="color:#a6e22e">isArray</span>(<span style="color:#a6e22e">array</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">array</span>.<span style="color:#a6e22e">every</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#f92672">!</span>isNaN(<span style="color:#a6e22e">e</span>)))) {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Please give an array including numbers.&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">values</span> } <span style="color:#f92672">=</span> [...<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Set</span>(<span style="color:#a6e22e">array</span>.<span style="color:#a6e22e">sort</span>((<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) =&gt; <span style="color:#a6e22e">a</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">b</span>))].<span style="color:#a6e22e">reduce</span>(
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">o</span>, <span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">i</span>, <span style="color:#a6e22e">a</span>) =&gt; {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span>
</span></span><span style="display:flex;"><span>              (<span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">e</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>[<span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>            ) {
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">e</span>);
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>              <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">push</span>({
</span></span><span style="display:flex;"><span>                  <span style="color:#a6e22e">start</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>[<span style="color:#ae81ff">0</span>],
</span></span><span style="display:flex;"><span>                  <span style="color:#a6e22e">end</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>[<span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>],
</span></span><span style="display:flex;"><span>                });
</span></span><span style="display:flex;"><span>              }
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> [<span style="color:#a6e22e">e</span>];
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">push</span>(
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">?</span> { <span style="color:#a6e22e">start</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>[<span style="color:#ae81ff">0</span>], <span style="color:#a6e22e">end</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>[<span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] }
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">:</span> { <span style="color:#a6e22e">start</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">end</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span> }
</span></span><span style="display:flex;"><span>              );
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">o</span>;
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>          { <span style="color:#a6e22e">temp</span><span style="color:#f92672">:</span> [], <span style="color:#a6e22e">values</span><span style="color:#f92672">:</span> [] }
</span></span><span style="display:flex;"><span>        );
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">values</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">compilingNumbers</span>(<span style="color:#a6e22e">array</span>);
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">unpivot</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">unpivot</span>(<span style="color:#a6e22e">values</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * When the inputted array is 2 dimensional array, true is returned.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @param {Array} array 2 dimensional array.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @return {Boolean} When the inputted array is 2 dimensional array, true is returned.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">is2DimensionalArray</span>(<span style="color:#a6e22e">array</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">array</span>.<span style="color:#a6e22e">every</span>((<span style="color:#a6e22e">r</span>) =&gt; Array.<span style="color:#a6e22e">isArray</span>(<span style="color:#a6e22e">r</span>));
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * Converting 2-dimensional array as unpivot (reverse pivot).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @param {Array} values 2 dimensional array.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @return {Array} 2 dimensional array converted as unpivot (reverse pivot).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">unpivot</span>(<span style="color:#a6e22e">values</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>Array.<span style="color:#a6e22e">isArray</span>(<span style="color:#a6e22e">values</span>) <span style="color:#f92672">||</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">is2DimensionalArray</span>(<span style="color:#a6e22e">values</span>)) {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Please give an array of values.&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> [[, ...<span style="color:#a6e22e">h</span>], ...<span style="color:#a6e22e">v</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">values</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">flatMap</span>((<span style="color:#a6e22e">hh</span>, <span style="color:#a6e22e">i</span>) =&gt; <span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">t</span>) =&gt; [<span style="color:#a6e22e">hh</span>, <span style="color:#a6e22e">t</span>[<span style="color:#ae81ff">0</span>], <span style="color:#a6e22e">t</span>[<span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]]));
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">unpivot</span>(<span style="color:#a6e22e">values</span>);
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">expandA1Notations</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">expandA1Notations</span>(<span style="color:#a6e22e">a1Notations</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * Converting colum letter to column index. Start of column index is 0.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @param {String} letter Column letter.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @return {Number} Column index.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">columnLetterToIndex</span>(<span style="color:#a6e22e">letter</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">letter</span> <span style="color:#f92672">===</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> <span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">letter</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;string&#34;</span>) {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Please give the column letter as a string.&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">letter</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">letter</span>.<span style="color:#a6e22e">toUpperCase</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> [...<span style="color:#a6e22e">letter</span>].<span style="color:#a6e22e">reduce</span>(
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">c</span>, <span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">i</span>, <span style="color:#a6e22e">a</span>) =&gt;
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">c</span> <span style="color:#f92672">+=</span> (<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">64</span>) <span style="color:#f92672">*</span> Math.<span style="color:#a6e22e">pow</span>(<span style="color:#ae81ff">26</span>, <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)),
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        );
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * Converting colum index to column letter. Start of column index is 0.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * Ref: https://stackoverflow.com/a/53678158/7108653
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @param {Number} index Column index.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @return {String} Column letter.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">columnIndexToLetter</span>(<span style="color:#a6e22e">index</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">index</span> <span style="color:#f92672">===</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> isNaN(<span style="color:#a6e22e">index</span>)) {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Please give the column indexr as a number. In this case, 1st number is 0.&#34;</span>
</span></span><span style="display:flex;"><span>          );
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (<span style="color:#a6e22e">a</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">floor</span>(<span style="color:#a6e22e">index</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">26</span>)) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">?</span> <span style="color:#a6e22e">columnIndexToLetter</span>(<span style="color:#a6e22e">a</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> String.<span style="color:#a6e22e">fromCharCode</span>(<span style="color:#ae81ff">65</span> <span style="color:#f92672">+</span> (<span style="color:#a6e22e">index</span> <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span>))
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * This method is used for expanding A1Notations.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @param {Array} a1Notations Array including A1Notations.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @return {Array} Array including the expanded A1Notations.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">expandA1Notations</span>(<span style="color:#a6e22e">a1Notations</span>, <span style="color:#a6e22e">maxRow</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10&#34;</span>, <span style="color:#a6e22e">maxColumn</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Z&#34;</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>Array.<span style="color:#a6e22e">isArray</span>(<span style="color:#a6e22e">a1Notations</span>) <span style="color:#f92672">||</span> <span style="color:#a6e22e">a1Notations</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Please give a1Notations (Array).&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">reg1</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> RegExp(<span style="color:#e6db74">&#34;^([A-Z]+)([0-9]+)$&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">reg2</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> RegExp(<span style="color:#e6db74">&#34;^([A-Z]+)$&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">reg3</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> RegExp(<span style="color:#e6db74">&#34;^([0-9]+)$&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a1Notations</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">a1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;!&#34;</span>);
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">r</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">a1</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">?</span> <span style="color:#a6e22e">a1</span>[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">:</span> <span style="color:#a6e22e">a1</span>[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">r1</span>, <span style="color:#a6e22e">r2</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;:&#34;</span>);
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">r2</span>) <span style="color:#66d9ef">return</span> [<span style="color:#a6e22e">r1</span>];
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">rr</span>;
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">reg1</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">r1</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">reg1</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">r2</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">rr</span> <span style="color:#f92672">=</span> [<span style="color:#a6e22e">r1</span>.<span style="color:#a6e22e">toUpperCase</span>().<span style="color:#a6e22e">match</span>(<span style="color:#a6e22e">reg1</span>), <span style="color:#a6e22e">r2</span>.<span style="color:#a6e22e">toUpperCase</span>().<span style="color:#a6e22e">match</span>(<span style="color:#a6e22e">reg1</span>)];
</span></span><span style="display:flex;"><span>          } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">reg2</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">r1</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">reg2</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">r2</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">rr</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>              [<span style="color:#66d9ef">null</span>, <span style="color:#a6e22e">r1</span>, <span style="color:#ae81ff">1</span>],
</span></span><span style="display:flex;"><span>              [<span style="color:#66d9ef">null</span>, <span style="color:#a6e22e">r2</span>, <span style="color:#a6e22e">maxRow</span>],
</span></span><span style="display:flex;"><span>            ];
</span></span><span style="display:flex;"><span>          } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">reg1</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">r1</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">reg2</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">r2</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">rr</span> <span style="color:#f92672">=</span> [<span style="color:#a6e22e">r1</span>.<span style="color:#a6e22e">toUpperCase</span>().<span style="color:#a6e22e">match</span>(<span style="color:#a6e22e">reg1</span>), [<span style="color:#66d9ef">null</span>, <span style="color:#a6e22e">r2</span>, <span style="color:#a6e22e">maxRow</span>]];
</span></span><span style="display:flex;"><span>          } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">reg2</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">r1</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">reg1</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">r2</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">rr</span> <span style="color:#f92672">=</span> [[<span style="color:#66d9ef">null</span>, <span style="color:#a6e22e">r1</span>, <span style="color:#a6e22e">maxRow</span>], <span style="color:#a6e22e">r2</span>.<span style="color:#a6e22e">toUpperCase</span>().<span style="color:#a6e22e">match</span>(<span style="color:#a6e22e">reg1</span>)];
</span></span><span style="display:flex;"><span>          } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">reg3</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">r1</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">reg3</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">r2</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">rr</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>              Number(<span style="color:#a6e22e">r1</span>) <span style="color:#f92672">&gt;</span> Number(<span style="color:#a6e22e">r2</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">?</span> [
</span></span><span style="display:flex;"><span>                    [<span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;A&#34;</span>, <span style="color:#a6e22e">r2</span>],
</span></span><span style="display:flex;"><span>                    [<span style="color:#66d9ef">null</span>, <span style="color:#a6e22e">maxColumn</span>, <span style="color:#a6e22e">r1</span>],
</span></span><span style="display:flex;"><span>                  ]
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>                    [<span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;A&#34;</span>, <span style="color:#a6e22e">r1</span>],
</span></span><span style="display:flex;"><span>                    [<span style="color:#66d9ef">null</span>, <span style="color:#a6e22e">maxColumn</span>, <span style="color:#a6e22e">r2</span>],
</span></span><span style="display:flex;"><span>                  ];
</span></span><span style="display:flex;"><span>          } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">reg1</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">r1</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">reg3</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">r2</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">rr</span> <span style="color:#f92672">=</span> [<span style="color:#a6e22e">r1</span>.<span style="color:#a6e22e">toUpperCase</span>().<span style="color:#a6e22e">match</span>(<span style="color:#a6e22e">reg1</span>), [<span style="color:#66d9ef">null</span>, <span style="color:#a6e22e">maxColumn</span>, <span style="color:#a6e22e">r2</span>]];
</span></span><span style="display:flex;"><span>          } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">reg3</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">r1</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">reg1</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">r2</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">r2</span>.<span style="color:#a6e22e">toUpperCase</span>().<span style="color:#a6e22e">match</span>(<span style="color:#a6e22e">reg1</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">rr</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>              Number(<span style="color:#a6e22e">temp</span>[<span style="color:#ae81ff">2</span>]) <span style="color:#f92672">&gt;</span> Number(<span style="color:#a6e22e">r1</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">?</span> [
</span></span><span style="display:flex;"><span>                    [<span style="color:#66d9ef">null</span>, <span style="color:#a6e22e">temp</span>[<span style="color:#ae81ff">1</span>], <span style="color:#a6e22e">r1</span>],
</span></span><span style="display:flex;"><span>                    [<span style="color:#66d9ef">null</span>, <span style="color:#a6e22e">maxColumn</span>, <span style="color:#a6e22e">temp</span>[<span style="color:#ae81ff">2</span>]],
</span></span><span style="display:flex;"><span>                  ]
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">:</span> [<span style="color:#a6e22e">temp</span>, [<span style="color:#66d9ef">null</span>, <span style="color:#a6e22e">maxColumn</span>, <span style="color:#a6e22e">r1</span>]];
</span></span><span style="display:flex;"><span>          } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Wrong a1Notation: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">r</span>);
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">startRowIndex</span><span style="color:#f92672">:</span> Number(<span style="color:#a6e22e">rr</span>[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">2</span>]),
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">endRowIndex</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">rr</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">?</span> Number(<span style="color:#a6e22e">rr</span>[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">2</span>]) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> Number(<span style="color:#a6e22e">rr</span>[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">2</span>]) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">startColumnIndex</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">columnLetterToIndex</span>(<span style="color:#a6e22e">rr</span>[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>]),
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">endColumnIndex</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">rr</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">?</span> <span style="color:#a6e22e">columnLetterToIndex</span>(<span style="color:#a6e22e">rr</span>[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>]) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">:</span> <span style="color:#a6e22e">columnLetterToIndex</span>(<span style="color:#a6e22e">rr</span>[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>]) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>          };
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">startRowIndex</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">endRowIndex</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">startColumnIndex</span>; <span style="color:#a6e22e">j</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">endColumnIndex</span>; <span style="color:#a6e22e">j</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">columnIndexToLetter</span>(<span style="color:#a6e22e">j</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">i</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">temp</span>;
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">expandA1Notations</span>(<span style="color:#a6e22e">a1Notations</span>);
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">g</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">GeminiWithFiles</span>.<span style="color:#a6e22e">geminiWithFiles</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">apiKey</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">response_mime_type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">doCountToken</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">functions</span> <span style="color:#f92672">=</span> Object.<span style="color:#a6e22e">entries</span>(<span style="color:#a6e22e">functionObj</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">map</span>(
</span></span><span style="display:flex;"><span>      ([<span style="color:#a6e22e">k</span>, <span style="color:#a6e22e">v</span>]) =&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`&lt;FunctionName&gt;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">k</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;/FunctionName&gt;&lt;Function&gt;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">toString</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;/Function&gt;`</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">jsonSchema</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;5 input values for giving each function&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Proposal 5 input values for giving each function. </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">functions</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> Don&#39;t propose &#34;empty&#34;, &#34;null&#34;, &#34;undefined&#34; as values.`</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;array&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">items</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;object&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">properties</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">functionName</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Function name&#34;</span>, <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">inputValues</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Proposed 5 input values. Don&#39;t propose &#34;empty&#34;, &#34;null&#34;, &#34;undefined&#34; as values.`</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;array&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">items</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Proposed input value&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;array|object|string|number&#34;</span>,
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">additionalProperties</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">g</span>.<span style="color:#a6e22e">generateContent</span>({ <span style="color:#a6e22e">jsonSchema</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;string&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">res</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> ({ <span style="color:#a6e22e">stack</span> }) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">stack</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">o</span>, { <span style="color:#a6e22e">functionName</span>, <span style="color:#a6e22e">inputValues</span> }) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">o</span>[<span style="color:#a6e22e">functionName</span>] <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">inputValues</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">input</span>) =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">output</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">functionObj</span>[<span style="color:#a6e22e">functionName</span>](<span style="color:#a6e22e">input</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">o</span>[<span style="color:#a6e22e">functionName</span>].<span style="color:#a6e22e">push</span>({ <span style="color:#a6e22e">input</span>, <span style="color:#a6e22e">output</span> });
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> ({ <span style="color:#a6e22e">stack</span> }) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">stack</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">o</span>;
</span></span><span style="display:flex;"><span>  }, {});
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">result</span>));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When this script is run, the following result is obtained. You can see that valid input and output values are created.</p>
<pre tabindex="0"><code>{
  &#34;transpose&#34;: [
    { &#34;input&#34;: [[1, 2], [3, 4]], &#34;output&#34;: [[1, 3], [2, 4]] },
    { &#34;input&#34;: [[&#34;a&#34;, &#34;b&#34;], [&#34;c&#34;, &#34;d&#34;]], &#34;output&#34;: [[&#34;a&#34;, &#34;c&#34;], [&#34;b&#34;, &#34;d&#34;]] },
    { &#34;input&#34;: [[&#34;a1&#34;, &#34;b1&#34;], [&#34;c1&#34;, &#34;d1&#34;], [&#34;e1&#34;, &#34;f1&#34;]], &#34;output&#34;: [[&#34;a1&#34;, &#34;c1&#34;, &#34;e1&#34;], [&#34;b1&#34;, &#34;d1&#34;, &#34;f1&#34;]] },
    { &#34;input&#34;: [[true, false], [false, true]], &#34;output&#34;: [[true, null], [null, true]] },
    { &#34;input&#34;: [[1, &#34;a&#34;], [&#34;c&#34;, true]], &#34;output&#34;: [[1, &#34;c&#34;], [&#34;a&#34;, true]] }
  ],

  &#34;removeDuplicatedValues&#34;: [
    { &#34;input&#34;: [1, 2, 3, 4, 5], &#34;output&#34;: { &#34;removeDuplicatedValues&#34;: [1, 2, 3, 4, 5], &#34;duplicatedValues&#34;: [], &#34;numberOfDuplicate&#34;: { &#34;1&#34;: 1, &#34;2&#34;: 1, &#34;3&#34;: 1, &#34;4&#34;: 1, &#34;5&#34;: 1 } } },
    { &#34;input&#34;: [&#34;a&#34;, &#34;b&#34;, &#34;c&#34;, &#34;d&#34;, &#34;e&#34;], &#34;output&#34;: { &#34;removeDuplicatedValues&#34;: [&#34;a&#34;, &#34;b&#34;, &#34;c&#34;, &#34;d&#34;, &#34;e&#34;], &#34;duplicatedValues&#34;: [], &#34;numberOfDuplicate&#34;: { &#34;a&#34;: 1, &#34;b&#34;: 1, &#34;c&#34;: 1, &#34;d&#34;: 1, &#34;e&#34;: 1 } } },
    { &#34;input&#34;: [1, 2, 1, 3, 2, 4, 3, 5, 4], &#34;output&#34;: { &#34;removeDuplicatedValues&#34;: [1, 2, 3, 4, 5], &#34;duplicatedValues&#34;: [1, 2, 3, 4], &#34;numberOfDuplicate&#34;: { &#34;1&#34;: 2, &#34;2&#34;: 2, &#34;3&#34;: 2, &#34;4&#34;: 2, &#34;5&#34;: 1 } } },
    { &#34;input&#34;: [&#34;a&#34;, &#34;b&#34;, &#34;a&#34;, &#34;c&#34;, &#34;b&#34;, &#34;d&#34;, &#34;c&#34;, &#34;e&#34;, &#34;d&#34;], &#34;output&#34;: { &#34;removeDuplicatedValues&#34;: [&#34;a&#34;, &#34;b&#34;, &#34;c&#34;, &#34;d&#34;, &#34;e&#34;], &#34;duplicatedValues&#34;: [&#34;a&#34;, &#34;b&#34;, &#34;c&#34;, &#34;d&#34;], &#34;numberOfDuplicate&#34;: { &#34;a&#34;: 2, &#34;b&#34;: 2, &#34;c&#34;: 2, &#34;d&#34;: 2, &#34;e&#34;: 1 } } },
    { &#34;input&#34;: [1, &#34;a&#34;, 2, &#34;b&#34;, 1, &#34;c&#34;, 2, &#34;d&#34;, 1, &#34;e&#34;], &#34;output&#34;: { &#34;removeDuplicatedValues&#34;: [1, &#34;a&#34;, 2, &#34;b&#34;, &#34;c&#34;, &#34;d&#34;, &#34;e&#34;], &#34;duplicatedValues&#34;: [1, 2], &#34;numberOfDuplicate&#34;: { &#34;1&#34;: 3, &#34;2&#34;: 2, &#34;a&#34;: 1, &#34;b&#34;: 1, &#34;c&#34;: 1, &#34;d&#34;: 1, &#34;e&#34;: 1 } } }
  ],

  &#34;compilingNumbers&#34;: [
    { &#34;input&#34;: [1, 2, 3, 4, 5], &#34;output&#34;: [{ &#34;start&#34;: 1, &#34;end&#34;: 5 }] },
    { &#34;input&#34;: [1, 3, 5, 7, 9, 11, 13], &#34;output&#34;: [{ &#34;start&#34;: 1, &#34;end&#34;: 1 }, { &#34;start&#34;: 3, &#34;end&#34;: 3 }, { &#34;start&#34;: 5, &#34;end&#34;: 5 }, { &#34;start&#34;: 7, &#34;end&#34;: 7 }, { &#34;start&#34;: 9, &#34;end&#34;: 9 }, { &#34;start&#34;: 11, &#34;end&#34;: 11 }, { &#34;start&#34;: 13, &#34;end&#34;: 13 }] },
    { &#34;input&#34;: [1, 3, 5, 7, 8, 10, 12, 13], &#34;output&#34;: [{ &#34;start&#34;: 1, &#34;end&#34;: 1 }, { &#34;start&#34;: 3, &#34;end&#34;: 3 }, { &#34;start&#34;: 5, &#34;end&#34;: 5 }, { &#34;start&#34;: 7, &#34;end&#34;: 8 }, { &#34;start&#34;: 10, &#34;end&#34;: 10 }, { &#34;start&#34;: 12, &#34;end&#34;: 13 }] },
    { &#34;input&#34;: [1, 2, 4, 5, 7, 8, 10, 11, 13, 14], &#34;output&#34;: [{ &#34;start&#34;: 1, &#34;end&#34;: 2 }, { &#34;start&#34;: 4, &#34;end&#34;: 5 }, { &#34;start&#34;: 7, &#34;end&#34;: 8 }, { &#34;start&#34;: 10, &#34;end&#34;: 11 }, { &#34;start&#34;: 13, &#34;end&#34;: 14 }] },
    { &#34;input&#34;: [1, 2, 3, 5, 6, 8, 9, 11, 12, 14, 15], &#34;output&#34;: [{ &#34;start&#34;: 1, &#34;end&#34;: 3 }, { &#34;start&#34;: 5, &#34;end&#34;: 6 }, { &#34;start&#34;: 8, &#34;end&#34;: 9 }, { &#34;start&#34;: 11, &#34;end&#34;: 12 }, { &#34;start&#34;: 14, &#34;end&#34;: 15 }] }
  ],

  &#34;unpivot&#34;: [
    { &#34;input&#34;: [[&#34;name&#34;, &#34;score1&#34;, &#34;score2&#34;], [&#34;sample1&#34;, 100, 80], [&#34;sample2&#34;, 90, 70]], &#34;output&#34;: [[&#34;score1&#34;, &#34;sample1&#34;, 100], [&#34;score1&#34;, &#34;sample2&#34;, 90], [&#34;score2&#34;, &#34;sample1&#34;, 80], [&#34;score2&#34;, &#34;sample2&#34;, 70]] },
    { &#34;input&#34;: [[&#34;name&#34;, &#34;score1&#34;, &#34;score2&#34;, &#34;score3&#34;], [&#34;sample1&#34;, 100, 80, 70], [&#34;sample2&#34;, 90, 70, 80]], &#34;output&#34;: [[&#34;score1&#34;, &#34;sample1&#34;, 100], [&#34;score1&#34;, &#34;sample2&#34;, 90], [&#34;score2&#34;, &#34;sample1&#34;, 80], [&#34;score2&#34;, &#34;sample2&#34;, 70], [&#34;score3&#34;, &#34;sample1&#34;, 70], [&#34;score3&#34;, &#34;sample2&#34;, 80]] },
    { &#34;input&#34;: [[&#34;id&#34;, &#34;x&#34;, &#34;y&#34;, &#34;z&#34;], [&#34;a&#34;, 1, 2, 3], [&#34;b&#34;, 4, 5, 6]], &#34;output&#34;: [[&#34;x&#34;, &#34;a&#34;, 1], [&#34;x&#34;, &#34;b&#34;, 4], [&#34;y&#34;, &#34;a&#34;, 2], [&#34;y&#34;, &#34;b&#34;, 5], [&#34;z&#34;, &#34;a&#34;, 3], [&#34;z&#34;, &#34;b&#34;, 6]] },
    { &#34;input&#34;: [[&#34;id&#34;, &#34;x&#34;, &#34;y&#34;, &#34;z&#34;, &#34;xx&#34;, &#34;yy&#34;, &#34;zz&#34;], [&#34;a&#34;, 1, 2, 3, 10, 20, 30], [&#34;b&#34;, 4, 5, 6, 40, 50, 60]], &#34;output&#34;: [[&#34;x&#34;, &#34;a&#34;, 1], [&#34;x&#34;, &#34;b&#34;, 4], [&#34;y&#34;, &#34;a&#34;, 2], [&#34;y&#34;, &#34;b&#34;, 5], [&#34;z&#34;, &#34;a&#34;, 3], [&#34;z&#34;, &#34;b&#34;, 6], [&#34;xx&#34;, &#34;a&#34;, 10], [&#34;xx&#34;, &#34;b&#34;, 40], [&#34;yy&#34;, &#34;a&#34;, 20], [&#34;yy&#34;, &#34;b&#34;, 50], [&#34;zz&#34;, &#34;a&#34;, 30], [&#34;zz&#34;, &#34;b&#34;, 60]] },
    { &#34;input&#34;: [[&#34;Fruit&#34;, &#34;2021&#34;, &#34;2022&#34;, &#34;2023&#34;], [&#34;apple&#34;, 100, 120, 150], [&#34;orange&#34;, 80, 90, 100]], &#34;output&#34;: [[&#34;2021&#34;, &#34;apple&#34;, 100], [&#34;2021&#34;, &#34;orange&#34;, 80], [&#34;2022&#34;, &#34;apple&#34;, 120], [&#34;2022&#34;, &#34;orange&#34;, 90], [&#34;2023&#34;, &#34;apple&#34;, 150], [&#34;2023&#34;, &#34;orange&#34;, 100]] }
  ],

  &#34;expandA1Notations&#34;: [
    { &#34;input&#34;: [&#34;A1:B5&#34;, &#34;C3:D7&#34;, &#34;E2:F10&#34;], &#34;output&#34;: [[&#34;A1&#34;, &#34;B1&#34;, &#34;A2&#34;, &#34;B2&#34;, &#34;A3&#34;, &#34;B3&#34;, &#34;A4&#34;, &#34;B4&#34;, &#34;A5&#34;, &#34;B5&#34;], [&#34;C3&#34;, &#34;D3&#34;, &#34;C4&#34;, &#34;D4&#34;, &#34;C5&#34;, &#34;D5&#34;, &#34;C6&#34;, &#34;D6&#34;, &#34;C7&#34;, &#34;D7&#34;], [&#34;E2&#34;, &#34;F2&#34;, &#34;E3&#34;, &#34;F3&#34;, &#34;E4&#34;, &#34;F4&#34;, &#34;E5&#34;, &#34;F5&#34;, &#34;E6&#34;, &#34;F6&#34;, &#34;E7&#34;, &#34;F7&#34;, &#34;E8&#34;, &#34;F8&#34;, &#34;E9&#34;, &#34;F9&#34;, &#34;E10&#34;, &#34;F10&#34;]] },
    { &#34;input&#34;: [&#34;A:B&#34;, &#34;C:D&#34;, &#34;E:F&#34;], &#34;output&#34;: [[&#34;A1&#34;, &#34;B1&#34;, &#34;A2&#34;, &#34;B2&#34;, &#34;A3&#34;, &#34;B3&#34;, &#34;A4&#34;, &#34;B4&#34;, &#34;A5&#34;, &#34;B5&#34;, &#34;A6&#34;, &#34;B6&#34;, &#34;A7&#34;, &#34;B7&#34;, &#34;A8&#34;, &#34;B8&#34;, &#34;A9&#34;, &#34;B9&#34;, &#34;A10&#34;, &#34;B10&#34;], [&#34;C1&#34;, &#34;D1&#34;, &#34;C2&#34;, &#34;D2&#34;, &#34;C3&#34;, &#34;D3&#34;, &#34;C4&#34;, &#34;D4&#34;, &#34;C5&#34;, &#34;D5&#34;, &#34;C6&#34;, &#34;D6&#34;, &#34;C7&#34;, &#34;D7&#34;, &#34;C8&#34;, &#34;D8&#34;, &#34;C9&#34;, &#34;D9&#34;, &#34;C10&#34;, &#34;D10&#34;], [&#34;E1&#34;, &#34;F1&#34;, &#34;E2&#34;, &#34;F2&#34;, &#34;E3&#34;, &#34;F3&#34;, &#34;E4&#34;, &#34;F4&#34;, &#34;E5&#34;, &#34;F5&#34;, &#34;E6&#34;, &#34;F6&#34;, &#34;E7&#34;, &#34;F7&#34;, &#34;E8&#34;, &#34;F8&#34;, &#34;E9&#34;, &#34;F9&#34;, &#34;E10&#34;, &#34;F10&#34;]] },
    { &#34;input&#34;: [&#34;A1:C5&#34;], &#34;output&#34;: [[&#34;A1&#34;, &#34;B1&#34;, &#34;C1&#34;, &#34;A2&#34;, &#34;B2&#34;, &#34;C2&#34;, &#34;A3&#34;, &#34;B3&#34;, &#34;C3&#34;, &#34;A4&#34;, &#34;B4&#34;, &#34;C4&#34;, &#34;A5&#34;, &#34;B5&#34;, &#34;C5&#34;]] },
    { &#34;input&#34;: [&#34;A:C&#34;], &#34;output&#34;: [[&#34;A1&#34;, &#34;B1&#34;, &#34;C1&#34;, &#34;A2&#34;, &#34;B2&#34;, &#34;C2&#34;, &#34;A3&#34;, &#34;B3&#34;, &#34;C3&#34;, &#34;A4&#34;, &#34;B4&#34;, &#34;C4&#34;, &#34;A5&#34;, &#34;B5&#34;, &#34;C5&#34;, &#34;A6&#34;, &#34;B6&#34;, &#34;C6&#34;, &#34;A7&#34;, &#34;B7&#34;, &#34;C7&#34;, &#34;A8&#34;, &#34;B8&#34;, &#34;C8&#34;, &#34;A9&#34;, &#34;B9&#34;, &#34;C9&#34;, &#34;A10&#34;, &#34;B10&#34;, &#34;C10&#34;]] },
    { &#34;input&#34;: [&#34;1:5&#34;, &#34;3:7&#34;, &#34;2:10&#34;], &#34;output&#34;: [[&#34;A1&#34;, &#34;B1&#34;, &#34;C1&#34;, &#34;D1&#34;, &#34;E1&#34;, &#34;F1&#34;, &#34;G1&#34;, &#34;H1&#34;, &#34;I1&#34;, &#34;J1&#34;, &#34;K1&#34;, &#34;L1&#34;, &#34;M1&#34;, &#34;N1&#34;, &#34;O1&#34;, &#34;P1&#34;, &#34;Q1&#34;, &#34;R1&#34;, &#34;S1&#34;, &#34;T1&#34;, &#34;U1&#34;, &#34;V1&#34;, &#34;W1&#34;, &#34;X1&#34;, &#34;Y1&#34;, &#34;Z1&#34;, &#34;A2&#34;, &#34;B2&#34;, &#34;C2&#34;, &#34;D2&#34;, &#34;E2&#34;, &#34;F2&#34;, &#34;G2&#34;, &#34;H2&#34;, &#34;I2&#34;, &#34;J2&#34;, &#34;K2&#34;, &#34;L2&#34;, &#34;M2&#34;, &#34;N2&#34;, &#34;O2&#34;, &#34;P2&#34;, &#34;Q2&#34;, &#34;R2&#34;, &#34;S2&#34;, &#34;T2&#34;, &#34;U2&#34;, &#34;V2&#34;, &#34;W2&#34;, &#34;X2&#34;, &#34;Y2&#34;, &#34;Z2&#34;, &#34;A3&#34;, &#34;B3&#34;, &#34;C3&#34;, &#34;D3&#34;, &#34;E3&#34;, &#34;F3&#34;, &#34;G3&#34;, &#34;H3&#34;, &#34;I3&#34;, &#34;J3&#34;, &#34;K3&#34;, &#34;L3&#34;, &#34;M3&#34;, &#34;N3&#34;, &#34;O3&#34;, &#34;P3&#34;, &#34;Q3&#34;, &#34;R3&#34;, &#34;S3&#34;, &#34;T3&#34;, &#34;U3&#34;, &#34;V3&#34;, &#34;W3&#34;, &#34;X3&#34;, &#34;Y3&#34;, &#34;Z3&#34;, &#34;A4&#34;, &#34;B4&#34;, &#34;C4&#34;, &#34;D4&#34;, &#34;E4&#34;, &#34;F4&#34;, &#34;G4&#34;, &#34;H4&#34;, &#34;I4&#34;, &#34;J4&#34;, &#34;K4&#34;, &#34;L4&#34;, &#34;M4&#34;, &#34;N4&#34;, &#34;O4&#34;, &#34;P4&#34;, &#34;Q4&#34;, &#34;R4&#34;, &#34;S4&#34;, &#34;T4&#34;, &#34;U4&#34;, &#34;V4&#34;, &#34;W4&#34;, &#34;X4&#34;, &#34;Y4&#34;, &#34;Z4&#34;, &#34;A5&#34;, &#34;B5&#34;, &#34;C5&#34;, &#34;D5&#34;, &#34;E5&#34;, &#34;F5&#34;, &#34;G5&#34;, &#34;H5&#34;, &#34;I5&#34;, &#34;J5&#34;, &#34;K5&#34;, &#34;L5&#34;, &#34;M5&#34;, &#34;N5&#34;, &#34;O5&#34;, &#34;P5&#34;, &#34;Q5&#34;, &#34;R5&#34;, &#34;S5&#34;, &#34;T5&#34;, &#34;U5&#34;, &#34;V5&#34;, &#34;W5&#34;, &#34;X5&#34;, &#34;Y5&#34;, &#34;Z5&#34;], [&#34;A3&#34;, &#34;B3&#34;, &#34;C3&#34;, &#34;D3&#34;, &#34;E3&#34;, &#34;F3&#34;, &#34;G3&#34;, &#34;H3&#34;, &#34;I3&#34;, &#34;J3&#34;, &#34;K3&#34;, &#34;L3&#34;, &#34;M3&#34;, &#34;N3&#34;, &#34;O3&#34;, &#34;P3&#34;, &#34;Q3&#34;, &#34;R3&#34;, &#34;S3&#34;, &#34;T3&#34;, &#34;U3&#34;, &#34;V3&#34;, &#34;W3&#34;, &#34;X3&#34;, &#34;Y3&#34;, &#34;Z3&#34;, &#34;A4&#34;, &#34;B4&#34;, &#34;C4&#34;, &#34;D4&#34;, &#34;E4&#34;, &#34;F4&#34;, &#34;G4&#34;, &#34;H4&#34;, &#34;I4&#34;, &#34;J4&#34;, &#34;K4&#34;, &#34;L4&#34;, &#34;M4&#34;, &#34;N4&#34;, &#34;O4&#34;, &#34;P4&#34;, &#34;Q4&#34;, &#34;R4&#34;, &#34;S4&#34;, &#34;T4&#34;, &#34;U4&#34;, &#34;V4&#34;, &#34;W4&#34;, &#34;X4&#34;, &#34;Y4&#34;, &#34;Z4&#34;, &#34;A5&#34;, &#34;B5&#34;, &#34;C5&#34;, &#34;D5&#34;, &#34;E5&#34;, &#34;F5&#34;, &#34;G5&#34;, &#34;H5&#34;, &#34;I5&#34;, &#34;J5&#34;, &#34;K5&#34;, &#34;L5&#34;, &#34;M5&#34;, &#34;N5&#34;, &#34;O5&#34;, &#34;P5&#34;, &#34;Q5&#34;, &#34;R5&#34;, &#34;S5&#34;, &#34;T5&#34;, &#34;U5&#34;, &#34;V5&#34;, &#34;W5&#34;, &#34;X5&#34;, &#34;Y5&#34;, &#34;Z5&#34;, &#34;A6&#34;, &#34;B6&#34;, &#34;C6&#34;, &#34;D6&#34;, &#34;E6&#34;, &#34;F6&#34;, &#34;G6&#34;, &#34;H6&#34;, &#34;I6&#34;, &#34;J6&#34;, &#34;K6&#34;, &#34;L6&#34;, &#34;M6&#34;, &#34;N6&#34;, &#34;O6&#34;, &#34;P6&#34;, &#34;Q6&#34;, &#34;R6&#34;, &#34;S6&#34;, &#34;T6&#34;, &#34;U6&#34;, &#34;V6&#34;, &#34;W6&#34;, &#34;X6&#34;, &#34;Y6&#34;, &#34;Z6&#34;, &#34;A7&#34;, &#34;B7&#34;, &#34;C7&#34;, &#34;D7&#34;, &#34;E7&#34;, &#34;F7&#34;, &#34;G7&#34;, &#34;H7&#34;, &#34;I7&#34;, &#34;J7&#34;, &#34;K7&#34;, &#34;L7&#34;, &#34;M7&#34;, &#34;N7&#34;, &#34;O7&#34;, &#34;P7&#34;, &#34;Q7&#34;, &#34;R7&#34;, &#34;S7&#34;, &#34;T7&#34;, &#34;U7&#34;, &#34;V7&#34;, &#34;W7&#34;, &#34;X7&#34;, &#34;Y7&#34;, &#34;Z7&#34;], [&#34;A2&#34;, &#34;B2&#34;, &#34;C2&#34;, &#34;D2&#34;, &#34;E2&#34;, &#34;F2&#34;, &#34;G2&#34;, &#34;H2&#34;, &#34;I2&#34;, &#34;J2&#34;, &#34;K2&#34;, &#34;L2&#34;, &#34;M2&#34;, &#34;N2&#34;, &#34;O2&#34;, &#34;P2&#34;, &#34;Q2&#34;, &#34;R2&#34;, &#34;S2&#34;, &#34;T2&#34;, &#34;U2&#34;, &#34;V2&#34;, &#34;W2&#34;, &#34;X2&#34;, &#34;Y2&#34;, &#34;Z2&#34;, &#34;A3&#34;, &#34;B3&#34;, &#34;C3&#34;, &#34;D3&#34;, &#34;E3&#34;, &#34;F3&#34;, &#34;G3&#34;, &#34;H3&#34;, &#34;I3&#34;, &#34;J3&#34;, &#34;K3&#34;, &#34;L3&#34;, &#34;M3&#34;, &#34;N3&#34;, &#34;O3&#34;, &#34;P3&#34;, &#34;Q3&#34;, &#34;R3&#34;, &#34;S3&#34;, &#34;T3&#34;, &#34;U3&#34;, &#34;V3&#34;, &#34;W3&#34;, &#34;X3&#34;, &#34;Y3&#34;, &#34;Z3&#34;, &#34;A4&#34;, &#34;B4&#34;, &#34;C4&#34;, &#34;D4&#34;, &#34;E4&#34;, &#34;F4&#34;, &#34;G4&#34;, &#34;H4&#34;, &#34;I4&#34;, &#34;J4&#34;, &#34;K4&#34;, &#34;L4&#34;, &#34;M4&#34;, &#34;N4&#34;, &#34;O4&#34;, &#34;P4&#34;, &#34;Q4&#34;, &#34;R4&#34;, &#34;S4&#34;, &#34;T4&#34;, &#34;U4&#34;, &#34;V4&#34;, &#34;W4&#34;, &#34;X4&#34;, &#34;Y4&#34;, &#34;Z4&#34;, &#34;A5&#34;, &#34;B5&#34;, &#34;C5&#34;, &#34;D5&#34;, &#34;E5&#34;, &#34;F5&#34;, &#34;G5&#34;, &#34;H5&#34;, &#34;I5&#34;, &#34;J5&#34;, &#34;K5&#34;, &#34;L5&#34;, &#34;M5&#34;, &#34;N5&#34;, &#34;O5&#34;, &#34;P5&#34;, &#34;Q5&#34;, &#34;R5&#34;, &#34;S5&#34;, &#34;T5&#34;, &#34;U5&#34;, &#34;V5&#34;, &#34;W5&#34;, &#34;X5&#34;, &#34;Y5&#34;, &#34;Z5&#34;, &#34;A6&#34;, &#34;B6&#34;, &#34;C6&#34;, &#34;D6&#34;, &#34;E6&#34;, &#34;F6&#34;, &#34;G6&#34;, &#34;H6&#34;, &#34;I6&#34;, &#34;J6&#34;, &#34;K6&#34;, &#34;L6&#34;, &#34;M6&#34;, &#34;N6&#34;, &#34;O6&#34;, &#34;P6&#34;, &#34;Q6&#34;, &#34;R6&#34;, &#34;S6&#34;, &#34;T6&#34;, &#34;U6&#34;, &#34;V6&#34;, &#34;W6&#34;, &#34;X6&#34;, &#34;Y6&#34;, &#34;Z6&#34;, &#34;A7&#34;, &#34;B7&#34;, &#34;C7&#34;, &#34;D7&#34;, &#34;E7&#34;, &#34;F7&#34;, &#34;G7&#34;, &#34;H7&#34;, &#34;I7&#34;, &#34;J7&#34;, &#34;K7&#34;, &#34;L7&#34;, &#34;M7&#34;, &#34;N7&#34;, &#34;O7&#34;, &#34;P7&#34;, &#34;Q7&#34;, &#34;R7&#34;, &#34;S7&#34;, &#34;T7&#34;, &#34;U7&#34;, &#34;V7&#34;, &#34;W7&#34;, &#34;X7&#34;, &#34;Y7&#34;, &#34;Z7&#34;, &#34;A8&#34;, &#34;B8&#34;, &#34;C8&#34;, &#34;D8&#34;, &#34;E8&#34;, &#34;F8&#34;, &#34;G8&#34;, &#34;H8&#34;, &#34;I8&#34;, &#34;J8&#34;, &#34;K8&#34;, &#34;L8&#34;, &#34;M8&#34;, &#34;N8&#34;, &#34;O8&#34;, &#34;P8&#34;, &#34;Q8&#34;, &#34;R8&#34;, &#34;S8&#34;, &#34;T8&#34;, &#34;U8&#34;, &#34;V8&#34;, &#34;W8&#34;, &#34;X8&#34;, &#34;Y8&#34;, &#34;Z8&#34;, &#34;A9&#34;, &#34;B9&#34;, &#34;C9&#34;, &#34;D9&#34;, &#34;E9&#34;, &#34;F9&#34;, &#34;G9&#34;, &#34;H9&#34;, &#34;I9&#34;, &#34;J9&#34;, &#34;K9&#34;, &#34;L9&#34;, &#34;M9&#34;, &#34;N9&#34;, &#34;O9&#34;, &#34;P9&#34;, &#34;Q9&#34;, &#34;R9&#34;, &#34;S9&#34;, &#34;T9&#34;, &#34;U9&#34;, &#34;V9&#34;, &#34;W9&#34;, &#34;X9&#34;, &#34;Y9&#34;, &#34;Z9&#34;, &#34;A10&#34;, &#34;B10&#34;, &#34;C10&#34;, &#34;D10&#34;, &#34;E10&#34;, &#34;F10&#34;, &#34;G10&#34;, &#34;H10&#34;, &#34;I10&#34;, &#34;J10&#34;, &#34;K10&#34;, &#34;L10&#34;, &#34;M10&#34;, &#34;N10&#34;, &#34;O10&#34;, &#34;P10&#34;, &#34;Q10&#34;, &#34;R10&#34;, &#34;S10&#34;, &#34;T10&#34;, &#34;U10&#34;, &#34;V10&#34;, &#34;W10&#34;, &#34;X10&#34;, &#34;Y10&#34;, &#34;Z10&#34;]] }
  ]
}
</code></pre><h2 id="5-sample-script-2">5. Sample script 2</h2>
<p>Each function of the above sample script uses only one argument. When multiple arguments are used, the script is as follows. The sample function is as follows.</p>
<ul>
<li><a href="https://github.com/tanaikech/UtlApp?tab=readme-ov-file#splitarray">splitArray</a>: Split array every n length.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set your API key.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">functionObj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">splitArray</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">splitArray</span>(<span style="color:#a6e22e">array</span>, <span style="color:#a6e22e">size</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * Split array every n length.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @param {Array} array 2 dimensional array.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @param {Boolean} check Check whether the inputted array is 2 dimensional array. Default is true.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       * @return {Array} Transposed array.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">splitArray</span>(<span style="color:#a6e22e">array</span>, <span style="color:#a6e22e">size</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">array</span> <span style="color:#f92672">||</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">size</span> <span style="color:#f92672">||</span> <span style="color:#f92672">!</span>Array.<span style="color:#a6e22e">isArray</span>(<span style="color:#a6e22e">array</span>)) {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Please give an array and split size.&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> [...Array(Math.<span style="color:#a6e22e">ceil</span>(<span style="color:#a6e22e">array</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">/</span> <span style="color:#a6e22e">size</span>))].<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">_</span>) =&gt;
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">array</span>.<span style="color:#a6e22e">splice</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">size</span>)
</span></span><span style="display:flex;"><span>        );
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">splitArray</span>(<span style="color:#a6e22e">array</span>, <span style="color:#a6e22e">size</span>);
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">g</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">GeminiWithFiles</span>.<span style="color:#a6e22e">geminiWithFiles</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">apiKey</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">response_mime_type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">doCountToken</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">functions</span> <span style="color:#f92672">=</span> Object.<span style="color:#a6e22e">entries</span>(<span style="color:#a6e22e">functionObj</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">map</span>(
</span></span><span style="display:flex;"><span>      ([<span style="color:#a6e22e">k</span>, <span style="color:#a6e22e">v</span>]) =&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`&lt;FunctionName&gt;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">k</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;/FunctionName&gt;&lt;Function&gt;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">toString</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;/Function&gt;`</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">jsonSchema</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;5 input values for giving each function&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Proposal 5 input values for giving each function. </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">functions</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> Don&#39;t propose &#34;empty&#34;, &#34;null&#34;, &#34;undefined&#34; as values.`</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;array&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">items</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;object&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">properties</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">functionName</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Function name&#34;</span>, <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">inputValues</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Proposed 5 input values. Don&#39;t propose &#34;empty&#34;, &#34;null&#34;, &#34;undefined&#34; as values.`</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;array&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">items</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Proposed input value&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;array|object|string|number&#34;</span>,
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">additionalProperties</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">g</span>.<span style="color:#a6e22e">generateContent</span>({ <span style="color:#a6e22e">jsonSchema</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;string&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">res</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> ({ <span style="color:#a6e22e">stack</span> }) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">stack</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">o</span>, { <span style="color:#a6e22e">functionName</span>, <span style="color:#a6e22e">inputValues</span> }) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">o</span>[<span style="color:#a6e22e">functionName</span>] <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">inputValues</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">input</span>) =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">input</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">output</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">functionObj</span>[<span style="color:#a6e22e">functionName</span>](...<span style="color:#a6e22e">temp</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">o</span>[<span style="color:#a6e22e">functionName</span>].<span style="color:#a6e22e">push</span>({ <span style="color:#a6e22e">input</span>, <span style="color:#a6e22e">output</span> });
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> ({ <span style="color:#a6e22e">stack</span> }) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">stack</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">o</span>;
</span></span><span style="display:flex;"><span>  }, {});
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">result</span>));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When this script is run, the following result is obtained.</p>
<pre tabindex="0"><code>{
  &#34;splitArray&#34;: [
    { &#34;input&#34;: [[1, 2, 3, 4, 5, 6], 2], &#34;output&#34;: [[1, 2], [3, 4], [5, 6]] },
    { &#34;input&#34;: [[&#34;a&#34;, &#34;b&#34;, &#34;c&#34;, &#34;d&#34;, &#34;e&#34;], 2], &#34;output&#34;: [[&#34;a&#34;, &#34;b&#34;], [&#34;c&#34;, &#34;d&#34;], [&#34;e&#34;]] },
    { &#34;input&#34;: [[&#34;apple&#34;, &#34;orange&#34;, &#34;grape&#34;, &#34;banana&#34;, &#34;kiwi&#34;], 3], &#34;output&#34;: [[&#34;apple&#34;, &#34;orange&#34;, &#34;grape&#34;], [&#34;banana&#34;, &#34;kiwi&#34;]] },
    { &#34;input&#34;: [[true, false, true, false, true], 1], &#34;output&#34;: [[true], [false], [true], [false], [true]] },
    { &#34;input&#34;: [[1.2, 3.14, 2.71, 0.577], 2], &#34;output&#34;: [[1.2, 3.14], [2.71, 0.577]] }
  ]
}
</code></pre><h1 id="summary">Summary</h1>
<p>From the above result, we can confirm the possibility of reverse engineering using Gemini API. This also shows that Gemini API can be used to develop applications.</p>
<h1 id="note">Note</h1>
<ul>
<li>If an error occurs, please run the script again. Or, please adjust the description in the JSON schema.</li>
<li>I believe that this approach will be able to be also used for other languages except for Google Apps Script.</li>
<li>In the current stage, it seems that the class objects depending on Google Apps Script like SpreadsheetApp, DriveApp, and so on cannot be used as the input values.</li>
<li>The top abstract image was created by <a href="https://gemini.google.com/app">Gemini</a>.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f08%2fleveraging-gemini-1.5-api-for-automated-test-case-generation-in-google-apps-script-reverse-engineering%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f08%2fleveraging-gemini-1.5-api-for-automated-test-case-generation-in-google-apps-script-reverse-engineering%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f08%2fleveraging-gemini-1.5-api-for-automated-test-case-generation-in-google-apps-script-reverse-engineering%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f08%2fleveraging-gemini-1.5-api-for-automated-test-case-generation-in-google-apps-script-reverse-engineering%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f08%2fleveraging-gemini-1.5-api-for-automated-test-case-generation-in-google-apps-script-reverse-engineering%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f08%2fleveraging-gemini-1.5-api-for-automated-test-case-generation-in-google-apps-script-reverse-engineering%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2024/05/07/gemini-api-with-json-schema/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2024/05/07/gemini-api-with-json-schema/">Gemini API with JSON schema</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2024/05/15/adding-page-numbers-to-pdf-using-google-apps-script/">Adding Page Numbers to PDF using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2024/05/15/adding-page-numbers-to-pdf-using-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

