<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Checking API Enabled with Advanced Google Services using Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>X</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Checking API Enabled with Advanced Google Services using Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>16 May 2024, 10:52</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-api">google api</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/3f03dac24179f750c013abc39703c4d2">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20240516a/fig1.jpg" alt=""></p>
<h1 id="overview">Overview</h1>
<p>This script checks if the desired API is enabled or disabled in the Advanced Google Services section of Google Apps Script.</p>
<h1 id="introduction">Introduction</h1>
<p>As of December 11, 2023, Drive API v3 became available for use in Advanced Google Services. <a href="https://developers.google.com/apps-script/docs/release-notes#December_11_2023">Ref</a> This means you can now choose between v2 and v3 in your scripts. However, when Drive API is enabled, version 3 is automatically selected. This caused compatibility issues with previously published libraries that relied on v2.</p>
<p>To address this issue and ensure compatibility, I&rsquo;ve created a sample Google Apps Script to check the enabled Drive API version in Advanced Google Services. Also, the script can use all APIs of Advanced Google services. So, you can check if the desired API is enabled or disabled in the Advanced Google Services section of Google Apps Script. I will be including this script in my future library updates.</p>
<h1 id="main-script">Main script</h1>
<p>This is the main script. This function returns an object with &ldquo;api&rdquo; and &ldquo;version&rdquo; properties by taking the API name as input, such as &ldquo;Drive&rdquo; or &ldquo;Sheet&rdquo;.</p>
<p>When &ldquo;api&rdquo; is set to &ldquo;disable&rdquo; for a given API name (e.g., &ldquo;Drive&rdquo;), it indicates that the Drive API has not been enabled. Conversely, if &ldquo;api&rdquo; is set to &ldquo;enable&rdquo; (again, for a specific API name like &ldquo;Drive&rdquo;), it indicates that the Drive API has already been enabled. In this case, the API version can be found in the &ldquo;version&rdquo; property.</p>
<p>Important: This script does not use any scopes. This allows you to confirm API enablement without requiring any permissions.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Check whether Drive API is enabled at Advanced Google services, and return it as true or false and the version.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param {String} apiName API name you want to check.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @returns {Object} Object including &#34;api&#34; and &#34;version&#34; properties.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">isAPIAtAdvancedGoogleServices_</span>(<span style="color:#a6e22e">apiName</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">apiName</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">apiName</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">||</span> <span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">apiName</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;string&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Please set a valid API name.&#34;</span>);
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#e6db74">/^[A-Z]+$/g</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">apiName</span>[<span style="color:#ae81ff">0</span>])) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">t</span>, ...<span style="color:#a6e22e">b</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">apiName</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">apiName</span> <span style="color:#f92672">=</span> [<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">toUpperCase</span>(), ...<span style="color:#a6e22e">b</span>].<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">apiName</span>, <span style="color:#a6e22e">api</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;disable&#34;</span> };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">typeof</span> <span style="color:#66d9ef">this</span>[<span style="color:#a6e22e">apiName</span>] <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#34;undefined&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">api</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;enable&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">version</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>[<span style="color:#a6e22e">apiName</span>].<span style="color:#a6e22e">getVersion</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">obj</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="testing">Testing</h2>
<p>When you test this script, please do the following steps.</p>
<h3 id="1-create-a-google-apps-script-project">1. Create a Google Apps Script project</h3>
<p>Please create a Google Apps Script project. You can use both the standalone script and the container-bound script.</p>
<h3 id="2-sample-script">2. Sample script</h3>
<p>Please copy and paste both the above <code>isAPIAtAdvancedGoogleServices_</code> function and the following function.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">isAPIAtAdvancedGoogleServices_</span>(<span style="color:#e6db74">&#34;Drive&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">isAPIAtAdvancedGoogleServices_</span>(<span style="color:#e6db74">&#34;Sheets&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res1</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res2</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When the function <code>sample</code> is run, <code>res1</code> and <code>res2</code> show <code>{ apiName: 'Drive', api: 'disable' }</code> and <code>{ apiName: 'Sheets', api: 'disable' }</code>, respectively. Because Drive API and Sheets API have not been enabled.</p>
<h3 id="3-enable-drive-api">3. Enable Drive API</h3>
<p>Please enable Drive API at Advanced Google services. <a href="https://developers.google.com/apps-script/guides/services/advanced#enable_advanced_services">Ref</a></p>
<p>Under this condition, when the function <code>sample</code> is run, <code>res1</code> and <code>res2</code> show <code>{ apiName: 'Drive', api: 'enable', version: 'v3' }</code> and <code>{ apiName: 'Sheets', api: 'disable' }</code>, respectively.</p>
<p>From this result, you can confirm that Drive API v3 is enabled. In the current stage, when Drive API is enabled, version 3 is automatically selected.</p>
<h3 id="4-enable-sheets-api">4. Enable Sheets API</h3>
<p>Please enable Sheet API at Advanced Google services. <a href="https://developers.google.com/apps-script/guides/services/advanced#enable_advanced_services">Ref</a></p>
<p>Under this condition, when the function <code>sample</code> is run, <code>res1</code> and <code>res2</code> show <code>{ apiName: 'Drive', api: 'enable', version: 'v3' }</code> and <code>{ apiName: 'Sheets', api: 'enable', version: 'v4' }</code>, respectively.</p>
<p>From this result, you can confirm that both Drive API v3 and Sheets API v4 are enabled.</p>
<h1 id="applying-to-google-apps-script-library">Applying to Google Apps Script Library</h1>
<p>This document describes a scenario to illustrate how Google Apps Script library dependencies work.</p>
<h2 id="1-create-two-standalone-google-apps-script-projects">1. Create two standalone Google Apps Script projects:</h2>
<ul>
<li>A library script named &ldquo;lib&rdquo;.</li>
<li>A client script.</li>
</ul>
<h2 id="2-library-script">2. Library Script:</h2>
<p>Copy and paste the following script into the library. This script uses the Drive API v2.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">insert</span>({ <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample&#34;</span> });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And, deploy this script as a library.</p>
<h2 id="3-client-script-and-error">3. Client Script and Error:</h2>
<p>Copy and paste the following script into the client. This script uses the Drive API v2.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lib</span>.<span style="color:#a6e22e">sample</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Running this script initially will result in a <code>ReferenceError: DriveApp is not defined</code> because the Drive API is not enabled for the client script.</p>
<h2 id="4-enable-drive-api-v3-in-client-script">4. Enable Drive API (v3) in Client Script:</h2>
<p>Enable the Drive API in the client script&rsquo;s &ldquo;Advanced Google services&rdquo; settings. However, this will likely set the version to v3 by default. Running <code>myFunction</code> again will likely cause a <code>TypeError: DriveApp.getFiles().create is not a function</code> because the library script uses DriveApp (v2) and the client script has v3 enabled.</p>
<h2 id="5-enable-drive-api-v2-in-library-script">5. Enable Drive API (v2) in Library Script:</h2>
<p>Enable Drive API v2 in the library script&rsquo;s &ldquo;Advanced Google services&rdquo; settings.</p>
<h2 id="6-run-myfunction-again">6. Run myFunction Again:</h2>
<p>Now, running <code>myFunction</code> in the client script should work without errors. This is because the library script uses Drive API v2, which is now enabled for the library project.</p>
<h2 id="7-applying-this-method-in-this-report">7. Applying this method in this report</h2>
<p>Here, in order to test this method, please disable Drive API at both the client script and the library script. And, replace the script in the library script as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Check whether Drive API is enabled at Advanced Google services, and return it as true or false and the version.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param {String} apiName API name you want to check.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @returns {Object} Object including &#34;api&#34; and &#34;version&#34; properties.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">isAPIAtAdvancedGoogleServices_</span>(<span style="color:#a6e22e">apiName</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">apiName</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">apiName</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">||</span> <span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">apiName</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;string&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Please set a valid API name.&#34;</span>);
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#e6db74">/^[A-Z]+$/g</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">apiName</span>[<span style="color:#ae81ff">0</span>])) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">t</span>, ...<span style="color:#a6e22e">b</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">apiName</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">apiName</span> <span style="color:#f92672">=</span> [<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">toUpperCase</span>(), ...<span style="color:#a6e22e">b</span>].<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">apiName</span>, <span style="color:#a6e22e">api</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;disable&#34;</span> };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">typeof</span> <span style="color:#66d9ef">this</span>[<span style="color:#a6e22e">apiName</span>] <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#34;undefined&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">api</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;enable&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">version</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>[<span style="color:#a6e22e">apiName</span>].<span style="color:#a6e22e">getVersion</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">obj</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">checkAPI</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">isAPIAtAdvancedGoogleServices_</span>(<span style="color:#e6db74">&#34;Drive&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">checkAPI</span>.<span style="color:#a6e22e">api</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;disable&#34;</span> <span style="color:#f92672">||</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">checkAPI</span>.<span style="color:#a6e22e">api</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;enable&#34;</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">checkAPI</span>.<span style="color:#a6e22e">version</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;v3&#34;</span>)
</span></span><span style="display:flex;"><span>  ) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Please enable Drive API v2 at Advanced Google services.&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">insert</span>({ <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample&#34;</span> });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>By this modification, when the function <code>myFunction</code> on the client script is run, it occurred a custom error like <code>Please enable Drive API v2 at Advanced Google services.</code>.</p>
<h2 id="key-point">Key Point:</h2>
<p>As a key point, in Google Apps Script, libraries are deployed as separate projects. The enabled APIs for a script depend on the project where the script resides, not the script calling it. This means that even if the Drive API v3 is enabled in the client script, the library script will continue to use DriveApp (v2) as long as v2 is enabled for the library project. Also, even when Drive API is disabled on the client script, the function <code>myFunction</code> works fine when Drive API v2 is enabled in the library script. Namely, it was found that when the library is used, the APIs at Advanced Google services can be managed at the library side.</p>
<h1 id="note">Note</h1>
<ul>
<li>The top abstract image was created by giving this report to <a href="https://gemini.google.com/app">Gemini</a>.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f16%2fchecking-api-enabled-with-advanced-google-services-using-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f16%2fchecking-api-enabled-with-advanced-google-services-using-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f16%2fchecking-api-enabled-with-advanced-google-services-using-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f16%2fchecking-api-enabled-with-advanced-google-services-using-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f16%2fchecking-api-enabled-with-advanced-google-services-using-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f16%2fchecking-api-enabled-with-advanced-google-services-using-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2024/05/15/updated-gas-library-pdfapp/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2024/05/15/updated-gas-library-pdfapp/">Updated: GAS Library - PDFApp</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

