<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tanaikech.github.io/img/og-main.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>Techniques for Creating Nested Lists on Google Documents using Google Docs API &middot; tanaike - Google Apps Script, Gemini API, and Developer Tips</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": "tanaike",
  "author": {
    "@type": "Person",
    "name": "Kanshi Tanaike"
  },
  "description": "Technical blog about Google Apps Script, Google API, Node.js and AI.",
  "url": "https://tanaikech.github.io/"
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Techniques for Creating Nested Lists on Google Documents using Google Docs API</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>28 May 2024, 17:09</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/document">document</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/document">document</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/docs-api">Docs API</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/c3d409c44579a9c23382e20400f51d4c">Gists</a></p>
<h1 id="abstract">Abstract</h1>
<p>Current Google Docs API documentation offers methods for working with existing lists but lacks instructions for creating nested lists in new documents. This report fills this gap, empowering developers and streamlining nested list creation using Google Apps Script (concepts applicable to other languages).</p>
<h1 id="introduction">Introduction</h1>
<p>The official Google Docs API documentation provides instructions for working with existing lists, including converting paragraphs to lists and removing bullets. However, it lacks guidance on creating nested lists within an empty document body. <a href="https://developers.google.com/docs/api/how-tos/lists">Ref</a></p>
<p>This omission can be a hurdle for users who need to programmatically generate nested lists in new documents. In fact, encountering this challenge is a common theme on Stack Overflow, as evidenced by these discussions: <a href="https://stackoverflow.com/a/65333204">Ref</a> and <a href="https://stackoverflow.com/a/78541593">Ref</a></p>
<p>By addressing this gap in the official documentation, this report aims to empower developers and streamline their use of the Google Docs API for creating nested lists. It leverages Google Apps Script for demonstration purposes, but the concepts and approaches can be adapted to other programming languages as well.</p>
<h1 id="sample">Sample</h1>
<p>This report introduces the method for creating the following nested list by Google Docs API.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240528a/fig1.png" alt=""></p>
<h1 id="usage">Usage</h1>
<h2 id="1-create-a-new-google-document">1. Create a New Google Document</h2>
<p>Start by creating a new Google Document. Then, open the script editor within the document.</p>
<p>This report uses Google Docs API with Google Apps Script as a simple example. Authorization for the Google Docs API is simplified when using Apps Script, which is why it was chosen for this demonstration.</p>
<h2 id="2-enable-google-docs-api">2. Enable Google Docs API</h2>
<p>Enable the Google Docs API in Advanced Google services. You can find instructions for enabling advanced services in the Apps Script documentation. <a href="https://developers.google.com/apps-script/guides/services/advanced#enable_advanced_services">Ref</a></p>
<h2 id="3-sample-script">3. Sample script</h2>
<p>Copy and paste the following script into the script editor of your Google Document. Save the script after pasting.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Create a request body for creating a nested list to Google Document using Google Docs API with Google Apps Script.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param {Object} object Object for using this method.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param {Number} object.startIndex Position for inserting the list.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param {String} object.bulletPreset Please select this from https://developers.google.com/docs/api/reference/rest/v1/documents/request#BulletGlyphPreset
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param {String} object.temporalBullet Temporal bullet using the value of &#34;listArray&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param {Array} object.listArray Array includes the list using the temporal bullet. The nested list is set using the space and the temporal bullet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @returns {Array} Request body for creating a nested list to Google Document using Google Docs API.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">createRequestBody_</span>(<span style="color:#a6e22e">object</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">startIndex</span>, <span style="color:#a6e22e">bulletPreset</span>, <span style="color:#a6e22e">temporalBullet</span>, <span style="color:#a6e22e">listArray</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">totalText</span>, <span style="color:#a6e22e">deleteParagraphBullets</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">listArray</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">o</span>, <span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">reg</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> RegExp(<span style="color:#e6db74">`^([ </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">temporalBullet</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]*) `</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">r</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">match</span>(<span style="color:#a6e22e">reg</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">r</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">nest</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">r</span>[<span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">replace</span>(<span style="color:#a6e22e">temporalBullet</span>, <span style="color:#e6db74">&#34;&#34;</span>).<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span>Array(<span style="color:#a6e22e">nest</span>).<span style="color:#a6e22e">fill</span>(<span style="color:#e6db74">&#34;\t&#34;</span>).<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#e6db74">}${</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#a6e22e">r</span>[<span style="color:#ae81ff">0</span>], <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">\n`</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">totalText</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">temp</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">e</span><span style="color:#e6db74">}</span><span style="color:#e6db74">\n`</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">start</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">startIndex</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">totalText</span>.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">totalText</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">temp</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">deleteParagraphBullets</span>.<span style="color:#a6e22e">push</span>({ <span style="color:#a6e22e">deleteParagraphBullets</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">range</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">startIndex</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">start</span>, <span style="color:#a6e22e">endIndex</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">start</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> } } });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">o</span>;
</span></span><span style="display:flex;"><span>  }, { <span style="color:#a6e22e">totalText</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#a6e22e">deleteParagraphBullets</span><span style="color:#f92672">:</span> [] });
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> [
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">insertText</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">totalText</span>, <span style="color:#a6e22e">location</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">index</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">startIndex</span> } } },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">createParagraphBullets</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">range</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">startIndex</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">startIndex</span>, <span style="color:#a6e22e">endIndex</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">startIndex</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">totalText</span>.<span style="color:#a6e22e">length</span> }, <span style="color:#a6e22e">bulletPreset</span> } },
</span></span><span style="display:flex;"><span>    ...<span style="color:#a6e22e">deleteParagraphBullets</span>.<span style="color:#a6e22e">reverse</span>()
</span></span><span style="display:flex;"><span>  ];
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Please run this function.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Please set your variables.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">startIndex</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; <span style="color:#75715e">// When 1 is set, the list is inserted from the top of Google Document.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">bulletPreset</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;NUMBERED_DECIMAL_NESTED&#34;</span>; <span style="color:#75715e">// Please select this from https://developers.google.com/docs/api/reference/rest/v1/documents/request#BulletGlyphPreset
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">temporalBullet</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;*&#34;</span>; <span style="color:#75715e">// Temporal bullet using the value of &#34;listArray&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Array including the list using the temporal bullet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// Nested list is set using the space and the temporal bullet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">listArray</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Sample text 1&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;* Sample text 2&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34; * Sample text 3&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;  * Sample text 4&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;   * Sample text 5&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;  * Sample text 6&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34; * Sample text 7&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;* Sample text 8&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Sample text 9&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;  * Sample text 10&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;  * Sample text 11&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;  * Sample text 12&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;* Sample text 13&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34; * Sample text 14&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34; * Sample text 15&#34;</span>,
</span></span><span style="display:flex;"><span>  ];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">requests</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">createRequestBody_</span>({ <span style="color:#a6e22e">startIndex</span>, <span style="color:#a6e22e">bulletPreset</span>, <span style="color:#a6e22e">temporalBullet</span>, <span style="color:#a6e22e">listArray</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">docmentId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DocumentApp</span>.<span style="color:#a6e22e">getActiveDocument</span>().<span style="color:#a6e22e">getId</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Docs</span>.<span style="color:#a6e22e">Documents</span>.<span style="color:#a6e22e">batchUpdate</span>({ <span style="color:#a6e22e">requests</span> }, <span style="color:#a6e22e">docmentId</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="4-explanation-of-script">4. Explanation of script</h2>
<p>When the function myFunction is run, it performs the following steps:</p>
<ol>
<li>Set variables.</li>
<li>Create a request body for creating a nested list in a Google Document using the Google Docs API.</li>
<li>Request the batchUpdate method of the Google Docs API with the created request body.</li>
</ol>
<h3 id="creating-the-request-body-for-nested-lists">Creating the Request Body for Nested Lists</h3>
<p>A crucial step is creating the request body for the Google Docs API. Before explaining the <code>createRequestBody_</code> function, let&rsquo;s explore how to build a nested list using the Docs API.</p>
<ol>
<li>Create Text for Insertion:
<ul>
<li>To create nested lists using \t and \n characters, the text for each paragraph becomes:</li>
<li><code>Sample text 2\n</code></li>
<li><code>\tSample text 3\n</code></li>
<li><code>\t\tSample text 4\n</code></li>
<li><code>\t\t\tSample text 5\n (and so on)</code></li>
<li>As you can see, each paragraph is constructed with <code>\t</code> (tab), text, and <code>\n</code> (newline).</li>
<li>The <code>totalText</code> variable in <code>createRequestBody_</code> demonstrates this structure: <code>Sample text 1\nSample text 2\n\tSample text 3\n\t\tSample text 4\n\t\t\tSample text 5\n\t\tSample text 6\n\tSample text 7\nSample text 8\nSample text 9\n\t\tSample text 10\n\t\tSample text 11\n\t\tSample text 12\nSample text 13\n\tSample text 14\n\tSample text 15\n</code></li>
</ul>
</li>
<li>Insert Text: Insert the created text into the document using <a href="https://developers.google.com/docs/api/reference/rest/v1/documents/request#inserttextrequest">InsertTextRequest</a>.</li>
<li>Set Paragraph Bullets: Apply bullets to the inserted text using <a href="https://developers.google.com/docs/api/reference/rest/v1/documents/request#createparagraphbulletsrequest">CreateParagraphBulletsRequest</a>. <code>startIndex</code> and <code>endIndex</code> define the starting index for the list and the length of the text, respectively.</li>
<li>Delete Unwanted Bullets: For paragraphs that shouldn&rsquo;t have bullets (like <code>Sample text 1</code> and <code>Sample text 9</code>), remove them using <a href="https://developers.google.com/docs/api/reference/rest/v1/documents/request#deleteparagraphbulletsrequest">DeleteParagraphBulletsRequest</a>. Set <code>startIndex</code> and <code>endIndex</code> to target only the first character of the paragraph.</li>
</ol>
<p>Following this flow, the <code>createRequestBody_</code> function constructs the request body for the nested list. Here&rsquo;s the created request body:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>  { <span style="color:#f92672">&#34;insertText&#34;</span>: { <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;Sample text 1\nSample text 2\n\tSample text 3\n\t\tSample text 4\n\t\t\tSample text 5\n\t\tSample text 6\n\tSample text 7\nSample text 8\nSample text 9\n\t\tSample text 10\n\t\tSample text 11\n\t\tSample text 12\nSample text 13\n\tSample text 14\n\tSample text 15\n&#34;</span>, <span style="color:#f92672">&#34;location&#34;</span>: { <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">1</span> } } },
</span></span><span style="display:flex;"><span>  { <span style="color:#f92672">&#34;createParagraphBullets&#34;</span>: { <span style="color:#f92672">&#34;range&#34;</span>: { <span style="color:#f92672">&#34;startIndex&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#f92672">&#34;endIndex&#34;</span>: <span style="color:#ae81ff">234</span> }, <span style="color:#f92672">&#34;bulletPreset&#34;</span>: <span style="color:#e6db74">&#34;NUMBERED_DECIMAL_NESTED&#34;</span> } },
</span></span><span style="display:flex;"><span>  { <span style="color:#f92672">&#34;deleteParagraphBullets&#34;</span>: { <span style="color:#f92672">&#34;range&#34;</span>: { <span style="color:#f92672">&#34;startIndex&#34;</span>: <span style="color:#ae81ff">122</span>, <span style="color:#f92672">&#34;endIndex&#34;</span>: <span style="color:#ae81ff">123</span> } } },
</span></span><span style="display:flex;"><span>  { <span style="color:#f92672">&#34;deleteParagraphBullets&#34;</span>: { <span style="color:#f92672">&#34;range&#34;</span>: { <span style="color:#f92672">&#34;startIndex&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#f92672">&#34;endIndex&#34;</span>: <span style="color:#ae81ff">2</span> } } }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p>This request body can also be used with various languages besides Google Apps Script. For instance, you can directly use it with the &ldquo;API explorer&rdquo; of &ldquo;Try it!&rdquo; at <a href="https://developers.google.com/docs/api/reference/rest/v1/documents/batchUpdate">Method: documents.batchUpdate</a>.</p>
<h3 id="steps-in-the-createrequestbody_-function">Steps in the createRequestBody_ function:</h3>
<ol>
<li>The text for insertion is created within a <code>reduce</code> loop. The loop also builds an array containing objects for using DeleteParagraphBulletsRequest. This array needs to be reversed because deleting unnecessary bullets alters the indices.</li>
<li>The request body is constructed in the order of InsertTextRequest, CreateParagraphBulletsRequest, and DeleteParagraphBulletsRequest.</li>
</ol>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f28%2ftechniques-for-creating-nested-lists-on-google-documents-using-google-docs-api%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f28%2ftechniques-for-creating-nested-lists-on-google-documents-using-google-docs-api%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f28%2ftechniques-for-creating-nested-lists-on-google-documents-using-google-docs-api%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f28%2ftechniques-for-creating-nested-lists-on-google-documents-using-google-docs-api%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f28%2ftechniques-for-creating-nested-lists-on-google-documents-using-google-docs-api%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f28%2ftechniques-for-creating-nested-lists-on-google-documents-using-google-docs-api%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2024/05/27/enhancing-html-and-javascript-development-in-script-editor-of-google-apps-script-overcoming-formatting-challenges/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2024/05/27/enhancing-html-and-javascript-development-in-script-editor-of-google-apps-script-overcoming-formatting-challenges/">Enhancing HTML and Javascript Development in Script Editor of Google Apps Script: Overcoming Formatting Challenges</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2024/05/29/updated-gas-library-geminiwithfiles/">Updated: GAS Library - GeminiWithFiles</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2024/05/29/updated-gas-library-geminiwithfiles/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

