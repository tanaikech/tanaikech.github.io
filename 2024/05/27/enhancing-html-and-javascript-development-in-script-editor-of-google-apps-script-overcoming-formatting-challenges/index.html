<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Enhancing HTML and Javascript Development in Script Editor of Google Apps Script: Overcoming Formatting Challenges &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>X</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Enhancing HTML and Javascript Development in Script Editor of Google Apps Script: Overcoming Formatting Challenges</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>27 May 2024, 10:18</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/script-editor">script editor</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/be52daa21ccf07873ad2a2e43e566676">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20240527a/fig1.jpg" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>Despite the improved Google Apps Script IDE launched in April 2022, challenges arise for HTML and Javascript development. The Script Editor&rsquo;s built-in formatting for these languages proves insufficient, particularly for large Javascript codebases, potentially causing errors. This report proposes a solution to address this formatting issue and streamline development within the Script Editor.</p>
<h1 id="introduction">Introduction</h1>
<p>The Google Apps Script Integrated Development Environment (IDE) Script Editor received a significant update on April 13, 2022, transforming it into a more modern and streamlined development experience. <a href="https://workspaceupdates.googleblog.com/2022/04/apps-script-integrated-development-enviornment-improvements.html">Ref</a> This enhanced IDE empowers developers to create custom solutions that extend the capabilities of Google Workspace applications for their organizations.</p>
<p>While the Script Editor is a valuable tool for Google Apps Script development, it presents challenges when working with HTML and Javascript. Currently, HTML and Javascript development within the Script Editor occurs directly in HTML files. While the editor offers formatting capabilities, Javascript code formatting seems less robust compared to HTML formatting. This can lead to errors, especially when dealing with large Javascript codebases.</p>
<p>This report proposes a workaround for this specific issue. We will explore methods to effectively develop HTML and Javascript within the Google Apps Script Script Editor, ensuring proper Javascript code formatting to enhance development efficiency and reduce errors.</p>
<h1 id="usage">Usage</h1>
<h2 id="1-create-a-google-apps-script-project">1. Create a Google Apps Script project</h2>
<p>In this sample, in order to use HTML and Javascript, a dialog on Google Spreadsheet is used. So, please create a new Google Spreadsheet and open the script editor.</p>
<h2 id="2-sample-script-1">2. Sample script 1</h2>
<p>In this section, it explains the current issue. Please copy and paste the following script and HTML to the script editor.</p>
<h3 id="codegs"><code>code.gs</code></h3>
<pre tabindex="0"><code>function openDialog() {
  const html = HtmlService.createHtmlOutputFromFile(&#34;index&#34;);
  SpreadsheetApp.getUi().showModalDialog(html, &#34;sample&#34;);
}
</code></pre><h3 id="indexhtml"><code>index.html</code></h3>
<pre tabindex="0"><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;base target=&#34;_top&#34;&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id=&#34;sample&#34;&gt;&lt;/div&gt;
&lt;script&gt;
const array = [[&#34;A1&#34;, &#34;B1&#34;, &#34;C1&#34;],[&#34;A2&#34;, &#34;B2&#34;, &#34;C2&#34;],[&#34;A3&#34;, &#34;B3&#34;, &#34;C3&#34;]];
const div = document.getElementById(&#34;sample&#34;);
const table = document.createElement(&#39;table&#39;);
table.border = &#34;1&#34;;
table.style.width = &#34;100%&#34;;
table.style[&#34;border-collapse&#34;] = &#34;collapse&#34;;
for (let i = 0; i &lt; array.length; i++) {
const tr = document.createElement(&#39;tr&#39;);
for (let j = 0; j &lt; array[i].length; j++) {
const td = document.createElement(&#39;td&#39;);
const text = document.createTextNode(array[i][j]);
td.appendChild(text);
tr.appendChild(td);
}
table.appendChild(tr);
}
div.appendChild(table);
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><h3 id="testing">Testing</h3>
<p>When you run the function <code>openDialog</code>, a dialog is opened and you can see the following table in the dialog. You can see that HTML and Javascript work fine.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240527a/fig2.png" alt=""></p>
<p>As the next step, when you see <code>index.html</code>, you can notice that the format of Javascript is not done and the readability is low. When this code is formatted by the script editor, it becomes as follows.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240527a/fig3.gif" alt=""></p>
<p>When the code is formatted, HTML can be correctly formatted. However, you can see that Javascript cannot be correctly formatted. I think that this situation is an issue for developing Javascript.</p>
<h2 id="2-sample-script-2">2. Sample script 2</h2>
<p>In this section, I would like to introduce a workaround for avoiding the above situation as a sample script 2. So, before you copy and paste the following script, please clear <code>code.gs</code> and <code>index.html</code> used in the above section once. And, please copy and paste the following script and HTML to the script editor.</p>
<h3 id="codegs-1"><code>code.gs</code></h3>
<pre tabindex="0"><code>function javascript_() {
const array = [[&#34;A1&#34;, &#34;B1&#34;, &#34;C1&#34;],[&#34;A2&#34;, &#34;B2&#34;, &#34;C2&#34;],[&#34;A3&#34;, &#34;B3&#34;, &#34;C3&#34;]];
const div = document.getElementById(&#34;sample&#34;);
const table = document.createElement(&#39;table&#39;);
table.border = &#34;1&#34;;
table.style.width = &#34;100%&#34;;
table.style[&#34;border-collapse&#34;] = &#34;collapse&#34;;
for (let i = 0; i &lt; array.length; i++) {
const tr = document.createElement(&#39;tr&#39;);
for (let j = 0; j &lt; array[i].length; j++) {
const td = document.createElement(&#39;td&#39;);
const text = document.createTextNode(array[i][j]);
td.appendChild(text);
tr.appendChild(td);
}
table.appendChild(tr);
}
div.appendChild(table);
}

function openDialog() {
  const html = HtmlService.createTemplateFromFile(&#34;index&#34;);
  html.javascript = javascript_
  .toString()
  .match(/^function javascript_\(\) {([\s\S\w]*)}$/)[1];
  SpreadsheetApp.getUi().showModalDialog(html.evaluate(), &#34;sample&#34;);
}
</code></pre><h3 id="indexhtml-1"><code>index.html</code></h3>
<pre tabindex="0"><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;base target=&#34;_top&#34;&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id=&#34;sample&#34;&gt;&lt;/div&gt;
&lt;script&gt;
&lt;?!= javascript ?&gt;
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><h3 id="testing-1">Testing</h3>
<p>When you run the function <code>openDialog</code>, a dialog is opened and you can see the following table in the dialog. You can see the same result in the above section.</p>
<p>As the next step, when you see the current <code>index.html</code> and <code>code.gs</code>, you can notice that both formats are not done and the readability is low. When those codes are formatted by the script editor, it becomes as follows.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240527a/fig4.gif" alt=""></p>
<p>When <code>index.html</code> and <code>code.gs</code> are formatted, both files can be displayed with proper formatting, improving readability. Additionally, the JavaScript code functions correctly within the dialog.</p>
<p>As previously mentioned, the script editor can currently format Google Apps Script within the <code>code.gs</code> script file. This report leverages this functionality as a workaround. JavaScript is developed in the <code>code.gs</code> script file, and the developed code is then imported into the <code>index.html</code> HTML file. This workflow allows for the development of JavaScript code with proper formatting.</p>
<h1 id="important">IMPORTANT</h1>
<p>It&rsquo;s important to note that this workaround is not applicable if the JavaScript code includes syntax incompatible with the script editor. Please exercise caution in such scenarios.</p>
<h1 id="note">Note</h1>
<ul>
<li>The top abstract image was created by giving this report to <a href="https://gemini.google.com/app">Gemini</a>.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f27%2fenhancing-html-and-javascript-development-in-script-editor-of-google-apps-script-overcoming-formatting-challenges%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f27%2fenhancing-html-and-javascript-development-in-script-editor-of-google-apps-script-overcoming-formatting-challenges%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f27%2fenhancing-html-and-javascript-development-in-script-editor-of-google-apps-script-overcoming-formatting-challenges%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f27%2fenhancing-html-and-javascript-development-in-script-editor-of-google-apps-script-overcoming-formatting-challenges%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f27%2fenhancing-html-and-javascript-development-in-script-editor-of-google-apps-script-overcoming-formatting-challenges%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f05%2f27%2fenhancing-html-and-javascript-development-in-script-editor-of-google-apps-script-overcoming-formatting-challenges%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2024/05/23/updated-javascript-library-resumableuploadforgoogledrive_js/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2024/05/23/updated-javascript-library-resumableuploadforgoogledrive_js/">Updated: Javascript library - ResumableUploadForGoogleDrive_js</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

