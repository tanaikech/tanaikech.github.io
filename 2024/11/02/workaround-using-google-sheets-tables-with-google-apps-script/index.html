<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="Official profile of Kanshi Tanaike, a Google Developer Expert (GDE) in Google Workspace and Physicist. Specializing in Google Apps Script, Gemini API, and innovative IT solutions.">
  <meta name="generator" content="Hugo 0.98.0" />

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tanaikech.github.io/img/og-main.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>tanaike - Google Apps Script, Gemini API Expert & Physicist</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Kanshi Tanaike",
  "alternateName": "tanaike",
  "url": "https://tanaikech.github.io/",
  "image": "https://tanaikech.github.io/img/og-main.png",
  "jobTitle": "Google Developer Expert",
  "honorificPrefix": "Ph.D.",
  "description": "Japanese scientist, Physicist and Google Developer Expert for Google Workspace.",
  "award": "First place in the Outstanding GDE Award 2025",
  "sameAs": [
    "https://twitter.com/tanaikech",
    "https://github.com/tanaikech",
    "https://stackoverflow.com/users/7108653/tanaike",
    "https://developers.google.com/community/experts/directory?text=tanaike",
    "https://zenn.dev/tanaike",
    "https://medium.com/@tanaike"
  ]
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://www.youtube.com/@tanaike" rel="me" target="_blank"><i class="fab fa-youtube-square fa-fw"></i>YouTube</a>
    </li>
    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2026. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Workaround: Using Google Sheets Tables with Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>02 Nov 2024, 10:11</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/2e6b1fa2d8f16464dffba070376c458d">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20241102a/fig1.png" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>Google Sheets&rsquo; new Tables feature enhances data organization but lacks direct management via Apps Script. This report proposes a workaround solution using Apps Script until native support arrives.</p>
<h1 id="introduction">Introduction</h1>
<p>Google Sheets recently introduced a new feature called Tables. <a href="https://workspaceupdates.googleblog.com/2024/05/tables-in-google-sheets.html">Ref</a> Tables offer a powerful way to organize and manage your data by transforming unformatted ranges into structured datasets with automatic headers, filtering options, and data validation capabilities. This not only improves the readability and maintainability of your spreadsheets but also allows for seamless integration with existing Google Sheets functions.</p>
<p>However, there&rsquo;s a current limitation: while Tables offer significant benefits, Google Apps Script currently lacks built-in methods for directly managing them. This report addresses this gap by proposing a workaround solution utilizing Google Apps Script. It&rsquo;s important to note that this workaround might be temporary, as future updates to Google Apps Script might introduce native support for managing Tables.</p>
<h1 id="current-limitations">Current limitations</h1>
<p>These limitations might be resolved in a future update.</p>
<h2 id="google-apps-script-and-google-sheets-tables">Google Apps Script and Google Sheets Tables</h2>
<ul>
<li>Direct Management: Currently, there are no built-in methods in Google Apps Script to directly create, and modify the metadata of Google Sheets Tables. However, you can access and manipulate the data within existing Tables using Google Apps Script.</li>
<li>Table Creation: Google Apps Script cannot directly create new Tables. Tables must be manually created within Google Sheets.</li>
</ul>
<h2 id="google-sheets-functions-and-tables">Google Sheets Functions and Tables</h2>
<ul>
<li>Direct Access: When using Google Sheets functions, you can directly reference Tables by their names.</li>
<li>Table Name Retrieval: It&rsquo;s important to note that there&rsquo;s no direct way to retrieve the names of all Tables in a spreadsheet using Google Apps Script. You&rsquo;ll need to manually specify the Table names when accessing them within your scripts.</li>
</ul>
<h1 id="current-workaround">Current workaround</h1>
<p>In this workaround, we attempt to access the table data by combining Google Sheets functions and Google Apps Script. This approach allows us to leverage the power of both tools to dynamically retrieve and manipulate data from the table.</p>
<h1 id="sample-tables-on-a-google-spreadsheet">Sample tables on a Google Spreadsheet</h1>
<p>The sample tables are as follows. It supposes that these tables are put into &ldquo;Sheet1&rdquo;.</p>
<p><img src="https://tanaikech.github.io/image-storage/20241102a/fig2.png" alt=""></p>
<h1 id="retrieve-values-using-table-name">Retrieve values using Table name</h1>
<p>The sample formula for retrieving the values of <code>SampleTable1</code> shown in the above image using the Table name is as follows.</p>
<pre tabindex="0"><code>=LET(
  tableName, SampleTable1,
  ARRAYFORMULA(OFFSET(tableName, -1,0,ROWS(tableName)+1))
)
</code></pre><p>When <code>=ARRAYFORMULA(SampleTable1)</code> is used, the header row is not included. This formula will be useful only when you want the data rows. But, when you want whole table including the header row, the above formula might be useful.</p>
<p>When the values of <code>SampleTable1</code> are retrieved using Google Apps Script with the Table name, the sample script is as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample1</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tableName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SampleTable1&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">formula</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`=LET(
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  tableName, </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">tableName</span><span style="color:#e6db74">}</span><span style="color:#e6db74">,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  ARRAYFORMULA(OFFSET(tableName, -1,0,ROWS(tableName)+1))
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">)`</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tempSheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">insertSheet</span>(<span style="color:#e6db74">`smaple_</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">getUuid</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tempSheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#e6db74">&#34;A1&#34;</span>).<span style="color:#a6e22e">setFormula</span>(<span style="color:#a6e22e">formula</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">flush</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tempSheet</span>.<span style="color:#a6e22e">getDataRange</span>().<span style="color:#a6e22e">getValues</span>(); <span style="color:#75715e">// Values of the table.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">deleteSheet</span>(<span style="color:#a6e22e">tempSheet</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">values</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When this script is run to the above tables in the sample image, the following result is obtained.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;B2&#34;</span>, <span style="color:#e6db74">&#34;C2&#34;</span>, <span style="color:#e6db74">&#34;D2&#34;</span>, <span style="color:#e6db74">&#34;E2&#34;</span>, <span style="color:#e6db74">&#34;F2&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;B3&#34;</span>, <span style="color:#e6db74">&#34;C3&#34;</span>, <span style="color:#e6db74">&#34;D3&#34;</span>, <span style="color:#e6db74">&#34;E3&#34;</span>, <span style="color:#e6db74">&#34;F3&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;B4&#34;</span>, <span style="color:#e6db74">&#34;C4&#34;</span>, <span style="color:#e6db74">&#34;D4&#34;</span>, <span style="color:#e6db74">&#34;E4&#34;</span>, <span style="color:#e6db74">&#34;F4&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;B5&#34;</span>, <span style="color:#e6db74">&#34;C5&#34;</span>, <span style="color:#e6db74">&#34;D5&#34;</span>, <span style="color:#e6db74">&#34;E5&#34;</span>, <span style="color:#e6db74">&#34;F5&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;B6&#34;</span>, <span style="color:#e6db74">&#34;C6&#34;</span>, <span style="color:#e6db74">&#34;D6&#34;</span>, <span style="color:#e6db74">&#34;E6&#34;</span>, <span style="color:#e6db74">&#34;F6&#34;</span>]
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><h1 id="retrieve-a1notation-of-table-using-table-name">Retrieve A1Notation of Table using Table name</h1>
<p>The sample formula for retrieving the A1Notation of <code>SampleTable2</code> shown in the above image using the Table name is as follows. (I believe that this sample formula will be able to be simpler.)</p>
<pre tabindex="0"><code>=LET(
  tableName, SampleTable2,
  regexText, &#34;&#39;?([^&#39;]+)&#39;?!&#34;,
  tableAdress, CELL(&#34;address&#34;, tableName),
  checkAddress, REGEXMATCH(CELL(&#34;address&#34;,tableName),regexText),
  sheetName, IF(checkAddress,REGEXEXTRACT(tableAdress,&#34;&#39;?([^&#39;]+)&#39;?!&#34;),&#34;&#34;),
  rowPos, ROW(tableName) - 1,
  colPos, COLUMN(tableName),
  rowLength, ROWS(tableName) + 1,
  colLength, COLUMNS(tableName),
  a1Notation1, ADDRESS(rowPos,colPos,4),
  a1Notation2, ADDRESS(rowPos + rowLength - 1,colPos + colLength - 1,4),
  IF(sheetName&lt;&gt;&#34;&#34;, &#34;&#39;&#34;&amp;sheetName&amp;&#34;&#39;!&#34;&amp;a1Notation1&amp;&#34;:&#34;&amp;a1Notation2, a1Notation1&amp;&#34;:&#34;&amp;a1Notation2)
)
</code></pre><p>When the above tables are put into &ldquo;Sheet1&rdquo;, this formula is run at &ldquo;Sheet2&rdquo;, the following result is obtained.</p>
<pre tabindex="0"><code>&#39;Sheet1&#39;!B9:H13
</code></pre><p>In this case, when the formula is run on the same sheet as the tables, the sheet name is not included because of the specification of &ldquo;CELL&rdquo;.</p>
<p>Also, when this A1Notation is used, the values of the table can be retrieved using Google Apps Script. The sample script is as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample2</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tableName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SampleTable2&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">formula</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`=LET(
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  tableName, </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">tableName</span><span style="color:#e6db74">}</span><span style="color:#e6db74">,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  regexText, &#34;&#39;?([^&#39;]+)&#39;?!&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  tableAdress, CELL(&#34;address&#34;, tableName),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  checkAddress, REGEXMATCH(CELL(&#34;address&#34;,tableName),regexText),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  sheetName, IF(checkAddress,REGEXEXTRACT(tableAdress,&#34;&#39;?([^&#39;]+)&#39;?!&#34;),&#34;&#34;),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  rowPos, ROW(tableName) - 1,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  colPos, COLUMN(tableName),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  rowLength, ROWS(tableName) + 1,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  colLength, COLUMNS(tableName),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  a1Notation1, ADDRESS(rowPos,colPos,4),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  a1Notation2, ADDRESS(rowPos + rowLength - 1,colPos + colLength - 1,4),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  IF(sheetName&lt;&gt;&#34;&#34;, &#34;&#39;&#34;&amp;sheetName&amp;&#34;&#39;!&#34;&amp;a1Notation1&amp;&#34;:&#34;&amp;a1Notation2, a1Notation1&amp;&#34;:&#34;&amp;a1Notation2)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">)`</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tempSheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">insertSheet</span>(<span style="color:#e6db74">`smaple_</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">getUuid</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tempSheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#e6db74">&#34;A1&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">setFormula</span>(<span style="color:#a6e22e">formula</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">flush</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">a1Notation</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getValue</span>(); <span style="color:#75715e">// A1Notation of the table.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">deleteSheet</span>(<span style="color:#a6e22e">tempSheet</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">a1Notation</span>).<span style="color:#a6e22e">getValues</span>(); <span style="color:#75715e">// Values of the table.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">values</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When this script is run to the above tables in the sample image, the following result is obtained.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;B9&#34;</span>, <span style="color:#e6db74">&#34;C9&#34;</span>, <span style="color:#e6db74">&#34;D9&#34;</span>, <span style="color:#e6db74">&#34;E9&#34;</span>, <span style="color:#e6db74">&#34;F9&#34;</span>, <span style="color:#e6db74">&#34;G9&#34;</span>, <span style="color:#e6db74">&#34;H9&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;B10&#34;</span>, <span style="color:#e6db74">&#34;C10&#34;</span>, <span style="color:#e6db74">&#34;D10&#34;</span>, <span style="color:#e6db74">&#34;E10&#34;</span>, <span style="color:#e6db74">&#34;F10&#34;</span>, <span style="color:#e6db74">&#34;G10&#34;</span>, <span style="color:#e6db74">&#34;H10&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;B11&#34;</span>, <span style="color:#e6db74">&#34;C11&#34;</span>, <span style="color:#e6db74">&#34;D11&#34;</span>, <span style="color:#e6db74">&#34;E11&#34;</span>, <span style="color:#e6db74">&#34;F11&#34;</span>, <span style="color:#e6db74">&#34;G11&#34;</span>, <span style="color:#e6db74">&#34;H11&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;B12&#34;</span>, <span style="color:#e6db74">&#34;C12&#34;</span>, <span style="color:#e6db74">&#34;D12&#34;</span>, <span style="color:#e6db74">&#34;E12&#34;</span>, <span style="color:#e6db74">&#34;F12&#34;</span>, <span style="color:#e6db74">&#34;G12&#34;</span>, <span style="color:#e6db74">&#34;H12&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;B13&#34;</span>, <span style="color:#e6db74">&#34;C13&#34;</span>, <span style="color:#e6db74">&#34;D13&#34;</span>, <span style="color:#e6db74">&#34;E13&#34;</span>, <span style="color:#e6db74">&#34;F13&#34;</span>, <span style="color:#e6db74">&#34;G13&#34;</span>, <span style="color:#e6db74">&#34;H13&#34;</span>]
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p><strong>Also, when the A1Notation of the table can be known, the values on the table can also be updated using Google Apps Script. This might be an important point.</strong></p>
<h1 id="note">Note</h1>
<ul>
<li>There might be cases where specific table values, such as dropdown list selections (DataValidation), cannot be retrieved directly. In these scenarios, a workaround is needed. You can find a workaround in my Stack Overflow answer.</li>
</ul>
<h1 id="summary">Summary</h1>
<p>This report explored methods for retrieving data values and A1Notation from tables in Google Spreadsheets from the table name using Google Apps Script with the current workaround. Currently, Google Apps Script lacks functionalities for directly manipulating tables within Spreadsheets. However, future updates are expected to address this limitation. For instance, the ability to retrieve the list of tables in a spreadsheet would significantly enhance table management using Google Apps Script.</p>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2024%2f11%2f02%2fworkaround-using-google-sheets-tables-with-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2024%2f11%2f02%2fworkaround-using-google-sheets-tables-with-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f11%2f02%2fworkaround-using-google-sheets-tables-with-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2024%2f11%2f02%2fworkaround-using-google-sheets-tables-with-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f11%2f02%2fworkaround-using-google-sheets-tables-with-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f11%2f02%2fworkaround-using-google-sheets-tables-with-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2024/10/17/unlocking-power-leverage-the-google-docs-api-beyond-apps-scripts-document-service/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2024/10/17/unlocking-power-leverage-the-google-docs-api-beyond-apps-scripts-document-service/">Unlocking Power: Leverage the Google Docs API Beyond Apps Script&#39;s Document Service</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2024/11/06/exporting-google-sheets-tables-as-pdfs-using-google-apps-script/">Exporting Google Sheets Tables as PDFs using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2024/11/06/exporting-google-sheets-tables-as-pdfs-using-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

