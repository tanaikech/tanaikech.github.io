<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Identifying Colored Cell Regions in Google Sheets with Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter fa-fw"></i>X</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Identifying Colored Cell Regions in Google Sheets with Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>10 Apr 2024, 10:13</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/15198f6c6872385b4ed6e85498b82733">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20240410a/fig1.gif" alt=""></p>
<h1 id="overview">Overview</h1>
<p>This Google Apps Script helps identify and analyze regions of colored cells in a Google Sheet.</p>
<h1 id="description">Description</h1>
<p>Recently, I encountered a situation where I needed to identify colored cell regions in Google Sheets. For instance, consider the following spreadsheet:</p>
<p><img src="https://tanaikech.github.io/image-storage/20240410a/fig2.png" alt=""></p>
<p>The region enclosed by the red cells (B2:D4) is a rectangle. In this case, the closed region can be easily identified using a simple script in Google Sheets. However, the region enclosed by the blue cells (H3, I2, J2,,,) is more complex. It consists of multiple disconnected cells that form a single shape. Identifying such irregular shapes using a script can be challenging.</p>
<p>In this report, I will introduce a sample script that can be used to identify complicated closed shapes like the one enclosed by the blue cells in the example. When this script is used, the closed regions can be filled in with colors, as shown in the top demonstration. This script also demonstrates a technique for working with cells on Google Sheets using Google Apps Script.</p>
<h1 id="usage">Usage</h1>
<h2 id="1-create-a-new-google-spreadsheet">1. Create a new Google Spreadsheet</h2>
<p>Please create a new Google Spreadsheet and open the script editor.</p>
<h2 id="2-base-script">2. Base script</h2>
<p>Please copy and paste the following script to the script editor and save the script. This script is used with the following sample scripts.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Fill in cells by colors.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FillInCells</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">constructor</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">sheet</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">objectFromGetObjectMethod</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">objectFromGetEachObjectsMethod</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Main method.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @param {Object} object Object using this library.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @returns {Object[]} Object including the a1Notations and colors.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">run</span>(<span style="color:#a6e22e">object</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">range</span>, <span style="color:#a6e22e">defColor</span>, <span style="color:#a6e22e">fill</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">offsetR</span>, <span style="color:#a6e22e">offsetC</span>, <span style="color:#a6e22e">maxR</span>, <span style="color:#a6e22e">maxC</span>, <span style="color:#a6e22e">backgrounds</span> } <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getInitValues_</span>(<span style="color:#a6e22e">range</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj1</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getObject_</span>({
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">defColor</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">offsetR</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">offsetC</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">maxR</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">maxC</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">backgrounds</span>,
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj2</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getEachObjects_</span>(<span style="color:#a6e22e">obj1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj3</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getInsideRanges_</span>(<span style="color:#a6e22e">obj2</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">fill</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">fillIn_</span>(<span style="color:#a6e22e">obj3</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">obj3</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Get initial values.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @param {SpreadsheetApp.Range} range Range with this library.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @returns {Object} Values offsetR, offsetC, maxR, maxC, backgrounds.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">getInitValues_</span>(<span style="color:#a6e22e">range</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getSheet</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">offsetR</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getRow</span>() <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">offsetC</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getColumn</span>() <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">maxR</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getNumRows</span>() <span style="color:#f92672">+</span> <span style="color:#a6e22e">offsetR</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">maxC</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getNumColumns</span>() <span style="color:#f92672">+</span> <span style="color:#a6e22e">offsetC</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">backgrounds</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getBackgrounds</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> { <span style="color:#a6e22e">offsetR</span>, <span style="color:#a6e22e">offsetC</span>, <span style="color:#a6e22e">maxR</span>, <span style="color:#a6e22e">maxC</span>, <span style="color:#a6e22e">backgrounds</span> };
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Get colored cells.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @param {Object} object Values defColor, offsetR, offsetC, maxR, maxC, backgrounds.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @returns {Object} Object including each colord cells.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">getObject_</span>(<span style="color:#a6e22e">object</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">defColor</span>, <span style="color:#a6e22e">offsetR</span>, <span style="color:#a6e22e">offsetC</span>, <span style="color:#a6e22e">maxR</span>, <span style="color:#a6e22e">maxC</span>, <span style="color:#a6e22e">backgrounds</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">checks</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">backgrounds</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">ar</span>, <span style="color:#a6e22e">r</span>, <span style="color:#a6e22e">i</span>, <span style="color:#a6e22e">a</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">c</span>, <span style="color:#a6e22e">j</span>) =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">defColor</span>) {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">row</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">offsetR</span>;
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">col</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">offsetC</span>;
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">area</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">ro</span> <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">ro</span> <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">ro</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">co</span> <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">co</span> <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">co</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>              <span style="color:#66d9ef">if</span> (
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ro</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">&gt;</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">co</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">&gt;</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ro</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">maxR</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">offsetR</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">co</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">maxC</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">offsetC</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">a</span>[<span style="color:#a6e22e">ro</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">i</span>][<span style="color:#a6e22e">co</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">j</span>] <span style="color:#f92672">!=</span> <span style="color:#a6e22e">defColor</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">row</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">ro</span> <span style="color:#f92672">&gt;=</span> <span style="color:#a6e22e">offsetR</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">col</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">co</span> <span style="color:#f92672">&gt;=</span> <span style="color:#a6e22e">offsetC</span>
</span></span><span style="display:flex;"><span>              ) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">row</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">row</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">ro</span>, <span style="color:#a6e22e">col</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">col</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">co</span> };
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">row</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">row</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">col</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">col</span>) {
</span></span><span style="display:flex;"><span>                  <span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">center</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>                  <span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">color</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">area</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">temp</span>);
</span></span><span style="display:flex;"><span>              }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">area</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ar</span>;
</span></span><span style="display:flex;"><span>    }, []);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">checks</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">o</span>, <span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">t</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">find</span>(({ <span style="color:#a6e22e">center</span> }) =&gt; <span style="color:#a6e22e">center</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">o</span>[<span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">row</span><span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">col</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">o</span>;
</span></span><span style="display:flex;"><span>    }, {});
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">objectFromGetObjectMethod</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">obj</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">obj</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Get each objects in the sheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @param {Object} obj Values from the method getObject_.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @returns {Object} Object including colored cell range as A1Notations.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">getEachObjects_</span>(<span style="color:#a6e22e">obj</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">keys</span> <span style="color:#f92672">=</span> Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">obj</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">r</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">keys</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">k</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tempObj</span> <span style="color:#f92672">=</span> { ...<span style="color:#a6e22e">obj</span> };
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tempObj</span>[<span style="color:#a6e22e">k</span>];
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">delete</span> <span style="color:#a6e22e">tempObj</span>[<span style="color:#a6e22e">k</span>];
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ttt</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">ttt</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">k</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">check</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">value</span>) =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">value</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tk</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">row</span><span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">col</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">k</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">tk</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">tempObj</span>.<span style="color:#a6e22e">hasOwnProperty</span>(<span style="color:#a6e22e">tk</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ttt</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">tk</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tv</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tempObj</span>[<span style="color:#a6e22e">tk</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">delete</span> <span style="color:#a6e22e">tempObj</span>[<span style="color:#a6e22e">tk</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">check</span>(<span style="color:#a6e22e">tv</span>);
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>      };
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">color</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">value</span>.<span style="color:#a6e22e">find</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">center</span>).<span style="color:#a6e22e">color</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">v</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">value</span>.<span style="color:#a6e22e">filter</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#f92672">!</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">hasOwnProperty</span>(<span style="color:#e6db74">&#34;center&#34;</span>));
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">check</span>(<span style="color:#a6e22e">v</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">ttt</span>.<span style="color:#a6e22e">sort</span>((<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) =&gt; (<span style="color:#a6e22e">a</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">b</span> <span style="color:#f92672">?</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>));
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> { <span style="color:#a6e22e">v</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">ttt</span>, <span style="color:#a6e22e">c</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">color</span> };
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">removeDuplicate</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">o</span>, <span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">sort</span>((<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) =&gt; (<span style="color:#a6e22e">a</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">b</span> <span style="color:#f92672">?</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)).<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;,&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">hasOwnProperty</span>(<span style="color:#a6e22e">key</span>)) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">o</span>[<span style="color:#a6e22e">key</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">o</span>;
</span></span><span style="display:flex;"><span>    }, {});
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">removeDuplicateAr</span> <span style="color:#f92672">=</span> Object.<span style="color:#a6e22e">values</span>(<span style="color:#a6e22e">removeDuplicate</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">removeDuplicateAr</span>.<span style="color:#a6e22e">map</span>(({ <span style="color:#a6e22e">v</span>, <span style="color:#a6e22e">c</span> }) =&gt; ({
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">row_col</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">v</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">closed</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">every</span>((<span style="color:#a6e22e">f</span>) =&gt; <span style="color:#a6e22e">obj</span>[<span style="color:#a6e22e">f</span>].<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">3</span>),
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">c</span>,
</span></span><span style="display:flex;"><span>    }));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">objectFromGetEachObjectsMethod</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">o</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cells</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">row_col</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">row</span>, <span style="color:#a6e22e">col</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;_&#34;</span>);
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">return</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">columnIndexToLetter_</span>(<span style="color:#a6e22e">col</span>)<span style="color:#e6db74">}${</span>Number(<span style="color:#a6e22e">row</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">sort</span>((<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) =&gt; (<span style="color:#a6e22e">a</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">b</span> <span style="color:#f92672">?</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>));
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> { <span style="color:#a6e22e">cells</span>, <span style="color:#a6e22e">closed</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">closed</span>, <span style="color:#a6e22e">color</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">c</span> };
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @param {Object} obj Values from the method getEachObjects_.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @returns {Object[]} Object including the a1Notations and colors.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">getInsideRanges_</span>(<span style="color:#a6e22e">obj</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">getRes_</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">type</span>, <span style="color:#a6e22e">start</span>, <span style="color:#a6e22e">end</span>, <span style="color:#a6e22e">ob</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ar</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">r</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">start</span>; <span style="color:#a6e22e">r</span> <span style="color:#f92672">&lt;=</span> <span style="color:#a6e22e">end</span>; <span style="color:#a6e22e">r</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">ob</span>[<span style="color:#a6e22e">r</span>]) {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ob</span>[<span style="color:#a6e22e">r</span>].<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">arr</span>, <span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">i</span>, <span style="color:#a6e22e">a</span>) =&gt; {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">a</span>[<span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]) {
</span></span><span style="display:flex;"><span>              <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tt</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>              <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">c</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>; <span style="color:#a6e22e">c</span> <span style="color:#f92672">&lt;=</span> <span style="color:#a6e22e">a</span>[<span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]; <span style="color:#a6e22e">c</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">tt</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">c</span>);
</span></span><span style="display:flex;"><span>              }
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">tt</span>.<span style="color:#a6e22e">shift</span>();
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">tt</span>.<span style="color:#a6e22e">pop</span>();
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">arr</span>.<span style="color:#a6e22e">push</span>(...<span style="color:#a6e22e">tt</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">arr</span>;
</span></span><span style="display:flex;"><span>          }, []);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">push</span>(
</span></span><span style="display:flex;"><span>          ...<span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>) =&gt;
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;row&#34;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">?</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">columnIndexToLetter_</span>(<span style="color:#a6e22e">e</span>)<span style="color:#e6db74">}${</span><span style="color:#a6e22e">r</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">:</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">columnIndexToLetter_</span>(<span style="color:#a6e22e">r</span>)<span style="color:#e6db74">}${</span><span style="color:#a6e22e">e</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>          )
</span></span><span style="display:flex;"><span>        );
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ar</span>;
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">ar</span>, <span style="color:#a6e22e">o</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">closed</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">t</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">row_col</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;_&#34;</span>).<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">f</span>) =&gt; Number(<span style="color:#a6e22e">f</span>)));
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">or</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">reduce</span>(
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">oo</span>, [<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>]) =&gt; (
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">oo</span>[<span style="color:#a6e22e">a</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">oo</span>[<span style="color:#a6e22e">a</span>] <span style="color:#f92672">?</span> [...<span style="color:#a6e22e">oo</span>[<span style="color:#a6e22e">a</span>], <span style="color:#a6e22e">b</span>].<span style="color:#a6e22e">sort</span>((<span style="color:#a6e22e">c</span>, <span style="color:#a6e22e">d</span>) =&gt; <span style="color:#a6e22e">c</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">d</span>) <span style="color:#f92672">:</span> [<span style="color:#a6e22e">b</span>]), <span style="color:#a6e22e">oo</span>
</span></span><span style="display:flex;"><span>          ),
</span></span><span style="display:flex;"><span>          {}
</span></span><span style="display:flex;"><span>        );
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">oc</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">reduce</span>(
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">oo</span>, [<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>]) =&gt; (
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">oo</span>[<span style="color:#a6e22e">b</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">oo</span>[<span style="color:#a6e22e">b</span>] <span style="color:#f92672">?</span> [...<span style="color:#a6e22e">oo</span>[<span style="color:#a6e22e">b</span>], <span style="color:#a6e22e">a</span>].<span style="color:#a6e22e">sort</span>((<span style="color:#a6e22e">c</span>, <span style="color:#a6e22e">d</span>) =&gt; <span style="color:#a6e22e">c</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">d</span>) <span style="color:#f92672">:</span> [<span style="color:#a6e22e">a</span>]), <span style="color:#a6e22e">oo</span>
</span></span><span style="display:flex;"><span>          ),
</span></span><span style="display:flex;"><span>          {}
</span></span><span style="display:flex;"><span>        );
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tr</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">e</span>[<span style="color:#ae81ff">0</span>]);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tc</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">e</span>[<span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">startRowIdx</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">min</span>(...<span style="color:#a6e22e">tr</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">endRowIdx</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">max</span>(...<span style="color:#a6e22e">tr</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">startColIdx</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">min</span>(...<span style="color:#a6e22e">tc</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">endColIdx</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">max</span>(...<span style="color:#a6e22e">tc</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">se</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">getRes_</span>(<span style="color:#e6db74">&#34;row&#34;</span>, <span style="color:#a6e22e">startRowIdx</span>, <span style="color:#a6e22e">endRowIdx</span>, <span style="color:#a6e22e">or</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sf</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">getRes_</span>(<span style="color:#e6db74">&#34;col&#34;</span>, <span style="color:#a6e22e">startColIdx</span>, <span style="color:#a6e22e">endColIdx</span>, <span style="color:#a6e22e">oc</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">push</span>({ <span style="color:#a6e22e">ranges</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">se</span>.<span style="color:#a6e22e">filter</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">sf</span>.<span style="color:#a6e22e">includes</span>(<span style="color:#a6e22e">e</span>)), <span style="color:#a6e22e">color</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">c</span> });
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ar</span>;
</span></span><span style="display:flex;"><span>    }, []);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Fill in the closed objects in the sheet with colors.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @param {Object} obj Values from the method getInsideRanges_.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @returns {void}
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fillIn_</span>(<span style="color:#a6e22e">object</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">forEach</span>(({ <span style="color:#a6e22e">ranges</span>, <span style="color:#a6e22e">color</span> }) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">ranges</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getRangeList</span>(<span style="color:#a6e22e">ranges</span>).<span style="color:#a6e22e">setBackground</span>(<span style="color:#a6e22e">color</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Convert column index to column letter.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Ref: https://stackoverflow.com/a/53678158
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @param {Number} index Column index.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @returns {String} Column letter.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">columnIndexToLetter_</span>(<span style="color:#a6e22e">index</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">floor</span>(<span style="color:#a6e22e">index</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">26</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">?</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">columnIndexToLetter_</span>(<span style="color:#a6e22e">a</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>          String.<span style="color:#a6e22e">fromCharCode</span>(<span style="color:#ae81ff">65</span> <span style="color:#f92672">+</span> (<span style="color:#a6e22e">index</span> <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span>))
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This class offers functions for analyzing and modifying colored cell regions in a Google Sheet:</p>
<ul>
<li><code>run</code>: The primary function that triggers the entire process.</li>
<li><code>getInitValues_</code>: This function retrieves the initial background color information for a given range of cells.</li>
<li><code>getObject_</code>: This function gathers the coordinates of colored cells and the cells directly surrounding them.</li>
<li><code>getEachObjects_</code>: This function identifies each distinct colored cell region and verifies if they are fully enclosed by other cells.</li>
<li><code>getInsideRanges_</code>: This function retrieves the coordinates of uncolored cells located within each identified region.</li>
<li><code>fillIn_</code>: This function fills the cells within closed regions with a designated color.</li>
</ul>
<h2 id="3-sample-script-1">3. Sample script 1</h2>
<p>Please copy and paste the following script to the script editor and save the script.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">onChange</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">changeType</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;FORMAT&#34;</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSheet</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getMaxRows</span>(), <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getMaxColumns</span>());
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">f</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">FillInCells</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">run</span>({ <span style="color:#a6e22e">range</span>, <span style="color:#a6e22e">defColor</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">offset</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">getBackground</span>() });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Browser</span>.<span style="color:#a6e22e">msgBox</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">objectFromGetEachObjectsMethod</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">closed</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;Closed&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Opened&#34;</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And, please install the OnChange trigger to the function <code>onChange</code>. <a href="https://developers.google.com/apps-script/guides/triggers/installable#manage_triggers_manually">Ref</a> By this, the following result is obtained.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240410a/fig3.gif" alt=""></p>
<p>When you select several cells and set a color, a dialog is opened. And, you can see the identified result in the dialog.</p>
<h2 id="4-sample-script-2">4. Sample script 2</h2>
<p>Please copy and paste the following script to the script editor and save the script.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">onChange</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">changeType</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;FORMAT&#34;</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSheet</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getMaxRows</span>(), <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getMaxColumns</span>());
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">f</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">FillInCells</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">run</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">range</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">defColor</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">offset</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">getBackground</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fill</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And, please install the OnChange trigger to the function <code>onChange</code>. <a href="https://developers.google.com/apps-script/guides/triggers/installable#manage_triggers_manually">Ref</a> By this, the demonstration at the top of this report can be obtained.</p>
<h2 id="5-sample-script-3">5. Sample script 3</h2>
<p>Please copy and paste the following script to the script editor and save the script.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample3</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">a1Notation</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39;Sheet1&#39;!A1:M6&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">defColor</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#ffffff&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fill</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>().<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">a1Notation</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">f</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">FillInCells</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">run</span>({ <span style="color:#a6e22e">range</span>, <span style="color:#a6e22e">defColor</span>, <span style="color:#a6e22e">fill</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">identifiedRegions</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">objectFromGetEachObjectsMethod</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">identifiedRegions</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When this script is run to the following situation,</p>
<p><img src="https://tanaikech.github.io/image-storage/20240410a/fig2.png" alt=""></p>
<p>The following result is obtained.</p>
<p><code>identifiedRegions</code>: This is the cell coordinates of each identified cell region. <code>color</code> is the background color.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;cells&#34;</span>: [<span style="color:#e6db74">&#34;B2&#34;</span>, <span style="color:#e6db74">&#34;B3&#34;</span>, <span style="color:#e6db74">&#34;B4&#34;</span>, <span style="color:#e6db74">&#34;C2&#34;</span>, <span style="color:#e6db74">&#34;C4&#34;</span>, <span style="color:#e6db74">&#34;D2&#34;</span>, <span style="color:#e6db74">&#34;D3&#34;</span>, <span style="color:#e6db74">&#34;D4&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;closed&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;color&#34;</span>: <span style="color:#e6db74">&#34;#ff0000&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;cells&#34;</span>: [<span style="color:#e6db74">&#34;H3&#34;</span>, <span style="color:#e6db74">&#34;I2&#34;</span>, <span style="color:#e6db74">&#34;I4&#34;</span>, <span style="color:#e6db74">&#34;J2&#34;</span>, <span style="color:#e6db74">&#34;J5&#34;</span>, <span style="color:#e6db74">&#34;K3&#34;</span>, <span style="color:#e6db74">&#34;K5&#34;</span>, <span style="color:#e6db74">&#34;L4&#34;</span>, <span style="color:#e6db74">&#34;L5&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;closed&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;color&#34;</span>: <span style="color:#e6db74">&#34;#0000ff&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p><code>res</code>: This is the cell coordinates of uncolored cells in each identified cell region. <code>color</code> is the background color of the surrounding cells.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>  { <span style="color:#f92672">&#34;ranges&#34;</span>: [<span style="color:#e6db74">&#34;C3&#34;</span>], <span style="color:#f92672">&#34;color&#34;</span>: <span style="color:#e6db74">&#34;#ff0000&#34;</span> },
</span></span><span style="display:flex;"><span>  { <span style="color:#f92672">&#34;ranges&#34;</span>: [<span style="color:#e6db74">&#34;I3&#34;</span>, <span style="color:#e6db74">&#34;J3&#34;</span>, <span style="color:#e6db74">&#34;J4&#34;</span>, <span style="color:#e6db74">&#34;K4&#34;</span>], <span style="color:#f92672">&#34;color&#34;</span>: <span style="color:#e6db74">&#34;#0000ff&#34;</span> }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><h1 id="note">Note</h1>
<ul>
<li>I guess that this sample might not be suitable for a large sheet.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2024%2f04%2f10%2fidentifying-colored-cell-regions-in-google-sheets-with-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2024%2f04%2f10%2fidentifying-colored-cell-regions-in-google-sheets-with-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f04%2f10%2fidentifying-colored-cell-regions-in-google-sheets-with-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2024%2f04%2f10%2fidentifying-colored-cell-regions-in-google-sheets-with-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f04%2f10%2fidentifying-colored-cell-regions-in-google-sheets-with-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f04%2f10%2fidentifying-colored-cell-regions-in-google-sheets-with-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2024/04/03/parsing-invoices-using-gemini-1.5-api-with-google-apps-script/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2024/04/03/parsing-invoices-using-gemini-1.5-api-with-google-apps-script/">Parsing Invoices using Gemini 1.5 API with Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2024/04/10/specifying-output-types-for-gemini-api-with-google-apps-script/">Specifying Output Types for Gemini API with Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2024/04/10/specifying-output-types-for-gemini-api-with-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

