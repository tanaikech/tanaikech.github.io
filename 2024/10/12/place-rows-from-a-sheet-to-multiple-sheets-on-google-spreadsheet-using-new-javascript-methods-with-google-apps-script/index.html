<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Place Rows from a Sheet to Multiple Sheets on Google Spreadsheet using New Javascript Methods with Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>X</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Place Rows from a Sheet to Multiple Sheets on Google Spreadsheet using New Javascript Methods with Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>12 Oct 2024, 16:08</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/641d9ff0989951b98eaeca10559932d8">Gists</a></p>
<h1 id="abstract">Abstract</h1>
<p>This report showcases a practical application of Google Apps Script, demonstrating how new JavaScript methods can be used to create a script that automatically transfers selected rows between sheets in a Google Sheet.</p>
<h1 id="introduction">Introduction</h1>
<p>JavaScript, a fundamental pillar of contemporary web development, has experienced a significant rise in popularity due to its versatility and widespread adoption. As JavaScript&rsquo;s influence has expanded, so too has Google Apps Script, a cloud-based scripting language constructed on the V8 JavaScript engine. This evolution has led to the introduction of novel methods and features, thereby expanding the capabilities of developers working within the Google Workspace ecosystem.</p>
<p>In this report, we will delve into a practical application of Google Apps Script, showcasing the effective utilization of these newly introduced methods. Specifically, we will present a sample script designed to automatically transfer selected rows from one sheet to every other sheet within a Google Sheet. By harnessing the enhanced functionalities of modern JavaScript methods, this script demonstrates how developers can create more efficient and streamlined solutions within the Google Apps Script environment. This example provides valuable insights into the potential benefits of adopting these new methods and encourages developers to explore how they can be applied to their own projects.</p>
<h1 id="samples">Samples</h1>
<h2 id="sample-1">Sample 1</h2>
<p>Create a new Google Spreadsheet and put the following values of &ldquo;Input&rdquo; situation.</p>
<p><img src="https://tanaikech.github.io/image-storage/20241012a/fig1.png" alt=""></p>
<p>In this sample, from the &ldquo;main&rdquo; sheet, the 3 sheets &ldquo;ID1&rdquo;, &ldquo;ID2&rdquo;, and &ldquo;ID3&rdquo; are created and the values of each ID are put into each sheet. When a script is created to achieve this goal using a new method of Javascript, it becomes as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample1</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;main&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">keyColumn</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; <span style="color:#75715e">// Column &#34;A&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">groupBy</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sheet</span>
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastRow</span>() <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastColumn</span>())
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">getDisplayValues</span>(),
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">r</span>) =&gt; <span style="color:#a6e22e">r</span>[<span style="color:#a6e22e">keyColumn</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>  ).<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">v</span>, <span style="color:#a6e22e">k</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">k</span>) <span style="color:#f92672">||</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">insertSheet</span>(<span style="color:#a6e22e">k</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">getLastRow</span>() <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">length</span>, <span style="color:#a6e22e">v</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">length</span>).<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">v</span>);
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In this script, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/groupBy">Map.groupBy()</a> is used. When <code>console.log(JSON.stringify([...Map.groupBy(,,,)]))</code> is run to this script, the following value is returned. You can see the rows are split by the values of column &ldquo;A&rdquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>  [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;ID1&#34;</span>,
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;ID1&#34;</span>, <span style="color:#e6db74">&#34;b2&#34;</span>, <span style="color:#e6db74">&#34;c2&#34;</span>, <span style="color:#e6db74">&#34;d2&#34;</span>, <span style="color:#e6db74">&#34;e2&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;ID1&#34;</span>, <span style="color:#e6db74">&#34;b5&#34;</span>, <span style="color:#e6db74">&#34;c5&#34;</span>, <span style="color:#e6db74">&#34;d5&#34;</span>, <span style="color:#e6db74">&#34;e5&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;ID1&#34;</span>, <span style="color:#e6db74">&#34;b6&#34;</span>, <span style="color:#e6db74">&#34;c6&#34;</span>, <span style="color:#e6db74">&#34;d6&#34;</span>, <span style="color:#e6db74">&#34;e6&#34;</span>]
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;ID2&#34;</span>,
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;ID2&#34;</span>, <span style="color:#e6db74">&#34;b3&#34;</span>, <span style="color:#e6db74">&#34;c3&#34;</span>, <span style="color:#e6db74">&#34;d3&#34;</span>, <span style="color:#e6db74">&#34;e3&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;ID2&#34;</span>, <span style="color:#e6db74">&#34;b8&#34;</span>, <span style="color:#e6db74">&#34;c8&#34;</span>, <span style="color:#e6db74">&#34;d8&#34;</span>, <span style="color:#e6db74">&#34;e8&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;ID2&#34;</span>, <span style="color:#e6db74">&#34;b9&#34;</span>, <span style="color:#e6db74">&#34;c9&#34;</span>, <span style="color:#e6db74">&#34;d9&#34;</span>, <span style="color:#e6db74">&#34;e9&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;ID2&#34;</span>, <span style="color:#e6db74">&#34;b10&#34;</span>, <span style="color:#e6db74">&#34;c10&#34;</span>, <span style="color:#e6db74">&#34;d10&#34;</span>, <span style="color:#e6db74">&#34;e10&#34;</span>]
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;ID3&#34;</span>,
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;ID3&#34;</span>, <span style="color:#e6db74">&#34;b4&#34;</span>, <span style="color:#e6db74">&#34;c4&#34;</span>, <span style="color:#e6db74">&#34;d4&#34;</span>, <span style="color:#e6db74">&#34;e4&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;ID3&#34;</span>, <span style="color:#e6db74">&#34;b7&#34;</span>, <span style="color:#e6db74">&#34;c7&#34;</span>, <span style="color:#e6db74">&#34;d7&#34;</span>, <span style="color:#e6db74">&#34;e7&#34;</span>]
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p>For example, when <code>Map.groupBy(,,,)</code> is modified using the method without &ldquo;Map.groupBy()&rdquo;, it becomes as follows.</p>
<p>From:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">groupBy</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sheet</span>
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastRow</span>() <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastColumn</span>())
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getDisplayValues</span>(),
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">r</span>) =&gt; <span style="color:#a6e22e">r</span>[<span style="color:#a6e22e">keyColumn</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><p>To:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">sheet</span>
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastRow</span>() <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastColumn</span>())
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getDisplayValues</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">m</span>, <span style="color:#a6e22e">r</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">k</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">r</span>[<span style="color:#a6e22e">keyColumn</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">set</span>(<span style="color:#a6e22e">k</span>, <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">has</span>(<span style="color:#a6e22e">k</span>) <span style="color:#f92672">?</span> [...<span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">get</span>(<span style="color:#a6e22e">k</span>), <span style="color:#a6e22e">r</span>] <span style="color:#f92672">:</span> [<span style="color:#a6e22e">r</span>]);
</span></span><span style="display:flex;"><span>  }, <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Map</span>());
</span></span></code></pre></div><p>As additional information, when benchmarking &ldquo;Map.groupBy&rdquo; and &ldquo;reduce and Map&rdquo; it was found that &ldquo;Map.groupBy&rdquo; had a processing cost approximately 10 % lower than &ldquo;reduce and Map&rdquo;. This result suggests that &ldquo;Map.groupBy&rdquo; can be used to reduce both the processing cost and the complexity of the script.</p>
<h2 id="sample-2">Sample 2</h2>
<p>In this sample, it supposes that &ldquo;Sample 1&rdquo; has already been finished. And, the Spreadsheet of &ldquo;Sample 1&rdquo; is used.</p>
<p><img src="https://tanaikech.github.io/image-storage/20241012a/fig2.png" alt=""></p>
<p>In this sample, after &ldquo;Sample1&rdquo; was finished, the new data of the &ldquo;main&rdquo; sheet is put into &ldquo;ID1&rdquo;. The duplicated rows are checked. When a script is created to achieve this goal using a new method of Javascript, it becomes as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample2</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;main&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">keyColumn</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; <span style="color:#75715e">// Column &#34;A&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">groupBy</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sheet</span>
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastRow</span>() <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastColumn</span>())
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">getDisplayValues</span>(),
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">r</span>) =&gt; <span style="color:#a6e22e">r</span>[<span style="color:#a6e22e">keyColumn</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>  ).<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">v</span>, <span style="color:#a6e22e">k</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">k</span>) <span style="color:#f92672">||</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">insertSheet</span>(<span style="color:#a6e22e">k</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">dstValues</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Set</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">getDataRange</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">getDisplayValues</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">r</span>) =&gt; <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;&#34;</span>))
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">srcObj</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Map</span>(<span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">r</span>) =&gt; [<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;&#34;</span>), <span style="color:#a6e22e">r</span>]));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">check</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Set</span>(<span style="color:#a6e22e">srcObj</span>.<span style="color:#a6e22e">keys</span>()).<span style="color:#a6e22e">difference</span>(<span style="color:#a6e22e">dstValues</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">check</span>.<span style="color:#a6e22e">size</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> [...<span style="color:#a6e22e">check</span>].<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">srcObj</span>.<span style="color:#a6e22e">get</span>(<span style="color:#a6e22e">e</span>));
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">getRange</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">getLastRow</span>() <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">values</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">length</span>
</span></span><span style="display:flex;"><span>      ).<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">values</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> items were added to the &#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">k</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; sheet.`</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In this script, the rows split by &ldquo;Map.groupBy()&rdquo; are compared with the existing values in each sheet using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set/difference">Set.prototype.difference()</a>. By this, only the new rows are appended to each sheet.</p>
<p>When the script in the forEach loop is modified without using &ldquo;Set.prototype.difference()&rdquo;, it becomes as follows.</p>
<p>From:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">check</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Set</span>(<span style="color:#a6e22e">srcObj</span>.<span style="color:#a6e22e">keys</span>()).<span style="color:#a6e22e">difference</span>(<span style="color:#a6e22e">dstValues</span>);
</span></span></code></pre></div><p>To:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">check</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Set</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">srcObj</span>.<span style="color:#a6e22e">keys</span>().<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">dstValues</span>.<span style="color:#a6e22e">has</span>(<span style="color:#a6e22e">e</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">check</span>.<span style="color:#a6e22e">add</span>(<span style="color:#a6e22e">e</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>As additional information, in this case, when benchmarking &ldquo;Set.prototype.difference&rdquo; and &ldquo;Set, forEach&rdquo; it was found that &ldquo;Set.prototype.difference&rdquo; had a processing cost approximately 40 % higher than &ldquo;Set, forEach&rdquo;. This result suggests that &ldquo;Set.prototype.difference&rdquo; can be used to reduce the complexity of the script while the processing cost is increased. I guess that this might depend on the use case.</p>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2024%2f10%2f12%2fplace-rows-from-a-sheet-to-multiple-sheets-on-google-spreadsheet-using-new-javascript-methods-with-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2024%2f10%2f12%2fplace-rows-from-a-sheet-to-multiple-sheets-on-google-spreadsheet-using-new-javascript-methods-with-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f10%2f12%2fplace-rows-from-a-sheet-to-multiple-sheets-on-google-spreadsheet-using-new-javascript-methods-with-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2024%2f10%2f12%2fplace-rows-from-a-sheet-to-multiple-sheets-on-google-spreadsheet-using-new-javascript-methods-with-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f10%2f12%2fplace-rows-from-a-sheet-to-multiple-sheets-on-google-spreadsheet-using-new-javascript-methods-with-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f10%2f12%2fplace-rows-from-a-sheet-to-multiple-sheets-on-google-spreadsheet-using-new-javascript-methods-with-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2024/10/09/improving-geminis-text-generation-accuracy-with-corpus-managed-by-google-spreadsheet-as-rag/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2024/10/09/improving-geminis-text-generation-accuracy-with-corpus-managed-by-google-spreadsheet-as-rag/">Improving Gemini&#39;s Text Generation Accuracy with Corpus Managed by Google Spreadsheet as RAG</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

