<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>A Novel Approach to Learning: Combining Gemini with Google Apps Script for Automated Q&amp;A &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>X</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>A Novel Approach to Learning: Combining Gemini with Google Apps Script for Automated Q&amp;A</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>08 Aug 2024, 15:05</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/application">application</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/5b472baa500ced516a85e2a24628a03d">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20240808a/fig1.jpg" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>This report proposes a novel learning method using Gemini to automate Q&amp;A generation, addressing the challenges of manual Q&amp;A creation. By integrating with Google tools, this approach aims to enhance learning efficiency, accessibility, and personalization while reducing costs.</p>
<h1 id="introduction">Introduction</h1>
<p>Mastering a new subject often demands a significant time commitment. A proven strategy for efficient learning is through question-and-answer (Q&amp;A) practice. This method typically involves constructing a dataset of pertinent Q&amp;A pairs and subsequently engaging in repeated practice until desired proficiency levels are achieved. While platforms such as Google Forms and Google Apps Script can streamline the Q&amp;A creation and evaluation process, the manual generation of Q&amp;A data remains a time-consuming and expensive endeavor. Minimizing the operational costs associated with scripting is crucial for long-term sustainability.</p>
<p>To overcome this hurdle, we introduce a novel methodology that harnesses the power of Gemini, a large language model, to automate the generation of Q&amp;A data. By streamlining the creation process, we aim to make learning accessible and efficient across a wide range of subjects. Moreover, by meticulously analyzing the history of answered questions, we can pinpoint learners&rsquo; strengths and weaknesses, thereby enabling tailored learning experiences.</p>
<p>This report presents a groundbreaking learning approach that integrates Gemini with widely used Google tools: Forms, Spreadsheets, and Apps Script as an application implemented on Google Spreadsheet. Given the extensive adoption of these Google applications, we anticipate that this method will be widely embraced and yield substantial benefits for a diverse user base.</p>
<p>The repository of this is <a href="https://github.com/tanaikech/A_Novel_Approach_to_Learning">here</a>.</p>
<h1 id="flow-charts">Flow charts</h1>
<p><img src="https://tanaikech.github.io/image-storage/20240808a/fig2.png" alt="">
Fig 1. Learning process with a script and a manual operation.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240808a/fig3.png" alt="">
Fig 2. Learning process with a script and Gemini.</p>
<p>Figures 1 and 2 illustrate the flow of the learning process for two scenarios: (1) using a script and manual operation, and (2) using a script and Gemini. In Fig. 1, the questions are required to be manually prepared. And, when the summary for answers is also required to be manually created. On the other hand, in Fig. 2, when Gemini is used, those can be automatically generated. I created this as an application implemented on Google Spreadsheet.</p>
<p>The following section introduces how to use the application.</p>
<h1 id="usage">Usage</h1>
<h2 id="1-copy-google-spreadsheet">1. Copy Google Spreadsheet</h2>
<p>Please copy a Google Spreadsheet including this application to your Google Drive. So, please access the following URL.</p>
<p><a href="https://docs.google.com/spreadsheets/d/1VPjk-tcr-IZzEihJa6MvKd9ok0rfHPmfcGz_1qYFaNI/copy">https://docs.google.com/spreadsheets/d/1VPjk-tcr-IZzEihJa6MvKd9ok0rfHPmfcGz_1qYFaNI/copy</a></p>
<p>When you open this Spreadsheet, you can see the following 5 sheets.</p>
<ul>
<li><code>dashboard</code>: This sheet is used for setting variables including the API key for using Gemini API and confirming the current situation.</li>
<li><code>comments</code>: When you answer and the value <code>currentAccuracyRate</code> is over <code>targetAccuracyRate</code>, the comment is generated from your answered results as the summary by Gemini.</li>
<li><code>questions</code>: The questions generated by Gemini are put into this sheet. Of course, you can directly modify the questions when you find the modification points.</li>
<li><code>questionsByUser</code>: When you want to include your original questions, please put them into this sheet.</li>
<li><code>archive</code>: When you run &ldquo;Reset&rdquo;, the current questions are moved to this sheet. And, the question sheet is cleared.</li>
</ul>
<p>When you open the script editor of this Spreadsheet, you can see the following script files.</p>
<ul>
<li><code>main.gs</code>: This includes the main methods.</li>
<li><code>ManagementLearning</code>: This includes the main class object.</li>
<li><code>GeminiWithFiles.gs</code>: This is from <a href="https://github.com/tanaikech/GeminiWithFiles">GeminiWithFiles (Author: me)</a>.</li>
</ul>
<h2 id="2-create-an-api-key">2. Create an API key</h2>
<p>Please access <a href="https://ai.google.dev/gemini-api/docs/api-key">https://ai.google.dev/gemini-api/docs/api-key</a> and create your API key. At that time, please enable Generative Language API at the API console. This API key is used for this sample script.</p>
<p>This official document can be also seen. <a href="https://ai.google.dev/">Ref</a>.</p>
<p>Of course, if you can link the Google Cloud Platform Project to the Google Apps Script Project in the copied Spreadsheet, you can also use the access token.</p>
<h2 id="3-setup">3. Setup</h2>
<p>Open the &ldquo;dashboard&rdquo; sheet and enter your API key and the field you want to learn. If you want to use the access token, leave the API key field blank and check the checkbox of &ldquo;useAccessToken&rdquo;. You can also set other parameters as needed.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240808a/fig4.png" alt="">
Fig 3. Dashboard sheet.</p>
<p>You can see the descriptions for each parameter. You are required to set the green color cells. The orange color cells are automatically set by a script and also you can edit. The blue color cells are automatically set by a script.</p>
<p>As a simple setting,</p>
<h2 id="4-testing">4. Testing</h2>
<p><strong>In this application, a Google Spreadsheet is for a single user. Because Google Forms cannot identify each user who opens it.</strong></p>
<p>The current situation can be seen at &ldquo;status&rdquo; of the &ldquo;dashboard&rdquo; sheet as shown in Fig. 3. Please do the following steps. The detailed flow of the script can be seen in Fig. 2.</p>
<ol>
<li>Open the copied Spreadsheet and see the &ldquo;dashboard&rdquo; sheet.</li>
<li>Put your API key into &ldquo;B2&rdquo; of the &ldquo;dashboard&rdquo; sheet.</li>
<li>As a sample field, put &ldquo;Javascript&rdquo; into &ldquo;B6&rdquo; of the &ldquo;dashboard&rdquo; sheet.</li>
<li>You can see the custom menu &ldquo;ManagementLearning&rdquo; on the Spreadsheet. Please run the script from &ldquo;Run&rdquo; from &ldquo;ManagementLearning&rdquo;. By this, a dialog for authorization of the scopes is opened. Please permit them.</li>
<li>When the script of &ldquo;Run&rdquo; is finished, you can see the updated &ldquo;dashboard&rdquo; sheet and &ldquo;questions&rdquo; sheet. <strong>If the &ldquo;dashboard&rdquo; and &ldquo;questions&rdquo; sheets are not updated, please run &ldquo;Run&rdquo; again.</strong> You can see the generated categories and 2 kinds of URLs of a Google Form. When you open the URL <code>googleFormPublishedUrl</code>, you can see the Google Form including the generated questions. As the default, 5 questions are shown in the Google Form. Of course, this can be managed from the dashboard sheet. When you update the dashboard, please run &ldquo;Run&rdquo; again.</li>
<li>Answer the questions in the Google Form and submit them. By this, the value of <code>currentAccuracyRate</code> of the dashboard sheet is updated. When this value is over the value of <code>targetAccuracyRate</code>, the learning is finished and the Google Form is closed. Also, you can see the generated comment in the &ldquo;comments&rdquo; sheet. <strong>About <code>currentAccuracyRate</code>, in this case, for example, when <code>repetitionsForQuestion</code> is 3, after the question was answered 3 times, <code>accuracyRate</code> is calculated. So, when <code>countCorrects</code> and <code>countIncorrects</code> are 2 and 0, respectively, <code>accuracyRate</code> is 0. When <code>countCorrects</code> and <code>countIncorrects</code> are 2 and 1, respectively, <code>accuracyRate</code> is 66.6.</strong></li>
</ol>
<p>About &ldquo;useGemini&rdquo;, when I tested this, I confirmed that there was a case in which no suitable questions were sometimes selected although in most cases, the suitable questions were selected. From this situation, as the default, I used to select questions in the Google Form by the array processing.</p>
<h1 id="additional-information">Additional information</h1>
<h2 id="when-you-want-to-include-your-original-questions">When you want to include your original questions</h2>
<p>When you want to include your original questions, please put them into the &ldquo;questionsByUser&rdquo; sheet. You can confirm the format of the question from the 1st header row. At that time, please use the categories from the categories in the &ldquo;dashboard&rdquo; sheet.</p>
<h2 id="when-you-want-to-manually-change-the-category">When you want to manually change the category</h2>
<p>When you want to manually change the category, please do the following steps.</p>
<ol>
<li>Prepare new categories.</li>
<li>Run &ldquo;Reset&rdquo; from the custom menu &ldquo;ManagementLearning&rdquo; on the Spreadsheet.</li>
<li>Put your new categories on the &ldquo;dashboard&rdquo; sheet.</li>
<li>Run &ldquo;Run&rdquo; from the custom menu &ldquo;ManagementLearning&rdquo; on the Spreadsheet.</li>
</ol>
<h2 id="when-you-want-to-edit-the-questions-in-the-questions-sheet">When you want to edit the questions in the &ldquo;questions&rdquo; sheet</h2>
<p>When you want to edit the questions in the &ldquo;questions&rdquo; sheet, please do the following steps.</p>
<ol>
<li>Edit questions in the &ldquo;questions&rdquo; sheet. At that time, please clear the values <code>countCorrects</code>, <code>countIncorrects</code>, <code>accuracyRate</code>, <code>history</code> if you need.</li>
<li>Run &ldquo;Run&rdquo; from the custom menu &ldquo;ManagementLearning&rdquo; on the Spreadsheet.</li>
</ol>
<h2 id="reason-for-using-5-choice-questions-in-this-application">Reason for using 5 choice questions in this application</h2>
<p>In this application, I used the questions for choosing one of 5 choices. Of course, when Gemini is used, the questions for writing sentences can be used. But, the process cost for deciding the score for the answer was high. So, I selected the questions for choosing.</p>
<h2 id="about-language">About language</h2>
<p>In this application, I used English. But, when Gemini is used, another language can be used. At that time, you can modify the script.</p>
<h1 id="important">IMPORTANT</h1>
<p>When generating questions by Gemini, I confirmed that incorrect questions or answers may sometimes be produced although in most cases, the correct questions and answers were generated. I believe that this will be resolved in the future update. Therefore, in the current stage, I would like to recommend that you check the questions and answers on the &ldquo;questions&rdquo; sheet of the spreadsheet before providing an answer and make corrections if necessary. After you modify them, please run &ldquo;Run&rdquo; from the custom menu &ldquo;ManagementLearning&rdquo; on the Spreadsheet. By this, the current questions are used in the Google Form.</p>
<h1 id="note">Note</h1>
<ul>
<li>The top abstract image was created by <a href="https://gemini.google.com/app">Gemini</a>.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2024%2f08%2f08%2fa-novel-approach-to-learning-combining-gemini-with-google-apps-script-for-automated-qa%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2024%2f08%2f08%2fa-novel-approach-to-learning-combining-gemini-with-google-apps-script-for-automated-qa%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f08%2f08%2fa-novel-approach-to-learning-combining-gemini-with-google-apps-script-for-automated-qa%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2024%2f08%2f08%2fa-novel-approach-to-learning-combining-gemini-with-google-apps-script-for-automated-qa%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f08%2f08%2fa-novel-approach-to-learning-combining-gemini-with-google-apps-script-for-automated-qa%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f08%2f08%2fa-novel-approach-to-learning-combining-gemini-with-google-apps-script-for-automated-qa%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2024/08/04/updated-gas-library-geminiwithfiles/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2024/08/04/updated-gas-library-geminiwithfiles/">Updated: GAS Library - GeminiWithFiles</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2024/08/16/uploading-multiple-files-with-split-asynchronous-processes-and-resumable-upload-in-google-spreadsheets/">Uploading Multiple Files with Split Asynchronous Processes and Resumable Upload in Google Spreadsheets</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2024/08/16/uploading-multiple-files-with-split-asynchronous-processes-and-resumable-upload-in-google-spreadsheets/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

