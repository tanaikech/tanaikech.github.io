<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Empowering Everyone to Leverage Various Google APIs &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Empowering Everyone to Leverage Various Google APIs</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>14 Mar 2024, 14:04</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-api">google api</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/88c180fa4bb35b74b73203f754db2d3c">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20240314a/fig1.png" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>Google offers powerful APIs but using them (except advanced services) can be complex. A new, simpler method would benefit developers creating diverse applications. To address this, I built a Google Apps Script library simplifying API access.</p>
<h1 id="description">Description</h1>
<p>There are numerous powerful Google APIs available today. Google Apps Script streamlines interacting with these APIs through a simplified authorization process. Additionally, advanced Google services integrate seamlessly with Apps Script, making Google APIs highly advantageous for users.</p>
<p>However, utilizing APIs beyond advanced Google services can be challenging for some users. Developing a simpler method for using various Google APIs would significantly increase their accessibility and empower a broader range of users to create diverse applications.</p>
<p>To address this challenge, I recently created a Google Apps Script library called GoogleApiApp that simplifies the process of using various Google APIs.</p>
<p>This library offers the following functionalities:</p>
<ul>
<li>Simplified API Calls: When a valid access token is present, users can directly interact with various Google APIs through Apps Script. This requires providing the API name, the desired method, and the necessary values.</li>
<li>Automatic Pagination: For APIs that utilize pagination through a pageToken, this library automatically retrieves all available items by handling the pageToken internally.</li>
</ul>
<p>The repository of this library is <a href="https://github.com/tanaikech/GoogleApiApp">here</a>.</p>
<h1 id="usage">Usage</h1>
<p>In this report, Google Apps Script is used.</p>
<h2 id="1-create-a-gas-project">1. Create a GAS project.</h2>
<p>Please create a new Google Spreadsheet and open the script editor.</p>
<h2 id="2-install-library">2. Install library</h2>
<p>Please install the library. You can see how to install it at my repository.</p>
<p>The libraryâ€™s project key is <code>1YVWd5qzz0quKljrJkliE143UwwJq1BopoZQSwNEqwNgHOPQ9VeaQeNS7</code>.</p>
<p>When you install this library, the following required scopes are automatically installed.</p>
<ul>
<li><code>https://www.googleapis.com/auth/script.external_request</code></li>
</ul>
<h1 id="important">IMPORTANT</h1>
<p>When you use Google APIs using this library, please enable the APIs you want to use at Advanced Google services or the API console. At that time, it might be required to link the Google Cloud Platform Project to the Google Apps Script Project.</p>
<p>Also, please check the scopes for using the APIs you want to use. When you run the script without setting them, an error occurs. Please be careful about this.</p>
<p>When an error like <code>Request had insufficient authentication scopes.</code> occurs, please include the required scopes and test it again.</p>
<h1 id="flow-of-this-library">Flow of this library</h1>
<h2 id="flow-of-the-library">Flow of the Library:</h2>
<ol>
<li>Discovery URL Retrieval: Obtain the discovery document URL by searching Google APIs using the Google API Discovery Service: <a href="https://developers.google.com/discovery">https://developers.google.com/discovery</a>.</li>
<li>Method Information Retrieval: Extract information about the desired API method from the retrieved discovery document URL.</li>
<li>API Request: Make the API request using the retrieved information.</li>
</ol>
<h2 id="functionality">Functionality:</h2>
<p>This library allows users to interact with Google APIs by simply providing the API name, method name, and necessary parameters. The library automatically constructs the endpoint URL and request method based on the retrieved API information.</p>
<h2 id="limitations">Limitations:</h2>
<p>Currently, the library is limited to Google APIs discoverable through the Google API Discovery Service: <a href="https://developers.google.com/discovery">https://developers.google.com/discovery</a>. This means APIs not registered with this service, like the current version of Gemini API, are not yet supported. However, future updates are expected to expand compatibility.</p>
<h1 id="sample-scripts">Sample scripts</h1>
<p>About the value of <code>apiInf</code> and <code>apiParams</code> in the following sample scripts, for example, when <a href="https://developers.google.com/drive/api/reference/rest/v3/files/update">&ldquo;Method: files.update&rdquo;</a> is used as a sample, each value is as follows. Also, you can see them in the following image.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240314a/fig2.png" alt=""></p>
<p><code>path</code>: The variables in the endpoint. It&rsquo;s <code>fileId</code> of <code>https://www.googleapis.com/upload/drive/v3/files/{fileId}</code>. You can see this at <a href="https://developers.google.com/drive/api/reference/rest/v3/files/update#http-request">HTTP request</a> at the official document.
<code> query</code>: You can see them at <a href="https://developers.google.com/drive/api/reference/rest/v3/files/update#query-parameters">Query parameters</a>. The API key is included in this. You can see this at <a href="https://developers.google.com/drive/api/reference/rest/v3/files/update?apix=true">Try this method</a> at the official document.
<code>requestBody</code>: You can see them at <a href="https://developers.google.com/drive/api/reference/rest/v3/files/update#request-body">Request body</a>. You can create the request body at <a href="https://developers.google.com/drive/api/reference/rest/v3/files/update?apix=true">Try this method</a> at the official document.</p>
<h2 id="sample-1">Sample 1</h2>
<p>In this sample, &ldquo;<a href="https://developers.google.com/drive/api/reference/rest/v3/files/update">Method: files.update</a>&rdquo; is tested.</p>
<p>In this case, please enable Drive API at Advanced Google services. And, please add a scope of <code>https://www.googleapis.com/auth/drive</code>.</p>
<p>When you want to update the filename of a file on Google Drive, the sample script is as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiInf</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">api</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;drive&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;v3&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">methodName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;files.update&#34;</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiParams</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">fileId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span> }, <span style="color:#75715e">// Please set your file ID.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">query</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">fields</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;id,name&#34;</span> },
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">requestBody</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;new filename&#34;</span> },
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">GoogleApiApp</span>.<span style="color:#a6e22e">setAPIInf</span>(<span style="color:#a6e22e">apiInf</span>).<span style="color:#a6e22e">setAPIParams</span>(<span style="color:#a6e22e">apiParams</span>).<span style="color:#a6e22e">request</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">getContentText</span>());
</span></span></code></pre></div><h2 id="sample-2">Sample 2</h2>
<p>In this sample, &ldquo;<a href="https://developers.google.com/drive/api/reference/rest/v3/files/get">Method: files.get</a>&rdquo; is tested.</p>
<p>In this case, please enable Drive API at Advanced Google services. And, please add one of the scopes of <code>https://www.googleapis.com/auth/drive</code>, <code>https://www.googleapis.com/auth/drive.readonly</code>.</p>
<p>When you want to download a file, the sample script is as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiInf</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">api</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;drive&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;v3&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">methodName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;files.get&#34;</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiParams</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">fileId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span> }, <span style="color:#75715e">// Please set your file ID. In this case, please set the file ID of the files except for Google Docs files.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">query</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">alt</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;media&#34;</span> },
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">GoogleApiApp</span>.<span style="color:#a6e22e">setAPIInf</span>(<span style="color:#a6e22e">apiInf</span>).<span style="color:#a6e22e">setAPIParams</span>(<span style="color:#a6e22e">apiParams</span>).<span style="color:#a6e22e">request</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">getBlob</span>(); <span style="color:#75715e">// This is a blob of the downloaded file.
</span></span></span></code></pre></div><ul>
<li>
<p><code>request</code> method returns 2 pattern objects like <code>UrlFetchApp.HTTPResponse</code> or <code>String[]</code>. When <code>usePageToken: true</code> is NOT used, <code>UrlFetchApp.HTTPResponse</code> is returned. When <code>usePageToken: true</code> is used, <code>String[]</code> is returned. So, the following script can be used for both patterns.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">GoogleApiApp</span>.<span style="color:#a6e22e">setAPIInf</span>(<span style="color:#a6e22e">apiInf</span>).<span style="color:#a6e22e">setAPIParams</span>(<span style="color:#a6e22e">apiParams</span>).<span style="color:#a6e22e">request</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (Array.<span style="color:#a6e22e">isArray</span>(<span style="color:#a6e22e">res</span>)) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>);
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">getContentText</span>()); <span style="color:#75715e">// and/or const blob = res.getBlob();
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div></li>
</ul>
<h2 id="sample-3">Sample 3</h2>
<p>In this sample, &ldquo;<a href="https://developers.google.com/apps-script/api/reference/rest/v1/projects/getContent">Method: projects.getContent</a>&rdquo; is tested.</p>
<p>In this case, please link the Google Cloud Platform Project to the Google Apps Script Project. And enable Apps Script API at the API console. And, please add one of the scopes of <code>https://www.googleapis.com/auth/script.projects</code> and <code>https://www.googleapis.com/auth/script.projects.readonly</code>.</p>
<p>When you want to retrieve the scripts from the Google Apps Script project, the sample script is as follows. In this case, <a href="https://developers.google.com/apps-script/api/reference/rest/v1/projects/getContent">Method: projects.getContent</a> of Apps Script API v1 is used.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiInf</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">api</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;script&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;v1&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">methodName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;projects.getContent&#34;</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiParams</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">scriptId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span> }, <span style="color:#75715e">// Please set your script ID.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">GoogleApiApp</span>.<span style="color:#a6e22e">setAPIInf</span>(<span style="color:#a6e22e">apiInf</span>).<span style="color:#a6e22e">setAPIParams</span>(<span style="color:#a6e22e">apiParams</span>).<span style="color:#a6e22e">request</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">getContentText</span>());
</span></span></code></pre></div><h2 id="sample-4">Sample 4</h2>
<p>In this sample, &ldquo;<a href="https://developers.google.com/forms/api/reference/rest/v1/forms/get">Method: forms.get</a>&rdquo; is tested.</p>
<p>In this case, please link the Google Cloud Platform Project to the Google Apps Script Project. And, enables Forms API at the API console. And, please add one of the scopes of <code>https://www.googleapis.com/auth/script.projects</code> and <code>https://www.googleapis.com/auth/script.projects.readonly</code>.</p>
<p>When you want to retrieve a Google Form with Google Forms API v1, the sample script is as follows. In this case, <a href="https://developers.google.com/forms/api/reference/rest/v1/forms/get">Method: forms.get</a> of Forms API v1 is used.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiInf</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">api</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;forms&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;v1&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">methodName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;forms.get&#34;</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiParams</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">formId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span> }, <span style="color:#75715e">//  Please set your Google Form ID.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">GoogleApiApp</span>.<span style="color:#a6e22e">setAPIInf</span>(<span style="color:#a6e22e">apiInf</span>).<span style="color:#a6e22e">setAPIParams</span>(<span style="color:#a6e22e">apiParams</span>).<span style="color:#a6e22e">request</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">getContentText</span>());
</span></span></code></pre></div><h2 id="sample-5-automatic-pagination">Sample 5: Automatic Pagination</h2>
<p>In this sample, &ldquo;<a href="https://developers.google.com/drive/api/reference/rest/v3/files/list">Method: files.list</a>&rdquo; is tested.</p>
<p>In this case, please enable Drive API at Advanced Google services. And, please add one of the scopes of <code>https://www.googleapis.com/auth/drive</code>, <code>https://www.googleapis.com/auth/drive.readonly</code>, <code>https://www.googleapis.com/auth/drive.metadata.readonly</code>.</p>
<p>When you want to retrieve the file and folder list in your Google Drive, the sample script is as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiInf</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">api</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;drive&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;v3&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">methodName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;files.list&#34;</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiParams</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">query</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">orderBy</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;name&#34;</span>, <span style="color:#a6e22e">fields</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;files(id,name)&#34;</span> },
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">usePageToken</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">GoogleApiApp</span>.<span style="color:#a6e22e">setAPIInf</span>(<span style="color:#a6e22e">apiInf</span>).<span style="color:#a6e22e">setAPIParams</span>(<span style="color:#a6e22e">apiParams</span>).<span style="color:#a6e22e">request</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>);
</span></span></code></pre></div><ul>
<li>In this case, when <code>usePageToken: true</code> is used, all files and folders are retrieved using <code>pageToken</code>. In this case, all methods of the Google APIs using <code>pageToken</code> can be used. When <code>usePageToken: true</code> is not used, only one page is retrieved. I believe that this will be an important point of this library.</li>
</ul>
<p>As another sample, &ldquo;<a href="https://developers.google.com/drive/api/reference/rest/v3/comments/list">Method: comments.list</a>&rdquo; is tested. When you want to retrieve all comments from a file, you can use the following sample script.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiInf</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">api</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;drive&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;v3&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">methodName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;comments.list&#34;</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiParams</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">fileId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span>, <span style="color:#75715e">// Please set your file ID.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">usePageToken</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">GoogleApiApp</span>.<span style="color:#a6e22e">setAPIInf</span>(<span style="color:#a6e22e">apiInf</span>).<span style="color:#a6e22e">setAPIParams</span>(<span style="color:#a6e22e">apiParams</span>).<span style="color:#a6e22e">request</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>);
</span></span></code></pre></div><h2 id="sample-6-automatic-pagination">Sample 6: Automatic Pagination</h2>
<p>In this sample, &ldquo;<a href="https://developers.google.com/people/api/rest/v1/people.connections/list">Method: people.connections.list</a>&rdquo; is tested.</p>
<p>In this case, please enable People API at Advanced Google services. And, please add one of the scopes of <code>https://www.googleapis.com/auth/contacts</code>, <code>https://www.googleapis.com/auth/contacts.readonly</code>.</p>
<p>The sample script is as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiInf</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">api</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;people&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;v1&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">methodName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;people.connections.list&#34;</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiParams</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">resourceName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;people/me&#34;</span> },
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">query</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">personFields</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;emailAddresses&#34;</span> },
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">usePageToken</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">GoogleApiApp</span>.<span style="color:#a6e22e">setAPIInf</span>(<span style="color:#a6e22e">apiInf</span>).<span style="color:#a6e22e">setAPIParams</span>(<span style="color:#a6e22e">apiParams</span>).<span style="color:#a6e22e">request</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>);
</span></span></code></pre></div><h2 id="sample-7-automatic-pagination">Sample 7: Automatic Pagination</h2>
<p>In this sample, &ldquo;<a href="https://developers.google.com/classroom/reference/rest/v1/courses/list">Method: courses.list</a>&rdquo; is tested.</p>
<p>In this case, please enable Classroom API at Advanced Google services. And, please add one of the scopes of <code>https://www.googleapis.com/auth/classroom.courses</code>, <code>https://www.googleapis.com/auth/classroom.courses.readonly</code>.</p>
<p>The sample script is as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiInf</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">api</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;classroom&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;v1&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">methodName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;courses.list&#34;</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiParams</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">usePageToken</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">GoogleApiApp</span>.<span style="color:#a6e22e">setAPIInf</span>(<span style="color:#a6e22e">apiInf</span>).<span style="color:#a6e22e">setAPIParams</span>(<span style="color:#a6e22e">apiParams</span>).<span style="color:#a6e22e">request</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>);
</span></span></code></pre></div><h2 id="sample-8-automatic-pagination">Sample 8: Automatic Pagination</h2>
<p>In this sample, &ldquo;<a href="https://developers.google.com/youtube/v3/docs/videos/list">Videos: list</a>&rdquo; is tested.</p>
<p>In this case, please enable YouTube API at Advanced Google services. And, please add one of the scope of <code>https://www.googleapis.com/auth/youtube</code>.</p>
<p><strong>By the way, in this API, it seems that <code>methodName</code> is <code>videos.list</code>.</strong></p>
<p>The sample script is as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiInf</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">api</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;youtube&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;v3&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">methodName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;videos.list&#34;</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiParams</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">query</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">part</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;id&#34;</span>, <span style="color:#a6e22e">chart</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;mostPopular&#34;</span> },
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">usePageToken</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">GoogleApiApp</span>.<span style="color:#a6e22e">setAPIInf</span>(<span style="color:#a6e22e">apiInf</span>).<span style="color:#a6e22e">setAPIParams</span>(<span style="color:#a6e22e">apiParams</span>).<span style="color:#a6e22e">request</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>);
</span></span></code></pre></div><h1 id="note">Note</h1>
<ul>
<li>I tested this library with Google APIs I often use. But, I cannot test all Google APIs. When I found the APIs that cannot be used with this library, I would like to add them.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2024%2f03%2f14%2fempowering-everyone-to-leverage-various-google-apis%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2024%2f03%2f14%2fempowering-everyone-to-leverage-various-google-apis%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f03%2f14%2fempowering-everyone-to-leverage-various-google-apis%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2024%2f03%2f14%2fempowering-everyone-to-leverage-various-google-apis%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f03%2f14%2fempowering-everyone-to-leverage-various-google-apis%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f03%2f14%2fempowering-everyone-to-leverage-various-google-apis%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2024/03/11/updated-gas-library-onedriveapp/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2024/03/11/updated-gas-library-onedriveapp/">Updated: GAS Library - OnedriveApp</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

