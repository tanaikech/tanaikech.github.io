<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Analyzing Trends of Google Apps Script from Questions on Stackoverflow using Gemini 1.5 API &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Analyzing Trends of Google Apps Script from Questions on Stackoverflow using Gemini 1.5 API</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Mar 2024, 14:28</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/stackoverflow">Stackoverflow</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/ai">AI</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/llm">LLM</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/stackoverflow">Stackoverflow</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/8621c3b799685fd2db1204d1372e1d73">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20240330b/fig1.png" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>A new large language model (LLM) called Gemini with an API is now available, allowing developers to analyze vast amounts of data. This report explores trends in Google Apps Script by using the Gemini 1.5 API to analyze questions on Stack Overflow.</p>
<h1 id="introduction">Introduction</h1>
<p>The release of the LLM model Gemini as an API on Vertex AI and Google AI Studio has opened a world of possibilities. <a href="https://deepmind.google/technologies/gemini/#introduction">Ref</a> The Gemini API significantly expands the potential of various scripting languages, paving the way for diverse applications. Additionally, Gemini 1.5 has recently been released in AI Studio. <a href="https://blog.google/technology/ai/google-gemini-next-generation-model-february-2024/#sundar-note">Ref</a> We can expect the Gemini 1.5 API to follow suit soon.</p>
<p>The difference between Gemini 1.0 and Gemini 1.5 is as following table created by Gemini.</p>
<p><a href="https://gist.github.com/tanaikech/157bb4778149429e865d37312ad8a5da">https://gist.github.com/tanaikech/157bb4778149429e865d37312ad8a5da</a></p>
<table>
<thead>
<tr>
<th style="text-align:left">Feature</th>
<th style="text-align:left">Gemini 1.0</th>
<th style="text-align:left">Gemini 1.5</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Number of parameters</td>
<td style="text-align:left">1.5T</td>
<td style="text-align:left">540B</td>
</tr>
<tr>
<td style="text-align:left">Training data</td>
<td style="text-align:left">1.56T words</td>
<td style="text-align:left">1.56T words</td>
</tr>
<tr>
<td style="text-align:left">Model architecture</td>
<td style="text-align:left">Transformer-based decoder-only</td>
<td style="text-align:left">Transformer-based decoder-only with MoE</td>
</tr>
<tr>
<td style="text-align:left">Context window size</td>
<td style="text-align:left">32k tokens</td>
<td style="text-align:left">1M tokens</td>
</tr>
<tr>
<td style="text-align:left">Inference speed</td>
<td style="text-align:left">10x faster than GPT-3</td>
<td style="text-align:left">2x faster than Gemini 1.0</td>
</tr>
<tr>
<td style="text-align:left">Performance on language benchmarks</td>
<td style="text-align:left">SOTA on GLUE, SuperGLUE, and CoQA</td>
<td style="text-align:left">SOTA on GLUE, SuperGLUE, CoQA, and Winograd Schema Challenge</td>
</tr>
<tr>
<td style="text-align:left">Availability</td>
<td style="text-align:left">Invite-only beta</td>
<td style="text-align:left">Public beta</td>
</tr>
</tbody>
</table>
<p>Given Gemini 1.5&rsquo;s ability to analyze large data, this report leverages the Gemini 1.5 API to analyze trends in Google Apps Script from the data of questions on Stackoverflow. We achieve this by examining all questions tagged <code>google-apps-script</code> from 2008 to 2024 (only 2024, from January to March 28) on Stack Overflow.</p>
<h1 id="step">Step</h1>
<p>The steps of this analysis are as follows.</p>
<h2 id="1-retrieve-questions-from-stackoverflow">1. Retrieve questions from Stackoverflow</h2>
<p><img src="https://tanaikech.github.io/image-storage/20240330b/fig2.png" alt=""></p>
<p>As the base data of Stackoverflow, I used the data retrieved at &ldquo;<a href="https://medium.com/google-cloud/trend-of-google-apps-script-tag-on-stackoverflow-2024-584e20fb892c">Trend of google-apps-script Tag on Stackoverflow 2024</a>&rdquo;. In that report, all questions including a tag <code>google-apps-script</code> from 2008 to 2024 have already been retrieved. The data from January 1, 2024, to March 28, 2024, was retrieved in this report. All data is retrieved by StackExchange API. <a href="https://api.stackexchange.com/docs">Ref</a> This flow can be seen in the above image. As a result, 17 CSV files including the data from Stackoverflow were created. The total number of questions including <code>google-apps-script</code> tag from 2008 to March 28, 2024, on Stackoverflow was 54,135.</p>
<h2 id="2-generate-texts-for-each-year">2. Generate texts for each year</h2>
<p><img src="https://tanaikech.github.io/image-storage/20240330b/fig3.png" alt=""></p>
<p>As the next step, each summary is created from the retrieved 17 CSV files using Gemini 1.5 API. Because in the current stage, all 17 CSV data cannot be directly used by one API call. So, I separated them. This flow can be seen in the above image. By this flow, a text file including the summaries of each year was created.</p>
<h2 id="3-generate-text-from-all-year">3. Generate text from all year</h2>
<p><img src="https://tanaikech.github.io/image-storage/20240330b/fig4.png" alt=""></p>
<p>As the next step, a summary is created from a text file including summaries from 2008 to 2024. This flow can be seen in the above image. By this flow, the summary of all data from 2008 to 2024 is created.</p>
<h1 id="usage">Usage</h1>
<p>In order to test this script, please do the following steps.</p>
<h2 id="1-create-an-api-key">1. Create an API key</h2>
<p>Please access <a href="https://makersuite.google.com/app/apikey">https://makersuite.google.com/app/apikey</a> and create your API key. At that time, please enable Generative Language API at the API console. This API key is used for this sample script.</p>
<p>This official document can be also seen. <a href="https://ai.google.dev/">Ref</a>.</p>
<h2 id="2-create-a-google-apps-script-project">2. Create a Google Apps Script project</h2>
<p>In this report, Google Apps Script is used. Of course, the method introducing this report can be also used in other languages.</p>
<p>Please create a standalone Google Apps Script project. Of course, this script can be also used with the container-bound script.</p>
<p>And, please open the script editor of the Google Apps Script project.</p>
<h2 id="3-base-data">3. Base data</h2>
<p>Here, prepare the data as described in the section &ldquo;1. Retrieve questions from Stack Overflow.&rdquo; In this report, we focus on the values of &ldquo;creation_date,&rdquo; &ldquo;title,&rdquo; &ldquo;score,&rdquo; and &ldquo;tags.&rdquo; While I initially wanted to include the body of the question, it significantly increased the number of tokens for processing. Therefore, the body was excluded. However, I believe the trend can still be obtained from the remaining values: &ldquo;creation_date,&rdquo; &ldquo;title,&rdquo; &ldquo;score,&rdquo; and &ldquo;tags.&rdquo;</p>
<h2 id="4-base-script">4. Base script</h2>
<p>The base script for processing this analysis is as follows. Please copy and paste the following script to the script editor of Google Apps Script and save the script.</p>
<p>In this script, the model <code>models/gemini-1.5-pro-latest</code> was used for generating texts.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Sample script for this report.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DoGemini</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @param {Object} object Object using this library.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">constructor</span>(<span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {}) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">model</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;models/gemini-1.5-pro-latest&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">baseUrl</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`https://generativelanguage.googleapis.com/v1beta/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">model</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">||</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">headers</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">apiKey</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">?</span> <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">authorization</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Bearer </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">token</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">getOAuthToken</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">retry</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">folderId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">folderId</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#34;root&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Create summaries for each year of the data.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @returns {String} A file ID of the file including the created summaries.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">createSummariesOfEachYear</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">headerText</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;creation_date&#34;</span>, <span style="color:#e6db74">&#34;title&#34;</span>, <span style="color:#e6db74">&#34;score&#34;</span>, <span style="color:#e6db74">&#34;tags&#34;</span>].<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;,&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">files</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFolderById</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">folderId</span>).<span style="color:#a6e22e">getFilesByType</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">MimeType</span>.<span style="color:#a6e22e">CSV</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fileList</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">hasNext</span>()) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">next</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">csv</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getBlob</span>().<span style="color:#a6e22e">getDataAsString</span>().<span style="color:#a6e22e">trim</span>() <span style="color:#f92672">||</span> <span style="color:#e6db74">&#34;No data.&#34;</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">filename</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getName</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">fileList</span>.<span style="color:#a6e22e">push</span>({ <span style="color:#a6e22e">filename</span>, <span style="color:#a6e22e">csv</span> });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">fileList</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;No CSV files.&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fileList</span>.<span style="color:#a6e22e">sort</span>((<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) =&gt; (<span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">filename</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">filename</span> <span style="color:#f92672">?</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`--- File list\n</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fileList</span>.<span style="color:#a6e22e">map</span>(({ <span style="color:#a6e22e">filename</span> <span style="color:#e6db74">}</span><span style="color:#e6db74">) =&gt; filename),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        null,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        2
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      )}`</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">fileList</span>.<span style="color:#a6e22e">map</span>(({ <span style="color:#a6e22e">filename</span>, <span style="color:#a6e22e">csv</span> }) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Now processing: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">filename</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">q</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`Summary the trend from the following CSV data. The CSV data is questions related to Google Apps Script in Stackoverflow. Namely, summarize the trend of questions on Stackoverflow from CSV data.`</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`Consider the creation date of the first column.`</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`Consider the affection of the advent of AI.`</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`Consider the history of Google Apps Script.`</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`Include a value, that you evaluated the activity level of Google Apps Script between 1 and 100, in the response without overestimating.`</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">``</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">filename</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`The format of CSV data is as follows.`</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">``</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`[Format of CSV data]`</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`Created date of the question, Title of the question, Score of the question, Tags related to the question`</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">``</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`[CSV data]`</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">headerText</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">csv</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>      ].<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;\n&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">summary</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">generateContent_</span>(<span style="color:#a6e22e">q</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> { <span style="color:#a6e22e">filename</span>, ...<span style="color:#a6e22e">summary</span> };
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFolderById</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">folderId</span>)
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">createFile</span>(<span style="color:#e6db74">&#34;summariesOfEachYear.txt&#34;</span>, <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">res</span>))
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">getId</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Create a summary of all years.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @param {String} fileId File ID including summaries of each year.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @returns {String} A file ID of the file including the created summary.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">createSummaryOfAllYears</span>(<span style="color:#a6e22e">fileId</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">fileId</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Please set the file ID of the file including summaries of each year.&#34;</span>
</span></span><span style="display:flex;"><span>      );
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">headerText</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;year&#34;</span>, <span style="color:#e6db74">&#34;summary&#34;</span>].<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;,&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">fileId</span>).<span style="color:#a6e22e">getBlob</span>().<span style="color:#a6e22e">getDataAsString</span>()
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">csv</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">filename</span><span style="color:#e6db74">}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">response</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>).<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;\n&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// const csv = data.map(e =&gt; `${e.filename},&#39;${JSON.stringify(e.response).replace(/&#39;/, &#34;\&#39;&#34;)}&#39;`).join(&#34;\n&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">q</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`Summary the trend from the following CSV data. The CSV data is the summary of trend of questions related to Google Apps Script in Stackoverflow every year. The summaries were created by Gemini API.`</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`Consider the each year of the first column.`</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`Consider the affection of the advent of AI.`</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`Consider the history of Google Apps Script.`</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`At the last of summary, add all values, that you evaluated the activity level of Google Apps Script between 1 and 100, in the response without overestimating. Output the values as an array. The array format is [[&#34;year&#34;, &#34;activity value&#34;],[&#34;year&#34;, &#34;activity value&#34;],,,].`</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">``</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`The format of CSV data is as follows.`</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">``</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`[Format of CSV data]`</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`year, Summary of trend of questions`</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">``</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`[CSV data]`</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">headerText</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">csv</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>    ].<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;\n&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">response</span> } <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">generateContent_</span>(<span style="color:#a6e22e">q</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFolderById</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">folderId</span>)
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">createFile</span>(<span style="color:#e6db74">&#34;summaryOfAllYears.txt&#34;</span>, <span style="color:#a6e22e">response</span>)
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">getId</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Count tokens of inputted values with Gemini API.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @param {Object} options Object for UrlFetchApp.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @returns {Object} totalTokens
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">countToken_</span>(<span style="color:#a6e22e">options</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">baseUrl</span><span style="color:#e6db74">}</span><span style="color:#e6db74">:countTokens`</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">`?key=</span><span style="color:#e6db74">${</span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">apiKey</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">fetch_</span>({ <span style="color:#a6e22e">url</span>, ...<span style="color:#a6e22e">options</span> });
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">getContentText</span>());
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Generate content with Gemini API.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @param {String} q Text for prompt.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @returns {UrlFetchApp.HTTPResponse|String[]} Response from API. When pageToken is used, String[] is returned.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">generateContent_</span>(<span style="color:#a6e22e">q</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">payload</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">contents</span><span style="color:#f92672">:</span> [{ <span style="color:#a6e22e">parts</span><span style="color:#f92672">:</span> [{ <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">q</span> }], <span style="color:#a6e22e">role</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;user&#34;</span> }] };
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">options</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">payload</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">payload</span>),
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">contentType</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">muteHttpExceptions</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">headers</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">options</span>.<span style="color:#a6e22e">headers</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">headers</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">totalTokens</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">countToken_</span>(<span style="color:#a6e22e">options</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">totalTokens</span>); <span style="color:#75715e">// Confirm the total tokens in the log.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">baseUrl</span><span style="color:#e6db74">}</span><span style="color:#e6db74">:generateContent`</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">`?key=</span><span style="color:#e6db74">${</span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">apiKey</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">fetch_</span>({ <span style="color:#a6e22e">url</span>, ...<span style="color:#a6e22e">options</span> });
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">getContentText</span>());
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">candidates</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">candidates</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">candidates</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">content</span>.<span style="color:#a6e22e">parts</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    ) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> { <span style="color:#a6e22e">totalTokens</span>, <span style="color:#a6e22e">response</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">candidates</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">content</span>.<span style="color:#a6e22e">parts</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">text</span> };
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">retry</span><span style="color:#f92672">--</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">warn</span>(<span style="color:#e6db74">&#34;No response. Retry again.&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">retry</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">generateContent_</span>(<span style="color:#a6e22e">q</span>);
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;No response.&#34;</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * ### Description
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Request Gemini API.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @param {Object} obj Object for using UrlFetchApp.fetchAll.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * @returns {UrlFetchApp.HTTPResponse} Response from API.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fetch_</span>(<span style="color:#a6e22e">obj</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">muteHttpExceptions</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetchAll</span>([<span style="color:#a6e22e">obj</span>])[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">getResponseCode</span>() <span style="color:#f92672">!=</span> <span style="color:#ae81ff">200</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">getContentText</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="5-script-for-generate-texts-for-each-year">5. Script for &ldquo;Generate texts for each year&rdquo;</h2>
<p>This script creates a text file including summaries from 2008 to 2024. The file is created in the same folder as the CSV files. Of course, you can also see each summary from the file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">process1</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set your API key.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">apiKey</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">folderId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span>, <span style="color:#75715e">// Please set the folder ID of the folder including 17 CSV files including data from Stackoverflow.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">dg</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">DoGemini</span>(<span style="color:#a6e22e">object</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">dg</span>.<span style="color:#a6e22e">createSummariesOfEachYear</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When this script is run, the number of tokens for each year can be seen at the following chart.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240330b/fig5.png" alt=""></p>
<p>This chart reveals that the number of tokens exceeds 32,000 in most years. In this context, the Gemini 1.5 API has proven to be a valuable tool.</p>
<h2 id="6-script-for-generate-text-from-all-year">6. Script for &ldquo;Generate text from all year&rdquo;</h2>
<p>This script creates a text file of a summary of the trend of all questions including a tag <code>google-apps-script</code> posted from 2008 to 2024. In this case, the result file is created in the root folder.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">process2</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set your API key.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fileId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the file ID of a text file including summaries of each year.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">apiKey</span> };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">dg</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">DoGemini</span>(<span style="color:#a6e22e">object</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">dg</span>.<span style="color:#a6e22e">createSummaryOfAllYears</span>(<span style="color:#a6e22e">fileId</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="result">Result</h1>
<p>When the above scripts are run, the following result is obtained.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>## Summary of Google Apps Script Activity on Stack Overflow:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Based on the provided summaries of Google Apps Script questions on Stack Overflow from 2008 to 2024, we can observe the following trends:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>**Early Stage (2008-2009):**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>* Minimal activity as the platform was in its early stages of development and adoption.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>**Growth and Adoption (2010 onwards):**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>* Gradual increase in questions, indicating growing interest and adoption.
</span></span><span style="display:flex;"><span>* Focus on basic functionalities initially, followed by more complex and diverse topics as the platform matured.
</span></span><span style="display:flex;"><span>* Active community participation and knowledge sharing.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>**Impact of AI:**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>* While not explicitly evident in the earlier data, the potential for AI integration with Google Apps Script is recognized and may influence future trends.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>**Activity Level:**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>* Estimated activity level between **60 and 70 out of 100**, indicating a healthy and active community with room for further growth.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>**Specific Observations:**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>* Common topics include:
</span></span><span style="display:flex;"><span>    * Basic syntax and functionality
</span></span><span style="display:flex;"><span>    * Integration with Google Sheets, Forms, and other Google products
</span></span><span style="display:flex;"><span>    * Email automation
</span></span><span style="display:flex;"><span>    * Data manipulation
</span></span><span style="display:flex;"><span>    * Triggering scripts
</span></span><span style="display:flex;"><span>    * Web app development
</span></span><span style="display:flex;"><span>* Recurring challenges faced by users:
</span></span><span style="display:flex;"><span>    * Authorization and permission errors
</span></span><span style="display:flex;"><span>    * Understanding specific methods and syntax
</span></span><span style="display:flex;"><span>    * Debugging scripts
</span></span><span style="display:flex;"><span>    * Optimizing script performance
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>**Overall, the data suggests a steady and ongoing interest in Google Apps Script, with a growing user base and increasingly complex use cases. While AI integration is not yet a dominant theme, it has the potential to influence future trends and applications.**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>**Estimated Activity Levels:**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Based on the analysis of each year&#39;s data, here&#39;s an array summarizing the estimated activity levels of Google Apps Script on Stack Overflow:
</span></span></code></pre></div><p>[
[&ldquo;2008-2009&rdquo;, 10], // Estimated low activity due to early stage
[&ldquo;2010-2011&rdquo;, 30], // Moderate activity during early growth
[&ldquo;2011-2012&rdquo;, 60], // Increasing activity and diversification of topics
[&ldquo;2012-2013&rdquo;, 60], // Steady growth and expanding capabilities
[&ldquo;2013-2014&rdquo;, 60], // Moderately active and engaged community
[&ldquo;2014-2015&rdquo;, 65], // Consistent activity with focus on both basic and advanced functionalities
[&ldquo;2015-2016&rdquo;, 75], // Healthy and active community, diverse topics covered
[&ldquo;2016-2017&rdquo;, 70], // Consistent activity, focus on integrations and web app development
[&ldquo;2017-2018&rdquo;, 70], // Steady interest, diverse use cases, and demand for advanced functionalities
[&ldquo;2018-2019&rdquo;, 65], // Consistent activity, potential for future AI integration
[&ldquo;2019-2020&rdquo;, 65], // Sustained interest, potential influence of AI in automation
[&ldquo;2020-2021&rdquo;, 65], // Consistent activity, continued relevance and adoption
[&ldquo;2021-2022&rdquo;, 75], // Vibrant and active community, growing adoption and complex use cases
[&ldquo;2022-2023&rdquo;, 75], // Consistent activity, potential for AI integration in specific areas
[&ldquo;2023-2024&rdquo;, 65], // Steady interest, focus on basic functionalities and integrations
]</p>
<pre tabindex="0"><code>
**Note:** These activity levels are estimations based on the provided data and general knowledge of Google Apps Script&#39;s adoption and development. A more precise assessment would require access to a larger dataset and more detailed information about question topics and user engagement.
</code></pre><p>When the activity level is evaluated by Gemini 1.5 API for each year is exported as a chart, it becomes as follows.</p>
<p><img src="https://tanaikech.github.io/image-storage/20240330b/fig6.png" alt=""></p>
<p>The above results confirm various insights about the trend of Google Apps Script on Stack Overflow. Additionally, the Gemini 1.5 API emerged as a valuable tool for data analysis.</p>
<h1 id="note">Note</h1>
<ul>
<li>The top illustration was created by <a href="https://gemini.google.com/">Gemini</a> with giving the abstract.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2024%2f03%2f30%2fanalyzing-trends-of-google-apps-script-from-questions-on-stackoverflow-using-gemini-1.5-api%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2024%2f03%2f30%2fanalyzing-trends-of-google-apps-script-from-questions-on-stackoverflow-using-gemini-1.5-api%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f03%2f30%2fanalyzing-trends-of-google-apps-script-from-questions-on-stackoverflow-using-gemini-1.5-api%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2024%2f03%2f30%2fanalyzing-trends-of-google-apps-script-from-questions-on-stackoverflow-using-gemini-1.5-api%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f03%2f30%2fanalyzing-trends-of-google-apps-script-from-questions-on-stackoverflow-using-gemini-1.5-api%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2024%2f03%2f30%2fanalyzing-trends-of-google-apps-script-from-questions-on-stackoverflow-using-gemini-1.5-api%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2024/03/30/generating-texts-using-files-uploaded-by-gemini-1.5-api/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2024/03/30/generating-texts-using-files-uploaded-by-gemini-1.5-api/">Generating Texts using Files Uploaded by Gemini 1.5 API</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2024/04/01/technique-for-appending-values-to-specific-columns-on-google-spreadsheet-using-google-apps-script/">Technique for Appending Values to Specific Columns on Google Spreadsheet using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2024/04/01/technique-for-appending-values-to-specific-columns-on-google-spreadsheet-using-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

