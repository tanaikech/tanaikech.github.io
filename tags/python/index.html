<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="Official profile of Kanshi Tanaike, a Google Developer Expert (GDE) in Google Workspace and Physicist. Specializing in Google Apps Script, Gemini API, and innovative IT solutions.">
  <meta name="generator" content="Hugo 0.157.0">

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tanaikech.github.io/img/og-main.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>tanaike - Google Apps Script, Gemini API Expert & Physicist</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  
  <link rel="alternate" type="application/rss+xml" title="tanaike - Google Apps Script, Gemini API, and Developer Tips"
    href='https://tanaikech.github.io/tags/python/index.xml' />
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Kanshi Tanaike",
  "alternateName": "tanaike",
  "url": "https://tanaikech.github.io/",
  "image": "https://tanaikech.github.io/img/og-main.png",
  "jobTitle": "Google Developer Expert",
  "honorificPrefix": "Ph.D.",
  "description": "Japanese scientist, Physicist and Google Developer Expert for Google Workspace.",
  "award": "First place in the Outstanding GDE Award 2025",
  "sameAs": [
    "https://twitter.com/tanaikech",
    "https://github.com/tanaikech",
    "https://stackoverflow.com/users/7108653/tanaike",
    "https://developers.google.com/community/experts/directory?text=tanaike",
    "https://zenn.dev/tanaike",
    "https://medium.com/@tanaike"
  ]
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href='https://tanaikech.github.io/tags/python/index.xml'><i
          class="fas fa-rss fa-fw"></i>RSS</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://www.youtube.com/@tanaike" rel="me" target="_blank"><i class="fab fa-youtube-square fa-fw"></i>YouTube</a>
    </li>
    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2026. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Python</h1>
</div>

<div class="content">
  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2025/06/06/importance-of-time-information-in-gemini-and-current-time-handling/">Importance of Time Information in Gemini and Current Time Handling</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>06 Jun 2025, 15:00</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/ai">AI</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/e5114194e059153de2b0511ca18ba4bd">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20250606a/fig1.jpg" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>This report investigates how Gemini handles current time information, particularly when using the Gemini API. We found that while the Gemini web interface knows the current time, the Gemini API does not inherently. Therefore, applications must explicitly provide current time information in API calls for accurate time-sensitive responses.</p>
<h1 id="introduction">Introduction</h1>
<p>The rapidly advancing field of generative AI is enabling increasingly complex tasks, particularly through the use of open protocols like the Model Context Protocol (MCP) and Agent2Agent (A2A) Protocol. These protocols facilitate sophisticated operations that often require accurate and dynamic information, including time-sensitive data. For instance, applications that manage schedules or coordinate events critically depend on precise time information.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2025/06/06/importance-of-time-information-in-gemini-and-current-time-handling/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2025/05/10/image-transfer-mcp-server-web-apps/google-apps-script-to-mcp-client-gemini/python/">Image Transfer: MCP Server (Web Apps/Google Apps Script) to MCP Client (Gemini/Python)</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>10 May 2025, 14:06</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">Python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/model-context-protocol">Model Context Protocol</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/mcp">MCP</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/ai">AI</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/llm">LLM</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/8dc35b2e331ec99b0bdbc74b73eab821">Gists</a></p>
<h1 id="abstract">Abstract</h1>
<p>This report details transferring image data via Model Context Protocol (MCP) from Google Apps Script server to a Python/Gemini client, extending capabilities for multimodal applications beyond text.</p>
<h1 id="introduction">Introduction</h1>
<p>Following up on my previous report, &ldquo;Building Model Context Protocol (MCP) Server with Google Apps Script&rdquo; (<a href="https://medium.com/google-cloud/building-model-context-protocol-mcp-server-with-google-apps-script-9ff1fe58653c">Ref</a>), which detailed the transfer of text data between the MCP server and client, this new report focuses on extending the protocol to handle image data. It introduces a practical method for transferring image data efficiently from the Google Apps Script-based MCP server to an MCP client. In this implementation, the MCP client was built using Python and integrated with the Gemini model, allowing for the processing and utilization of the transferred image data alongside text, thereby enabling more complex, multimodal applications within the MCP framework.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2025/05/10/image-transfer-mcp-server-web-apps/google-apps-script-to-mcp-client-gemini/python/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2025/05/01/analyzing-google-apps-script-from-stackoverflow/">Analyzing Google Apps Script from Stackoverflow</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>01 May 2025, 14:48</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/stackoverflow">Stackoverflow</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/trend">Trend</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/stackoverflow">Stackoverflow</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/dc6bf3578bed965aaf3bf62abe81e822">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20250501b/fig1.jpg" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>The report details a novel Gemini API method to analyze big data beyond AI context window limits, which was validated with Stack Overflow data for insights into Google Apps Script&rsquo;s potential.</p>
<h1 id="introduction">Introduction</h1>
<p>Generative AI models face significant limitations when processing massive datasets, primarily due to the constraints imposed by their fixed context windows. Current methods thus struggle to analyze the entirety of big data within a single API call, preventing comprehensive analysis. To address this challenge, I have developed and published a detailed report presenting a novel approach using the Gemini API for comprehensive big data analysis, designed to operate effectively beyond typical model context window limits. <a href="https://github.com/tanaikech/analyze_big_data_by_Gemini">Ref</a></p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2025/05/01/analyzing-google-apps-script-from-stackoverflow/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2025/05/01/comprehensive-big-data-processing-with-gemini/">Comprehensive Big Data Processing with Gemini</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>01 May 2025, 14:12</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/ai">AI</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/llm">LLM</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/92e16484ddfd8e8966673fdf92165ff9">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20250501a/fig1.jpg" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>Generative AI faces limits in processing massive datasets due to context windows. Current methods can&rsquo;t analyze entire data lakes. This report presents a Gemini API approach for comprehensive big data analysis beyond typical model limits.</p>
<h1 id="introduction">Introduction</h1>
<p>The rapid advancement and widespread adoption of generative AI have been remarkable. High expectations are placed on these technologies, particularly regarding processing speed and the capacity to handle vast amounts of data. While AI processing speed continues to increase with technological progress, effectively managing and analyzing truly large datasets presents significant challenges. The current practical limits on the amount of data that can be processed or held within a model&rsquo;s context window simultaneously, sometimes around a million tokens or less, depending on the model and task, restrict direct comprehensive analysis of massive data lakes.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2025/05/01/comprehensive-big-data-processing-with-gemini/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2025/04/03/stowage-planning-automation-using-gemini-a-feasibility-study-and-a-prompt-based-approach/">Stowage Planning Automation Using Gemini: A Feasibility Study and A Prompt-Based Approach</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>03 Apr 2025, 11:14</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/9ef17c48c485891e7b873408c7fec82a">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20250403a/fig1.jpg" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>Gemini 2.5 Pro Experimental enabled automated cargo ship stowage planning via prompt engineering, overcoming prior model limitations. This eliminates the need for complex algorithms, demonstrating AI&rsquo;s potential in logistics.</p>
<h1 id="introduction">Introduction</h1>
<p>Recently, I encountered a practical business challenge: automating stowage planning through AI. Specifically, I received a request to generate optimal container loading plans for cargo ships, a task traditionally requiring significant manual effort and domain expertise. In initial tests, prior to the release of Gemini 2.5, I found that existing models struggled to effectively handle the complexities of this problem, including constraints like weight distribution, container dimensions, and destination sequencing. However, with the release of Gemini 2.5, I observed a significant improvement in the model&rsquo;s capabilities. Utilizing the Gemini 2.5 Pro Experimental model, I successfully demonstrated the generation of viable stowage plans using only carefully crafted prompts. This breakthrough eliminates the need for complex, custom-built algorithms or extensive training datasets. The successful implementation involved providing the model with key parameters such as container dimensions, weights, destination ports, and ship capacity. This report details the methodology, prompt engineering, and results of my attempt to create automated stowage planning using Gemini 2.5 Pro Experimental, highlighting its potential to revolutionize logistics and shipping operations.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2025/04/03/stowage-planning-automation-using-gemini-a-feasibility-study-and-a-prompt-based-approach/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/10/01/pseudo-function-calling-for-gemini-api-through-prompt-engineering/">Pseudo Function Calling for Gemini API Through Prompt Engineering</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>01 Oct 2024, 10:39</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/65c720a1fdc56d99c35b24aeaaa57f7e">Gists</a></p>
<h1 id="abstract">Abstract</h1>
<p>This research explores &ldquo;pseudo function calling&rdquo; in Gemini API using prompt engineering with JSON schema, bypassing model dependency limitations.</p>
<h1 id="introduction">Introduction</h1>
<p>Large Language Models (LLMs) like Gemini and ChatGPT offer powerful functionalities, but their capabilities can be further extended through function calling. This feature allows the LLM to execute pre-defined functions with arguments generated based on the user&rsquo;s prompt. This unlocks a wide range of applications, as demonstrated in these resources (see References).</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2024/10/01/pseudo-function-calling-for-gemini-api-through-prompt-engineering/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/05/07/gemini-api-with-json-schema/">Gemini API with JSON schema</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>07 May 2024, 16:33</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/ai">AI</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/llm">LLM</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/45b1a738b9e27236545a3cbcc1479a58">Gists</a></p>
<h1 id="overview">Overview</h1>
<p>These are sample scripts in Python and Node.js for controlling the output format of the Gemini API using JSON schemas.</p>
<h1 id="description">Description</h1>
<p>In a previous report, &ldquo;Taming the Wild Output: Effective Control of Gemini API Response Formats with response_mime_type,&rdquo; I presented sample scripts created with Google Apps Script. <a href="https://medium.com/google-cloud/taming-the-wild-output-effective-control-of-gemini-api-response-formats-with-response-mime-type-da273c08be85">Ref</a> Following its publication, I received requests for sample scripts using Python and Node.js. This report addresses those requests by providing sample scripts in both languages.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2024/05/07/gemini-api-with-json-schema/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/03/25/crafting-bespoke-output-formats-with-gemini-api/">Crafting Bespoke Output Formats with Gemini API</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>25 Mar 2024, 10:54</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/ai">AI</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/llm">LLM</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/3a659a87673e3e582c880934c8f19e01">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20240325a/fig1.png" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>The Gemini API unlocks potential for diverse applications but requires consistent output formatting. This report proposes a method using question phrasing and API calls to craft a bespoke output, enabling seamless integration with user applications. Examples include data categorization and obtaining multiple response options.</p>
<h1 id="introduction">Introduction</h1>
<p>With the release of the LLM model Gemini as an API on Vertex AI and Google AI Studio, a world of possibilities has opened up. <a href="https://deepmind.google/technologies/gemini/#introduction">Ref</a> The Gemini API significantly expands the potential of various scripting languages and paves the way for diverse applications. However, leveraging the Gemini API smoothly requires consistent output formatting, which can be tricky due to its dependence on the specific question asked.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2024/03/25/crafting-bespoke-output-formats-with-gemini-api/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/10/19/executing-google-apps-script-with-service-account/">Executing Google Apps Script with Service Account</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>19 Oct 2023, 14:59</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gotips">GoTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/webapps">WebApps</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/service-account">Service Account</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/golang">golang</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/304fea821ca36b8e9ccebe9814eaed82">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20231019a/fig2.png" alt=""></p>
<h2 id="abstract">Abstract</h2>
<p>One day, you might have a situation where it is required to run Google Apps Script using the service account. Unfortunately, in the current stage, Google Apps Script cannot be directly run with the service account because of the current specification. So, this report introduces a workaround for executing Google Apps Script using the service account.</p>
<h2 id="introduction">Introduction</h2>
<p>When you want to execute Google Apps Script from outside of Google, as the basic approach, it can be achieved by Google Apps Script API. <a href="https://developers.google.com/apps-script/api/reference/rest/v1/scripts/run">Ref</a> In order to use Google Apps Script, it is required to link the Google Apps Script project with the Google Cloud Platform project. <a href="https://github.com/tanaikech/Linking-Google-Cloud-Platform-Project-to-Google-Apps-Script-Project-for-New-IDE">Ref</a> But, in the current stage, Google Apps Script can be executed by Google Apps Script API with only the access token obtained from OAuth2. Unfortunately, the access token obtained by the service account cannot used for executing Google Apps Script using Google Apps Script API. It seems that this is the current specification on the Google side. However, there might be a case that it is required to execute Google Apps Script using the service account. In this report, I would like to introduce a workaround for executing Google Apps Script using the service account. In this workaround, the Web Apps created by Google Apps Script is used. The Web Apps can be used for executing the preserved functions of <code>doGet</code> and <code>doPost</code> from outside of Google. <a href="https://developers.google.com/apps-script/guides/web">Ref</a> In this workaround, this Web Apps is used for executing the various functions.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/10/19/executing-google-apps-script-with-service-account/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/02/28/resumable-download-of-file-from-google-drive-using-drive-api-with-python/">Resumable Download of File from Google Drive using Drive API with Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>28 Feb 2023, 11:58</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/googledrive">GoogleDrive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/dfdad37859d591526b2fba8fb4390cf5">Gists</a></p>
<p>This is a sample script for achieving the resumable download of a file from Google Drive using Dive API with Python.</p>
<p>There might be a case in that you want to achieve the resumable download of a file from Google Drive using Dive API with Python. For example, when a large file is downloaded, the downloading might be stopped in the middle of downloading. At that time, you might want to resume the download. In this post, I would like to introduce the sample script of python.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/02/28/resumable-download-of-file-from-google-drive-using-drive-api-with-python/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/02/16/using-until-expiration-time-of-access-token-retrieved-by-googleapis-for-python/">Using Until Expiration Time of Access Token Retrieved By googleapis for Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>16 Feb 2023, 15:05</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-api">google api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/service-account">Service Account</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/b2d877e4e4d274b17876191d48204882">Gists</a></p>
<p>When Google APIs are used with <a href="https://github.com/googleapis/google-api-python-client">googleapis for Python</a>, the client is obtained as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>creds <span style="color:#f92672">=</span> service_account<span style="color:#f92672">.</span>Credentials<span style="color:#f92672">.</span>from_service_account_file(service_account_credential_file, scopes<span style="color:#f92672">=</span>scopes)
</span></span><span style="display:flex;"><span>service <span style="color:#f92672">=</span> build(<span style="color:#e6db74">&#34;drive&#34;</span>, <span style="color:#e6db74">&#34;v3&#34;</span>, credentials<span style="color:#f92672">=</span>creds)
</span></span></code></pre></div><p>In this case, when the script is run, the access token is retrieved every time. But, the expiration time of the retrieved access token is 1 hour. Here, there might be the case that you want to use the access token until the expiration time. It is considered that effectively using the access token will lead to SDGs. In this post, I would like to introduce a sample script for using the access token until the expiration time.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/02/16/using-until-expiration-time-of-access-token-retrieved-by-googleapis-for-python/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/02/15/retrieving-access-token-from-service-account-using-oauth2client-and-google-auth-with-python/">Retrieving Access Token from Service Account using oauth2client and google-auth with Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15 Feb 2023, 14:46</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-api">google api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/service-account">Service Account</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/5196ed237812192539c4369000bc131b">Gists</a></p>
<p>This is a sample script for retrieving the access token from the service account using oauth2client and google-auth with Python.</p>
<h2 id="sample-script-1">Sample script 1</h2>
<p>Use <code>oauth2client</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> oauth2client.service_account <span style="color:#f92672">import</span> ServiceAccountCredentials
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SERVICE_ACCOUNT_FILE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;credentials.json&#34;</span>
</span></span><span style="display:flex;"><span>SCOPES <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;https://www.googleapis.com/auth/drive&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>creds <span style="color:#f92672">=</span> ServiceAccountCredentials<span style="color:#f92672">.</span>from_json_keyfile_name(SERVICE_ACCOUNT_FILE, scopes<span style="color:#f92672">=</span>SCOPES)
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> creds<span style="color:#f92672">.</span>get_access_token()
</span></span><span style="display:flex;"><span>access_token <span style="color:#f92672">=</span> res<span style="color:#f92672">.</span>access_token
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(access_token)
</span></span></code></pre></div><h2 id="sample-script-2">Sample script 2</h2>
<p>Use <code>google-auth</code>. In the current stage, this method might be general.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> google.oauth2 <span style="color:#f92672">import</span> service_account
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> google.auth.transport.requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SERVICE_ACCOUNT_FILE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;credentials.json&#34;</span>
</span></span><span style="display:flex;"><span>SCOPES <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;https://www.googleapis.com/auth/drive&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>creds <span style="color:#f92672">=</span> service_account<span style="color:#f92672">.</span>Credentials<span style="color:#f92672">.</span>from_service_account_file(SERVICE_ACCOUNT_FILE, scopes<span style="color:#f92672">=</span>SCOPES)
</span></span><span style="display:flex;"><span>request <span style="color:#f92672">=</span> google<span style="color:#f92672">.</span>auth<span style="color:#f92672">.</span>transport<span style="color:#f92672">.</span>requests<span style="color:#f92672">.</span>Request()
</span></span><span style="display:flex;"><span>creds<span style="color:#f92672">.</span>refresh(request)
</span></span><span style="display:flex;"><span>access_token <span style="color:#f92672">=</span> creds<span style="color:#f92672">.</span>token
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(access_token)
</span></span></code></pre></div><h2 id="references">References</h2>
<ul>
<li><a href="https://oauth2client.readthedocs.io/en/latest/source/oauth2client.service_account.html">oauth2client.service_account module</a></li>
<li><a href="https://google-auth.readthedocs.io/en/master/reference/google.oauth2.service_account.html">google.oauth2.service_account module</a></li>
<li><a href="https://google-auth.readthedocs.io/en/master/reference/google.auth.transport.requests.html">google.auth.transport.requests module</a></li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/05/28/uploading-files-to-google-drive-with-asynchronous-process-using-python/">Uploading Files to Google Drive with Asynchronous Process using Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>28 May 2022, 09:45</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/a4cfbea4935b8c281d1f6abb91016705">Gists</a></p>
<p>This is a sample script for uploading files to Google Drive with asynchronous process using Python.</p>
<h2 id="sample-script">Sample script</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> aiohttp
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> asyncio
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>folder_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span> <span style="color:#75715e"># Please set the folder ID you want to put.</span>
</span></span><span style="display:flex;"><span>token <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span> <span style="color:#75715e"># Please set your access token.</span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://www.googleapis.com/upload/drive/v3/files&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">workers</span>(file):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">with</span> aiohttp<span style="color:#f92672">.</span>ClientSession() <span style="color:#66d9ef">as</span> session:
</span></span><span style="display:flex;"><span>        metadata <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;name&#34;</span>: file[<span style="color:#e6db74">&#34;filename&#34;</span>], <span style="color:#e6db74">&#34;parents&#34;</span>: [folder_id]}
</span></span><span style="display:flex;"><span>        data <span style="color:#f92672">=</span> aiohttp<span style="color:#f92672">.</span>FormData()
</span></span><span style="display:flex;"><span>        data<span style="color:#f92672">.</span>add_field(<span style="color:#e6db74">&#34;metadata&#34;</span>, json<span style="color:#f92672">.</span>dumps(metadata), content_type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;application/json; charset=UTF-8&#34;</span>)
</span></span><span style="display:flex;"><span>        data<span style="color:#f92672">.</span>add_field(<span style="color:#e6db74">&#34;file&#34;</span>, open(file[<span style="color:#e6db74">&#34;path&#34;</span>], <span style="color:#e6db74">&#34;rb&#34;</span>))
</span></span><span style="display:flex;"><span>        headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;Authorization&#34;</span>: <span style="color:#e6db74">&#34;Bearer &#34;</span> <span style="color:#f92672">+</span> token}
</span></span><span style="display:flex;"><span>        params <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;uploadType&#34;</span>: <span style="color:#e6db74">&#34;multipart&#34;</span>}
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">with</span> session<span style="color:#f92672">.</span>post(url, data<span style="color:#f92672">=</span>data, params<span style="color:#f92672">=</span>params, headers<span style="color:#f92672">=</span>headers) <span style="color:#66d9ef">as</span> resp:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">await</span> resp<span style="color:#f92672">.</span>json()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Please set the filenames and the file paths as follows.</span>
</span></span><span style="display:flex;"><span>    fileList <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>        {<span style="color:#e6db74">&#34;filename&#34;</span>: <span style="color:#e6db74">&#34;sample1&#34;</span>, <span style="color:#e6db74">&#34;path&#34;</span>: <span style="color:#e6db74">&#34;./sample1.png&#34;</span>},
</span></span><span style="display:flex;"><span>        ,
</span></span><span style="display:flex;"><span>        ,
</span></span><span style="display:flex;"><span>        ,
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>    works <span style="color:#f92672">=</span> [asyncio<span style="color:#f92672">.</span>create_task(workers(e)) <span style="color:#66d9ef">for</span> e <span style="color:#f92672">in</span> fileList]
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> asyncio<span style="color:#f92672">.</span>gather(<span style="color:#f92672">*</span>works)
</span></span><span style="display:flex;"><span>    print(res)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>asyncio<span style="color:#f92672">.</span>run(main())
</span></span></code></pre></div><ul>
<li>When this script is run, the files of <code>fileList</code> are uploaded to Google Drive with the asynchronous process.</li>
</ul>
<h2 id="note">Note</h2>
<ul>
<li>This sample supposes that your access token can be used for uploading files to Google Drive using Drive API. Please be careful about this.</li>
</ul>
<h2 id="reference">Reference</h2>
<ul>
<li>I answered this sample script for <a href="https://stackoverflow.com/q/72399888/7108653">this thread of Stackoverflow</a></li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2021/09/25/replacing-template-texts-with-array-in-google-document-using-docs-api-with-python/">Replacing Template Texts with Array in Google Document using Docs API with Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>25 Sep 2021, 10:51</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/document">document</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/document">document</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/f1f9fb91d3432362670c810ae05ba53b">Gists</a></p>
<p>This is a sample script for replacing the template texts with an array in Google Document using Docs API with Python.</p>
<p>The sample input and output situations are as follows.</p>
<p><img src="https://tanaikech.github.io/image-storage/20210925a/fig1.png" alt=""></p>
<p>In the current stage, when <code>replaceAllText</code> of Docs API is used with the sample value of <code>[&quot;updated text 1&quot;, &quot;updated text 2&quot;, &quot;updated text 3&quot;]</code>, all values of <code>{{oldText}}</code> are replaced with the 1st value of <code>updated text 1</code> in one batch request. So in order to replace each <code>{{oldText}}</code> with <code>[&quot;updated text 1&quot;, &quot;updated text 2&quot;, &quot;updated text 3&quot;]</code>, it is required to use a workaround.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2021/09/25/replacing-template-texts-with-array-in-google-document-using-docs-api-with-python/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/12/03/sample-scripts-for-creating-new-event-with-google-meet-link-to-google-calendar-using-various-languages/">Sample Scripts for Creating New Event with Google Meet Link to Google Calendar using Various Languages</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>03 Dec 2020, 16:04</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gotips">GoTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/rubytips">RubyTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/curltips">CurlTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/golang">golang</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/ruby">ruby</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/curl">curl</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/calendar">Calendar</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/94791d48823e9659aa376cf7f0161d9b">Gists</a></p>
<p>This is the sample scripts for creating new event with Google Meet link to Google Calendar using various languages. When I saw <a href="https://developers.google.com/calendar/create-events#conferencing">the official document</a> of &ldquo;Add video and phone conferences to events&rdquo;, in the current stage, I can see only the sample script for Javascript. But I saw the several questions related to this for various languages. So I published the sample scripts for creating new event with Google Meet link to Google Calendar using various languages.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/12/03/sample-scripts-for-creating-new-event-with-google-meet-link-to-google-calendar-using-various-languages/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/10/13/retrieving-all-values-from-all-sheets-from-url-of-2pacx-of-web-published-google-spreadsheet-using-python/">Retrieving All Values from All Sheets from URL of 2PACX- of Web Published Google Spreadsheet using Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Oct 2020, 14:59</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/51628e5e0a2c017329457afdb1936912">Gists</a></p>
<p>This is a sample script for retrieving all values from all sheets from URL of 2PACX- of Web Published Google Spreadsheet using Python.</p>
<p>In this post, it supposes that the Google Spreadsheet has already been published for Web. <a href="https://support.google.com/docs/answer/183965?co=GENIE.Platform%3DDesktop&amp;hl=en">Ref</a></p>
<h2 id="flow">Flow</h2>
<p>The flow of this method is as follows.</p>
<ol>
<li>Retrieve XLSX data from the URL of web published Google Spreadsheet as <code>BytesIO</code> data.
<ul>
<li>The URL is like <code>https://docs.google.com/spreadsheets/d/e/2PACX-###/pubhtml</code>.</li>
</ul>
</li>
<li>XLSX data is parsed with openpyxl.</li>
<li>Retrieve all values from all sheets.</li>
</ol>
<h2 id="sample-script">Sample script</h2>
<p>Please set <code>spreadsheetUrl</code>.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/10/13/retrieving-all-values-from-all-sheets-from-url-of-2pacx-of-web-published-google-spreadsheet-using-python/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/08/11/updated-python-library-getfilelistpy/">Updated: python library - getfilelistpy</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>11 Aug 2020, 11:19</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapi">googleapi</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/foldertree">folderTree</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/filelist">filelist</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="python-library---getfilelistpy-was-updated-to-v107">python library - getfilelistpy was updated to v1.0.7.</h2>
<ul>
<li>
<p>v1.0.7 (August 11, 2020)</p>
<ol>
<li><a href="https://github.com/tanaikech/getfilelistpy/pull/4">Pull request</a> was reflected.</li>
</ol>
</li>
</ul>
<p><strong>You can check getfilelistpy at <a href="https://github.com/tanaikech/getfilelistpy">https://github.com/tanaikech/getfilelistpy</a>.</strong></p>
<p><strong>You can also check getfilelistpy at <a href="https://pypi.org/project/getfilelistpy/">https://pypi.org/project/getfilelistpy/</a>.</strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/06/01/updated-getfilelist-for-golang-javascript-node.js-and-python/">Updated: GetFileList for golang, Javascript, Node.js and Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>01 Jun 2020, 14:12</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gotips">GoTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/module">module</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/golang">golang</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/module">module</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/foldertree">folderTree</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/filelist">filelist</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>Updated: GetFileList for golang, Javascript, Node.js and Python</p>
<p>This is the libraries to retrieve the file list with the folder tree from the specific folder of own Google Drive and shared Drives.</p>
<ul>
<li>Golang: <a href="https://github.com/tanaikech/go-getfilelist">https://github.com/tanaikech/go-getfilelist</a>
<ul>
<li>Updated to v1.0.4.</li>
</ul>
</li>
<li>Javascript: <a href="https://github.com/tanaikech/GetFileList_js">https://github.com/tanaikech/GetFileList_js</a>
<ul>
<li>Updated to v1.0.3.</li>
</ul>
</li>
<li>Node.js: <a href="https://github.com/tanaikech/node-getfilelist">https://github.com/tanaikech/node-getfilelist</a>
<ul>
<li>Updated to v1.0.5.</li>
</ul>
</li>
<li>Python: <a href="https://github.com/tanaikech/getfilelistpy">https://github.com/tanaikech/getfilelistpy</a>
<ul>
<li>Updated to v1.0.6.</li>
</ul>
</li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/05/15/updated-python-library-getfilelistpy/">Updated: python library - getfilelistpy</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15 May 2020, 11:49</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapi">googleapi</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/foldertree">folderTree</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/filelist">filelist</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="python-library---getfilelistpy-was-updated-to-v105">python library - getfilelistpy was updated to v1.0.5.</h2>
<ul>
<li>
<p>v1.0.5 (May 15, 2020)</p>
<ol>
<li>
<p>Shared drive got to be able to be used. The file list can be retrieved from both your Google Drive and the shared drive.</p>
<ul>
<li>For example, when the folder ID in the shared Drive is used <code>id</code> of <code>resource</code>, you can retrieve the file list from the folder in the shared Drive.</li>
</ul>
</li>
</ol>
</li>
</ul>
<p><strong>You can check getfilelistpy at <a href="https://github.com/tanaikech/getfilelistpy">https://github.com/tanaikech/getfilelistpy</a>.</strong></p>
<p><strong>You can also check getfilelistpy at <a href="https://pypi.org/project/getfilelistpy/">https://pypi.org/project/getfilelistpy/</a>.</strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/03/05/simple-script-of-resumable-upload-with-google-drive-api-for-python/">Simple Script of Resumable Upload with Google Drive API for Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>05 Mar 2020, 14:10</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/resumable-upload">resumable-upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/f709a952ff6e286027950d0484f6c03e">Gists</a></p>
<p>This is a simple sample script for achieving the resumable upload to Google Drive using Python. In order to achieve the resumable upload, at first, it is required to retrieve the location, which is the endpoint of upload. The location is included in the response headers. After the location was retrieved, the file can be uploaded to the location URL.</p>
<p>In this sample, a PNG file is uploaded with the resumable upload using a single chunk.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/03/05/simple-script-of-resumable-upload-with-google-drive-api-for-python/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/01/22/libraries-of-gdoctableapp-for-golang-node.js-and-python-were-updated-to-v110/">Libraries of gdoctableapp for golang, Node.js and python were updated to v110</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>22 Jan 2020, 15:22</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/module">module</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapi">googleapi</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gotips">GoTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/module">module</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-document">Google Document</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/document">Document</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/docs-api">Docs API</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/table">Table</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/golang">golang</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="libraries-of-gdoctableapp-for-golang-nodejs-and-python-were-updated-to-v110">Libraries of gdoctableapp for golang, Node.js and python were updated to v1.1.0</h2>
<ul>
<li>
<p><a href="https://github.com/tanaikech/go-gdoctableapp">go-gdoctableapp</a></p>
<ul>
<li>v1.1.0 (January 22, 2020)
<ol>
<li><a href="https://github.com/tanaikech/go-gdoctableapp#replacetexts">2 new methods were added.</a> From this version, the texts can be replaced by images. The direct link and local file can be used as the image.</li>
</ol>
</li>
</ul>
</li>
<li>
<p><a href="https://github.com/tanaikech/node-gdoctableapp">node-gdoctableapp</a></p>
<ul>
<li>v1.1.0 (January 22, 2020)
<ol>
<li><a href="https://github.com/tanaikech/node-gdoctableapp#replacetexts">New method was added.</a> From this version, the texts can be replaced by images. The direct link and local file can be used as the image.</li>
</ol>
</li>
</ul>
</li>
<li>
<p><a href="https://github.com/tanaikech/gdoctableapppy">gdoctableapppy</a></p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/01/22/libraries-of-gdoctableapp-for-golang-node.js-and-python-were-updated-to-v110/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/01/21/libraries-of-gdoctableapp-for-golang-node.js-and-python-were-updated-to-v105/">Libraries of gdoctableapp for golang, Node.js and python were updated to v105</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>21 Jan 2020, 15:00</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/module">module</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapi">googleapi</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gotips">GoTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/module">module</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-document">Google Document</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/document">Document</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/docs-api">Docs API</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/table">Table</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/golang">golang</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="libraries-of-gdoctableapp-for-golang-nodejs-and-python-were-updated-to-v105">Libraries of gdoctableapp for golang, Node.js and python were updated to v1.0.5</h2>
<ul>
<li><a href="https://github.com/tanaikech/go-gdoctableapp">go-gdoctableapp</a></li>
<li><a href="https://github.com/tanaikech/node-gdoctableapp">node-gdoctableapp</a></li>
<li><a href="https://github.com/tanaikech/gdoctableapppy">gdoctableapppy</a></li>
</ul>
<h3 id="update-history">Update History</h3>
<ul>
<li>
<p>v1.0.5 (January 21, 2020)</p>
<ul>
<li>When the inline objects and tables are put in the table. An error occurred. This bug was removed by this update.</li>
</ul>
</li>
<li>
<p>I got the pull request at <a href="https://github.com/tanaikech/gdoctableapppy/pull/3">here</a>.</p>
</li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2019/08/23/updated-python-library-getfilelistpy/">Updated: python library - getfilelistpy</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>23 Aug 2019, 15:20</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapi">googleapi</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/foldertree">folderTree</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/filelist">filelist</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="python-library---getfilelistpy-was-updated-to-v104">python library - getfilelistpy was updated to v1.0.4.</h2>
<ul>
<li>
<p>v1.0.4 (August 23, 2019)</p>
<ol>
<li>For OAuth2, <code>oauth2client</code> and <code>google_auth_oauthlib</code> got to be able to be used. About the sample script for <code>google_auth_oauthlib</code>, please see <a href="https://github.com/tanaikech/getfilelistpy#googleauthoauthlibsample">this</a>.</li>
</ol>
</li>
</ul>
<p><strong>You can check getfilelistpy at <a href="https://github.com/tanaikech/getfilelistpy">https://github.com/tanaikech/getfilelistpy</a>.</strong></p>
<p><strong>You can also check getfilelistpy at <a href="https://pypi.org/project/getfilelistpy/">https://pypi.org/project/getfilelistpy/</a>.</strong></p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2019/07/21/creating-a-table-to-google-document-by-retrieving-values-from-google-spreadsheet-for-python/">Creating a Table to Google Document by Retrieving Values from Google Spreadsheet for Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>21 Jul 2019, 14:27</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/document">Document</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">Spreadsheet</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/table">Table</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/305e413696bcdf3a2ee3e86cebf3c7dc">Gists</a></p>
<p>This is a sample script for creating a table to Google Document by retrieving values from Google Spreadsheet for Python.</p>
<p>Before you use this script, please install python library of <a href="https://github.com/tanaikech/gdoctableapppy">gdoctableapppy</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ pip install gdoctableapppy
</span></span></code></pre></div><h2 id="sample-script">Sample script:</h2>
<p>This sample script uses Service Account.</p>
<p>In this sample script, the values are retrieved from <code>Sheet1!A1:C5</code> of Spreadsheet, and new table is created to the Document using the values.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> google.oauth2 <span style="color:#f92672">import</span> service_account
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> gdoctableapppy <span style="color:#f92672">import</span> gdoctableapp
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> googleapiclient.discovery <span style="color:#f92672">import</span> build
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SCOPES <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;https://www.googleapis.com/auth/documents&#39;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#39;https://www.googleapis.com/auth/spreadsheets&#39;</span>]
</span></span><span style="display:flex;"><span>SERVICE_ACCOUNT_FILE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;credential.json&#39;</span> <span style="color:#75715e"># Please set the json file of Service account.</span>
</span></span><span style="display:flex;"><span>creds <span style="color:#f92672">=</span> service_account<span style="color:#f92672">.</span>Credentials<span style="color:#f92672">.</span>from_service_account_file(
</span></span><span style="display:flex;"><span>    SERVICE_ACCOUNT_FILE, scopes<span style="color:#f92672">=</span>SCOPES)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>service <span style="color:#f92672">=</span> build(<span style="color:#e6db74">&#39;sheets&#39;</span>, <span style="color:#e6db74">&#39;v4&#39;</span>, credentials<span style="color:#f92672">=</span>creds)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>spreadsheet_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;###&#39;</span>  <span style="color:#75715e"># Please set here</span>
</span></span><span style="display:flex;"><span>document_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;###&#39;</span>  <span style="color:#75715e"># Please set here</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> service<span style="color:#f92672">.</span>spreadsheets()<span style="color:#f92672">.</span>values()<span style="color:#f92672">.</span>get(
</span></span><span style="display:flex;"><span>    spreadsheetId<span style="color:#f92672">=</span>spreadsheet_id, range<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sheet1!A1:C5&#39;</span>)<span style="color:#f92672">.</span>execute()
</span></span><span style="display:flex;"><span>values <span style="color:#f92672">=</span> res[<span style="color:#e6db74">&#39;values&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resource <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;service_account&#34;</span>: creds,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;documentId&#34;</span>: document_id,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;rows&#34;</span>: len(values),
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;columns&#34;</span>: len(values[<span style="color:#ae81ff">0</span>]),
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;append&#34;</span>: <span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;values&#34;</span>: values
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> gdoctableapp<span style="color:#f92672">.</span>CreateTable(resource)
</span></span><span style="display:flex;"><span>print(res)
</span></span></code></pre></div><h2 id="references">References:</h2>
<ul>
<li><a href="https://github.com/tanaikech/gdoctableapppy">gdoctableapppy</a></li>
<li><a href="https://developers.google.com/identity/protocols/OAuth2ServiceAccount">Service account</a></li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2019/07/18/python-library-gdoctableapppy/">python library - gdoctableapppy</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>18 Jul 2019, 11:46</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapi">googleapi</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-document">Google Document</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/document">Document</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/docs-api">Docs API</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/table">Table</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p>This is a python library to manage the tables on Google Document using Google Docs API.</p>
<h2 id="description">Description</h2>
<p>Google Docs API has been released. When I used this API, I found that it is very difficult for me to manage the tables on Google Document using Google Docs API. Although I checked <a href="https://developers.google.com/docs/api/how-tos/tables">the official document</a>, unfortunately, I thought that it&rsquo;s very difficult for me. So in order to easily manage the tables on Google Document, I created this library.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2019/07/18/python-library-gdoctableapppy/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/11/17/python-library-getfilelistpy/">python library - getfilelistpy</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Nov 2018, 15:11</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapi">googleapi</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/foldertree">folderTree</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/filelist">filelist</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h1 id="overview">Overview</h1>
<p>This is a python library to retrieve the file list with the folder tree from the specific folder of Google Drive.</p>
<h1 id="description">Description</h1>
<p>When I create applications for using Google Drive, I often retrieve a file list from a folder in the application. So far, I had created the script for retrieving a file list from a folder for each application. Recently, I thought that if there is the script for retrieving the file list with the folder tree from the folder of Google Drive as a library, it will be useful for me and other users. So I created this.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/11/17/python-library-getfilelistpy/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/02/27/append-values-by-inserting-rows-using-google-sheets-api/">Append Values by Inserting Rows using Google Sheets API</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>27 Feb 2018, 09:51</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">Spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">Python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/sheetsapi">SheetsAPI</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/batchupdate">batchUpdate</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/7846ebcafbab8318ff74c9955a99e06b">Gists</a></p>
<p>In the case appending values to cell by inserting rows, when <code>sheets.spreadsheets.values.append</code> is used, the values are appended to the next empty row of the last row. If you want to append values to between cells with values by inserting row, you can achieve it using <code>sheets.spreadsheets.batchUpdate</code>.</p>
<p>When you use this, please use your access token.</p>
<h2 id="endpoint-">Endpoint :</h2>
<pre tabindex="0"><code>POST https://sheets.googleapis.com/v4/spreadsheets/### spreadsheet ID ###:batchUpdate
</code></pre><h2 id="request-body-">Request body :</h2>
<p>In this request body, it appends the data of &ldquo;sample1, sample2, sample3&rdquo; to &ldquo;A1:A3&rdquo; of the sheetId of &ldquo;1234567890&rdquo;. Before appends the data, it supposes that there are some values at &ldquo;A1:A3&rdquo;.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/02/27/append-values-by-inserting-rows-using-google-sheets-api/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/02/12/uploading-files-from-local-to-google-drive-by-python-without-quickstart/">Uploading Files From Local To Google Drive by Python without Quickstart</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>12 Feb 2018, 11:39</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">Python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/8cdfd23807372657dc63d81e25e35153">Gists</a></p>
<p>This is a sample script for uploading files from local PC to Google Drive using Python. In this sample, Quickstart is not used. So when you use this script, please retrieve access token.</p>
<h2 id="curl-sample-">Curl sample :</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X POST <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -H <span style="color:#e6db74">&#34;Authorization: Bearer ### access token ###&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -F <span style="color:#e6db74">&#34;metadata={name : &#39;sample.png&#39;, parents: [&#39;### folder ID ###&#39;]};type=application/json;charset=UTF-8&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -F <span style="color:#e6db74">&#34;file=@sample.png;type=image/png&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&#34;</span>
</span></span></code></pre></div><p>]</p>
<h2 id="python-sample-">Python sample :</h2>
<p>When above curl sample is converted to Python, it becomes as follows.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/02/12/uploading-files-from-local-to-google-drive-by-python-without-quickstart/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/12/18/decoding-gmail-body-with-japanese-language-using-python/">Decoding Gmail Body with Japanese Language using Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>18 Dec 2017, 08:22</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">Python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gmail">Gmail</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/decode">decode</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/ef78cdbb978989904415b14a1c45b47f">Gist</a></p>
<p>This is a sample script for decoding Gmail body with Japanese language using Python.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>msg <span style="color:#f92672">=</span> service<span style="color:#f92672">.</span>users()<span style="color:#f92672">.</span>messages()<span style="color:#f92672">.</span>get(userId<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;me&#39;</span>, id<span style="color:#f92672">=</span>id)<span style="color:#f92672">.</span>execute()
</span></span><span style="display:flex;"><span>parts <span style="color:#f92672">=</span> msg[<span style="color:#e6db74">&#39;payload&#39;</span>][<span style="color:#e6db74">&#39;parts&#39;</span>]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> e <span style="color:#f92672">in</span> parts:
</span></span><span style="display:flex;"><span>    msg <span style="color:#f92672">=</span> base64<span style="color:#f92672">.</span>urlsafe_b64decode(e[<span style="color:#e6db74">&#39;body&#39;</span>][<span style="color:#e6db74">&#39;data&#39;</span>])<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)<span style="color:#f92672">.</span>encode(<span style="color:#e6db74">&#39;cp932&#39;</span>, <span style="color:#e6db74">&#34;ignore&#34;</span>)<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;cp932&#39;</span>)
</span></span><span style="display:flex;"><span>    print(msg)
</span></span></code></pre></div>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/08/19/updating-thumbnail-of-file-on-google-drive-using-python/">Updating Thumbnail of File on Google Drive using Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>19 Aug 2017, 16:27</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">pythontips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api </a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/thumbnail">Thumbnail</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/update">Update</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/731c412c271828276bf3e24a25235aab">Gists</a></p>
<p>This sample script is for updating thumbnail of file on Google Drive using Python.</p>
<p>This sample supposes that <a href="https://developers.google.com/drive/v3/web/quickstart/python">quickstart</a> is used and default quickstart works fine. In order to use this sample, please carry out as follows.</p>
<ul>
<li>Replace <code>main()</code> of the default quickstart to this sample.</li>
</ul>
<h2 id="script-">Script :</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> base64 <span style="color:#75715e"># This is used for this sample.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    credentials <span style="color:#f92672">=</span> get_credentials()
</span></span><span style="display:flex;"><span>    http <span style="color:#f92672">=</span> credentials<span style="color:#f92672">.</span>authorize(httplib2<span style="color:#f92672">.</span>Http())
</span></span><span style="display:flex;"><span>    service <span style="color:#f92672">=</span> discovery<span style="color:#f92672">.</span>build(<span style="color:#e6db74">&#39;drive&#39;</span>, <span style="color:#e6db74">&#39;v3&#39;</span>, http<span style="color:#f92672">=</span>http)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;./sample.png&#34;</span>, <span style="color:#e6db74">&#34;rb&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> service<span style="color:#f92672">.</span>files()<span style="color:#f92672">.</span>update(
</span></span><span style="display:flex;"><span>            fileId<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;### file ID ###&#34;</span>,
</span></span><span style="display:flex;"><span>            body<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;contentHints&#34;</span>: {
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;thumbnail&#34;</span>: {
</span></span><span style="display:flex;"><span>                        <span style="color:#e6db74">&#34;image&#34;</span>: base64<span style="color:#f92672">.</span>urlsafe_b64encode(f<span style="color:#f92672">.</span>read())<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf8&#39;</span>),
</span></span><span style="display:flex;"><span>                        <span style="color:#e6db74">&#34;mimeType&#34;</span>: <span style="color:#e6db74">&#34;image/png&#34;</span>,
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>        )<span style="color:#f92672">.</span>execute()
</span></span><span style="display:flex;"><span>        print(res)
</span></span></code></pre></div><p><code>contentHints.thumbnail.image</code> is URL-safe Base64-encoded image. So an image data that you want to use as new thumbnail has to be converted to URL-safe Base64-encoded data. For this, it uses <code>base64.urlsafe_b64encode()</code> at Python.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/08/19/updating-thumbnail-of-file-on-google-drive-using-python/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/06/22/sublime-text-plugin-gislacks/">Sublime Text Plugin - gislacks</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>22 Jun 2017, 13:33</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/plugin">plugin</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/sublime">sublime</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gislacks">gislacks</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gist">gist</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/slack">slack</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/plugin">plugin</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/sublime">sublime</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h1 id="overview">Overview</h1>
<p>This is a plugin of Sublime Text 3 for submitting files to both Gist and Slack.</p>
<h1 id="description">Description</h1>
<p>I like to use Sublime Text for developing scripts. And when I discuss about developing scripts, I often use Slack. When I submitted a script to Slack, I had saved the script to Gist as a backup. I had done manually this on my browser. Namely, I wanted to be saving the revision of script while I&rsquo;m discussing about the script at Slack. One day, I wished this process had been able to be automatically run. So I created this plugin and <a href="https://github.com/tanaikech/gislack/">gislack of a CLI tool</a>.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/06/22/sublime-text-plugin-gislacks/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/06/09/error-handling-for-subprocess-at-python/">Error Handling for Subprocess at Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Jun 2017, 14:27</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">Python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/subprocess">subprocess</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This sample is for error handling for subprocess.Popen. It confirms whether the execution file is existing. If the execution file is also not in the path, the error message is shown.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> subprocess
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> subprocess<span style="color:#f92672">.</span>Popen(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;application&#34;</span>,  <span style="color:#75715e">#  &lt;- Execution file</span>
</span></span><span style="display:flex;"><span>    stdout<span style="color:#f92672">=</span>subprocess<span style="color:#f92672">.</span>PIPE,
</span></span><span style="display:flex;"><span>    stderr<span style="color:#f92672">=</span>subprocess<span style="color:#f92672">.</span>PIPE,
</span></span><span style="display:flex;"><span>    shell<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>)<span style="color:#f92672">.</span>communicate()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> len(res[<span style="color:#ae81ff">1</span>]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;ok: Application is existing.&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Error: Application is not found.&#34;</span>)
</span></span></code></pre></div>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/06/09/using-constructor-between-classes-at-python/">Using Constructor Between Classes at Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Jun 2017, 10:52</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">Python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/class">class</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This sample is for using constructor between classes at Python.</p>
<h2 id="sample-">Sample :</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">test1</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>msg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sample text&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">test2</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>msg <span style="color:#f92672">=</span> test1()<span style="color:#f92672">.</span>msg
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(test2()<span style="color:#f92672">.</span>msg)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> sample text
</span></span></code></pre></div>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/05/10/file-transfer-for-google-drive-without-authorization/">File Transfer for Google Drive Without Authorization</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>10 May 2017, 13:28</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">GoogleAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h1 id="overview">Overview</h1>
<p>In this article, I would like to introduce how to transfer files for Google Drive under no authorization.</p>
<p>This has also been published here. <a href="https://github.com/tanaikech/FileTransfer">https://github.com/tanaikech/FileTransfer</a></p>
<h1 id="description">Description</h1>
<p>When we download and upload files for Google Drive, it usually has to use Drive API. In order to use Drive API, access token is required. If you want to make your friends download and upload files for your Google Drive, the authorization process is to take time. So I proposal this.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/05/10/file-transfer-for-google-drive-without-authorization/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/05/02/ocr-using-google-drive-api/">OCR using Google Drive API</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>02 May 2017, 14:21</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">GoogleAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google">Google</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This is a sample script for OCR using Google Drive API. A text file which converted by OCR can be retrieved by inputting an image file.</p>
<p>In this sample, Python Quickstart is used. The detail information is <a href="https://developers.google.com/drive/v3/web/quickstart/python">https://developers.google.com/drive/v3/web/quickstart/python</a>. Please read Step 1: Turn on the Drive API and Step 2: Install the Google Client Library.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> __future__ <span style="color:#f92672">import</span> print_function
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> httplib2
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> io
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> apiclient <span style="color:#f92672">import</span> discovery
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> oauth2client <span style="color:#f92672">import</span> client
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> oauth2client <span style="color:#f92672">import</span> tools
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> oauth2client.file <span style="color:#f92672">import</span> Storage
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> apiclient.http <span style="color:#f92672">import</span> MediaFileUpload, MediaIoBaseDownload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> argparse
</span></span><span style="display:flex;"><span>    flags <span style="color:#f92672">=</span> argparse<span style="color:#f92672">.</span>ArgumentParser(parents<span style="color:#f92672">=</span>[tools<span style="color:#f92672">.</span>argparser])<span style="color:#f92672">.</span>parse_args()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span> <span style="color:#a6e22e">ImportError</span>:
</span></span><span style="display:flex;"><span>    flags <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If modifying these scopes, delete your previously saved credentials</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># at ~/.credentials/drive-python-quickstart.json</span>
</span></span><span style="display:flex;"><span>SCOPES <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://www.googleapis.com/auth/drive&#39;</span>
</span></span><span style="display:flex;"><span>CLIENT_SECRET_FILE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;client_secret.json&#39;</span>
</span></span><span style="display:flex;"><span>APPLICATION_NAME <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Drive API Python Quickstart&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_credentials</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Gets valid user credentials from storage.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    If nothing has been stored, or if the stored credentials are invalid,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    the OAuth2 flow is completed to obtain the new credentials.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Returns:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        Credentials, the obtained credential.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    credential_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#34;./&#34;</span>, <span style="color:#e6db74">&#39;drive-python-quickstart.json&#39;</span>)
</span></span><span style="display:flex;"><span>    store <span style="color:#f92672">=</span> Storage(credential_path)
</span></span><span style="display:flex;"><span>    credentials <span style="color:#f92672">=</span> store<span style="color:#f92672">.</span>get()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> credentials <span style="color:#f92672">or</span> credentials<span style="color:#f92672">.</span>invalid:
</span></span><span style="display:flex;"><span>        flow <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>flow_from_clientsecrets(CLIENT_SECRET_FILE, SCOPES)
</span></span><span style="display:flex;"><span>        flow<span style="color:#f92672">.</span>user_agent <span style="color:#f92672">=</span> APPLICATION_NAME
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> flags:
</span></span><span style="display:flex;"><span>            credentials <span style="color:#f92672">=</span> tools<span style="color:#f92672">.</span>run_flow(flow, store, flags)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:  <span style="color:#75715e"># Needed only for compatibility with Python 2.6</span>
</span></span><span style="display:flex;"><span>            credentials <span style="color:#f92672">=</span> tools<span style="color:#f92672">.</span>run(flow, store)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;Storing credentials to &#39;</span> <span style="color:#f92672">+</span> credential_path)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> credentials
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    credentials <span style="color:#f92672">=</span> get_credentials()
</span></span><span style="display:flex;"><span>    http <span style="color:#f92672">=</span> credentials<span style="color:#f92672">.</span>authorize(httplib2<span style="color:#f92672">.</span>Http())
</span></span><span style="display:flex;"><span>    service <span style="color:#f92672">=</span> discovery<span style="color:#f92672">.</span>build(<span style="color:#e6db74">&#39;drive&#39;</span>, <span style="color:#e6db74">&#39;v3&#39;</span>, http<span style="color:#f92672">=</span>http)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    imgfile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;sample.png&#39;</span>  <span style="color:#75715e"># Image with texts (png, jpg, bmp, gif, pdf)</span>
</span></span><span style="display:flex;"><span>    txtfile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;output.txt&#39;</span>  <span style="color:#75715e"># Text file outputted by OCR</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    mime <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;application/vnd.google-apps.document&#39;</span>
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> service<span style="color:#f92672">.</span>files()<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>        body<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;name&#39;</span>: imgfile,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;mimeType&#39;</span>: mime
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        media_body<span style="color:#f92672">=</span>MediaFileUpload(imgfile, mimetype<span style="color:#f92672">=</span>mime, resumable<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    )<span style="color:#f92672">.</span>execute()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    downloader <span style="color:#f92672">=</span> MediaIoBaseDownload(
</span></span><span style="display:flex;"><span>        io<span style="color:#f92672">.</span>FileIO(txtfile, <span style="color:#e6db74">&#39;wb&#39;</span>),
</span></span><span style="display:flex;"><span>        service<span style="color:#f92672">.</span>files()<span style="color:#f92672">.</span>export_media(fileId<span style="color:#f92672">=</span>res[<span style="color:#e6db74">&#39;id&#39;</span>], mimeType<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/plain&#34;</span>)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    done <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> done <span style="color:#f92672">is</span> <span style="color:#66d9ef">False</span>:
</span></span><span style="display:flex;"><span>        status, done <span style="color:#f92672">=</span> downloader<span style="color:#f92672">.</span>next_chunk()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    service<span style="color:#f92672">.</span>files()<span style="color:#f92672">.</span>delete(fileId<span style="color:#f92672">=</span>res[<span style="color:#e6db74">&#39;id&#39;</span>])<span style="color:#f92672">.</span>execute()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Done.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/05/01/converting-pdf-to-txt/">Converting PDF to TXT</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>01 May 2017, 15:04</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">GoogleAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google">Google</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This is a sample script for converting a PDF file to a TXT file. 2 steps are required for this.</p>
<ol>
<li>Upload a PDF file as a Google Document</li>
<li>Download a Google Document as a TXT file</li>
</ol>
<p>In this sample, Python Quickstart is used. The detail information is <a href="https://developers.google.com/drive/v3/web/quickstart/python">https://developers.google.com/drive/v3/web/quickstart/python</a>. Please read &ldquo;Step 1: Turn on the Drive API&rdquo; and &ldquo;Step 2: Install the Google Client Library&rdquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> __future__ <span style="color:#f92672">import</span> print_function
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> httplib2
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> io
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> apiclient <span style="color:#f92672">import</span> discovery
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> oauth2client <span style="color:#f92672">import</span> client
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> oauth2client <span style="color:#f92672">import</span> tools
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> oauth2client.file <span style="color:#f92672">import</span> Storage
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> apiclient.http <span style="color:#f92672">import</span> MediaFileUpload, MediaIoBaseDownload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> argparse
</span></span><span style="display:flex;"><span>    flags <span style="color:#f92672">=</span> argparse<span style="color:#f92672">.</span>ArgumentParser(parents<span style="color:#f92672">=</span>[tools<span style="color:#f92672">.</span>argparser])<span style="color:#f92672">.</span>parse_args()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span> <span style="color:#a6e22e">ImportError</span>:
</span></span><span style="display:flex;"><span>    flags <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SCOPES <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://www.googleapis.com/auth/drive&#39;</span>
</span></span><span style="display:flex;"><span>CLIENT_SECRET_FILE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;client_secret.json&#39;</span>
</span></span><span style="display:flex;"><span>APPLICATION_NAME <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Drive API Python Quickstart&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_credentials</span>():
</span></span><span style="display:flex;"><span>    credential_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#34;./&#34;</span>, <span style="color:#e6db74">&#39;drive-python-quickstart.json&#39;</span>)
</span></span><span style="display:flex;"><span>    store <span style="color:#f92672">=</span> Storage(credential_path)
</span></span><span style="display:flex;"><span>    credentials <span style="color:#f92672">=</span> store<span style="color:#f92672">.</span>get()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> credentials <span style="color:#f92672">or</span> credentials<span style="color:#f92672">.</span>invalid:
</span></span><span style="display:flex;"><span>        flow <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>flow_from_clientsecrets(CLIENT_SECRET_FILE, SCOPES)
</span></span><span style="display:flex;"><span>        flow<span style="color:#f92672">.</span>user_agent <span style="color:#f92672">=</span> APPLICATION_NAME
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> flags:
</span></span><span style="display:flex;"><span>            credentials <span style="color:#f92672">=</span> tools<span style="color:#f92672">.</span>run_flow(flow, store, flags)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:  <span style="color:#75715e"># Needed only for compatibility with Python 2.6</span>
</span></span><span style="display:flex;"><span>            credentials <span style="color:#f92672">=</span> tools<span style="color:#f92672">.</span>run(flow, store)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;Storing credentials to &#39;</span> <span style="color:#f92672">+</span> credential_path)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> credentials
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    credentials <span style="color:#f92672">=</span> get_credentials()
</span></span><span style="display:flex;"><span>    http <span style="color:#f92672">=</span> credentials<span style="color:#f92672">.</span>authorize(httplib2<span style="color:#f92672">.</span>Http())
</span></span><span style="display:flex;"><span>    service <span style="color:#f92672">=</span> discovery<span style="color:#f92672">.</span>build(<span style="color:#e6db74">&#39;drive&#39;</span>, <span style="color:#e6db74">&#39;v3&#39;</span>, http<span style="color:#f92672">=</span>http)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pdffile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;sample.pdf&#39;</span>
</span></span><span style="display:flex;"><span>    txtfile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;sample.txt&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    mime <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;application/vnd.google-apps.document&#39;</span>
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> service<span style="color:#f92672">.</span>files()<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>        body<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;name&#39;</span>: pdffile,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;mimeType&#39;</span>: mime
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        media_body<span style="color:#f92672">=</span>MediaFileUpload(pdffile, mimetype<span style="color:#f92672">=</span>mime, resumable<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    )<span style="color:#f92672">.</span>execute()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dl <span style="color:#f92672">=</span> MediaIoBaseDownload(
</span></span><span style="display:flex;"><span>        io<span style="color:#f92672">.</span>FileIO(txtfile, <span style="color:#e6db74">&#39;wb&#39;</span>),
</span></span><span style="display:flex;"><span>        service<span style="color:#f92672">.</span>files()<span style="color:#f92672">.</span>export_media(fileId<span style="color:#f92672">=</span>res[<span style="color:#e6db74">&#39;id&#39;</span>], mimeType<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/plain&#34;</span>)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    done <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> done <span style="color:#f92672">is</span> <span style="color:#66d9ef">False</span>:
</span></span><span style="display:flex;"><span>        status, done <span style="color:#f92672">=</span> dl<span style="color:#f92672">.</span>next_chunk()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Done.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/03/20/download-files-without-authorization-from-google-drive/">Download Files Without Authorization From Google Drive</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>20 Mar 2017, 14:30</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">GoogleAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h1 id="overview">Overview</h1>
<p>In this article, files can be downloaded without authorization.</p>
<h1 id="description">Description</h1>
<p>When we download files from Google Drive, it usually has to use Drive API. In order to use Drive API, access token is required. If you want to make your friends download files from your Google Drive, the authorization process is to take time. Also Web Link for each files can be used. But it has to set for each files. So I proposal this.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/03/20/download-files-without-authorization-from-google-drive/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2016/10/30/python-library-souwapy/">Python Library - souwapy</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Oct 2016, 13:38</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/benchmark">Benchmark</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">Python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/souwapy">souwapy</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This &ldquo;souwapy&rdquo; is a library for summing array elements with high speed by new algorithm (<a href="https://tanaikech.github.io/2016/10/13/improved-algorithms-for-summation-of-array-elements/">Pyramid method</a>). The speed is faster than csv and panbdas module of python and v8 engine of node.js. The souwapy module is 2.3 and 3.1 times faster than csv and pandas module, respectively. This was really surprised me. It was found that the theory was correct.</p>
<p>At first, I have created this theory for Google Apps Script. But recently I had to use large data and output a csv file on python. So I made this library. Additionally, I had wanted to know how to public own library to PyPI before. This chance was good for me. If this library is helpful for other people, I&rsquo;m glad.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2016/10/30/python-library-souwapy/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2016/10/21/elements-duplicate-number-in-array-at-python/">Element&#39;s Duplicate Number in Array at Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>21 Oct 2016, 12:29</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">Python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/sample">sample</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>Suddenly I had to need this.</p>
<p>This script can get the duplicate number of each element in array at Python. In this script, the duplicate number of each element is obtained and sorted by the duplicate number. This was expressed by the comprehension.</p>
<pre tabindex="0"><code>data = [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;b&#39;, &#39;c&#39;, &#39;b&#39;]
result = sorted({i: data.count(i) for i in set(data)}.items(), key=lambda x: x[1], reverse=True)
print(result)

&gt;&gt;&gt; [(&#39;b&#39;, 4), (&#39;c&#39;, 3), (&#39;d&#39;, 2), (&#39;a&#39;, 1)]
</code></pre>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2016/10/13/gas-library-souwa_gas-effects-on-optimized-codes-of-pyramid-method/">GAS Library - SOUWA_GAS - Effects on Optimized Codes of Pyramid Method</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Oct 2016, 15:57</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/benchmark">Benchmark</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/c&#43;&#43;">c&#43;&#43;</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">Python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/go">Go</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/java">Java</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/ruby">Ruby</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <center>
Kanshi TANAIKE
</center>
<h2 id="abstract">Abstract</h2>
<p><a href="#ref1">I have already reported that the pyramid method is one of very effectively algolithms for summing string elements in an array using Google Apps Script (GAS).</a> This report describes the adaptability of the pyramid method to any languages except for GAS. c++ (g++), Go, Java, Javascript on Node.js, Python and Ruby were chosen as the sample languages. In those languages, there are languages which have the distinctive commands for summing the array elements. In this report, &ldquo;+&rdquo; operator as a standard command and a special command for each language were used. For c++ (g++), Javascript on Node.js and Python which have no distinctive commands for summing the array elements, only &ldquo;+&rdquo; operator was used. For others, both &ldquo;+&rdquo; operator and each special command such as &ldquo;[]byte&rdquo;, &ldquo;StringBuilder&rdquo; and &ldquo;&laquo;&rdquo; were used. For languages without the distinctive commands for summing, the pyramid method made us show some interesting phenomena. It was found that the pyramid method shows a good effect on only the specific language. It was found that &ldquo;+&rdquo; operator had been optimized for g++ and Node.js. &ldquo;+&rdquo; operator of Python was corresponding to theoretical results. This means that &ldquo;+&rdquo; operator of Python is not optimized. On the other hand, for languages with the distinctive commands for summing, it was found that the distinctive commands is incompatible to the pyramid method. These results made us show the possibility of visualization for the optimized codes.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2016/10/13/gas-library-souwa_gas-effects-on-optimized-codes-of-pyramid-method/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>
