<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="Official profile of Kanshi Tanaike, a Google Developer Expert (GDE) in Google Workspace and Physicist. Specializing in Google Apps Script, Gemini API, and innovative IT solutions.">
  <meta name="generator" content="Hugo 0.157.0">

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tanaikech.github.io/img/og-main.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>tanaike - Google Apps Script, Gemini API Expert & Physicist</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  
  <link rel="alternate" type="application/rss+xml" title="tanaike - Google Apps Script, Gemini API, and Developer Tips"
    href='https://tanaikech.github.io/tags/drive-api/index.xml' />
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Kanshi Tanaike",
  "alternateName": "tanaike",
  "url": "https://tanaikech.github.io/",
  "image": "https://tanaikech.github.io/img/og-main.png",
  "jobTitle": "Google Developer Expert",
  "honorificPrefix": "Ph.D.",
  "description": "Japanese scientist, Physicist and Google Developer Expert for Google Workspace.",
  "award": "First place in the Outstanding GDE Award 2025",
  "sameAs": [
    "https://twitter.com/tanaikech",
    "https://github.com/tanaikech",
    "https://stackoverflow.com/users/7108653/tanaike",
    "https://developers.google.com/community/experts/directory?text=tanaike",
    "https://zenn.dev/tanaike",
    "https://medium.com/@tanaike"
  ]
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href='https://tanaikech.github.io/tags/drive-api/index.xml'><i
          class="fas fa-rss fa-fw"></i>RSS</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://www.youtube.com/@tanaike" rel="me" target="_blank"><i class="fab fa-youtube-square fa-fw"></i>YouTube</a>
    </li>
    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2026. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Drive Api</h1>
</div>

<div class="content">
  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/08/24/a-versatile-approach-to-uploading-files-with-node.js-integrating-gemini-drive-youtube-and-other-apis/">A Versatile Approach to Uploading Files with Node.js: Integrating Gemini, Drive, YouTube, and Other APIs</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>24 Aug 2024, 15:09</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/resumable-upload">resumable upload</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/7340cc7c87ec0f701dfb2f0351e02031">Gists</a></p>
<h1 id="abstract">Abstract</h1>
<p>A script using resumable upload with file streams is proposed to enhance file handling within the Gemini Generative AI API for Node.js. This script allows uploading from web URLs and local storage, efficiently handles large files, and offers potential reusability with other Google APIs.</p>
<h1 id="description">Description</h1>
<p>The <code>@google/generative-ai</code> library provides a powerful way to interact with the Gemini Generative AI API using Node.js. This enables developers to programmatically generate creative text formats, translate languages, write different kinds of creative content, and answer your questions in an informative way, all powered by Gemini&rsquo;s advanced AI models. <a href="https://github.com/google-gemini/generative-ai-js">Ref</a></p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2024/08/24/a-versatile-approach-to-uploading-files-with-node.js-integrating-gemini-drive-youtube-and-other-apis/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/06/22/analyzing-folder-structures-with-google-apps-script/">Analyzing Folder Structures with Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>22 Jun 2024, 14:38</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/aa654883775702d02bc3e40fdc3af69e">Gists</a></p>
<h1 id="abstract">Abstract</h1>
<p>This report provides a Google Apps Script to retrieve all files, including those within subfolders, for a designated folder. It addresses the challenges of retrieving files within deeply nested folder structures and obtaining complete file paths.</p>
<h1 id="introduction">Introduction</h1>
<p>Google Apps Script empowers developers to interact with Google Drive data programmatically, unlocking a wide range of functionalities. A core component of this interaction is the Drive service (DriveApp) and Drive API. These services provide programmatic control over files and folders within your Drive.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2024/06/22/analyzing-folder-structures-with-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2024/06/06/move-folder-including-files-and-folders-in-google-drive-using-google-apps-script/">Move Folder including Files and Folders in Google Drive using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>06 Jun 2024, 11:42</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/5e79afbc50be824e02c6ba138f905e5c">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20240606a/fig1.png" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>This script automates moving a folder including files and folders between Google Drives (personal or shared) by recreating the folder structure and transferring files, overcoming limitations for shared drives.</p>
<h1 id="introduction">Introduction</h1>
<p>This report addresses a common challenge: efficiently moving folders, including their subfolders and files, between Google Drives, encompassing both personal and shared drives using a script. While Google Drive offers straightforward methods for moving individual files between any drives, directly moving entire folders containing subfolders presents limitations, particularly when shared drives are involved. This script bridges that gap by providing a reliable Google Apps Script solution for such scenarios.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2024/06/06/move-folder-including-files-and-folders-in-google-drive-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/06/24/comparing-file-contents-of-files-on-google-drive-using-google-apps-script/">Comparing File Contents of Files on Google Drive using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>24 Jun 2023, 15:02</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/ed64668e23c155138baa300a31d7f16f">Gists</a></p>
<p>This is a sample script for comparing the file contents of files on Google Drive using Google Apps Script.</p>
<h2 id="sample-script">Sample script</h2>
<p>Before you use this script, please enable Drive API at Advanced Google services. And also, please set the file IDs you want to check whether the file contents of the files are the same.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">checkFiles_</span>(<span style="color:#a6e22e">f</span>, <span style="color:#a6e22e">checks</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;md5Checksum&#34;</span>, <span style="color:#e6db74">&#34;sha1Checksum&#34;</span>, <span style="color:#e6db74">&#34;sha256Checksum&#34;</span>]) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">files</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">id</span> =&gt; <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">id</span>));
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fields</span> <span style="color:#f92672">=</span> [...<span style="color:#a6e22e">checks</span>, <span style="color:#e6db74">&#34;id&#34;</span>].<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;,&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">o</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">o</span>, <span style="color:#a6e22e">f</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">mimeType</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">getMimeType</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ([<span style="color:#e6db74">&#34;FOLDR&#34;</span>, <span style="color:#e6db74">&#34;SHORTCUT&#34;</span>].<span style="color:#a6e22e">some</span>(<span style="color:#a6e22e">m</span> =&gt; <span style="color:#a6e22e">mimeType</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">MimeType</span>[<span style="color:#a6e22e">m</span>])) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Folders cannot be checked.&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">obj</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">mimeType</span>.<span style="color:#a6e22e">includes</span>(<span style="color:#e6db74">&#34;application/vnd.google-apps&#34;</span>)) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">getName</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">setName</span>(<span style="color:#e6db74">&#34;temp&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">sleep</span>(<span style="color:#ae81ff">2000</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">insert</span>({ <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;temp&#34;</span>, <span style="color:#a6e22e">mimeType</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">MimeType</span>.<span style="color:#a6e22e">PDF</span> }, <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">getBlob</span>(), { <span style="color:#a6e22e">supportsAllDrives</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>, <span style="color:#a6e22e">fields</span> });
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">setName</span>(<span style="color:#a6e22e">name</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">remove</span>(<span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">id</span>); <span style="color:#75715e">// If an error occurs, please use DriveApp.getFileById(obj.id).setTrashed(true);
</span></span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">get</span>(<span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">getId</span>(), { <span style="color:#a6e22e">supportsAllDrives</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>, <span style="color:#a6e22e">fields</span> });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">checks</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#a6e22e">e</span> =&gt; <span style="color:#a6e22e">o</span>[<span style="color:#a6e22e">e</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">o</span>[<span style="color:#a6e22e">e</span>] <span style="color:#f92672">?</span> [...<span style="color:#a6e22e">o</span>[<span style="color:#a6e22e">e</span>], <span style="color:#a6e22e">obj</span>[<span style="color:#a6e22e">e</span>]] <span style="color:#f92672">:</span> [<span style="color:#a6e22e">obj</span>[<span style="color:#a6e22e">e</span>]]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">o</span>;
</span></span><span style="display:flex;"><span>  }, {});
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> Object.<span style="color:#a6e22e">values</span>(<span style="color:#a6e22e">o</span>).<span style="color:#a6e22e">every</span>(<span style="color:#a6e22e">e</span> =&gt; [...<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Set</span>(<span style="color:#a6e22e">e</span>)].<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Please run this function.
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">file1</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###fileId1###&#34;</span>; <span style="color:#75715e">// Please set your file ID of file 1.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">file2</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###fileId2###&#34;</span>; <span style="color:#75715e">// Please set your file ID of file 2.
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">check</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">checkFiles_</span>([<span style="color:#a6e22e">file1</span>, <span style="color:#a6e22e">file2</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`&#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">file1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; and &#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">file2</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; are</span><span style="color:#e6db74">${</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">check</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34; &#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34; not &#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">}</span><span style="color:#e6db74">the same data.`</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>
<p>When this script is run, when the file contents of your inputted files are the same, <code>true</code> is returned.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/06/24/comparing-file-contents-of-files-on-google-drive-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/02/28/resumable-download-of-file-from-google-drive-using-drive-api-with-python/">Resumable Download of File from Google Drive using Drive API with Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>28 Feb 2023, 11:58</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/googledrive">GoogleDrive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/dfdad37859d591526b2fba8fb4390cf5">Gists</a></p>
<p>This is a sample script for achieving the resumable download of a file from Google Drive using Dive API with Python.</p>
<p>There might be a case in that you want to achieve the resumable download of a file from Google Drive using Dive API with Python. For example, when a large file is downloaded, the downloading might be stopped in the middle of downloading. At that time, you might want to resume the download. In this post, I would like to introduce the sample script of python.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/02/28/resumable-download-of-file-from-google-drive-using-drive-api-with-python/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/02/24/retrieving-total-file-sizes-in-specific-folder-of-google-drive-using-google-apps-script/">Retrieving Total File Sizes in Specific Folder of Google Drive using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>24 Feb 2023, 14:25</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/googledrive">GoogleDrive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/bbf37f05f5f5a98d346295f6e4aa3c48">Gists</a></p>
<p>This is a sample script for retrieving the total file sizes in the specific folder of Google Drive using Google Apps Script.</p>
<p>There is a case where you want to retrieve the total file sizes in the specific folder of Google Drive using Google Apps Script. In this post, I would like to introduce a sample script for achieving this.</p>
<h2 id="sample-script">Sample script</h2>
<p>Before you use this script, please enable Drive API at Advanced Google services. And please install <a href="https://github.com/tanaikech/FilesApp">FilesApp</a> of a Google Apps Script library.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/02/24/retrieving-total-file-sizes-in-specific-folder-of-google-drive-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2023/01/09/transferring-owner-of-file-to-other-user-using-google-apps-script/">Transferring Owner of File to Other User using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Jan 2023, 15:04</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/685929fd4e739c943ab0b4c53348a4af">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230109a/fig1a.png" alt=""></p>
<p>This is a sample script for transferring the ownership of a file to another user using Google Apps Script.</p>
<p>In the current stage, about the consumer account (gmail.com) the specification for transferring the ownership of a file has been changed as follows. <a href="https://developers.google.com/drive/api/guides/manage-sharing#transfer-consumer-account">Ref</a></p>
<blockquote>
<ol>
<li>The current owner initiates an ownership transfer by creating or updating the prospective new owner&rsquo;s file permission. The permission must include these settings: role=writer, type=user, and pendingOwner=true. If the new owner is creating a permission for the prospective owner, an email notification is sent to the prospective new owner indicating that they&rsquo;re being asked to assume ownership of the file.</li>
</ol>
</blockquote>
<blockquote>
<ol start="2">
<li>The new owner accepts the ownership transfer request by creating or updating their file permission. The permission must include these settings: role=owner and transferOwnership=true. If the new owner is creating a new permission, an email notification is sent to the previous owner indicating that ownership has been transferred.</li>
</ol>
</blockquote>
<p>When this flow is reflected in the sample script, it becomes as follows.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2023/01/09/transferring-owner-of-file-to-other-user-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/10/19/workaround-createddate-cannot-be-used-with-searchfiles-of-driveapp-in-google-apps-script/">Workaround: createdDate cannot be used with searchFiles of DriveApp in Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>19 Oct 2022, 10:42</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/2b9d86a7db01f72e88090116cb5fee1f">Gists</a></p>
<p>Unfortunately, in the current stage, in order to retrieve the file list using the created date, the search query of <code>createdDate</code> cannot be used with <code>searchFiles</code> method of <code>DriveApp</code> in Google Apps Script. This has already been reported at <a href="https://issuetracker.google.com/issues/79355545">this issue tracker</a> In this post, I would like to introduce a workaround for searching the files using the created date.</p>
<h2 id="issue-and-workaround">Issue and workaround</h2>
<ul>
<li>
<p>The parameter of &ldquo;searchFiles&rdquo; method of <code>DriveApp</code> uses the search query for Drive API v2. When I tested <code>createdDate &gt; '####-##-##'</code> for &ldquo;searchFiles&rdquo; and &ldquo;Files: list&rdquo; of Drive API v2, I confirmed errors like <code>Invalid argument: q</code> and <code>Invalid query</code> occurred, respectively.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/10/19/workaround-createddate-cannot-be-used-with-searchfiles-of-driveapp-in-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/08/07/sample-script-for-resumable-upload-to-google-drive-using-axios-with-node.js/">Sample Script for Resumable Upload to Google Drive using Axios with Node.js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>07 Aug 2022, 09:26</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/axios">Axios</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/resumable-upload">resumable-upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/5212f2a8127e1c0a70c8642e298ae661">Gists</a></p>
<p>This is a sample script for the resumable upload using Axios with Node.js.</p>
<h2 id="sample-script">Sample script</h2>
<p>In this sample script, as a sample situation in order to explain the resumable upload, the file data is loaded from the local PC, and the data is uploaded to Google Drive with the resumable upload.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">axios</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;axios&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fs</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;fs&#34;</span>).<span style="color:#a6e22e">promises</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">filepath</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./###&#34;</span>; <span style="color:#75715e">// Please set the filename and file path of the upload file.
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">new_access_token</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set your access token.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the filename on Google Drive.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">mimeType</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the mimeType of the uploading file. I thought that when this might not be required to be used.
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 1. Prepare chunks from loaded file data.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">split</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">262144</span>; <span style="color:#75715e">// This is a sample chunk size.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">readFile</span>(<span style="color:#a6e22e">filepath</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fileSize</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">array</span> <span style="color:#f92672">=</span> [...<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Int8Array</span>(<span style="color:#a6e22e">data</span>)];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">chunks</span> <span style="color:#f92672">=</span> [...Array(Math.<span style="color:#a6e22e">ceil</span>(<span style="color:#a6e22e">array</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">/</span> <span style="color:#a6e22e">split</span>))].<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">_</span>) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Int8Array</span>(<span style="color:#a6e22e">array</span>.<span style="color:#a6e22e">splice</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">split</span>)))
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 2. Retrieve endpoint for uploading a file.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res1</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">axios</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;POST&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">url</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://www.googleapis.com/upload/drive/v3/files?uploadType=resumable&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">Authorization</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Bearer </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">new_access_token</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;Content-Type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json&#34;</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">data</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">mimeType</span> }),
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">location</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">res1</span>.<span style="color:#a6e22e">headers</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 3. Upload the data using chunks.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">start</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">chunks</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">end</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">start</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">chunks</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res2</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">axios</span>({
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;PUT&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">url</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">location</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> { <span style="color:#e6db74">&#34;Content-Range&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`bytes </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">start</span><span style="color:#e6db74">}</span><span style="color:#e6db74">-</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">end</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">fileSize</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span> },
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">data</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">chunks</span>[<span style="color:#a6e22e">i</span>],
</span></span><span style="display:flex;"><span>    }).<span style="color:#66d9ef">catch</span>(({ <span style="color:#a6e22e">response</span> }) =&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>({ <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">status</span>, <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">data</span> })
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">start</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">end</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">res2</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">data</span>) <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res2</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">data</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">sample</span>();
</span></span></code></pre></div><h2 id="testing">Testing</h2>
<p>When this sample script is run, the following result is obtained.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2022/08/07/sample-script-for-resumable-upload-to-google-drive-using-axios-with-node.js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2022/05/28/uploading-files-to-google-drive-with-asynchronous-process-using-python/">Uploading Files to Google Drive with Asynchronous Process using Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>28 May 2022, 09:45</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/a4cfbea4935b8c281d1f6abb91016705">Gists</a></p>
<p>This is a sample script for uploading files to Google Drive with asynchronous process using Python.</p>
<h2 id="sample-script">Sample script</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> aiohttp
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> asyncio
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>folder_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span> <span style="color:#75715e"># Please set the folder ID you want to put.</span>
</span></span><span style="display:flex;"><span>token <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span> <span style="color:#75715e"># Please set your access token.</span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://www.googleapis.com/upload/drive/v3/files&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">workers</span>(file):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">with</span> aiohttp<span style="color:#f92672">.</span>ClientSession() <span style="color:#66d9ef">as</span> session:
</span></span><span style="display:flex;"><span>        metadata <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;name&#34;</span>: file[<span style="color:#e6db74">&#34;filename&#34;</span>], <span style="color:#e6db74">&#34;parents&#34;</span>: [folder_id]}
</span></span><span style="display:flex;"><span>        data <span style="color:#f92672">=</span> aiohttp<span style="color:#f92672">.</span>FormData()
</span></span><span style="display:flex;"><span>        data<span style="color:#f92672">.</span>add_field(<span style="color:#e6db74">&#34;metadata&#34;</span>, json<span style="color:#f92672">.</span>dumps(metadata), content_type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;application/json; charset=UTF-8&#34;</span>)
</span></span><span style="display:flex;"><span>        data<span style="color:#f92672">.</span>add_field(<span style="color:#e6db74">&#34;file&#34;</span>, open(file[<span style="color:#e6db74">&#34;path&#34;</span>], <span style="color:#e6db74">&#34;rb&#34;</span>))
</span></span><span style="display:flex;"><span>        headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;Authorization&#34;</span>: <span style="color:#e6db74">&#34;Bearer &#34;</span> <span style="color:#f92672">+</span> token}
</span></span><span style="display:flex;"><span>        params <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;uploadType&#34;</span>: <span style="color:#e6db74">&#34;multipart&#34;</span>}
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">with</span> session<span style="color:#f92672">.</span>post(url, data<span style="color:#f92672">=</span>data, params<span style="color:#f92672">=</span>params, headers<span style="color:#f92672">=</span>headers) <span style="color:#66d9ef">as</span> resp:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">await</span> resp<span style="color:#f92672">.</span>json()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Please set the filenames and the file paths as follows.</span>
</span></span><span style="display:flex;"><span>    fileList <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>        {<span style="color:#e6db74">&#34;filename&#34;</span>: <span style="color:#e6db74">&#34;sample1&#34;</span>, <span style="color:#e6db74">&#34;path&#34;</span>: <span style="color:#e6db74">&#34;./sample1.png&#34;</span>},
</span></span><span style="display:flex;"><span>        ,
</span></span><span style="display:flex;"><span>        ,
</span></span><span style="display:flex;"><span>        ,
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>    works <span style="color:#f92672">=</span> [asyncio<span style="color:#f92672">.</span>create_task(workers(e)) <span style="color:#66d9ef">for</span> e <span style="color:#f92672">in</span> fileList]
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> asyncio<span style="color:#f92672">.</span>gather(<span style="color:#f92672">*</span>works)
</span></span><span style="display:flex;"><span>    print(res)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>asyncio<span style="color:#f92672">.</span>run(main())
</span></span></code></pre></div><ul>
<li>When this script is run, the files of <code>fileList</code> are uploaded to Google Drive with the asynchronous process.</li>
</ul>
<h2 id="note">Note</h2>
<ul>
<li>This sample supposes that your access token can be used for uploading files to Google Drive using Drive API. Please be careful about this.</li>
</ul>
<h2 id="reference">Reference</h2>
<ul>
<li>I answered this sample script for <a href="https://stackoverflow.com/q/72399888/7108653">this thread of Stackoverflow</a></li>
</ul>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2021/04/27/specification-of-search-query-for-file-list-method-in-drive-api/">Specification of Search Query for File List Method in Drive API</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>27 Apr 2021, 15:58</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/search">search</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/268baf07f92f3b3962c86c6ea75b786a">Gists</a></p>
<p>In this report, I would like to report about the current specification of the search query for the file list method in Drive API.</p>
<p>Recently, I noticed that the specification of the search query for the file list method in Drive API might have been changed. I thought that to know the change of specification of the search query is important for creating the application using Drive API. In this report, I would like to introduce the current specification of the search query.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2021/04/27/specification-of-search-query-for-file-list-method-in-drive-api/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2021/01/05/simple-script-of-resumable-upload-with-google-drive-api-for-axios/">Simple Script of Resumable Upload with Google Drive API for Axios</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>05 Jan 2021, 21:18</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/axios">Axios</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/resumable-upload">resumable-upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/0e33b7a850e8c56d111ed0f32df0b485">Gists</a></p>
<p>This is a simple sample script for achieving the resumable upload to Google Drive using Axios. In order to achieve the resumable upload, at first, it is required to retrieve the location, which is the endpoint of upload. The location is included in the response headers. After the location was retrieved, the file can be uploaded to the location URL.</p>
<p>In this sample, a text data is uploaded with the resumable upload using a single chunk.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2021/01/05/simple-script-of-resumable-upload-with-google-drive-api-for-axios/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2021/01/05/downloading-and-uploading-file-to-google-drive-without-saving-file-with-stream-and-resumable-upload-using-node.js/">Downloading and Uploading File to Google Drive without Saving File with Stream and Resumable Upload using Node.js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>05 Jan 2021, 15:38</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/resumable-upload">resumable-upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/download">download</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/stream">stream</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/99187753ceb5fd55d343b52dcbe176a5">Gists</a></p>
<p>This is a sample script of Node.js for downloading the data and uploading the data to Google Drive with the resumable upload without saving it as a file. The downloaded data is uploaded to Google Drive with the stream.</p>
<h2 id="sample-script">Sample script</h2>
<p>Before you use this, please set the variables of <code>accessToken</code>, <code>url</code>, <code>fileSize</code>, <code>mimeType</code> and <code>filename</code>. In this case, <code>fileSize</code> is required to set because the data is uploaded with the resumable upload.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2021/01/05/downloading-and-uploading-file-to-google-drive-without-saving-file-with-stream-and-resumable-upload-using-node.js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/07/31/gas-library-gasprojectapp/">GAS Library - GASProjectApp</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>31 Jul 2020, 16:22</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p><strong>This is a Google Apps Script library for creating, updating and exporting Google Apps Script project of the standalone type using Drive API. In this case, Apps Script API is not used.</strong></p>
<h2 id="description">Description</h2>
<p>I had reported &ldquo;Drive API cannot create Google Apps Script project no longer&rdquo; before. <a href="https://gist.github.com/tanaikech/0609f2cd989c28d6bd49d211b70b453d">Ref</a> About this, I had reported the future request. <a href="https://issuetracker.google.com/issues/151165846">Ref</a> At July 30, 2020, I could confirm that the Google Apps Script project of the standalone type got to be able to be created by <code>multipart/form-data</code> using Drive API again. <a href="https://gist.github.com/tanaikech/36821c7d70f9ce376d043c3d682d404e">Ref</a> This is a good news for me. By this, in order to use this with Google Apps Script, I created this library. Because in this case, when the update method is used, the special scope of <code>https://www.googleapis.com/auth/drive.scripts</code> is required. So I thought that when this is published as the Google Apps Script library, this will be useful for users.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/07/31/gas-library-gasprojectapp/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/07/30/drive-api-got-to-be-able-to-create-google-apps-script-project-again/">Drive API got to be able to create Google Apps Script project again</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Jul 2020, 17:23</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/news">news</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/36821c7d70f9ce376d043c3d682d404e">Gists</a></p>
<p>I have reported &ldquo;Drive API cannot create Google Apps Script project no longer&rdquo;. <a href="https://gist.github.com/tanaikech/0609f2cd989c28d6bd49d211b70b453d">Ref</a> About this, I had reported the future request. <a href="https://issuetracker.google.com/issues/151165846">Ref</a> Today, I could confirm that the Google Apps Script project of the standalone type got to be able to be created by <code>multipart/form-data</code> using Drive API. This is a good news for me. By this, the following 2 patterns can be used from now.</p>
<h2 id="pattern-1">Pattern 1:</h2>
<ol>
<li>Create new standalone GAS project by Apps Script API.</li>
<li>Put the local script to the created GAS project by updating the project with Apps Script API.</li>
<li>Move the GAS project from the root folder to the specific folder using Drive API.</li>
</ol>
<p>In this pattern, 3 API calls are required.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/07/30/drive-api-got-to-be-able-to-create-google-apps-script-project-again/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/07/30/uploading-files-of-multipart/form-data-to-google-drive-using-drive-api-with-node.js/">Uploading Files of multipart/form-data to Google Drive using Drive API with Node.js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Jul 2020, 11:13</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/33563b6754e5054f3a5832667100fe91">Gists</a></p>
<p>These are the sample scripts for uploading files of <code>multipart/form-data</code> to Google Drive using Drive API with Node.js. In this case, <a href="https://github.com/googleapis/google-api-nodejs-client">googleapis for Node.js</a> is not used.</p>
<p>In these sample script, the maximum file size is 5 MB. Please be careful this. When you want to upload the files more than 5 MB, please check <a href="https://gist.github.com/tanaikech/ae451679e8220f3b2d48edb3f8c1a8d3">this report</a>.</p>
<h2 id="sample-script-1">Sample script 1</h2>
<p>This sample script uploads a file using the modules of <code>fs</code> and <code>request</code>. Before you use this script, please prepare your access token for uploading the file.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/07/30/uploading-files-of-multipart/form-data-to-google-drive-using-drive-api-with-node.js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/07/13/gas-library-ownershiptransfer/">GAS Library - OwnershipTransfer</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Jul 2020, 13:39</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p><strong>This is a Google Apps Script library for achieving the ownership-transfer of the specific folder including the files and sub-folders using Drive API.</strong></p>
<p><img src="https://github.com/tanaikech/OwnershipTransfer/raw/master/images/fig1.png" alt=""></p>
<p><a name="description"></a></p>
<h2 id="important-please-be-careful-this">IMPORTANT: PLEASE BE CAREFUL THIS.</h2>
<h3 id="at-first-please-read-this-section"><strong>At first, please read this section</strong></h3>
<h3><strong><u>I cannot take responsibility for the problems occurred by this library. So when you use this library, please use it by according to your own decision and at your own responsibility.</u></strong></h3>
<p><img src="https://github.com/tanaikech/OwnershipTransfer/raw/master/images/fig2.png" alt=""></p>
<h4 id="this-gas-library-transfers-the-ownership-of-files-and-folders-for-example-when-the-ownership-of-a-file-is-transferred-to-other-account-the-file-cannot-be-managed-by-the-original-user-and-also-when-the-ownership-of-the-specific-folder-is-transferred-to-other-account-all-files-ans-sub-folders-in-the-specific-folder-cannot-be-managed-by-the-original-user-please-be-careful-this-so-when-you-use-this-library-at-first-please-test-this-library-using-a-sample-file-and-folder-please-be-careful-this"><strong>This GAS library transfers the ownership of files and folders. For example, when the ownership of a file is transferred to other account, the file cannot be managed by the original user. And also, when the ownership of the specific folder is transferred to other account, all files ans sub-folders in the specific folder cannot be managed by the original user. PLEASE BE CAREFUL THIS. So when you use this library, at first, please test this library using a sample file and folder. PLEASE BE CAREFUL THIS.</strong></h4>
<h4 id="and-also-the-specification-of-ownership-transfer-might-be-updated-by-google-side-in-the-future-update-because-when-i-had-tested-this-library-i-could-notice-that-the-specification-had-been-changed"><strong>And also, the specification of ownership transfer might be updated by Google side in the future update. Because when I had tested this library, I could notice that the specification had been changed. <a href="https://tanaikech.github.io/2020/07/10/transfer-of-owner-of-files-got-to-be-able-to-be-achieved-with-batch-requests-of-drive-api/">Ref</a> By this, I noticed that the transferred files had no parent folders, and also, the script was required to be modified. From this situation, when you use this script for your important files and folders, please be careful this. At first, PLEASE TEST THIS LIBRARY USING A SIMPLE FILE AND FOLDER.</strong></h4>
<h2 id="description">Description</h2>
<p>Recently, I had the situation that it is required to transfer the ownership of a folder including the files and sub-folders. When I manually transferred the ownership of the top folder from my account to other user&rsquo;s account, although the ownership of top folder could be transferred, my account is left as the writer. And also, the ownership of the files and sub-folders in the top folder was not changed, while the user is the writer. Although I do the same situation using the method of create.permissions in Drive API, the same result was obtained. In the current stage, unfortunately, by the simple method, the complete ownership-transfer of the file including the files and sub-folders cannot be achieved. From this situation, I created the script for achieving the complete ownership-transfer of the files and folders as a Google Apps Script library.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/07/13/gas-library-ownershiptransfer/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/07/09/specification-of-files-copy-in-drive-api-was-changed/">Specification of Files: copy in Drive API was changed</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Jul 2020, 17:03</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/news">news</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>I noticed that the specification of Files: copy in Drive API was changed. About <a href="https://developers.google.com/drive/api/v3/reference/files/copy">the method of Files: copy in Drive API v3</a>, this method could be used with the scope of <code>https://www.googleapis.com/auth/drive.readonly</code> until July 5, 2020. But I confirmed that in the current stage, the scope is required to be changed to the following scopes.</p>
<ul>
<li><code>https://www.googleapis.com/auth/drive</code></li>
<li><code>https://www.googleapis.com/auth/drive.file</code></li>
<li><code>https://www.googleapis.com/auth/drive.appdata</code></li>
<li><code>https://www.googleapis.com/auth/drive.photos.readonly</code></li>
</ul>
<p>Please be careful this.</p>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/06/29/report-processing-to-create-new-file-to-specific-folder-using-drive-api/">Report: Processing to Create New File to Specific Folder using Drive API</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>29 Jun 2020, 13:59</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/d034e38169503c2c22eb0c3352ae30b6">Gists</a></p>
<p>In this report, I would like to report for processing to create new file to the specific folder using Drive API. When the new file is created to the specific folder using Drive API, the property of <code>parents</code> with the value of folder ID is included in the request body of the method &ldquo;Files: create&rdquo;. About this process, I had thought that the file is directly created to the specific folder. But, I could confirm that the new file is created by the following process.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/06/29/report-processing-to-create-new-file-to-specific-folder-using-drive-api/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/06/15/batch-requests-for-drive-api-using-google-apps-script/">Batch Requests for Drive API using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15 Jun 2020, 11:33</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/batch-request">batch request</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p><strong>These are the sample scripts of the batch requests for Drive API using Google Apps Script.</strong></p>
<h2 id="description">Description</h2>
<p>When we want to manage the files and folders on Google Drive, we have 2 ways. One is the use of <a href="https://developers.google.com/apps-script/reference/drive">Drive service</a>. Another is the use of <a href="https://developers.google.com/drive">Drive API</a>. In the case of them, when we want to manage a lot of files and folders, unfortunately, both ways have no batch requests. Namely, for example, the metadata of a lot of files are changed, <a href="https://developers.google.com/apps-script/reference/drive/file">the methods in Class File</a> and <a href="https://developers.google.com/drive/api/v3/reference/files/update">Files: update</a> are required to be used in the loop. In this case, the process cost will be high. On the other hand, Drive API can use <a href="https://developers.google.com/drive/api/v3/batch">the batch requests</a>. But in this case, in order to use this batch requests with Google Apps Script, it is required to create the request body of <code>multipart/mixed</code> by each user. Because there are no methods for automatically requests the batch requests. From this situation, here, I would like to introduce the simple sample scripts for creating, updating and deleting the files and folders on Google Drive using the batch requests with Google Apps Script.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/06/15/batch-requests-for-drive-api-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/05/28/creating-shortcut-on-google-drive-using-google-apps-script/">Creating Shortcut on Google Drive using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>28 May 2020, 14:49</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/shortcut">shortcut</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/4639cccc8130cea10d753fee9f900041">Gists</a></p>
<p>This is a sample script for creating a shortcut on Google Drive using Google Apps Script.</p>
<h2 id="sample-script">Sample script</h2>
<p>Before you run the script, <a href="https://developers.google.com/apps-script/guides/services/advanced#enabling_advanced_services">please enable Drive API at Advanced Google services</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">createShortcut</span>(<span style="color:#a6e22e">targetId</span>, <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">folderId</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">resource</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">shortcutDetails</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">targetId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">targetId</span> },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">name</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mimeType</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/vnd.google-apps.shortcut&#34;</span>,
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">folderId</span>) <span style="color:#a6e22e">resource</span>.<span style="color:#a6e22e">parents</span> <span style="color:#f92672">=</span> [{ <span style="color:#a6e22e">id</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">folderId</span> }];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">shortcut</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">insert</span>(<span style="color:#a6e22e">resource</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">shortcut</span>.<span style="color:#a6e22e">id</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Please run this function.
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">targetId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the ID of target file or folder.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">shortcutName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the shortcut name.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">folderId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the folder ID for putting the created shortcut.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">id</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">createShortcut</span>(<span style="color:#a6e22e">targetId</span>, <span style="color:#a6e22e">shortcutName</span>, <span style="color:#a6e22e">folderId</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">id</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="references">References</h2>
<ul>
<li>
<p><a href="https://developers.google.com/apps-script/guides/services/advanced">Advanced Google services</a></p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/05/28/creating-shortcut-on-google-drive-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/05/26/gas-library-copyfolder/">GAS Library - CopyFolder</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>26 May 2020, 07:53</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/copy">copy</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <h2 id="overview">Overview</h2>
<p><strong>This is Google Apps Script library for copying folder on Google Drive.</strong></p>
<p><img src="https://github.com/tanaikech/CopyFolder/blob/master/images/fig1.png" alt=""></p>
<h2 id="description">Description</h2>
<p>I have sometimes the situation that it is required to back up the folder on Google Drive to Google Drive. But unfortunately, the method of <a href="https://developers.google.com/apps-script/reference/drive/file#makecopy"><code>makeCopy()</code></a> of Class File and the method of <a href="https://developers.google.com/drive/api/v3/reference/files/copy"><code>Files: copy</code></a> of Drive API cannot be used for directly copying the folder on Google Drive. So I created this as a library. This library can copy the folder on Google Drive. All files in the folder can be copied to Google Drive with keeping the folder structure. When there are the files with newer modified time in the source folder than those in the destination folder, the files in the destination folder are overwritten by the newer files in the source folder. Also, in this library, the folders in the shared Drive and the publicly shared folders can be used as the source and destination folder.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/05/26/gas-library-copyfolder/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/04/20/updating-a-file-with-resumable-upload-using-drive-api/">Updating a File with Resumable Upload using Drive API</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>20 Apr 2020, 14:41</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/curltips">CurlTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/resumable-upload">resumable-upload</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/bc33a83ac648911d00b43c59a24268fc">Gists</a></p>
<p>This is a sample flow for updating a file with the resumable upload using Drive API.</p>
<h2 id="sample-situation">Sample situation:</h2>
<p>In this answer, as a sample situation, it supposes that a text file in Google Drive is updated by the resumable upload with the multiple chunks. And as the method for requesting, I use the curl command.</p>
<p>I prepared 2 files for 2 chunks. As the test situation, the 2 chunks of <strong>262,144 bytes</strong> and <strong>37,856 bytes</strong> are uploaded. So total upload size is <strong>300,000 bytes</strong>. Those filenames are <code>data1.txt</code> and <code>data2.txt</code>, respectively.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/04/20/updating-a-file-with-resumable-upload-using-drive-api/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/03/13/retrieving-files-and-folders-without-parents-in-google-drive/">Retrieving Files and Folders without Parents in Google Drive</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Mar 2020, 17:00</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/459089e678bad943f0f33e497e04c36f">Gists</a></p>
<p>This is a sample script for retrieving the files and folders which have no parents in own Google Drive.</p>
<p>When you use this script, please enable Drive API at Advanced Google services.</p>
<h2 id="sample-script">Sample script</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">myFunction</span> <span style="color:#f92672">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">token</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">getOAuthToken</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fields</span> <span style="color:#f92672">=</span> decodeURIComponent(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;nextPageToken,files(name,id,mimeType,parents)&#34;</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">q</span> <span style="color:#f92672">=</span> decodeURIComponent(<span style="color:#e6db74">&#34;&#39;me&#39; in owners and trashed = false&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">files</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">pageToken</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`https://www.googleapis.com/drive/v3/files?pageSize=1000&amp;fields=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">fields</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&amp;q=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">q</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&amp;pageToken=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">pageToken</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>      { <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">authorization</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Bearer </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">token</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span> } }
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">res</span>);
</span></span><span style="display:flex;"><span>    Array.<span style="color:#a6e22e">prototype</span>.<span style="color:#a6e22e">push</span>.<span style="color:#a6e22e">apply</span>(<span style="color:#a6e22e">files</span>, <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">files</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">pageToken</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">nextPageToken</span>;
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">pageToken</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">filter</span>(({ <span style="color:#a6e22e">parents</span> }) =&gt; <span style="color:#f92672">!</span><span style="color:#a6e22e">parents</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">result</span>);
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>When you run the script, the files and folders which have no parents in own Google Drive are retrieved.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/03/13/retrieving-files-and-folders-without-parents-in-google-drive/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/03/09/drive-api-cannot-create-google-apps-script-project-no-longer/">Drive API cannot create Google Apps Script project no longer</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Mar 2020, 15:09</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/news">news</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/driveapitips">DriveAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/0609f2cd989c28d6bd49d211b70b453d">Gists</a></p>
<p>Today, I noticed that new Google Apps Script project of the standalone script type cannot be created by the method of Files: create in Drive API. From now, in order to manage the Google Apps Script project, only Google Apps Script API is required to be used. By this, the following issues are brought.</p>
<ul>
<li>When the new standalone GAS project is created in the specific folder by uploading the local script, the following flow is required to be run.
<ol>
<li>Create new standalone GAS project by Apps Script API.</li>
<li>Put the local script to the created GAS project by updating the project with Apps Script API.</li>
<li>Move the GAS project from the root folder to the specific folder using Drive API.</li>
</ol>
</li>
</ul>
<p>From now, 3 API calls are required to be used like above. By the way, this had been able to be achieved by one API call of the method of files.create in Drive API before.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/03/09/drive-api-cannot-create-google-apps-script-project-no-longer/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/03/05/simple-script-of-resumable-upload-with-google-drive-api-for-python/">Simple Script of Resumable Upload with Google Drive API for Python</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>05 Mar 2020, 14:10</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/resumable-upload">resumable-upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/f709a952ff6e286027950d0484f6c03e">Gists</a></p>
<p>This is a simple sample script for achieving the resumable upload to Google Drive using Python. In order to achieve the resumable upload, at first, it is required to retrieve the location, which is the endpoint of upload. The location is included in the response headers. After the location was retrieved, the file can be uploaded to the location URL.</p>
<p>In this sample, a PNG file is uploaded with the resumable upload using a single chunk.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/03/05/simple-script-of-resumable-upload-with-google-drive-api-for-python/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2020/03/05/simple-script-of-resumable-upload-with-google-drive-api-for-node.js/">Simple Script of Resumable Upload with Google Drive API for Node.js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>05 Mar 2020, 13:48</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/resumable-upload">resumable-upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/ae451679e8220f3b2d48edb3f8c1a8d3">Gists</a></p>
<p>This is a simple sample script for achieving the resumable upload to Google Drive using Node.js. In order to achieve the resumable upload, at first, it is required to retrieve the location, which is the endpoint of upload. The location is included in the response headers. After the location was retrieved, the file can be uploaded to the location URL.</p>
<p>In this sample, a PNG file is uploaded with the resumable upload using a single chunk.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2020/03/05/simple-script-of-resumable-upload-with-google-drive-api-for-node.js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2019/12/25/music-streaming-player-for-discord-with-google-drive-using-node.js/">Music Streaming Player for Discord with Google Drive using Node.js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>25 Dec 2019, 15:18</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/discord">Discord</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/discord">Discord</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/voice">voice</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/6029cb2422dd58fe24c3a16a43ce7c35">Gists</a></p>
<h2 id="overview">Overview</h2>
<p>This is a sample script for the music streaming player for Discord with Google Drive using Node.js.</p>
<h2 id="description">Description</h2>
<p>This sample script can achieve to play the music when uses the voice channel on Discord. The music files are put in the specific folder of Google Drive. This script downloads all music files and plays the music files at the voice channel with the stream.</p>
<h2 id="usage">Usage</h2>
<h3 id="1-register-bot-to-discord">1. Register BOT to Discord</h3>
<p>At first, please register your BOT to Discord. And please retrieve the token.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2019/12/25/music-streaming-player-for-discord-with-google-drive-using-node.js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2019/09/16/modifying-revisions-of-a-file-on-google-drive-using-google-apps-script/">Modifying Revisions of a File on Google Drive using Google Apps Script</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>16 Sep 2019, 15:50</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/revision">revision</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/9508a9007c1a5196e4b234ea40528f96">Gists</a></p>
<p>This is a sample script for modifying the revisions of a file on Google Drive using Google Apps Script. This script can be used for not only Google Docs files, but also the files except for Google Docs.</p>
<h2 id="issue-and-workaround">Issue and workaround:</h2>
<p>Unfortunately, in the current stage, at Google Docs files, the revision of Google Docs cannot be directly changed by APIs with a script. So as one of several workarounds, I would like to propose to overwrite the Google Docs file using the exported data. On the other hand, at the files except for Google Docs, the data can be directly retrieved with the revision ID. This can be used for overwriting the file. The flow of this script is as follows.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2019/09/16/modifying-revisions-of-a-file-on-google-drive-using-google-apps-script/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2019/04/02/creating-new-google-docs-and-overwriting-existing-google-docs-by-text-with-node.js-without-using-googleapis/">Creating New Google Docs and Overwriting Existing Google Docs by Text with Node.js without using googleapis</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>02 Apr 2019, 16:33</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/update">update</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/915f1034749b8b2f451556167663ea19">Gists</a></p>
<p>There are 2 sample scripts.</p>
<ol>
<li>Create new Spreadsheet using a text value as CSV data.</li>
<li>Overwrite the existing Google Document using a text value.</li>
</ol>
<p>When you use these script, please enable Drive API and retrieve your access token.</p>
<h2 id="create-new-spreadsheet-using-text-value">Create New Spreadsheet using Text Value</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">request</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;request&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">textData</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;a1, b1, c1, d1, e1&#34;</span>; <span style="color:#75715e">// This is used as CSV data.
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">orgMimeType</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;text/csv&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">orgFileName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sample.csv&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">accessToken</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Access token
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">metadata</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;convertedSampleCSV&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mimeType</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/vnd.google-apps.spreadsheet&#34;</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">boundary</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;xxxxxxxxxxx&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;--&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">boundary</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\r\n&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">data</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;Content-Disposition: form-data; name=\&#34;metadata\&#34;\r\n&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">data</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;Content-Type: application/json; charset=UTF-8\r\n\r\n&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">data</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">metadata</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\r\n&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">data</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;--&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">boundary</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\r\n&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">data</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;Content-Disposition: form-data; name=\&#34;file\&#34;; filename=\&#34;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">orgFileName</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\&#34;\r\n&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">data</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;Content-Type: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">orgMimeType</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\r\n\r\n&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">payload</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">concat</span>([
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">data</span>, <span style="color:#e6db74">&#34;utf8&#34;</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Buffer</span>(<span style="color:#a6e22e">textData</span>, <span style="color:#e6db74">&#39;binary&#39;</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#e6db74">&#34;\r\n--&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">boundary</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;--&#34;</span>, <span style="color:#e6db74">&#34;utf8&#34;</span>),
</span></span><span style="display:flex;"><span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">options</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;post&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">url</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">url</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Content-Type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;multipart/related; boundary=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">boundary</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;Authorization&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Bearer &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">accessToken</span>,
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">payload</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">request</span>(<span style="color:#a6e22e">options</span>, (<span style="color:#a6e22e">error</span>, <span style="color:#a6e22e">response</span>, <span style="color:#a6e22e">body</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">body</span>);
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><h2 id="overwrite-existing-google-document-using-text-value">Overwrite Existing Google Document using Text Value</h2>
<p>This can be used when you don&rsquo;t want to update the existing Google Docs without changing the file ID.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2019/04/02/creating-new-google-docs-and-overwriting-existing-google-docs-by-text-with-node.js-without-using-googleapis/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/08/13/upload-files-to-google-drive-using-javascript/">Upload Files to Google Drive using Javascript</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Aug 2018, 10:16</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/javascripttips">JavascriptTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/bd53b366aedef70e35a35f449c51eced">Gists</a></p>
<h2 id="news">News</h2>
<p><strong><a href="https://github.com/tanaikech/ResumableUploadForGoogleDrive_js">At October 11, 2019, I published a Javascript library to to run the resumable upload for Google Drive.</a> When this is used, the large file can be uploaded. You can also use this js library.</strong></p>
<h2 id="description">Description</h2>
<p>This is a sample script for uploading files to Google Drive using Javascript. The files are uploaded by <a href="https://developers.google.com/drive/api/v3/reference/">Drive API v3</a>. <code>gapi.client.drive.files.create()</code> can create an empty file on Google Drive. But it cannot directly upload files including contents. I think that this might not be able to upload files and metadata with the multipart/related, although this might be resolved by the future update. So now, as one of workarounds, I use using XMLHttpRequest.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/08/13/upload-files-to-google-drive-using-javascript/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/05/20/create-folder-tree-of-google-drive-using-node.js/">Create Folder Tree of Google Drive using Node.js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>20 May 2018, 13:40</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/foldertree">folderTree</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/97b336f04c739ae0181a606eab3dff42">Gists</a></p>
<p>This is a sample script for retrieving a folder tree using Node.js. In this sample, you can set the top of folder for the folder tree. In generally, the folder tree is created by retrieving folders from the top folder in order. For example, when Google Apps Script is used, the script becomes like <a href="https://gist.github.com/tanaikech/8e9b6fd667efcb483c9c742da9cd4e19">this</a>. But when Drive API is used for this situation, if there are a lot of folders in the top folder, a lot of APIs are required to be called. So in this sample, I have tried to create the folder tree by a small number of API calls as possible.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/05/20/create-folder-tree-of-google-drive-using-node.js/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2018/02/12/uploading-files-from-local-to-google-drive-by-python-without-quickstart/">Uploading Files From Local To Google Drive by Python without Quickstart</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>12 Feb 2018, 11:39</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/pythontips">PythonTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">Python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/upload">upload</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/8cdfd23807372657dc63d81e25e35153">Gists</a></p>
<p>This is a sample script for uploading files from local PC to Google Drive using Python. In this sample, Quickstart is not used. So when you use this script, please retrieve access token.</p>
<h2 id="curl-sample-">Curl sample :</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X POST <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -H <span style="color:#e6db74">&#34;Authorization: Bearer ### access token ###&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -F <span style="color:#e6db74">&#34;metadata={name : &#39;sample.png&#39;, parents: [&#39;### folder ID ###&#39;]};type=application/json;charset=UTF-8&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -F <span style="color:#e6db74">&#34;file=@sample.png;type=image/png&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&#34;</span>
</span></span></code></pre></div><p>]</p>
<h2 id="python-sample-">Python sample :</h2>
<p>When above curl sample is converted to Python, it becomes as follows.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2018/02/12/uploading-files-from-local-to-google-drive-by-python-without-quickstart/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/08/17/downloading-files-under-specific-folder-using-node.js/">Downloading Files Under Specific Folder using Node.js</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Aug 2017, 09:25</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">googleapitips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/download">download</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p><a href="https://gist.github.com/tanaikech/38b536923b1765da052c21aab093649d">Gists</a></p>
<p>This sample script is for downloading files under a specific folder using Node.js. It can download files with Google Docs and others.</p>
<p>This sample supposes as follows. So please confirm it.</p>
<ul>
<li><a href="https://developers.google.com/drive/v3/web/quickstart/nodejs">quickstart</a> is used and default quickstart works fine.</li>
</ul>
<p>In order to use this sample, please carry out as follows.</p>
<ol>
<li>Replace <code>listFiles()</code> of the default quickstart to this sample.</li>
<li>Set <code>folderid</code>. This script can retrieve files in the folder with <code>folderid</code>.</li>
<li>Delete <code>drive-nodejs-quickstart.json</code>. I think that there is the file at <code>.credentials</code> in your home directory.</li>
<li>Change the SCOPE from <code>var SCOPES = ['https://www.googleapis.com/auth/drive.metadata.readonly'];</code> to <code>var SCOPES = ['https://www.googleapis.com/auth/drive.readonly'];</code>.</li>
<li>Run script, retrieve the code and authorize.</li>
</ol>
<h2 id="script-">Script :</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">listFiles</span>(<span style="color:#a6e22e">auth</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">folderid</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;### folder ID ###&#34;</span>; <span style="color:#75715e">// Folder ID. This script downloads files in the folder with this folder ID.
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">outputExtension</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;pdf&#34;</span>; <span style="color:#75715e">// Extension of output file. This is adapted to only Google Docs.
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">outputMimeType</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">mime</span>.<span style="color:#a6e22e">lookup</span>(<span style="color:#a6e22e">outputExtension</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">service</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">google</span>.<span style="color:#a6e22e">drive</span>(<span style="color:#e6db74">&#39;v3&#39;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">service</span>.<span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">list</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">auth</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">auth</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">q</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#39;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">folderid</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39; in parents and trashed=false&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fields</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;files(id, name, mimeType)&#34;</span>
</span></span><span style="display:flex;"><span>  }, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">response</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">err</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;The API returned an error: &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">err</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e</span>){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">mimeType</span>.<span style="color:#a6e22e">includes</span>(<span style="color:#e6db74">&#34;application/vnd.google-apps&#34;</span>)) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">dlfile</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">createWriteStream</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">outputExtension</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">service</span>.<span style="color:#a6e22e">files</span>.<span style="color:#66d9ef">export</span>({
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">auth</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">auth</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">fileId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">id</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">mimeType</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">outputMimeType</span>
</span></span><span style="display:flex;"><span>        }).<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;end&#39;</span>, <span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;&#39;%s&#39; was downloaded as %s.&#34;</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">outputExtension</span>);
</span></span><span style="display:flex;"><span>        }).<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;error&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">err</span>) {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">err</span>);
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">exit</span>();
</span></span><span style="display:flex;"><span>        }).<span style="color:#a6e22e">pipe</span>(<span style="color:#a6e22e">dlfile</span>);
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">dlfile</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">createWriteStream</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">name</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">service</span>.<span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">get</span>({
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">auth</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">auth</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">fileId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">id</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">alt</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;media&#39;</span>
</span></span><span style="display:flex;"><span>        }).<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;end&#39;</span>, <span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;&#39;%s&#39; was downloaded as %s.&#34;</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">mime</span>.<span style="color:#a6e22e">extension</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">mimeType</span>));
</span></span><span style="display:flex;"><span>        }).<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;error&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">err</span>) {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">err</span>);
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">exit</span>();
</span></span><span style="display:flex;"><span>        }).<span style="color:#a6e22e">pipe</span>(<span style="color:#a6e22e">dlfile</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/05/24/retrieving-html-file-id-from-microsoft-docx-file-on-google-drive/">Retrieving HTML File ID from Microsoft Docx File on Google Drive</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>24 May 2017, 09:08</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">GoogleAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This sample script converts from Microsoft Docx File on Google Drive to Google Spreadsheet, and converts to HTML file.</p>
<p>Drive APIs v2 and v3 are used for this. Please set as follows.</p>
<ul>
<li><a href="https://developers.google.com/drive/v2/reference/">Drive API v2</a></li>
<li><a href="https://developers.google.com/drive/v3/reference/">Drive API v3</a></li>
</ul>
<p>&ldquo;Drive API v2&rdquo; can be used at Google Apps Script by enabling Drive API of Advanced Google services and of Google API Console.</p>
<p>How to use it is as follows.</p>
<ol>
<li>
<p>In the script editor, select Resources &gt; Advanced Google services</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/05/24/retrieving-html-file-id-from-microsoft-docx-file-on-google-drive/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/05/02/ocr-using-google-drive-api/">OCR using Google Drive API</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>02 May 2017, 14:21</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">GoogleAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google">Google</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This is a sample script for OCR using Google Drive API. A text file which converted by OCR can be retrieved by inputting an image file.</p>
<p>In this sample, Python Quickstart is used. The detail information is <a href="https://developers.google.com/drive/v3/web/quickstart/python">https://developers.google.com/drive/v3/web/quickstart/python</a>. Please read Step 1: Turn on the Drive API and Step 2: Install the Google Client Library.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> __future__ <span style="color:#f92672">import</span> print_function
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> httplib2
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> io
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> apiclient <span style="color:#f92672">import</span> discovery
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> oauth2client <span style="color:#f92672">import</span> client
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> oauth2client <span style="color:#f92672">import</span> tools
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> oauth2client.file <span style="color:#f92672">import</span> Storage
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> apiclient.http <span style="color:#f92672">import</span> MediaFileUpload, MediaIoBaseDownload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> argparse
</span></span><span style="display:flex;"><span>    flags <span style="color:#f92672">=</span> argparse<span style="color:#f92672">.</span>ArgumentParser(parents<span style="color:#f92672">=</span>[tools<span style="color:#f92672">.</span>argparser])<span style="color:#f92672">.</span>parse_args()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span> <span style="color:#a6e22e">ImportError</span>:
</span></span><span style="display:flex;"><span>    flags <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If modifying these scopes, delete your previously saved credentials</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># at ~/.credentials/drive-python-quickstart.json</span>
</span></span><span style="display:flex;"><span>SCOPES <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://www.googleapis.com/auth/drive&#39;</span>
</span></span><span style="display:flex;"><span>CLIENT_SECRET_FILE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;client_secret.json&#39;</span>
</span></span><span style="display:flex;"><span>APPLICATION_NAME <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Drive API Python Quickstart&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_credentials</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Gets valid user credentials from storage.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    If nothing has been stored, or if the stored credentials are invalid,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    the OAuth2 flow is completed to obtain the new credentials.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Returns:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        Credentials, the obtained credential.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    credential_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#34;./&#34;</span>, <span style="color:#e6db74">&#39;drive-python-quickstart.json&#39;</span>)
</span></span><span style="display:flex;"><span>    store <span style="color:#f92672">=</span> Storage(credential_path)
</span></span><span style="display:flex;"><span>    credentials <span style="color:#f92672">=</span> store<span style="color:#f92672">.</span>get()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> credentials <span style="color:#f92672">or</span> credentials<span style="color:#f92672">.</span>invalid:
</span></span><span style="display:flex;"><span>        flow <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>flow_from_clientsecrets(CLIENT_SECRET_FILE, SCOPES)
</span></span><span style="display:flex;"><span>        flow<span style="color:#f92672">.</span>user_agent <span style="color:#f92672">=</span> APPLICATION_NAME
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> flags:
</span></span><span style="display:flex;"><span>            credentials <span style="color:#f92672">=</span> tools<span style="color:#f92672">.</span>run_flow(flow, store, flags)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:  <span style="color:#75715e"># Needed only for compatibility with Python 2.6</span>
</span></span><span style="display:flex;"><span>            credentials <span style="color:#f92672">=</span> tools<span style="color:#f92672">.</span>run(flow, store)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;Storing credentials to &#39;</span> <span style="color:#f92672">+</span> credential_path)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> credentials
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    credentials <span style="color:#f92672">=</span> get_credentials()
</span></span><span style="display:flex;"><span>    http <span style="color:#f92672">=</span> credentials<span style="color:#f92672">.</span>authorize(httplib2<span style="color:#f92672">.</span>Http())
</span></span><span style="display:flex;"><span>    service <span style="color:#f92672">=</span> discovery<span style="color:#f92672">.</span>build(<span style="color:#e6db74">&#39;drive&#39;</span>, <span style="color:#e6db74">&#39;v3&#39;</span>, http<span style="color:#f92672">=</span>http)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    imgfile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;sample.png&#39;</span>  <span style="color:#75715e"># Image with texts (png, jpg, bmp, gif, pdf)</span>
</span></span><span style="display:flex;"><span>    txtfile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;output.txt&#39;</span>  <span style="color:#75715e"># Text file outputted by OCR</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    mime <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;application/vnd.google-apps.document&#39;</span>
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> service<span style="color:#f92672">.</span>files()<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>        body<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;name&#39;</span>: imgfile,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;mimeType&#39;</span>: mime
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        media_body<span style="color:#f92672">=</span>MediaFileUpload(imgfile, mimetype<span style="color:#f92672">=</span>mime, resumable<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    )<span style="color:#f92672">.</span>execute()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    downloader <span style="color:#f92672">=</span> MediaIoBaseDownload(
</span></span><span style="display:flex;"><span>        io<span style="color:#f92672">.</span>FileIO(txtfile, <span style="color:#e6db74">&#39;wb&#39;</span>),
</span></span><span style="display:flex;"><span>        service<span style="color:#f92672">.</span>files()<span style="color:#f92672">.</span>export_media(fileId<span style="color:#f92672">=</span>res[<span style="color:#e6db74">&#39;id&#39;</span>], mimeType<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/plain&#34;</span>)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    done <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> done <span style="color:#f92672">is</span> <span style="color:#66d9ef">False</span>:
</span></span><span style="display:flex;"><span>        status, done <span style="color:#f92672">=</span> downloader<span style="color:#f92672">.</span>next_chunk()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    service<span style="color:#f92672">.</span>files()<span style="color:#f92672">.</span>delete(fileId<span style="color:#f92672">=</span>res[<span style="color:#e6db74">&#39;id&#39;</span>])<span style="color:#f92672">.</span>execute()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Done.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/05/01/converting-pdf-to-txt/">Converting PDF to TXT</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>01 May 2017, 15:04</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">GoogleAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/python">python</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google">Google</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This is a sample script for converting a PDF file to a TXT file. 2 steps are required for this.</p>
<ol>
<li>Upload a PDF file as a Google Document</li>
<li>Download a Google Document as a TXT file</li>
</ol>
<p>In this sample, Python Quickstart is used. The detail information is <a href="https://developers.google.com/drive/v3/web/quickstart/python">https://developers.google.com/drive/v3/web/quickstart/python</a>. Please read &ldquo;Step 1: Turn on the Drive API&rdquo; and &ldquo;Step 2: Install the Google Client Library&rdquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> __future__ <span style="color:#f92672">import</span> print_function
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> httplib2
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> io
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> apiclient <span style="color:#f92672">import</span> discovery
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> oauth2client <span style="color:#f92672">import</span> client
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> oauth2client <span style="color:#f92672">import</span> tools
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> oauth2client.file <span style="color:#f92672">import</span> Storage
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> apiclient.http <span style="color:#f92672">import</span> MediaFileUpload, MediaIoBaseDownload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> argparse
</span></span><span style="display:flex;"><span>    flags <span style="color:#f92672">=</span> argparse<span style="color:#f92672">.</span>ArgumentParser(parents<span style="color:#f92672">=</span>[tools<span style="color:#f92672">.</span>argparser])<span style="color:#f92672">.</span>parse_args()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span> <span style="color:#a6e22e">ImportError</span>:
</span></span><span style="display:flex;"><span>    flags <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SCOPES <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://www.googleapis.com/auth/drive&#39;</span>
</span></span><span style="display:flex;"><span>CLIENT_SECRET_FILE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;client_secret.json&#39;</span>
</span></span><span style="display:flex;"><span>APPLICATION_NAME <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Drive API Python Quickstart&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_credentials</span>():
</span></span><span style="display:flex;"><span>    credential_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#34;./&#34;</span>, <span style="color:#e6db74">&#39;drive-python-quickstart.json&#39;</span>)
</span></span><span style="display:flex;"><span>    store <span style="color:#f92672">=</span> Storage(credential_path)
</span></span><span style="display:flex;"><span>    credentials <span style="color:#f92672">=</span> store<span style="color:#f92672">.</span>get()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> credentials <span style="color:#f92672">or</span> credentials<span style="color:#f92672">.</span>invalid:
</span></span><span style="display:flex;"><span>        flow <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>flow_from_clientsecrets(CLIENT_SECRET_FILE, SCOPES)
</span></span><span style="display:flex;"><span>        flow<span style="color:#f92672">.</span>user_agent <span style="color:#f92672">=</span> APPLICATION_NAME
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> flags:
</span></span><span style="display:flex;"><span>            credentials <span style="color:#f92672">=</span> tools<span style="color:#f92672">.</span>run_flow(flow, store, flags)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:  <span style="color:#75715e"># Needed only for compatibility with Python 2.6</span>
</span></span><span style="display:flex;"><span>            credentials <span style="color:#f92672">=</span> tools<span style="color:#f92672">.</span>run(flow, store)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;Storing credentials to &#39;</span> <span style="color:#f92672">+</span> credential_path)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> credentials
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    credentials <span style="color:#f92672">=</span> get_credentials()
</span></span><span style="display:flex;"><span>    http <span style="color:#f92672">=</span> credentials<span style="color:#f92672">.</span>authorize(httplib2<span style="color:#f92672">.</span>Http())
</span></span><span style="display:flex;"><span>    service <span style="color:#f92672">=</span> discovery<span style="color:#f92672">.</span>build(<span style="color:#e6db74">&#39;drive&#39;</span>, <span style="color:#e6db74">&#39;v3&#39;</span>, http<span style="color:#f92672">=</span>http)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pdffile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;sample.pdf&#39;</span>
</span></span><span style="display:flex;"><span>    txtfile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;sample.txt&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    mime <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;application/vnd.google-apps.document&#39;</span>
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> service<span style="color:#f92672">.</span>files()<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>        body<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;name&#39;</span>: pdffile,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;mimeType&#39;</span>: mime
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        media_body<span style="color:#f92672">=</span>MediaFileUpload(pdffile, mimetype<span style="color:#f92672">=</span>mime, resumable<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    )<span style="color:#f92672">.</span>execute()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dl <span style="color:#f92672">=</span> MediaIoBaseDownload(
</span></span><span style="display:flex;"><span>        io<span style="color:#f92672">.</span>FileIO(txtfile, <span style="color:#e6db74">&#39;wb&#39;</span>),
</span></span><span style="display:flex;"><span>        service<span style="color:#f92672">.</span>files()<span style="color:#f92672">.</span>export_media(fileId<span style="color:#f92672">=</span>res[<span style="color:#e6db74">&#39;id&#39;</span>], mimeType<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/plain&#34;</span>)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    done <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> done <span style="color:#f92672">is</span> <span style="color:#66d9ef">False</span>:
</span></span><span style="display:flex;"><span>        status, done <span style="color:#f92672">=</span> dl<span style="color:#f92672">.</span>next_chunk()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Done.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/04/15/creating-spreadsheet-from-excel-file/">Creating Spreadsheet from Excel file</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15 Apr 2017, 10:39</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>These scripts can be executed on Script Editor. But, in order to use these, you have to enable Drive API of Advanced Google services and of Google API Console. &ldquo;Drive API v2&rdquo; can be used at Google Apps Script by enabling Drive API of Advanced Google services and of Google API Console.</p>
<p>How to use it is as follows.</p>
<ol>
<li>
<p>In the script editor, select Resources &gt; Advanced Google services</p>
</li>
<li>
<p>In the dialog that appears, click the on/off switch for <a href="https://developers.google.com/drive/v2/reference/">Drive API v2</a>.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/04/15/creating-spreadsheet-from-excel-file/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/04/14/creating-downloaded-excel-file-as-spreadsheet/">Creating Downloaded Excel file as Spreadsheet</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>14 Apr 2017, 18:03</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This is a sample GAS script to create an Excel file, which was downloaded from web, as Spreadsheet. By using Drive API, it can be achieved without access token.</p>
<p><strong>Script :</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">downloadFile</span>(<span style="color:#a6e22e">fileURL</span>, <span style="color:#a6e22e">folder</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">filename</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">fileURL</span>.<span style="color:#a6e22e">match</span>(<span style="color:#e6db74">&#34;.+/(.+?)([\?#;].*)?$&#34;</span>)[<span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">fileURL</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">rc</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">getResponseCode</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resource</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;mimeType&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/vnd.google-apps.spreadsheet&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;parents&#34;</span><span style="color:#f92672">:</span> [{<span style="color:#a6e22e">id</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">folder</span>}],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;title&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">filename</span>
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">insert</span>(<span style="color:#a6e22e">resource</span>, <span style="color:#a6e22e">blob</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">fileInfo</span> <span style="color:#f92672">=</span> [<span style="color:#a6e22e">rc</span>, <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">title</span>, <span style="color:#a6e22e">blob</span>.<span style="color:#a6e22e">getBytes</span>().<span style="color:#a6e22e">length</span>, <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">id</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">fileInfo</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Result :</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">200</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">sample.xlsx</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">10000.0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">##</span> <span style="color:#960050;background-color:#1e0010">file</span> <span style="color:#960050;background-color:#1e0010">id</span> <span style="color:#960050;background-color:#1e0010">##</span>
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div>
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/03/30/how-to-use-fields-of-drive-apis/">How to use &#34;fields&#34; of Drive APIs</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Mar 2017, 08:53</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">GoogleAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-drive">Google Drive</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">drive-api</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>There are a lot of APIs on Google. When we use Google Drive APIs, they usually have &ldquo;fields&rdquo; as a resource. The parameter &ldquo;fields&rdquo; gives various information which is selected to us. This is one of important parameters. And this can be used at Google Apps Script (GAS) although that version is v2. About how to use it, there are <a href="https://developers.google.com/drive/v2/reference/">some documents</a>. But it is difficult to find how to use it at GAS. So I would like to write down here as a memorandum. Most parameters for APIs have to be expressed as JSON. However, the expressions are different for each API. I would like to introduce this using some samples. <strong>This is for GAS.</strong></p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/03/30/how-to-use-fields-of-drive-apis/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/17/retrieving-access-token-for-google-drive-api-using-gas/">Retrieving Access Token for Google Drive API using GAS</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Feb 2017, 17:25</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">GoogleAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/oauth2">OAuth2</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">Drive API</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>These GASs retrieve an access token for using Google Drive API. There are 3 parts. Before you use this, please retrieve client ID, client secret and redirect uri from Google , and choose scopes.</p>
<h3 id="1-retrieving-code-from-web">1. Retrieving code from web</h3>
<p>This is a script to output URL for retrieving &ldquo;code&rdquo; from web. Please retrieve &ldquo;code&rdquo; by import this URL to your browser. After you run this script, using &ldquo;url&rdquo; got from this script, it retrieves &ldquo;code&rdquo;.</p>
  </p>

  
  <footer>
    <a href="https://tanaikech.github.io/2017/02/17/retrieving-access-token-for-google-drive-api-using-gas/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="https://tanaikech.github.io/2017/02/08/file-upload-and-download-with-file-convert-for-curl-using-drive-api/">File Upload and Download with File Convert For curl using Drive API</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>08 Feb 2017, 15:50</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/googleapitips">GoogleAPITips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google">Google</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/drive-api">Drive API</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/curl">curl</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>It is necessary to retrieve access token on Google. Scope is as follows.</p>
<pre tabindex="0"><code>https://www.googleapis.com/auth/drive
</code></pre><p>Other mimetypes can be seen <a href="https://developers.google.com/drive/v3/web/manage-downloads">here</a>.</p>
<h2 id="download-and-convert-from-spreadsheet-to-excel">Download and convert from Spreadsheet to Excel</h2>
<pre tabindex="0"><code>curl -X GET -sSL \
        -H &#34;Authorization: Bearer [Your access token]&#34; \
        -o &#34;Excel file name&#34; \
        &#34;https://www.googleapis.com/drive/v3/files/[File ID]/export?mimeType=application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#34;
</code></pre><h2 id="upload-and-convert-from-excel-to-spreadsheet">Upload and convert from Excel to Spreadsheet</h2>
<pre tabindex="0"><code>curl -X POST -sSL \
        -H &#34;Authorization: Bearer [Your access token]&#34; \
        -F &#34;metadata={ \
                     name : &#39;[File name on Google Drive]&#39;, \
                     mimeType : &#39;application/vnd.google-apps.spreadsheet&#39; \
                     };type=application/json;charset=UTF-8&#34; \
        -F &#34;file=@[Your Excel file];type=application/vnd.ms-excel&#34; \
        &#34;https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&#34;
</code></pre>
  </p>

  
</article>

  
</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>
