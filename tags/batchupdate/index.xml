<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>BatchUpdate on tanaike - Google Apps Script, Gemini API, and Developer Tips</title>
    <link>https://tanaikech.github.io/tags/batchupdate/</link>
    <description>Recent content in BatchUpdate on tanaike - Google Apps Script, Gemini API, and Developer Tips</description>
    <generator>Hugo</generator>
    <language>ja</language>
    <copyright>&amp;copy; 2026. All rights reserved.</copyright>
    <lastBuildDate>Mon, 20 Jul 2020 16:34:16 +0900</lastBuildDate>
    <atom:link href="https://tanaikech.github.io/tags/batchupdate/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Using Request Body of String JSON for Google APIs with googleapis of golang</title>
      <link>https://tanaikech.github.io/2020/07/20/using-request-body-of-string-json-for-google-apis-with-googleapis-of-golang/</link>
      <pubDate>Mon, 20 Jul 2020 16:34:16 +0900</pubDate>
      <guid>https://tanaikech.github.io/2020/07/20/using-request-body-of-string-json-for-google-apis-with-googleapis-of-golang/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://gist.github.com/tanaikech/3f1c8e9f40e78263ec1ade2cb9461dcc&#34;&gt;Gists&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;This is a sample script for directly using the request body of the string JSON for Google APIs with &lt;a href=&#34;https://github.com/googleapis/google-api-go-client&#34;&gt;googleapis of golang&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;p&gt;At googleapis for golang, when Google API is used, it is required to create the request body like &lt;a href=&#34;https://gist.github.com/tanaikech/76cde17cecba38f44398c3effe2aedf2&#34;&gt;this sample script&lt;/a&gt;. I have several contacts for creating about such request body. I thought that such script might be a bit difficult for users. I thought that when the string JSON object is directly used for this, it might be useful. So I would like to introduce about this. When this was useful for your situation, I&amp;rsquo;m glad.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Setting Number Format of Cells on Google Spreadsheet using batchUpdate in Sheets API with golang</title>
      <link>https://tanaikech.github.io/2020/07/19/setting-number-format-of-cells-on-google-spreadsheet-using-batchupdate-in-sheets-api-with-golang/</link>
      <pubDate>Sun, 19 Jul 2020 16:11:07 +0900</pubDate>
      <guid>https://tanaikech.github.io/2020/07/19/setting-number-format-of-cells-on-google-spreadsheet-using-batchupdate-in-sheets-api-with-golang/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://gist.github.com/tanaikech/76cde17cecba38f44398c3effe2aedf2&#34;&gt;Gists&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;This is a sample script for setting the number format of cells on Google Spreadsheet using batchUpdate in Sheets API with golang. In this case, &lt;a href=&#34;https://github.com/googleapis/google-api-go-client&#34;&gt;googleapis for golang&lt;/a&gt; is used. The script of the authorization can be seen at &lt;a href=&#34;https://developers.google.com/sheets/api/quickstart/go&#34;&gt;the official document&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;h2 id=&#34;sample-script&#34;&gt;Sample script&lt;/h2&gt;&#xA;&lt;p&gt;In this script, the number format of the column &amp;ldquo;A&amp;rdquo; is changed to &lt;code&gt;yyyy-mm-dd hh:mm:ss&lt;/code&gt;. And, please include &lt;code&gt;https://www.googleapis.com/auth/spreadsheets&lt;/code&gt; to the scopes.&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;&#34;&gt;&lt;code class=&#34;language-golang&#34; data-lang=&#34;golang&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;sheetId&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;12345678&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;// Please set the sheet ID which is not Spreadsheet ID. Please be careful this.&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;repeatCellRequest&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;sheets&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;RepeatCellRequest&lt;/span&gt;{&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;Fields&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;userEnteredFormat.numberFormat&amp;#34;&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;Range&lt;/span&gt;: &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;sheets&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;GridRange&lt;/span&gt;{&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;SheetId&lt;/span&gt;:          int64(&lt;span style=&#34;color:#a6e22e&#34;&gt;sheetId&lt;/span&gt;),&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;StartRowIndex&lt;/span&gt;:    &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;StartColumnIndex&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;EndColumnIndex&lt;/span&gt;:   &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    },&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;Cell&lt;/span&gt;: &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;sheets&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;CellData&lt;/span&gt;{&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;UserEnteredFormat&lt;/span&gt;: &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;sheets&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;CellFormat&lt;/span&gt;{&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#a6e22e&#34;&gt;NumberFormat&lt;/span&gt;: &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;sheets&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;NumberFormat&lt;/span&gt;{&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#a6e22e&#34;&gt;Pattern&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;yyyy-mm-dd hh:mm:ss&amp;#34;&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#a6e22e&#34;&gt;Type&lt;/span&gt;:    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;DATE&amp;#34;&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            },&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        },&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    },&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;requestBody&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;sheets&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;BatchUpdateSpreadsheetRequest&lt;/span&gt;{&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;Requests&lt;/span&gt;: []&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;sheets&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;Request&lt;/span&gt;{&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;sheets&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;Request&lt;/span&gt;{&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;RepeatCell&lt;/span&gt;: &lt;span style=&#34;color:#a6e22e&#34;&gt;repeatCellRequest&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }},&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;resp&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;err&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;srv&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;Spreadsheets&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;BatchUpdate&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;bookID&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;requestBody&lt;/span&gt;).&lt;span style=&#34;color:#a6e22e&#34;&gt;Do&lt;/span&gt;()&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;err&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;nil&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;log&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;Fatal&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;err&lt;/span&gt;)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;fmt&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;Printf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;%#v\n&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;resp&lt;/span&gt;)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;references&#34;&gt;References&lt;/h2&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/batchUpdate&#34;&gt;Method: spreadsheets.batchUpdate&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#repeatcellrequest&#34;&gt;RepeatCellRequest&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://stackoverflow.com/q/62964170&#34;&gt;How to format a cell with Google Sheets API v4 and Go?&lt;/a&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;I answered above sample script at this thread.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;</description>
    </item>
    <item>
      <title>Append Values by Inserting Rows using Google Sheets API</title>
      <link>https://tanaikech.github.io/2018/02/27/append-values-by-inserting-rows-using-google-sheets-api/</link>
      <pubDate>Tue, 27 Feb 2018 09:51:55 +0900</pubDate>
      <guid>https://tanaikech.github.io/2018/02/27/append-values-by-inserting-rows-using-google-sheets-api/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://gist.github.com/tanaikech/7846ebcafbab8318ff74c9955a99e06b&#34;&gt;Gists&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the case appending values to cell by inserting rows, when &lt;code&gt;sheets.spreadsheets.values.append&lt;/code&gt; is used, the values are appended to the next empty row of the last row. If you want to append values to between cells with values by inserting row, you can achieve it using &lt;code&gt;sheets.spreadsheets.batchUpdate&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;When you use this, please use your access token.&lt;/p&gt;&#xA;&lt;h2 id=&#34;endpoint-&#34;&gt;Endpoint :&lt;/h2&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;POST https://sheets.googleapis.com/v4/spreadsheets/### spreadsheet ID ###:batchUpdate&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;request-body-&#34;&gt;Request body :&lt;/h2&gt;&#xA;&lt;p&gt;In this request body, it appends the data of &amp;ldquo;sample1, sample2, sample3&amp;rdquo; to &amp;ldquo;A1:A3&amp;rdquo; of the sheetId of &amp;ldquo;1234567890&amp;rdquo;. Before appends the data, it supposes that there are some values at &amp;ldquo;A1:A3&amp;rdquo;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>spreadsheets.values.batchUpdate using Golang</title>
      <link>https://tanaikech.github.io/2017/09/15/spreadsheets.values.batchupdate-using-golang/</link>
      <pubDate>Fri, 15 Sep 2017 14:14:50 +0900</pubDate>
      <guid>https://tanaikech.github.io/2017/09/15/spreadsheets.values.batchupdate-using-golang/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://gist.github.com/tanaikech/0f5b15fec7f409cdb568b0c2904fccb2&#34;&gt;Gists&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;flow-&#34;&gt;Flow :&lt;/h2&gt;&#xA;&lt;p&gt;In my sample script, the script was made using the Quickstart. The flow to use this sample script is as follows.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;For &lt;a href=&#34;https://developers.google.com/sheets/api/quickstart/go&#34;&gt;Go Quickstart&lt;/a&gt;, please do Step 1 and Step 2.&lt;/li&gt;&#xA;&lt;li&gt;Please put &lt;code&gt;client_secret.json&lt;/code&gt; to the same directory with my sample script.&lt;/li&gt;&#xA;&lt;li&gt;Copy and paste my sample script, and create it as new script file.&lt;/li&gt;&#xA;&lt;li&gt;Run the script.&lt;/li&gt;&#xA;&lt;li&gt;When &lt;code&gt;Go to the following link in your browser then type the authorization code:&lt;/code&gt; is shown on your terminal, please copy the URL and paste to your browser. And then, please authorize and get code.&lt;/li&gt;&#xA;&lt;li&gt;Put the code to the terminal.&lt;/li&gt;&#xA;&lt;li&gt;When &lt;code&gt;Done.&lt;/code&gt; is displayed, it means that the update of spreadsheet is done.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 id=&#34;request-body-&#34;&gt;Request body :&lt;/h2&gt;&#xA;&lt;p&gt;For &lt;code&gt;Spreadsheets.Values.BatchUpdate&lt;/code&gt;, &lt;code&gt;BatchUpdateValuesRequest&lt;/code&gt; is required as one of parameters. In this case, the range, values and so on that you want to update are included in &lt;code&gt;BatchUpdateValuesRequest&lt;/code&gt;. The detail information of this &lt;code&gt;BatchUpdateValuesRequest&lt;/code&gt; can be seen at &lt;a href=&#34;https://godoc.org/google.golang.org/api/sheets/v4#BatchUpdateValuesRequest&#34;&gt;godoc&lt;/a&gt;. When it sees &lt;code&gt;BatchUpdateValuesRequest&lt;/code&gt;, &lt;code&gt;Data []*ValueRange&lt;/code&gt; can be seen. Here, please be carefull that &lt;code&gt;Data&lt;/code&gt; is &lt;code&gt;[]*ValueRange&lt;/code&gt;. Also &lt;code&gt;ValueRange&lt;/code&gt; can be seen at &lt;a href=&#34;https://godoc.org/google.golang.org/api/sheets/v4#ValueRange&#34;&gt;godoc&lt;/a&gt;. You can see &lt;code&gt;MajorDimension&lt;/code&gt;, &lt;code&gt;Range&lt;/code&gt; and &lt;code&gt;Values&lt;/code&gt; in &lt;code&gt;ValueRange&lt;/code&gt;.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
