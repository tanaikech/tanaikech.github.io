<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Applicating Spread Syntax and Destructuring assignment to Google Spreadsheet with Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>X</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Applicating Spread Syntax and Destructuring assignment to Google Spreadsheet with Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Mar 2022, 16:59</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips </a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/d0c60aa54fb55fc61a06593e311fa623">Gists</a></p>
<h2 id="introduction">Introduction</h2>
<p>In this report, I would like to introduce to apply the spread syntax and the destructuring assignment to Google Spreadsheet with Google Apps Script. The destructuring assignment can be used without V8 runtime. But, the spread syntax is required to be used with V8 runtime. Recently, I often saw the script using them at Stackoverflow. And also, I have sometimes gotten the questions related to the spread syntax and the destructuring assignment. So, I thought that I would like to introduce in my blog.</p>
<p>In generally, the data structure of most Spreadsheets is the header row in the 1st row and the data rows below 2nd row showing in the following image.</p>
<p><img src="https://tanaikech.github.io/image-storage/20220330a/fig1.png" alt=""></p>
<h2 id="sample-situation-1">Sample situation 1</h2>
<p>As the sample situation 1, when the values are retrieved from the such the data structure using Google Apps Script, in most cases, the following script might have used.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSheet</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">header</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#e6db74">&#34;A1:E1&#34;</span>).<span style="color:#a6e22e">getValues</span>()[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#e6db74">&#34;A2:E&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastRow</span>()).<span style="color:#a6e22e">getValues</span>();
</span></span></code></pre></div><p>and</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSheet</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getDataRange</span>().<span style="color:#a6e22e">getValues</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">header</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">shift</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">data</span>;
</span></span></code></pre></div><p>In this case, when the above sample Spreadsheet is used, <code>header</code> and <code>values</code> are as follows, respectively.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;Header1&#34;</span>, <span style="color:#e6db74">&#34;Header2&#34;</span>, <span style="color:#e6db74">&#34;Header3&#34;</span>, <span style="color:#e6db74">&#34;Header4&#34;</span>, <span style="color:#e6db74">&#34;Header5&#34;</span>]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a2&#34;</span>, <span style="color:#e6db74">&#34;b2&#34;</span>, <span style="color:#e6db74">&#34;c2&#34;</span>, <span style="color:#e6db74">&#34;d2&#34;</span>, <span style="color:#e6db74">&#34;e2&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a3&#34;</span>, <span style="color:#e6db74">&#34;b3&#34;</span>, <span style="color:#e6db74">&#34;c3&#34;</span>, <span style="color:#e6db74">&#34;d3&#34;</span>, <span style="color:#e6db74">&#34;e3&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a4&#34;</span>, <span style="color:#e6db74">&#34;b4&#34;</span>, <span style="color:#e6db74">&#34;c4&#34;</span>, <span style="color:#e6db74">&#34;d4&#34;</span>, <span style="color:#e6db74">&#34;e4&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a5&#34;</span>, <span style="color:#e6db74">&#34;b5&#34;</span>, <span style="color:#e6db74">&#34;c5&#34;</span>, <span style="color:#e6db74">&#34;d5&#34;</span>, <span style="color:#e6db74">&#34;e5&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a6&#34;</span>, <span style="color:#e6db74">&#34;b6&#34;</span>, <span style="color:#e6db74">&#34;c6&#34;</span>, <span style="color:#e6db74">&#34;d6&#34;</span>, <span style="color:#e6db74">&#34;e6&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a7&#34;</span>, <span style="color:#e6db74">&#34;b7&#34;</span>, <span style="color:#e6db74">&#34;c7&#34;</span>, <span style="color:#e6db74">&#34;d7&#34;</span>, <span style="color:#e6db74">&#34;e7&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a8&#34;</span>, <span style="color:#e6db74">&#34;b8&#34;</span>, <span style="color:#e6db74">&#34;c8&#34;</span>, <span style="color:#e6db74">&#34;d8&#34;</span>, <span style="color:#e6db74">&#34;e8&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a9&#34;</span>, <span style="color:#e6db74">&#34;b9&#34;</span>, <span style="color:#e6db74">&#34;c9&#34;</span>, <span style="color:#e6db74">&#34;d9&#34;</span>, <span style="color:#e6db74">&#34;e9&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a10&#34;</span>, <span style="color:#e6db74">&#34;b10&#34;</span>, <span style="color:#e6db74">&#34;c10&#34;</span>, <span style="color:#e6db74">&#34;d10&#34;</span>, <span style="color:#e6db74">&#34;e10&#34;</span>]
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p>Here, when the spread syntax and the destructuring assignment are used for this situation, the script becomes as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSheet</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">header</span>, ...<span style="color:#a6e22e">values</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getDataRange</span>().<span style="color:#a6e22e">getValues</span>();
</span></span></code></pre></div><p>In this case, the script becomes simple. The result values of <code>header</code> and <code>values</code> are the same with the above one.</p>
<h3 id="explanation">Explanation</h3>
<p><code>sheet.getDataRange().getValues()</code> returns the following values.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;Header1&#34;</span>, <span style="color:#e6db74">&#34;Header2&#34;</span>, <span style="color:#e6db74">&#34;Header3&#34;</span>, <span style="color:#e6db74">&#34;Header4&#34;</span>, <span style="color:#e6db74">&#34;Header5&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a2&#34;</span>, <span style="color:#e6db74">&#34;b2&#34;</span>, <span style="color:#e6db74">&#34;c2&#34;</span>, <span style="color:#e6db74">&#34;d2&#34;</span>, <span style="color:#e6db74">&#34;e2&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a3&#34;</span>, <span style="color:#e6db74">&#34;b3&#34;</span>, <span style="color:#e6db74">&#34;c3&#34;</span>, <span style="color:#e6db74">&#34;d3&#34;</span>, <span style="color:#e6db74">&#34;e3&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a4&#34;</span>, <span style="color:#e6db74">&#34;b4&#34;</span>, <span style="color:#e6db74">&#34;c4&#34;</span>, <span style="color:#e6db74">&#34;d4&#34;</span>, <span style="color:#e6db74">&#34;e4&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a5&#34;</span>, <span style="color:#e6db74">&#34;b5&#34;</span>, <span style="color:#e6db74">&#34;c5&#34;</span>, <span style="color:#e6db74">&#34;d5&#34;</span>, <span style="color:#e6db74">&#34;e5&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a6&#34;</span>, <span style="color:#e6db74">&#34;b6&#34;</span>, <span style="color:#e6db74">&#34;c6&#34;</span>, <span style="color:#e6db74">&#34;d6&#34;</span>, <span style="color:#e6db74">&#34;e6&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a7&#34;</span>, <span style="color:#e6db74">&#34;b7&#34;</span>, <span style="color:#e6db74">&#34;c7&#34;</span>, <span style="color:#e6db74">&#34;d7&#34;</span>, <span style="color:#e6db74">&#34;e7&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a8&#34;</span>, <span style="color:#e6db74">&#34;b8&#34;</span>, <span style="color:#e6db74">&#34;c8&#34;</span>, <span style="color:#e6db74">&#34;d8&#34;</span>, <span style="color:#e6db74">&#34;e8&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a9&#34;</span>, <span style="color:#e6db74">&#34;b9&#34;</span>, <span style="color:#e6db74">&#34;c9&#34;</span>, <span style="color:#e6db74">&#34;d9&#34;</span>, <span style="color:#e6db74">&#34;e9&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;a10&#34;</span>, <span style="color:#e6db74">&#34;b10&#34;</span>, <span style="color:#e6db74">&#34;c10&#34;</span>, <span style="color:#e6db74">&#34;d10&#34;</span>, <span style="color:#e6db74">&#34;e10&#34;</span>]
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p><code>...</code> of <code>...values</code> is the spread syntax. <code>header</code> and <code>...values</code> of <code>[header, ...values]</code> mean 1st row and the rows below 2nd rows. For example, when <code>const [header, values] = sheet.getDataRange().getValues()</code> is run, <code>header</code> and <code>values</code> return 1st row and 2nd row, respectively. From this situation, it is found that <code>...</code> of <code>...values</code> means the multiple rows. By this, the above result is obtained.</p>
<h2 id="sample-situation-2">Sample situation 2</h2>
<p>As the sample situation 2, there is a case that the specific columns have to be retrieved from Spreadsheet. For example, it thinks of the case that the columns &ldquo;B&rdquo; and &ldquo;D&rdquo; are retrieved from the above sample Spreadsheet. In this case, by the destructuring assignment, the simple sample script can be used.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSheet</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getDataRange</span>().<span style="color:#a6e22e">getValues</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">map</span>(([<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>, <span style="color:#a6e22e">c</span>, <span style="color:#a6e22e">d</span>, <span style="color:#a6e22e">e</span>]) =&gt; [<span style="color:#a6e22e">b</span>, <span style="color:#a6e22e">d</span>]);
</span></span></code></pre></div><p>When this script is run to the above Spreadsheet, the following result is obtained.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;Header2&#34;</span>, <span style="color:#e6db74">&#34;Header4&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;b2&#34;</span>, <span style="color:#e6db74">&#34;d2&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;b3&#34;</span>, <span style="color:#e6db74">&#34;d3&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;b4&#34;</span>, <span style="color:#e6db74">&#34;d4&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;b5&#34;</span>, <span style="color:#e6db74">&#34;d5&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;b6&#34;</span>, <span style="color:#e6db74">&#34;d6&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;b7&#34;</span>, <span style="color:#e6db74">&#34;d7&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;b8&#34;</span>, <span style="color:#e6db74">&#34;d8&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;b9&#34;</span>, <span style="color:#e6db74">&#34;d9&#34;</span>],
</span></span><span style="display:flex;"><span>  [<span style="color:#e6db74">&#34;b10&#34;</span>, <span style="color:#e6db74">&#34;d10&#34;</span>]
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><h3 id="explanation-1">Explanation</h3>
<p>For example, when <code>const res = values.map((r) =&gt; r)</code> is run, the result of <code>res</code> is the same with <code>values</code>. Namely, <code>r</code> of <code>values.map((r) =&gt; r)</code> is each row.</p>
<p>Here, <code>[a, b, c, d, e]</code> of <code>values.map(([a, b, c, d, e]) =&gt; [b, d])</code> means the columns &ldquo;A&rdquo; to &ldquo;E&rdquo;. By this, you can easily select the specific columns like <code>[b, d]</code>.</p>
<p>In the above situation, only the columns &ldquo;B&rdquo; and &ldquo;D&rdquo; are retrieved. So the above script can be also modified as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSheet</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getDataRange</span>().<span style="color:#a6e22e">getValues</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">map</span>(([, <span style="color:#a6e22e">b</span>, , <span style="color:#a6e22e">d</span>]) =&gt; [<span style="color:#a6e22e">b</span>, <span style="color:#a6e22e">d</span>]);
</span></span></code></pre></div><p>Of course, you can use <code>const res = values.map((r) =&gt; [r[1], r[3]])</code>. But from <a href="https://tanaikech.github.io/2020/10/23/benchmark-process-costs-for-retrieving-values-from-arrays-for-spreadsheet-using-google-apps-script/">the benchmark</a>, the process cost for using the destructuring assignment is lower than that for using the index.</p>
<p>But, when the number of column is large, when the destructuring assignment is used, the readability of script might be low. In that case, using index is suitable. So, please be careful about this.</p>
<h2 id="note">Note</h2>
<p>I think that the above methods can be also used for various situations except for Spreadsheet. So when this post was useful for your situation, I&rsquo;m glad.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax">Spread syntax (&hellip;)</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment">Destructuring assignment</a></li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2022%2f03%2f30%2fapplicating-spread-syntax-and-destructuring-assignment-to-google-spreadsheet-with-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2022%2f03%2f30%2fapplicating-spread-syntax-and-destructuring-assignment-to-google-spreadsheet-with-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2022%2f03%2f30%2fapplicating-spread-syntax-and-destructuring-assignment-to-google-spreadsheet-with-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2022%2f03%2f30%2fapplicating-spread-syntax-and-destructuring-assignment-to-google-spreadsheet-with-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2022%2f03%2f30%2fapplicating-spread-syntax-and-destructuring-assignment-to-google-spreadsheet-with-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2022%2f03%2f30%2fapplicating-spread-syntax-and-destructuring-assignment-to-google-spreadsheet-with-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2022/03/17/finally-google-forms-api-has-been-officially-released-as-version-1/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2022/03/17/finally-google-forms-api-has-been-officially-released-as-version-1/">Finally, Google Forms API has been officially released as version 1</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2022/04/01/merging-columns-with-same-header-title-in-google-spreadsheet-using-google-apps-script/">Merging Columns with Same Header Title in Google Spreadsheet using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2022/04/01/merging-columns-with-same-header-title-in-google-spreadsheet-using-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

