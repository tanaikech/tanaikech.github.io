<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Report: Publishing Various Google Docs with Same URL using Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Report: Publishing Various Google Docs with Same URL using Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>03 Jun 2022, 11:26</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-site">Google site</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/94810f7947361bef398ac9f301b9afde">Gists</a></p>
<p>This is a sample method for publishing various Google Docs files with the same URL using Google Apps Script.</p>
<p>By updating on May 25, 2022, the content got to be able to be embedded as a full page in the new Google site. <a href="https://tanaikech.github.io/2022/06/02/embed-content-as-a-full-page-in-new-google-sites/">Ref</a> In this method, this is used.</p>
<p><img src="https://tanaikech.github.io/image-storage/20220603a/fig1.png" alt=""></p>
<h2 id="usage">Usage</h2>
<h3 id="1-create-a-google-docs">1. Create a Google Docs.</h3>
<p>First, as a simple sample, please create a new Google Spreadsheet. And please copy the URL like <code>https://docs.google.com/spreadsheets/d/{spreadsheetId}/edit</code>.</p>
<h3 id="2-create-a-google-apps-script-project">2. Create a Google Apps Script project.</h3>
<p>You can use both the standalone script type and the container-bound script type.</p>
<h3 id="3-sample-script">3. Sample script</h3>
<p>Please copy and paste the following script to the script editor of the created Google Apps Script project. And, please set the Google Spreadsheet URL to <code>googleDocs</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">doGet</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">googleDocs</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;https://docs.google.com/spreadsheets/d/{spreadsheetId}/edit&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">html</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`&lt;iframe src=&#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">googleDocs</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; style=&#34;border: none; width: 95vw; height: 95vh; padding: 0; margin: 0;&#34;&gt;&lt;/iframe&gt;`</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">HtmlService</span>.<span style="color:#a6e22e">createHtmlOutput</span>(<span style="color:#a6e22e">html</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="4-deploy-web-apps">4. Deploy Web Apps.</h3>
<p>The detailed information can be seen at <a href="https://developers.google.com/apps-script/guides/web#deploy_a_script_as_a_web_app">the official document</a>. In this case, it supposes that you are using new IDE. Please be careful this.</p>
<ol>
<li>On the script editor, at the top right of the script editor, please click &ldquo;click Deploy&rdquo; -&gt; &ldquo;New deployment&rdquo;.</li>
<li>Please click &ldquo;Select type&rdquo; -&gt; &ldquo;Web App&rdquo;.</li>
<li>Please input the information about the Web App in the fields under &ldquo;Deployment configuration&rdquo;.</li>
<li>Please select <strong>&ldquo;Me&rdquo;</strong> for <strong>&ldquo;Execute as&rdquo;</strong>.</li>
<li>Please select <strong>&ldquo;Anyone&rdquo;</strong> for <strong>&ldquo;Who has access&rdquo;</strong>.
<ul>
<li>For testing this script, I thought that this setting might be suitable.</li>
</ul>
</li>
<li>Please click &ldquo;Deploy&rdquo; button.</li>
<li>Copy the URL of the Web App. It&rsquo;s like <code>https://script.google.com/macros/s/###/exec</code>.
<ul>
<li><strong>When you modified the Google Apps Script, please modify the deployment as a new version. By this, the modified script is reflected in Web Apps. Please be careful this.</strong></li>
<li>You can see the detail of this in the report of &ldquo;<a href="https://gist.github.com/tanaikech/ebf92d8f427d02d53989d6c3464a9c43">Redeploying Web Apps without Changing URL of Web Apps for new IDE</a>&rdquo;.</li>
</ul>
</li>
</ol>
<h3 id="5-create-a-new-google-site">5. Create a new Google site</h3>
<p>Pleases create a new Google site. And, please set the top page as the full page for embeding the content. <a href="https://tanaikech.github.io/2022/06/02/embed-content-as-a-full-page-in-new-google-sites/">Ref</a> and <a href="https://workspaceupdates.googleblog.com/2022/05/embed-content-as-full-page-in-new.html">Ref</a> I thought that the animation gif might be useful for understanding how to set it.</p>
<p>And, please set your Web Apps URL as the full page content to the created Google site. And, please publish the Google site.</p>
<h3 id="6-testing">6. Testing</h3>
<p>When the above setting is done and you access your published Google site, you can see the situation of the top image in this post on your browser.</p>
<ul>
<li>
<p>For the owner of Goog Apps Script, Google site, and Google Spreadsheet.</p>
<ul>
<li>In this sample, you can see and edit the Spreadsheet.</li>
<li>Script editor cannot be opened.</li>
<li>You can run the script using the custom functions.</li>
<li>When a button assigned to the Google Apps Script function is set, when you click the button, you can run the script.</li>
<li>You can use the script using the simple triggers of OnEdit, OnOpen.</li>
<li>You can use the script using the installed triggers which are OnEdit, OnChange, and so on.</li>
</ul>
</li>
<li>
<p>For the users who are NOT the owner of them.</p>
<ul>
<li>When the Spreadsheet is not publicly shared, when users access your Google site, the users cannot see the Spreadsheet. Because the users have no permissions.</li>
<li>When the Spreadsheet is publicly shared as the writer when users access your Google site, the users can see and edit the Spreadsheet.</li>
<li>In this sample, you can see and edit the Spreadsheet.</li>
<li>Script editor cannot be opened.</li>
<li><strong>Users can run the script using the custom functions.</strong></li>
<li>Even when the users click the button for running the script, the script is not run.</li>
<li>Triggers which are OnEdit, OnChange, and so on cannot be used.</li>
<li>Users can NOT use the script using the simple triggers of OnEdit, OnOpen.</li>
<li><strong>Users can use the script using the installed triggers which are OnEdit, OnChange, and so on.</strong></li>
</ul>
</li>
</ul>
<h2 id="note">Note</h2>
<ul>
<li>
<p>In this method, you can freely change from Google Spreadsheet to Google Document, Google Slides, Google Forms, and so on. And, the access URL is not changed. Users can always access your set Google Docs and other page using the same URL.</p>
</li>
<li>
<p>About the above sample, when you want change the Google Spreadsheet to Google Document, please modify <code>googleDocs</code>.</p>
<ul>
<li><strong>When you modified the Google Apps Script, please modify the deployment as a new version. By this, the modified script is reflected in Web Apps. Please be careful this.</strong></li>
</ul>
</li>
<li>
<p>Also, I think that this method can be used for publishing your original site created by Web Apps with Google Apps Script and HTML.</p>
</li>
</ul>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://tanaikech.github.io/2022/06/02/embed-content-as-a-full-page-in-new-google-sites/">Embed content as a full page in new Google Sites</a></li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2022%2f06%2f03%2freport-publishing-various-google-docs-with-same-url-using-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2022%2f06%2f03%2freport-publishing-various-google-docs-with-same-url-using-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2022%2f06%2f03%2freport-publishing-various-google-docs-with-same-url-using-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2022%2f06%2f03%2freport-publishing-various-google-docs-with-same-url-using-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2022%2f06%2f03%2freport-publishing-various-google-docs-with-same-url-using-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2022%2f06%2f03%2freport-publishing-various-google-docs-with-same-url-using-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2022/06/02/embed-content-as-a-full-page-in-new-google-sites/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2022/06/02/embed-content-as-a-full-page-in-new-google-sites/">Embed content as a full page in new Google Sites</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2022/06/07/benchmark-process-cost-for-html-template-using-google-apps-script/">Benchmark: Process cost for HTML Template using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2022/06/07/benchmark-process-cost-for-html-template-using-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=UA-84325623-1"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-84325623-1');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

