<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Gemini CLI with MCP Server: Expanding Possibilities with Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Gemini CLI with MCP Server: Expanding Possibilities with Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>03 Jul 2025, 15:45</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/model-context-protocol">Model Context Protocol</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/mcp">MCP</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/39b887f108b4896e34fea58df0695abd">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20250703a/fig1.jpg" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>The Gemini CLI provides a powerful command-line interface for interacting with Google&rsquo;s Gemini models. By leveraging the Model Context Protocol (MCP), the CLI can be extended with custom tools. This report explores the integration of the Gemini CLI with an MCP server built using Google Apps Script Web Apps. We demonstrate how this combination simplifies authorization for Google Workspace APIs (Gmail, Drive, Calendar, etc.), allowing Gemini to execute complex, multi-step tasks directly within the Google ecosystem. We provide setup instructions and several practical examples showcasing how this integration unlocks significant potential for automation and productivity enhancement.</p>
<h1 id="introduction">Introduction</h1>
<p>Recently, I published a report titled &ldquo;Gemini CLI with MCP Server Built by Web Apps of Google Apps Script&rdquo; (<a href="https://medium.com/google-cloud/gemini-cli-with-mcp-server-built-by-web-apps-of-google-apps-script-47046afdf3be">Ref</a>). This initial report highlighted how a Model Context Protocol (MCP) server, developed using Google Apps Script Web Apps, can be integrated with the <a href="https://github.com/google-gemini/gemini-cli">Gemini CLI</a>.</p>
<p>One of the key advantages of using Google Apps Script is its ability to provide seamless authorization for Google APIs, particularly those within Google Workspace. This significantly reduces the development overhead associated with building applications that interact with Google Workspace services.</p>
<p>Building upon that foundation, this report aims to explore the expanded possibilities when combining the Gemini CLI with an MCP server powered by Google Apps Script Web Apps. We will delve into how this powerful combination facilitates the integration of various tools and services, unlocking an infinite range of potential applications for enhanced productivity and automation within the Google ecosystem.</p>
<h1 id="usage">Usage</h1>
<p>This section details deploying the MCP server using Google Apps Script and configuring the Gemini CLI to use it.</p>
<h2 id="preparing-the-mcp-server">Preparing the MCP Server</h2>
<h3 id="1-create-a-google-apps-script-project">1. Create a Google Apps Script Project</h3>
<p>First, create a new standalone Google Apps Script project. A standalone project is not bound to a specific Google Sheet, Doc, or Form, making it ideal for creating a general-purpose web service. You can create one by visiting <a href="https://script.google.com/home/projects/create">script.google.com</a>. <a href="https://developers.google.com/apps-script/guides/projects#create-standalone">Ref</a></p>
<h3 id="2-install-libraries">2. Install Libraries</h3>
<p>To simplify building the MCP server, we will use pre-built Google Apps Script libraries. These encapsulate the complex MCP handling logic and provide ready-to-use tools, keeping the main script clean.</p>
<p>This sample uses two Google Apps Script libraries:</p>
<ol>
<li><strong><a href="https://github.com/tanaikech/MCPApp">MCPApp</a></strong>: Manages the MCP server lifecycle and communication protocols.</li>
<li><strong><a href="https://github.com/tanaikech/ToolsForMCPServer">ToolsForMCPServer</a></strong>: Provides a suite of pre-built tools for interacting with Google Workspace services (Gmail, Drive, Calendar, etc.).</li>
</ol>
<h4 id="library-project-keys-and-installation">Library Project Keys and Installation</h4>
<ol>
<li>Open the script editor of the project you just created.</li>
<li><strong>Install MCPApp</strong>:
<ul>
<li><a href="https://developers.google.com/apps-script/guides/libraries">Installation Guide</a></li>
<li>Project Key: <code>1TlX_L9COAriBlAYvrMLiRFQ5WVf1n0jChB6zHamq2TNwuSbVlI5sBUzh</code></li>
<li>Identifier: <code>MCPApp</code></li>
<li>Repository: <a href="https://github.com/tanaikech/MCPApp">https://github.com/tanaikech/MCPApp</a></li>
</ul>
</li>
<li><strong>Install ToolsForMCPServer</strong>:
<ul>
<li><a href="https://developers.google.com/apps-script/guides/libraries">Installation Guide</a></li>
<li>Project Key: <code>1lnE7UL1jQgPDbTB9yjhiwZM0SaS9MObhzvWUWb_t8FisO6A3bLepvM2j</code></li>
<li>Identifier: <code>ToolsForMCPServer</code></li>
<li>Repository: <a href="https://github.com/tanaikech/ToolsForMCPServer">https://github.com/tanaikech/ToolsForMCPServer</a></li>
</ul>
</li>
</ol>
<h3 id="3-script">3. Script</h3>
<p>Please copy and paste the following script into the script editor (replacing any existing code) and save the project.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// API key for Gemini API
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * This function is automatically run when the MCP client accesses Web Apps.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">doPost</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">main</span>(<span style="color:#a6e22e">e</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>(<span style="color:#a6e22e">eventObject</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">m</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ToolsForMCPServer</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">apiKey</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">eventObject</span>, <span style="color:#a6e22e">items</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">getServer</span>() };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">MCPApp</span>.<span style="color:#a6e22e">mcpApp</span>({ <span style="color:#a6e22e">accessKey</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample&#34;</span> })
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">setServices</span>({ <span style="color:#a6e22e">lock</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">LockService</span>.<span style="color:#a6e22e">getScriptLock</span>() })
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">server</span>(<span style="color:#a6e22e">object</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Note:</strong></p>
<ul>
<li>If you intend to use the <code>generate_presentation_with_google_slides</code> tool, you must uncomment the <code>apiKey</code> line in the script and provide a valid API key for the Gemini API.</li>
<li>If an error related to Drive API occurred, please enable Drive API at Advanced Google services.</li>
</ul>
<h3 id="4-deploy-web-apps">4. Deploy Web Apps</h3>
<p>To allow the Gemini CLI to communicate with our script, we must deploy it as a Web App. This creates a unique URL that acts as our MCP server endpoint.</p>
<p>You can find detailed information in <a href="https://developers.google.com/apps-script/guides/web#deploy_a_script_as_a_web_app">the official documentation</a>.</p>
<p>Please follow these steps to deploy the Web App in the script editor:</p>
<ol>
<li>In the script editor, at the top right, click <strong>Deploy</strong> -&gt; <strong>New deployment</strong>.</li>
<li>Click <strong>Select type</strong> -&gt; <strong>Web App</strong>.</li>
<li>Enter a description for the Web App in the fields under <strong>Deployment configuration</strong>.</li>
<li>Select <strong>&ldquo;Me&rdquo;</strong> for <strong>&ldquo;Execute as&rdquo;</strong>. This is crucial, as it allows the script to run with your permissions to access your Google services.</li>
<li>Select <strong>&ldquo;Anyone&rdquo;</strong> for <strong>&ldquo;Who has access&rdquo;</strong>. This makes the URL callable from the internet. Access is controlled by the unguessable URL and the <code>accessKey</code> defined in the script.</li>
<li>Click <strong>Deploy</strong>.</li>
<li>After authorizing the necessary scopes, copy the <strong>Web app URL</strong>. It will look similar to <code>https://script.google.com/macros/s/###/exec</code>. This is your MCP server endpoint.</li>
</ol>
<p><strong>Important:</strong> When you modify the Apps Script code, you must create a new deployment version to publish the changes. Click <strong>Deploy</strong> &gt; <strong>Manage deployments</strong>, select your active deployment, click the pencil icon, and choose <strong>&ldquo;New version&rdquo;</strong> from the Version dropdown. <a href="https://github.com/tanaikech/taking-advantage-of-Web-Apps-with-google-apps-script?tab=readme-ov-file#redeploy">More info here</a>.</p>
<h2 id="preparing-gemini-cli">Preparing Gemini CLI</h2>
<h3 id="1-install-gemini-cli">1. Install Gemini CLI</h3>
<p>Follow the official documentation to install the Gemini CLI on your system. <a href="https://github.com/google-gemini/gemini-cli">Ref</a></p>
<h3 id="2-modify-settingsjson">2. Modify <code>settings.json</code></h3>
<p>To connect the Gemini CLI to your new Apps Script server, you need to edit its settings file. This file is typically located at <code>~/.gemini/settings.json</code> on macOS/Linux or <code>%USERPROFILE%\.gemini\settings.json</code> on Windows.</p>
<p>Add the <code>mcpServers</code> configuration block as shown below.</p>
<ol>
<li>Replace <code>https://script.google.com/macros/s/###/exec</code> with the Web App URL you copied earlier.</li>
<li>Ensure the <code>accessKey</code> query parameter matches the <code>accessKey</code> you defined in your Google Apps Script (<code>sample</code> in this example).</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;theme&#34;</span>: <span style="color:#e6db74">&#34;Default&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;selectedAuthType&#34;</span>: <span style="color:#e6db74">&#34;###&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;mcpServers&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;gas_web_apps&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;command&#34;</span>: <span style="color:#e6db74">&#34;npx&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;args&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mcp-remote&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;https://script.google.com/macros/s/###/exec?accessKey=sample&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;env&#34;</span>: {}
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li><code>&quot;gas_web_apps&quot;</code>: A local identifier for your server.</li>
<li><code>&quot;command&quot;</code> and <code>&quot;args&quot;</code>: These tell the Gemini CLI how to invoke the <code>mcp-remote</code> tool, which handles the communication with your Web App URL.</li>
</ul>
<p>When you have never installed <code>mcp-remote</code>, please install it. <a href="https://www.npmjs.com/package/mcp-remote">Ref</a></p>
<h1 id="sample-prompts-and-answers">Sample Prompts and Answers</h1>
<p>The following examples demonstrate how the Gemini CLI uses the Google Apps Script MCP server to interact with various Google services.</p>
<h2 id="confirm-connected-mcp-servers">Confirm Connected MCP Servers</h2>
<p>This command lists all configured MCP servers and the tools they provide.</p>
<p><strong>Prompt</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>&gt; /mcp
</span></span></code></pre></div><p>When your setting is correct, the following result is returned.</p>
<p><strong>Answer</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>â„¹ Configured MCP servers:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ðŸŸ¢ gas_web_apps - Ready (23 tools)
</span></span><span style="display:flex;"><span>    - get_exchange_rate
</span></span><span style="display:flex;"><span>    - get_current_weather
</span></span><span style="display:flex;"><span>    - get_current_date_time
</span></span><span style="display:flex;"><span>    - search_schedule_on_Google_Calendar
</span></span><span style="display:flex;"><span>    - create_schedule_to_Google_Calendar
</span></span><span style="display:flex;"><span>    - get_values_from_google_docs
</span></span><span style="display:flex;"><span>    - put_values_into_google_docs
</span></span><span style="display:flex;"><span>    - search_file_in_google_drive
</span></span><span style="display:flex;"><span>    - get_file_from_google_drive
</span></span><span style="display:flex;"><span>    - put_file_to_google_drive
</span></span><span style="display:flex;"><span>    - create_file_to_google_drive
</span></span><span style="display:flex;"><span>    - generate_survey_with_google_forms
</span></span><span style="display:flex;"><span>    - generate_quiz_with_google_forms
</span></span><span style="display:flex;"><span>    - get_messages_by_time_from_Gmail
</span></span><span style="display:flex;"><span>    - get_messages_by_search_from_Gmail
</span></span><span style="display:flex;"><span>    - add_label_to_Gmail
</span></span><span style="display:flex;"><span>    - auto_reply_draft_creation_Gmail
</span></span><span style="display:flex;"><span>    - auto_new_draft_creation_Gmail
</span></span><span style="display:flex;"><span>    - send_mails_Gmail
</span></span><span style="display:flex;"><span>    - remove_mails_Gmail
</span></span><span style="display:flex;"><span>    - get_values_from_google_sheets
</span></span><span style="display:flex;"><span>    - put_values_to_google_sheets
</span></span><span style="display:flex;"><span>    - generate_presentation_with_google_slides
</span></span></code></pre></div><p>In the current stage (July 3, 2025), 23 tools are included in the MCP server &ldquo;gas_web_apps&rdquo;.</p>
<h2 id="search-files-in-google-drive">Search Files in Google Drive</h2>
<p><strong>Prompt</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Search for files with the filename of &#34;sample file&#34; from Google Drive.
</span></span></code></pre></div><p><strong>Answer</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  âœ”  search_file_in_google_drive (gas_web_apps MCP Server) {&#34;query&#34;:&#34;name = &#39;sample file&#39;&#34;}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>âœ¦ I found a file named &#34;sample file&#34; on Google Drive. It&#39;s a Google Sheet, and here&#39;s its link:
</span></span><span style="display:flex;"><span>  https://docs.google.com/spreadsheets/d/###/edit?usp=drivesdk
</span></span></code></pre></div><h3 id="explanation">Explanation</h3>
<p>Gemini interpreted the request and selected the <code>search_file_in_google_drive</code> tool from the <code>gas_web_apps</code> MCP server. It constructed the appropriate Google Drive search query (<code>name = 'sample file'</code>) and executed the search via Google Apps Script, returning the file metadata.</p>
<h2 id="show-schedule-from-google-calendar">Show Schedule from Google Calendar</h2>
<p><strong>Prompt</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Tell me my today&#39;s schedule.
</span></span></code></pre></div><p><strong>Answer</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  âœ”  search_schedule_on_Google_Calendar (gas_web_apps MCP Server) {&#34;start&#34;:&#34;2025-07-03&#34;,&#34;end&#34;:&#34;2025-07-03&#34;}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>âœ¦ Today, July 3, 2025, you have two events:
</span></span><span style="display:flex;"><span>   - 12:00 PM - 1:00 PM: &#34;sample event 1&#34; (Lunch) at Shinagawa Station.
</span></span><span style="display:flex;"><span>   - 7:00 PM - 8:00 PM: &#34;sample event 2&#34; (Dinner) at Osaka Station.
</span></span></code></pre></div><h3 id="explanation-1">Explanation</h3>
<p>The model used the <code>search_schedule_on_Google_Calendar</code> tool, automatically determining the correct start and end dates for &ldquo;today&rdquo;. The MCP server fetched the events from Google Calendar, and Gemini summarized the results.</p>
<h2 id="show-todays-emails">Show Today&rsquo;s Emails</h2>
<p><strong>Prompt</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Tell me my today&#39;s emails from tanaike@hotmail.com.
</span></span></code></pre></div><p><strong>Answer</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  âœ”  get_messages_by_search_from_Gmail (gas_web_apps MCP Server) {&#34;query&#34;:&#34;from:tanaike@hotmail.com after:2025/07/03&#34;}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>âœ¦ Here are your emails from tanaike@hotmail.com for today:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   1. From: Tanaike Kanshi &lt;tanaike@hotmail.com&gt;
</span></span><span style="display:flex;"><span>      Subject: sample mail 2
</span></span><span style="display:flex;"><span>      Body: This is a sample mail of No.2.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   2. From: Tanaike Kanshi &lt;tanaike@hotmail.com&gt;
</span></span><span style="display:flex;"><span>      Subject: sample mail 1
</span></span><span style="display:flex;"><span>      Body: This is a sample mail of No.1.
</span></span></code></pre></div><h3 id="explanation-2">Explanation</h3>
<p>Gemini utilized the <code>get_messages_by_search_from_Gmail</code> tool, correctly formulating a Gmail search query (<code>from:tanaike@hotmail.com after:2025/07/03</code>) to meet the constraints of the prompt.</p>
<h2 id="send-an-email">Send an Email</h2>
<p><strong>Prompt</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>I received a souvenir from my friend Tanaike. Create an email to thank him for it. Tanaike&#39;s email address is tanaike@hotmail.com.
</span></span></code></pre></div><p><strong>Answer</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  âœ”  auto_new_draft_creation_Gmail (gas_web_apps MCP Server) {&#34;obj&#34;:[{&#34;body&#34;:&#34;Dear Tanaike,\n\nThank you so much for the wonderâ€¦
</span></span><span style="display:flex;"><span>  A draft email was successfully created. The draft ID is &#34;r-###&#34;.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  âœ”  send_mails_Gmail (gas_web_apps MCP Server) {&#34;draftIds&#34;:[&#34;r-###&#34;]}
</span></span><span style="display:flex;"><span>  Message of &#34;Thank you for the souvenir!&#34; was correctly sent.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>âœ¦ I have already sent the email to Tanaike thanking him for the souvenir.
</span></span></code></pre></div><p>The following email was automatically sent to <a href="mailto:tanaike@hotmail.com">tanaike@hotmail.com</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Dear Tanaike,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Thank you so much for the wonderful souvenir! I really appreciate your
</span></span><span style="display:flex;"><span>thoughtfulness.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Best regards,
</span></span><span style="display:flex;"><span>Kanshi Tanaike
</span></span></code></pre></div><h3 id="explanation-3">Explanation</h3>
<p>This prompt required two steps. First, Gemini used <code>auto_new_draft_creation_Gmail</code> to generate the email content and create a draft within Gmail via the MCP server. Second, it immediately used the <code>send_mails_Gmail</code> tool, passing the draft ID from the first step to send the email.</p>
<h2 id="check-weather-and-create-a-schedule-in-google-calendar">Check Weather and Create a Schedule in Google Calendar</h2>
<p>This example demonstrates complex orchestration involving web search and multiple MCP tools. This prompt is similar to one found in this reference: <a href="https://github.com/tanaikech/A2AApp?tab=readme-ov-file#sample-3">Ref</a></p>
<p><strong>Prompt</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Check tomorrow&#39;s weather conditions at 12 PM around Shinagawa Station and exchange 100 US Dollars for Japanese Yen. Under this condition, will we enjoy eating lunch outside for 1 hour at the retrieved location and that day? Finally, create it as a schedule in Google Calendar.
</span></span></code></pre></div><p><strong>Answer</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  âœ”  GoogleSearch Searching the web for: &#34;latitude and longitude of Shinagawa Station&#34;
</span></span><span style="display:flex;"><span>  Search results for &#34;latitude and longitude of Shinagawa Station&#34; returned.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  âœ”  get_current_date_time (gas_web_apps MCP Server) {&#34;timezone&#34;:&#34;Asia/Tokyo&#34;}
</span></span><span style="display:flex;"><span>  The current date and time are &#34;2025-07-03 11:04:42&#34;. Timezone is &#34;Asia/Tokyo&#34;.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  âœ”  get_exchange_rate (gas_web_apps MCP Server) {&#34;currency_from&#34;:&#34;USD&#34;,&#34;currency_to&#34;:&#34;JPY&#34;}
</span></span><span style="display:flex;"><span>  The raw data from the API is {&#34;amount&#34;:1.0,&#34;base&#34;:&#34;USD&#34;,&#34;date&#34;:&#34;2025-07-02&#34;,&#34;rates&#34;:{&#34;JPY&#34;:144.15}}. The detailed result is as follows. The currency rate at latest from &#34;USD&#34; to &#34;JPY&#34; is 144.15.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  âœ”  get_current_weather (gas_web_apps MCP Server) {&#34;date&#34;:&#34;2025-07-04 12:00&#34;,&#34;longitude&#34;:139.73917,&#34;latitude&#34;:35.62861,&#34;timezoâ€¦
</span></span><span style="display:flex;"><span>  Mainly clear, partly cloudy, and overcast
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>âœ¦ Tomorrow&#39;s weather around Shinagawa Station at 12 PM is expected to be mainly clear, partly cloudy, and overcast. The exchange rate for 100 US Dollars is 14415 Japanese Yen (1 USD = 144.15 JPY).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Given the weather conditions, it might be enjoyable to eat lunch outside, but there&#39;s a chance of it being overcast.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  âœ”  create_schedule_to_Google_Calendar (gas_web_apps MCP Server) {&#34;description&#34;:&#34;Lunch at Shinagawa Station. Weather: Mainly câ€¦
</span></span><span style="display:flex;"><span>  An event was created as Start: 2025-07-04 12:00:00, End: 2025-07-04 13:00:00, Title: Outdoor Lunch at Shinagawa Station, Description: Lunch at Shinagawa Station. Weather: Mainly clear, partly cloudy, and overcast. Exchange rate: 1 USD = 144.15 JPY.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>âœ¦ The schedule for an outdoor lunch at Shinagawa Station tomorrow, July 4, 2025, from 12:00 PM to 1:00 PM, has been created in your Google Calendar. The description includes the weather forecast (mainly clear, partly cloudy, and overcast) and the exchange rate (1 USD = 144.15 JPY).
</span></span></code></pre></div><p>The following event was automatically created in Google Calendar:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Date: July 4, 2025, from 12:00 PM to 1:00 PM
</span></span><span style="display:flex;"><span>Title: Outdoor Lunch at Shinagawa Station
</span></span><span style="display:flex;"><span>Description: Lunch at Shinagawa Station. Weather: Mainly clear, partly cloudy, and overcast. Exchange rate: 1 USD = 144.15 JPY.
</span></span></code></pre></div><h3 id="explanation-4">Explanation</h3>
<p>This involved a complex chain of actions:</p>
<ol>
<li>Gemini used the standard <code>GoogleSearch</code> to find the latitude and longitude of Shinagawa Station.</li>
<li>It used the MCP tool <code>get_current_date_time</code> to establish the date.</li>
<li>It used <code>get_exchange_rate</code> to find the USD to JPY conversion.</li>
<li>It used <code>get_current_weather</code>, inputting the coordinates found in step 1 and the date/time.</li>
<li>Gemini synthesized this information to answer the qualitative question about enjoying lunch.</li>
<li>Finally, it used <code>create_schedule_to_Google_Calendar</code>, embedding the retrieved weather and exchange rate information into the event description.</li>
</ol>
<h2 id="add-text-to-an-existing-google-document-or-spreadsheet">Add Text to an Existing Google Document (or Spreadsheet)</h2>
<p><strong>Prompt</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Append the following text to the document &#34;sample document 20250703&#34;.
</span></span><span style="display:flex;"><span>&lt;Text&gt;
</span></span><span style="display:flex;"><span>sample text 1
</span></span><span style="display:flex;"><span>sample text 2
</span></span><span style="display:flex;"><span>sample text 3
</span></span><span style="display:flex;"><span>sample text 4
</span></span><span style="display:flex;"><span>sample text 5
</span></span><span style="display:flex;"><span>&lt;/Text&gt;
</span></span></code></pre></div><p><strong>Answer</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  âœ”  search_file_in_google_drive (gas_web_apps MCP Server) {&#34;query&#34;:&#34;sample document 20250703&#34;}
</span></span><span style="display:flex;"><span>  &#34;isError&#34;: true
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  âœ”  search_file_in_google_drive (gas_web_apps MCP Server) {&#34;query&#34;:&#34;name = &#39;sample document 20250703&#39;&#34;}
</span></span><span style="display:flex;"><span>     1 files were found.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  âœ”  put_values_into_google_docs (gas_web_apps MCP Server) {&#34;text&#34;:&#34;sample text 1\nsample text 2\nsample text 3\nsample text 4\â€¦
</span></span><span style="display:flex;"><span>  Text is appended successfully to Google Docs.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>âœ¦ The text has been successfully appended to the document &#34;sample document 20250703&#34;.
</span></span></code></pre></div><h3 id="explanation-5">Explanation</h3>
<p>This example demonstrates Gemini&rsquo;s ability to self-correct when using tools.</p>
<ol>
<li>Initially, Gemini tried searching Google Drive using an invalid query format (<code>{&quot;query&quot;:&quot;sample document 20250703&quot;}</code>). The MCP server returned an error (<code>&quot;isError&quot;: true</code>).</li>
<li>Gemini recognized the failure and automatically retried the <code>search_file_in_google_drive</code> tool, this time using a valid Drive API query format (<code>{&quot;query&quot;:&quot;name = 'sample document 20250703'&quot;}</code>).</li>
<li>Once the file was found, it used <code>put_values_into_google_docs</code> to append the provided text.</li>
</ol>
<h2 id="create-a-new-google-document-and-add-text">Create a New Google Document and Add Text</h2>
<p><strong>Prompt</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Create a new Google Document and put the following text into the Google Document.
</span></span><span style="display:flex;"><span>&lt;Text&gt;
</span></span><span style="display:flex;"><span>sample text 1
</span></span><span style="display:flex;"><span>sample text 2
</span></span><span style="display:flex;"><span>sample text 3
</span></span><span style="display:flex;"><span>sample text 4
</span></span><span style="display:flex;"><span>sample text 5
</span></span><span style="display:flex;"><span>&lt;/Text&gt;
</span></span></code></pre></div><p><strong>Answer</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  âœ”  create_file_to_google_drive (gas_web_apps MCP Server) {&#34;mimeType&#34;:&#34;application/vnd.google-apps.document&#34;,&#34;filename&#34;:&#34;New Dâ€¦
</span></span><span style="display:flex;"><span>  A file was created on the root folder. The file URL is &#34;https://docs.google.com/document/d/###/edit?usp=drivesdk&#34;.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  âœ”  put_values_into_google_docs (gas_web_apps MCP Server) {&#34;documentId&#34;:&#34;###&#34;,&#34;text&#34;:â€¦
</span></span><span style="display:flex;"><span>  Text is appended successfully to Google Docs.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>âœ¦ I have already created a new Google Document named &#34;New Document 2025-07-03&#34; and put the specified text into it.
</span></span></code></pre></div><h3 id="explanation-6">Explanation</h3>
<p>This required two sequential tools. First, <code>create_file_to_google_drive</code> was used to create a new document; Gemini automatically assigned a relevant filename (&ldquo;New Document 2025-07-03&rdquo;). Second, <code>put_values_into_google_docs</code> was used to insert the text into the newly created document ID.</p>
<h2 id="generate-presentation">Generate Presentation</h2>
<p>This idea and the supporting script are based on &ldquo;Integrating Gemini and Google Apps Script for Automated Google Slides Presentations&rdquo;. <a href="https://medium.com/google-cloud/integrating-gemini-and-google-apps-script-for-automated-google-slides-presentations-626eedc83166">Ref</a></p>
<p><strong>Prompt</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Please create a 3-minute presentation. The title will be &#34;Cooking miso soup&#34;. My name is Tanaike. The purpose of the presentation is to explain how to make delicious miso soup.
</span></span></code></pre></div><p><strong>Answer</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  âœ”  generate_presentation_with_google_slides (gas_web_apps MCP Server) {&#34;name&#34;:&#34;Tanaike&#34;,&#34;text&#34;:&#34;This presentation will guide â€¦
</span></span><span style="display:flex;"><span>  Presentation was successfully created. The url is &#34;https://docs.google.com/open?id=###&#34;.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>âœ¦ The presentation &#34;Cooking misosoup&#34; has been created. You can access it at:
</span></span><span style="display:flex;"><span>  https://docs.google.com/open?id=###
</span></span></code></pre></div><p>The following presentation is automatically generated in Google Slides.</p>
<p><img src="https://tanaikech.github.io/image-storage/20250703a/fig2.jpg" alt=""></p>
<h3 id="explanation-7">Explanation</h3>
<p>The Gemini CLI passed the request parameters to the <code>generate_presentation_with_google_slides</code> tool on the MCP server. This specific tool in Google Apps Script uses the Gemini API internally (requiring the API key mentioned in the setup) to generate the slide content and structure, then uses the Slides Service to create the presentation.</p>
<h2 id="generate-a-survey-using-google-forms-and-send-the-url-via-email">Generate a Survey Using Google Forms and Send the URL via Email</h2>
<p>This idea and the script are adapted from &ldquo;A Novel Approach to Learning: Combining Gemini with Google Apps Script for Automated Q&amp;A&rdquo;. <a href="https://medium.com/google-cloud/a-novel-approach-to-learning-combining-gemini-with-google-apps-script-for-automated-q-a-1cc3a8781066">Ref</a></p>
<p><strong>Prompt</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>I want to conduct a survey about favorite Japanese foods. Your mission is as follows:
</span></span><span style="display:flex;"><span>* Generate a survey using Google Forms.
</span></span><span style="display:flex;"><span>* Send an email to tanaike@hotmail.com including the published URL of the Google Form.
</span></span><span style="display:flex;"><span>* The email&#39;s subject line should be &#34;Request for a survey about your favorite Japanese foods.&#34;
</span></span><span style="display:flex;"><span>* Create the email&#39;s body from the subject.
</span></span></code></pre></div><p><strong>Answer</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  âœ”  generate_survey_with_google_forms (gas_web_apps MCP Server) {&#34;title&#34;:&#34;Favorite Japanese Foods Survey&#34;,&#34;itemList&#34;:[{&#34;requirâ€¦
</span></span><span style="display:flex;"><span>  The survey was successfully generated as a Google Form. The edit URL and published URL of the form are &#34;https://docs.google.com/forms/d/###/edit&#34; and &#34;https://docs.google.com/forms/d/e/#####/viewform&#34;, respectively.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  âœ”  auto_new_draft_creation_Gmail (gas_web_apps MCP Server) {&#34;obj&#34;:[{&#34;body&#34;:&#34;Request for a survey about your favorite Japaneseâ€¦
</span></span><span style="display:flex;"><span>  A draft email was successfully created. The draft ID is &#34;r###&#34;.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  âœ”  send_mails_Gmail (gas_web_apps MCP Server) {&#34;draftIds&#34;:[&#34;r###&#34;]}
</span></span><span style="display:flex;"><span>  Message of &#34;Request for a survey about your favorite Japanese foods.&#34; was correctly sent.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>âœ¦ I have successfully generated the survey and sent the email with the published URL of the Google Form to tanaike@hotmail.com.
</span></span></code></pre></div><p>The following survey is automatically generated in Google Forms.</p>
<p><img src="https://tanaikech.github.io/image-storage/20250703a/fig3.jpg" alt=""></p>
<p>And the following email is sent to <code>tanaike@hotmail.com</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Mail title:
</span></span><span style="display:flex;"><span>Request for a survey about your favorite Japanese foods.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Mail body:
</span></span><span style="display:flex;"><span>Request for a survey about your favorite Japanese foods.
</span></span><span style="display:flex;"><span>Here is the link to the survey: https://docs.google.com/forms/d/e/#####/viewform
</span></span></code></pre></div><h3 id="explanation-8">Explanation</h3>
<p>This required three steps integrating Forms and Gmail:</p>
<ol>
<li><code>generate_survey_with_google_forms</code> created the form and returned the published URL.</li>
<li><code>auto_new_draft_creation_Gmail</code> created an email draft, incorporating the URL from step 1.</li>
<li><code>send_mails_Gmail</code> sent the drafted email.</li>
</ol>
<h2 id="generate-a-quiz-using-google-forms">Generate a Quiz Using Google Forms</h2>
<p>This idea and the script are also adapted from &ldquo;A Novel Approach to Learning: Combining Gemini with Google Apps Script for Automated Q&amp;A&rdquo;. <a href="https://medium.com/google-cloud/a-novel-approach-to-learning-combining-gemini-with-google-apps-script-for-automated-q-a-1cc3a8781066">Ref</a></p>
<p><strong>Prompt</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Suggest 5 questions and answers for a quiz with multiple-choice questions for learning Google Apps Script for beginners. Generate the quiz in Google Forms using the questions. The number of choices for each question is 5. The title of the quiz is &#34;Learning Google Apps Script&#34;.
</span></span></code></pre></div><p><strong>Answer</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  âœ”  generate_quiz_with_google_forms (gas_web_apps MCP Server) {&#34;title&#34;:&#34;Learning Google Apps Script&#34;,&#34;itemList&#34;:[{&#34;required&#34;:tâ€¦
</span></span><span style="display:flex;"><span>  The quiz was successfully generated as a Google Form. The edit URL and published URL of the form are &#34;https://docs.google.com/forms/d/###/edit&#34; and &#34;https://docs.google.com/forms/d/e/#####/viewform&#34;, respectively.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>âœ¦ The quiz &#34;Learning Google Apps Script&#34; has been generated in Google Forms.
</span></span><span style="display:flex;"><span>   * Edit URL: https://docs.google.com/forms/d/###/edit
</span></span><span style="display:flex;"><span>   * Published URL: https://docs.google.com/forms/d/e/#####/viewform
</span></span></code></pre></div><p>The following quiz is automatically generated in Google Forms.</p>
<p><img src="https://tanaikech.github.io/image-storage/20250703a/fig4.jpg" alt=""></p>
<h3 id="explanation-9">Explanation</h3>
<p>Gemini generated the required questions, choices, and correct answers based on the prompt&rsquo;s requirements, and then structured this data into the parameters required by the <code>generate_quiz_with_google_forms</code> tool, which created the Google Form.</p>
<h1 id="summary">Summary</h1>
<p>The examples above demonstrate that combining the Gemini CLI with an MCP server built using Google Apps Script Web Apps enables powerful automation across Google Workspace. By leveraging Google Apps Script&rsquo;s inherent authorization capabilities, we can easily give Gemini access to Gmail, Calendar, Drive, Docs, Sheets, and Slides.</p>
<p>The samples provided represent only a small subset of what is possible. The <code>ToolsForMCPServer</code> library includes many functions derived from previously developed Google Apps Script utilities. Furthermore, because the MCP server is simply a Google Apps Script project, developers can easily incorporate their own existing GAS snippets as new tools for the Gemini CLI. As this MCP server is updated with more tools, the potential for complex, AI-driven automation within the Google ecosystem becomes nearly limitless.</p>
<h1 id="appendix">Appendix</h1>
<h2 id="add-custom-tools">Add custom tools</h2>
<p>You might want to add your custom tools to the MCP server. At that time, please refer to the following script.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * If you want to add your custom tools, please use the following script.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * This is a simple sample. Please modify the following script to your situation.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getCustomTools</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">functions</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">params_</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">function_name1</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">parameters</span><span style="color:#f92672">:</span> {},
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">function_name2</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">parameters</span><span style="color:#f92672">:</span> {},
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">function_name1</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">object</span>) =&gt; {},
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">function_name2</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">object</span>) =&gt; {},
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// for MCP
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">itemsForMCP</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;initialize&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">protocolVersion</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;2024-11-05&#34;</span>, <span style="color:#75715e">// or &#34;2025-03-26&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">capabilities</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">tools</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">listChanged</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span> } },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">serverInfo</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;gas_web_apps&#34;</span>, <span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;1.0.0&#34;</span> },
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    ...Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">functions</span>.<span style="color:#a6e22e">params_</span>).<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">f</span>) =&gt; ({
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;tools/list&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">functions</span>[<span style="color:#a6e22e">f</span>],
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">f</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">functions</span>.<span style="color:#a6e22e">params_</span>[<span style="color:#a6e22e">f</span>].<span style="color:#a6e22e">description</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">inputSchema</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">functions</span>.<span style="color:#a6e22e">params_</span>[<span style="color:#a6e22e">f</span>].<span style="color:#a6e22e">parameters</span>,
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    })),
</span></span><span style="display:flex;"><span>  ];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// return itemsForMCP;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">itemsForMCP</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// API key for Gemini API
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * This function is automatically run when the MCP client accesses Web Apps.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">doPost</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">main</span>(<span style="color:#a6e22e">e</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>(<span style="color:#a6e22e">eventObject</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">m</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ToolsForMCPServer</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">apiKey</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">eventObject</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">items</span><span style="color:#f92672">:</span> [...<span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">getServer</span>(), ...<span style="color:#a6e22e">getCustomTools</span>()],
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">MCPApp</span>.<span style="color:#a6e22e">mcpApp</span>({ <span style="color:#a6e22e">accessKey</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample&#34;</span> })
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">setServices</span>({ <span style="color:#a6e22e">lock</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">LockService</span>.<span style="color:#a6e22e">getScriptLock</span>() })
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">server</span>(<span style="color:#a6e22e">object</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2025%2f07%2f03%2fgemini-cli-with-mcp-server-expanding-possibilities-with-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2025%2f07%2f03%2fgemini-cli-with-mcp-server-expanding-possibilities-with-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f07%2f03%2fgemini-cli-with-mcp-server-expanding-possibilities-with-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2025%2f07%2f03%2fgemini-cli-with-mcp-server-expanding-possibilities-with-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f07%2f03%2fgemini-cli-with-mcp-server-expanding-possibilities-with-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f07%2f03%2fgemini-cli-with-mcp-server-expanding-possibilities-with-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2025/06/27/gemini-cli-with-mcp-server-built-by-web-apps-of-google-apps-script/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2025/06/27/gemini-cli-with-mcp-server-built-by-web-apps-of-google-apps-script/">Gemini CLI with MCP Server Built by Web Apps of Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2025/07/08/processing-file-content-using-gemini-cli-with-an-mcp-server-built-by-google-apps-script/">Processing File Content Using Gemini CLI with an MCP Server Built by Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2025/07/08/processing-file-content-using-gemini-cli-with-an-mcp-server-built-by-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

