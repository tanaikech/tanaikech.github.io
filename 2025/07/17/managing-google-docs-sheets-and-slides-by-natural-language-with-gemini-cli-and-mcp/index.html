<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tanaikech.github.io/img/og-main.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>Managing Google Docs, Sheets, and Slides by Natural Language with Gemini CLI and MCP &middot; tanaike - Google Apps Script, Gemini API, and Developer Tips</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": "tanaike",
  "author": {
    "@type": "Person",
    "name": "Kanshi Tanaike"
  },
  "description": "Technical blog about Google Apps Script, Google API, Node.js and AI.",
  "url": "https://tanaikech.github.io/"
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Managing Google Docs, Sheets, and Slides by Natural Language with Gemini CLI and MCP</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Jul 2025, 15:48</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/model-context-protocol">Model Context Protocol</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/mcp">MCP</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/07058ee7cefeae8e360be01cd99c6ebc">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20250717a/fig1.jpg" alt=""></p>
<h2 id="abstract">Abstract</h2>
<p>This report explores an optimized approach to integrating the Gemini CLI with Google Workspace via an MCP server. Traditionally, this process requires numerous custom tools, which increases development costs. We propose leveraging the inherent JSON schema requirements of the MCP server tools to directly construct request bodies for the <code>batchUpdate</code> methods of the Google Docs, Sheets, and Slides APIs. This approach aims to consolidate document management into just three core tools, significantly streamlining development and offering a scalable, cost-effective solution for Google Workspace automation and broader API integrations.</p>
<h2 id="introduction">Introduction</h2>
<p>The <strong>Gemini CLI</strong> provides a powerful way to interact with Google&rsquo;s AI models from your terminal. When combined with a <strong>Model Context Protocol (MCP) server</strong> built using <strong>Google Apps Script Web Apps</strong>, it can be extended to manage Google Workspace services programmatically. My previous reports have detailed this integration, showing how to manage Google Docs, Sheets, and Slides (<a href="https://medium.com/google-cloud/gemini-cli-with-mcp-server-built-by-web-apps-of-google-apps-script-47046afdf3be">Ref1</a>, <a href="https://medium.com/google-cloud/gemini-cli-with-mcp-server-expanding-possibilities-with-google-apps-script-4626c661ac81">Ref2</a>, <a href="https://medium.com/google-cloud/processing-file-content-using-gemini-cli-with-an-mcp-server-built-by-google-apps-script-86e2675e4d6b">Ref3</a>, <a href="https://medium.com/google-cloud/gemini-cli-featuring-an-enhanced-toolsformcpserver-7afaadfb5cfa">Ref4</a>, <a href="https://medium.com/google-cloud/next-level-data-automation-gemini-cli-google-sheets-and-mcp-e6628a382e90">Ref5</a>).</p>
<p>However, a significant challenge emerged: deeply managing these services often required creating a large number of specialized tools, leading to high development costs. This report introduces a more efficient method that addresses this issue.</p>
<p>The key insight is that <strong>MCP server tools require parameters defined by a JSON schema</strong>. This same structure can be used to construct the <strong>request body for the <code>batchUpdate</code> methods</strong> available in the Google Docs, Sheets, and Slides APIs. The <code>batchUpdate</code> methods are exceptionally powerful, allowing multiple operations (like inserting text, formatting, and creating tables) to be executed in a single, atomic API call.</p>
<p>By aligning the MCP tool&rsquo;s schema with the <code>batchUpdate</code> request structure, we can consolidate a vast array of document manipulations into <strong>just three core tools</strong>—one for each application. This streamlined approach not only simplifies Google Workspace automation but also offers a scalable and cost-effective model for integrating with other APIs that use JSON schemas.</p>
<h2 id="the-core-method-unified-tools-via-batchupdate">The Core Method: Unified Tools via <code>batchUpdate</code></h2>
<p>To implement this approach, I first used Gemini to generate a comprehensive JSON schema for the <code>batchUpdate</code> methods of the Docs, Sheets, and Slides APIs. The resulting schema, available in my repository at <a href="https://github.com/tanaikech/ToolsForMCPServer">https://github.com/tanaikech/ToolsForMCPServer</a>, is compatible with all <code>batchUpdate</code> methods for each respective API.</p>
<p>The <code>batchUpdate</code> method allows multiple requests to be bundled into a single call, which significantly improves efficiency. However, using it effectively requires specific object identifiers, such as child indexes in Docs, sheet IDs in Sheets, and object IDs in Slides. To retrieve this necessary information, three additional helper tools were created to fetch the document, spreadsheet, or presentation object structure.</p>
<p>Consequently, this entire solution uses a total of just six tools to enable comprehensive management of Google Docs, Sheets, and Slides through natural language commands.</p>
<h2 id="usage-and-sample-prompts">Usage and Sample Prompts</h2>
<p>For complete usage instructions, please visit my repository: <strong><a href="https://github.com/tanaikech/ToolsForMCPServer?tab=readme-ov-file#usage">https://github.com/tanaikech/ToolsForMCPServer?tab=readme-ov-file#usage</a></strong></p>
<p>This section demonstrates sample prompts and their outcomes using the Gemini CLI with the MCP server.</p>
<p><strong>Important:</strong> Before testing, please enable the Google Docs, Google Sheets, and Google Slides APIs in the Google Apps Script project containing the <code>doPost</code> function. <a href="https://developers.google.com/apps-script/guides/services/advanced#enable_advanced_services">Ref</a></p>
<hr>
<h3 id="1-google-docs-examples">1. Google Docs Examples</h3>
<h4 id="example-1-insert-text-and-change-font-color"><strong>Example 1: Insert text and change font color</strong></h4>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Document ID is &#34;###&#34;. Put a text &#34;sample text&#34; with the font colors of &#34;sample&#34; and &#34;text&#34; to &#34;red&#34; and &#34;blue&#34; into the Google Docs.
</span></span></code></pre></div><p><strong>Answer:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>✔  manage_google_docs_using_docs_api (gas_web_apps MCP Server) {&#34;requests&#34;:[{&#34;insertText&#34;:{&#34;location&#34;:{&#34;index&#34;:1},&#34;text&#34;:&#34;sam…
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>✦ The text &#34;sample text&#34; has been inserted into the Google Doc with &#34;sample&#34; in red and &#34;text&#34; in blue.
</span></span></code></pre></div><p><strong>Generated Request Body:</strong></p>
<p>The tool generates a <code>batchUpdate</code> request that first inserts the text and then applies two separate text style updates in a single API call.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;requests&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;sample text&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;updateTextStyle&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;fields&#34;</span>: <span style="color:#e6db74">&#34;foregroundColor&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;textStyle&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;foregroundColor&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;color&#34;</span>: {
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;rgbColor&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;red&#34;</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>              }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;range&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;endIndex&#34;</span>: <span style="color:#ae81ff">7</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;startIndex&#34;</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;updateTextStyle&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;range&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;endIndex&#34;</span>: <span style="color:#ae81ff">12</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;startIndex&#34;</span>: <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;fields&#34;</span>: <span style="color:#e6db74">&#34;foregroundColor&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;textStyle&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;foregroundColor&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;color&#34;</span>: {
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;rgbColor&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;blue&#34;</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>              }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;documentId&#34;</span>: <span style="color:#e6db74">&#34;###&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20250717a/fig2.jpg" alt=""></p>
<h4 id="example-2-insert-a-bulleted-list"><strong>Example 2: Insert a bulleted list</strong></h4>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Document ID is &#34;###&#34;. Append the following list to Google Docs as a bulleted list.
</span></span><span style="display:flex;"><span>&lt;List&gt;
</span></span><span style="display:flex;"><span>sample text1
</span></span><span style="display:flex;"><span>sample text2
</span></span><span style="display:flex;"><span>sample text3
</span></span><span style="display:flex;"><span>&lt;/List&gt;
</span></span></code></pre></div><p><strong>Answer:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>✔  manage_google_docs_using_docs_api (gas_web_apps MCP Server) {&#34;requests&#34;:[{&#34;insertText&#34;:{&#34;location&#34;:{&#34;index&#34;:1},&#34;text&#34;:&#34;sam…
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>✦ The bulleted list has been successfully appended to the Google Doc.
</span></span></code></pre></div><p><strong>Generated Request Body:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;requests&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;sample text1\nsample text2\nsample text3\n&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;createParagraphBullets&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;range&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;endIndex&#34;</span>: <span style="color:#ae81ff">40</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;startIndex&#34;</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;bulletPreset&#34;</span>: <span style="color:#e6db74">&#34;BULLET_DISC_CIRCLE_SQUARE&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;documentId&#34;</span>: <span style="color:#e6db74">&#34;###&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20250717a/fig3.jpg" alt=""></p>
<h4 id="example-3-insert-a-table-with-values"><strong>Example 3: Insert a table with values</strong></h4>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Document ID is &#34;###&#34;. Put a table with 2 rows and 3 columns at the top of the document with the following values. 1st Row: &#34;A1&#34;, &#34;B1&#34;, &#34;C1&#34; in columns. 2nd Row: &#34;A2&#34;, &#34;B2&#34;, &#34;C2&#34; in columns.
</span></span></code></pre></div><p>Initially, this prompt failed because the model could not generate the correct request body. To fix this, I provided context by having the Gemini CLI read a PDF version (<code>ref1.pdf</code>) of <a href="https://tanaikech.github.io/2019/05/22/creating-new-table-and-putting-values-to-cells-using-google-docs-api-with-google-apps-script/">my blog post</a> explaining how to create tables with the Docs API.</p>
<p><strong>Prompt 1: Provide Context</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Read the PDF file of &#34;ref1.pdf&#34; in the current directory.
</span></span></code></pre></div><p><strong>Answer:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>✔  ReadFile ref1.pdf
</span></span><span style="display:flex;"><span>  Read pdf file: ref1.pdf
</span></span></code></pre></div><p><strong>Prompt 2: Re-attempt Mission</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Follow the mission by understanding how to create a new table in Google Docs using the Docs API from &#34;ref1.pdf&#34;.
</span></span><span style="display:flex;"><span>&lt;Mission&gt;
</span></span><span style="display:flex;"><span>Document ID is &#34;###&#34;. Put a table with 2 rows and 3 columns at the top of the document with the following values. 1st Row: &#34;A1&#34;, &#34;B1&#34;, &#34;C1&#34; in columns. 2nd Row: &#34;A2&#34;, &#34;B2&#34;, &#34;C2&#34; in columns.
</span></span><span style="display:flex;"><span>&lt;/Mission&gt;
</span></span></code></pre></div><p><strong>Answer:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>✔  manage_google_docs_using_docs_api (gas_web_apps MCP Server) {&#34;documentId&#34;:&#34;###&#34;,&#34;…
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>✦ The table has been successfully created and populated with the specified values.
</span></span></code></pre></div><p><strong>Generated Request Body:</strong></p>
<p>With the added context, Gemini successfully generated a request body that first inserts a table and then sequentially inserts text into each cell.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;documentId&#34;</span>: <span style="color:#e6db74">&#34;###&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;requests&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertTable&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;columns&#34;</span>: <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;rows&#34;</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;C2&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">16</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">14</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;B2&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;A2&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;C1&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;B1&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;A1&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20250717a/fig3b.jpg" alt=""></p>
<hr>
<h3 id="2-google-sheets-examples">2. Google Sheets Examples</h3>
<h4 id="example-1-insert-text-and-change-font-color-1"><strong>Example 1: Insert text and change font color</strong></h4>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Spreadsheet ID is &#34;###&#34;. Put a text &#34;sample text&#34; with the font colors of &#34;sample&#34; and &#34;text&#34; to &#34;red&#34; and &#34;blue&#34; into a cell &#34;&#39;Sheet1&#39;!A1&#34;.
</span></span></code></pre></div><p><strong>Answer:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>✔  get_google_sheet_object_using_sheets_api (gas_web_apps MCP Server) {&#34;spreadsheetId&#34;:&#34;###…
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>✔  manage_google_sheets_using_sheets_api (gas_web_apps MCP Server) {&#34;spreadsheetId&#34;:&#34;###…
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>✦ I have put &#34;sample text&#34; into cell &#39;Sheet1&#39;!B1 with &#34;sample&#34; in red and &#34;text&#34; in blue.
</span></span></code></pre></div><p><strong>Generated Request Body:</strong></p>
<p>The <code>get_google_sheet_object_using_sheets_api</code> tool first converts the sheet name &ldquo;Sheet1&rdquo; to its required <code>sheetId</code>. Then, <code>manage_google_sheets_using_sheets_api</code> constructs a single <code>repeatCell</code> request to update the cell&rsquo;s value and text formatting simultaneously.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&#34;spreadsheetId&#34;</span>:<span style="color:#e6db74">&#34;###&#34;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&#34;requests&#34;</span>:[
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">&#34;repeatCell&#34;</span>:{
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;range&#34;</span>:{
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#34;startRowIndex&#34;</span>:<span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#34;startColumnIndex&#34;</span>:<span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#34;endColumnIndex&#34;</span>:<span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#34;sheetId&#34;</span>:<span style="color:#960050;background-color:#1e0010">###</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#34;endRowIndex&#34;</span>:<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;fields&#34;</span>:<span style="color:#e6db74">&#34;userEnteredValue,textFormatRuns&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;cell&#34;</span>:{
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#34;userEnteredValue&#34;</span>:{
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">&#34;stringValue&#34;</span>:<span style="color:#e6db74">&#34;sample text&#34;</span>
</span></span><span style="display:flex;"><span>               },
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#34;textFormatRuns&#34;</span>:[
</span></span><span style="display:flex;"><span>                  {
</span></span><span style="display:flex;"><span>                     <span style="color:#f92672">&#34;format&#34;</span>:{
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&#34;foregroundColor&#34;</span>:{
</span></span><span style="display:flex;"><span>                           <span style="color:#f92672">&#34;red&#34;</span>:<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                        }
</span></span><span style="display:flex;"><span>                     },
</span></span><span style="display:flex;"><span>                     <span style="color:#f92672">&#34;startIndex&#34;</span>:<span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                  },
</span></span><span style="display:flex;"><span>                  {
</span></span><span style="display:flex;"><span>                     <span style="color:#f92672">&#34;format&#34;</span>:{
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&#34;foregroundColor&#34;</span>:{
</span></span><span style="display:flex;"><span>                           <span style="color:#f92672">&#34;blue&#34;</span>:<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                        }
</span></span><span style="display:flex;"><span>                     },
</span></span><span style="display:flex;"><span>                     <span style="color:#f92672">&#34;startIndex&#34;</span>:<span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span>                  }
</span></span><span style="display:flex;"><span>               ]
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>         }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>   ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20250717a/fig4.jpg" alt=""></p>
<h4 id="example-2-delete-and-insert-a-sheet"><strong>Example 2: Delete and insert a sheet</strong></h4>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Spreadsheet ID is &#34;###&#34;. Delete &#34;temp1&#34; sheet and insert a new sheet as &#34;temp2&#34;.
</span></span></code></pre></div><p><strong>Answer:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>✔  get_google_sheet_object_using_sheets_api (gas_web_apps MCP Server) {&#34;spreadsheetId&#34;:&#34;###…
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>✔  manage_google_sheets_using_sheets_api (gas_web_apps MCP Server) {&#34;spreadsheetId&#34;:&#34;###…
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>✦ I have successfully deleted the &#34;temp1&#34; sheet and inserted a new sheet named &#34;temp2&#34; in the spreadsheet.
</span></span></code></pre></div><p><strong>Generated Request Body:</strong></p>
<p>The <code>batchUpdate</code> method combines a <code>deleteSheet</code> and an <code>addSheet</code> request into one atomic operation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;requests&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;deleteSheet&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;sheetId&#34;</span>: <span style="color:#e6db74">&#34;###&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;addSheet&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;properties&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;title&#34;</span>: <span style="color:#e6db74">&#34;temp2&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;spreadsheetId&#34;</span>: <span style="color:#e6db74">&#34;###&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h3 id="3-google-slides-examples">3. Google Slides Examples</h3>
<h4 id="example-1-insert-text-and-change-font-color-2"><strong>Example 1: Insert text and change font color</strong></h4>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Presentation ID is &#34;###&#34;. Put a text &#34;sample text&#34; with the font colors of &#34;sample&#34; and &#34;text&#34; to &#34;red&#34; and &#34;blue&#34; into the 1st page of the Google Slides.
</span></span></code></pre></div><p><strong>Answer:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>✔  get_google_slides_object_using_slides_api (gas_web_apps MCP Server) {&#34;presentationId&#34;:&#34;###…
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>✔  manage_google_slides_using_slides_api (gas_web_apps MCP Server) {&#34;requests&#34;:[{&#34;createShape&#34;:{&#34;shapeType&#34;:&#34;TEXT_BOX&#34;,&#34;objec…
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>✦ I have put &#34;sample text&#34; with &#34;sample&#34; in red and &#34;text&#34; in blue into the 1st page of the Google Slides.
</span></span></code></pre></div><p><strong>Generated Request Body:</strong></p>
<p>This complex operation, involving creating a text box, inserting text, and applying two different styles, is executed as a single <code>batchUpdate</code> request.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;requests&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;createShape&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;shapeType&#34;</span>: <span style="color:#e6db74">&#34;TEXT_BOX&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;objectId&#34;</span>: <span style="color:#e6db74">&#34;myTextBox&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;elementProperties&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;transform&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;unit&#34;</span>: <span style="color:#e6db74">&#34;EMU&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;scaleY&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;translateY&#34;</span>: <span style="color:#ae81ff">2000000</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;scaleX&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;translateX&#34;</span>: <span style="color:#ae81ff">2000000</span>
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;pageObjectId&#34;</span>: <span style="color:#e6db74">&#34;p&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;size&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;width&#34;</span>: {
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;magnitude&#34;</span>: <span style="color:#ae81ff">5000000</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;unit&#34;</span>: <span style="color:#e6db74">&#34;EMU&#34;</span>
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;height&#34;</span>: {
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;unit&#34;</span>: <span style="color:#e6db74">&#34;EMU&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;magnitude&#34;</span>: <span style="color:#ae81ff">1000000</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;sample text&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;insertionIndex&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;objectId&#34;</span>: <span style="color:#e6db74">&#34;myTextBox&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;updateTextStyle&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;fields&#34;</span>: <span style="color:#e6db74">&#34;foregroundColor&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;objectId&#34;</span>: <span style="color:#e6db74">&#34;myTextBox&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;textRange&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;FIXED_RANGE&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;startIndex&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;endIndex&#34;</span>: <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;style&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;foregroundColor&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;opaqueColor&#34;</span>: {
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;rgbColor&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;blue&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;green&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;red&#34;</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>              }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;updateTextStyle&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;fields&#34;</span>: <span style="color:#e6db74">&#34;foregroundColor&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;objectId&#34;</span>: <span style="color:#e6db74">&#34;myTextBox&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;style&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;foregroundColor&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;opaqueColor&#34;</span>: {
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;rgbColor&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;red&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;blue&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;green&#34;</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>              }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;textRange&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;startIndex&#34;</span>: <span style="color:#ae81ff">7</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;endIndex&#34;</span>: <span style="color:#ae81ff">11</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;FIXED_RANGE&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;presentationId&#34;</span>: <span style="color:#e6db74">&#34;###&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20250717a/fig5.jpg" alt=""></p>
<h4 id="example-2-put-shapes-and-set-texts"><strong>Example 2: Put shapes and set texts</strong></h4>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Presentation ID is &#34;###&#34;. On the 1st page ot Google Slides, put 3 rectangle shapes aligned vertically in the center of the page. And, put the texts of &#34;sample text 1&#34;, &#34;sample text 2&#34;, and &#34;sample text 3&#34; into each shape.
</span></span></code></pre></div><p><strong>Answer:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>✔  get_google_slides_object_using_slides_api (gas_web_apps MCP Server) {&#34;presentationId&#34;:&#34;###…
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>✔  manage_google_slides_using_slides_api (gas_web_apps MCP Server) {&#34;presentationId&#34;:&#34;###…
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>✦ I have successfully added three rectangle shapes with the specified texts, aligned vertically in the center of the first page
</span></span><span style="display:flex;"><span>  of the Google Slides presentation.
</span></span></code></pre></div><p><strong>Generated Request Body:</strong></p>
<p>The prompt is translated into six batched requests: one <code>createShape</code> and one <code>insertText</code> for each of the three rectangles.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;presentationId&#34;</span>: <span style="color:#e6db74">&#34;###&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;requests&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;createShape&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;objectId&#34;</span>: <span style="color:#e6db74">&#34;shape1&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;shapeType&#34;</span>: <span style="color:#e6db74">&#34;RECTANGLE&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;elementProperties&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;pageObjectId&#34;</span>: <span style="color:#e6db74">&#34;p&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;transform&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;scaleY&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;unit&#34;</span>: <span style="color:#e6db74">&#34;EMU&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;scaleX&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;translateX&#34;</span>: <span style="color:#ae81ff">3572000</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;translateY&#34;</span>: <span style="color:#ae81ff">1721750</span>
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;size&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;height&#34;</span>: {
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;magnitude&#34;</span>: <span style="color:#ae81ff">500000</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;unit&#34;</span>: <span style="color:#e6db74">&#34;EMU&#34;</span>
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;width&#34;</span>: {
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;unit&#34;</span>: <span style="color:#e6db74">&#34;EMU&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;magnitude&#34;</span>: <span style="color:#ae81ff">2000000</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;sample text 1&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;objectId&#34;</span>: <span style="color:#e6db74">&#34;shape1&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;createShape&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;objectId&#34;</span>: <span style="color:#e6db74">&#34;shape2&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;elementProperties&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;transform&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;translateY&#34;</span>: <span style="color:#ae81ff">2321750</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;scaleX&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;unit&#34;</span>: <span style="color:#e6db74">&#34;EMU&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;scaleY&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;translateX&#34;</span>: <span style="color:#ae81ff">3572000</span>
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;size&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;height&#34;</span>: {
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;magnitude&#34;</span>: <span style="color:#ae81ff">500000</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;unit&#34;</span>: <span style="color:#e6db74">&#34;EMU&#34;</span>
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;width&#34;</span>: {
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;unit&#34;</span>: <span style="color:#e6db74">&#34;EMU&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;magnitude&#34;</span>: <span style="color:#ae81ff">2000000</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;pageObjectId&#34;</span>: <span style="color:#e6db74">&#34;p&#34;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;shapeType&#34;</span>: <span style="color:#e6db74">&#34;RECTANGLE&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;objectId&#34;</span>: <span style="color:#e6db74">&#34;shape2&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;sample text 2&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;createShape&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;elementProperties&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;size&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;width&#34;</span>: {
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;magnitude&#34;</span>: <span style="color:#ae81ff">2000000</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;unit&#34;</span>: <span style="color:#e6db74">&#34;EMU&#34;</span>
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;height&#34;</span>: {
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;unit&#34;</span>: <span style="color:#e6db74">&#34;EMU&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;magnitude&#34;</span>: <span style="color:#ae81ff">500000</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;transform&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;scaleX&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;translateY&#34;</span>: <span style="color:#ae81ff">2921750</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;scaleY&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;unit&#34;</span>: <span style="color:#e6db74">&#34;EMU&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;translateX&#34;</span>: <span style="color:#ae81ff">3572000</span>
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;pageObjectId&#34;</span>: <span style="color:#e6db74">&#34;p&#34;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;objectId&#34;</span>: <span style="color:#e6db74">&#34;shape3&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;shapeType&#34;</span>: <span style="color:#e6db74">&#34;RECTANGLE&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;sample text 3&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;objectId&#34;</span>: <span style="color:#e6db74">&#34;shape3&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20250717a/fig6.jpg" alt=""></p>
<hr>
<h3 id="4-advanced-applications">4. Advanced Applications</h3>
<h4 id="copy-a-table-from-google-sheets-to-google-docs"><strong>Copy a table from Google Sheets to Google Docs</strong></h4>
<p>This example demonstrates a complex, cross-application workflow. Building on &ldquo;Example 3&rdquo; for Google Docs, I tested copying a table directly from Sheets to Docs.</p>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Read the PDF file of &#34;ref1.pdf&#34; in the current directory. Follow the mission by understanding how to create a new table in Google Docs using the Docs API from &#34;ref1.pdf&#34;.
</span></span><span style="display:flex;"><span>&lt;Mission&gt;
</span></span><span style="display:flex;"><span>Document ID and Spreadsheet ID are &#34;###&#34; and &#34;###&#34;, respectively. Copy a table from &#34;&#39;Sheet1&#39;!A1:C2&#34; on Google Sheets to the top of the document on Google Docs.
</span></span><span style="display:flex;"><span>&lt;/Mission&gt;
</span></span></code></pre></div><p><strong>Answer:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>✔  ReadFile ref1.pdf
</span></span><span style="display:flex;"><span>  Read pdf file: ref1.pdf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>✔  get_values_from_google_sheets (gas_web_apps MCP Server) {&#34;spreadsheetId&#34;:&#34;###&#34;,&#34;r…
</span></span><span style="display:flex;"><span>  [[&#34;a1&#34;,&#34;b1&#34;,&#34;c1&#34;],[&#34;a2&#34;,&#34;b2&#34;,&#34;c2&#34;]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>✔  manage_google_docs_using_docs_api (gas_web_apps MCP Server) {&#34;documentId&#34;:&#34;###&#34;,&#34;…
</span></span></code></pre></div><p><strong>Generated Request Body:</strong></p>
<p>First, the <code>ReadFile</code> tool provided context. Next, the <code>get_values_from_google_sheets</code> tool retrieved the data from the specified range. Finally, Gemini constructed the correct <code>batchUpdate</code> request body for the Docs API to create the table and populate it with the retrieved data.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;documentId&#34;</span>: <span style="color:#e6db74">&#34;###&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;requests&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertTable&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;columns&#34;</span>: <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;rows&#34;</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;c2&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">16</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">14</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;b2&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;a2&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;c1&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;b1&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;insertText&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;a1&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20250717a/fig7.jpg" alt=""></p>
<p>This successful test shows that by using core tools for the Docs, Sheets, and Slides APIs, complex processes can be accomplished via the Gemini API and MCP, unlocking infinite possibilities.</p>
<h2 id="note-on-error-handling-and-limitations">Note on Error Handling and Limitations</h2>
<p>During testing, I observed that the Gemini CLI can exhibit self-correction. Even when an initial request fails, the CLI can automatically revise the request body based on the error message and retry until it succeeds.</p>
<p>While this approach may not handle every conceivable user request perfectly, it provides a powerful and robust foundation for the detailed management of Docs, Sheets, and Slides using natural language.</p>
<h2 id="summary">Summary</h2>
<ul>
<li><strong>Problem:</strong> Automating Google Workspace with Gemini CLI and an MCP server traditionally required numerous, costly custom tools for anything beyond simple tasks.</li>
<li><strong>Solution:</strong> This report proposes a unified approach that consolidates document management into just three core tools by leveraging the <code>batchUpdate</code> methods of the Google Docs, Sheets, and Slides APIs.</li>
<li><strong>Methodology:</strong> The JSON schema required by the MCP server tools is used to directly construct the request bodies for the powerful <code>batchUpdate</code> API calls, which can handle multiple operations at once.</li>
<li><strong>Implementation:</strong> The solution uses six tools in total: one primary <code>batchUpdate</code> tool for each of the three services, and one helper tool for each to retrieve necessary object IDs.</li>
<li><strong>Benefits:</strong> This method dramatically reduces development cost and complexity, and enables sophisticated, cross-application automations—such as copying a table from Sheets to Docs—using simple, natural language prompts.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2025%2f07%2f17%2fmanaging-google-docs-sheets-and-slides-by-natural-language-with-gemini-cli-and-mcp%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2025%2f07%2f17%2fmanaging-google-docs-sheets-and-slides-by-natural-language-with-gemini-cli-and-mcp%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f07%2f17%2fmanaging-google-docs-sheets-and-slides-by-natural-language-with-gemini-cli-and-mcp%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2025%2f07%2f17%2fmanaging-google-docs-sheets-and-slides-by-natural-language-with-gemini-cli-and-mcp%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f07%2f17%2fmanaging-google-docs-sheets-and-slides-by-natural-language-with-gemini-cli-and-mcp%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f07%2f17%2fmanaging-google-docs-sheets-and-slides-by-natural-language-with-gemini-cli-and-mcp%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2025/07/12/next-level-data-automation-gemini-cli-google-sheets-and-mcp/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2025/07/12/next-level-data-automation-gemini-cli-google-sheets-and-mcp/">Next-Level Data Automation: Gemini CLI, Google Sheets, and MCP</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2025/07/19/updated-gas-library-toolsformcpserver/">Updated: GAS Library - ToolsForMCPServer</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2025/07/19/updated-gas-library-toolsformcpserver/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

