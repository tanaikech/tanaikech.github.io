<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Simplified Google Workspace Automation with Gemini CLI Extensions &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>X</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Simplified Google Workspace Automation with Gemini CLI Extensions</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15 Oct 2025, 15:06</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/model-context-protocol">Model Context Protocol</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/mcp">MCP</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/8693efc439bac83b3aea38317fb7724f">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20251015a/fig1.jpg" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>This project simplifies Google Workspace automation by using a Gemini CLI Extension. It installs a local Model Context Protocol (MCP) server that communicates with a powerful, securely authorized backend built on Google Apps Script Web Apps, overcoming previous complex setup and performance bottlenecks.</p>
<h1 id="introduction">Introduction</h1>
<p>In order to achieve Google Workspace Automation with seamless authorization and safety, I have published a Model Context Protocol (MCP) server built by Google Apps Script Web Apps. <a href="https://medium.com/google-cloud/gemini-cli-with-mcp-server-expanding-possibilities-with-google-apps-script-4626c661ac81">Ref</a> This is very useful because Google Apps Script provides native, secure authorization for Google Workspace APIs like Gmail, Drive, and Calendar. However, there was a bottleneck in the complex installation and a long loading time of the MCP server. Recently, Gemini Extensions have been released. <a href="https://cloud.google.com/blog/products/databases/gemini-cli-extensions-for-google-data-cloud?e=48754805&amp;hl=en">Ref</a> By this, tools and MCP servers can be directly and easily installed from sources like GitHub repositories using a simple command. From this situation, I attempted to implement this simplified installation method on the MCP server built by Google Apps Script Web Apps.</p>
<h1 id="repository">Repository</h1>
<p><a href="https://github.com/tanaikech/ToolsForMCPServer-extension">https://github.com/tanaikech/ToolsForMCPServer-extension</a></p>
<h1 id="workflow">Workflow</h1>
<ol>
<li>A user inputs a prompt into the Gemini CLI.</li>
<li>The local MCP server (running on Node.js) accepts the prompt.</li>
<li>The AI agent selects a tool and provides the necessary arguments.</li>
<li>The local server calls the corresponding tool on the GAS MCP server via an HTTP request.</li>
<li>The tool executes with your permissions on Google Apps Script and returns the result.</li>
<li>The result is passed back from the local server to the AI agent.</li>
<li>The AI agent processes the result and displays the final response to the user.</li>
</ol>
<p><img src="https://tanaikech.github.io/image-storage/20251015a/fig2.jpg" alt=""></p>
<p><a href="https://mermaidchart.com/play?utm_source=mermaid_live_editor&amp;utm_medium=share#pako:eNqVk0-P2jAQxb_KyKdWhYgkJBAfVkJUopW2FRLspUJCVjKbdZvErv-gbhHfvXYMLAvdw-YUP3t-897E2ZNSVEgo0fjbYlfiZ85qxdpNB-6RTBlecsk6Aw8a1a26wJZ3fDu__wpMw4aENbj1htyevhcla7bf5svtCtUOVajpVXAqHNUP352n6Kf--D_GYra6IVzWLoSoG4SZlBpWpeLS9JgA8iGGd3efXmxTiCOYgXUbwDtpjQYGUolWmijUvJz1ldcRKCQRrJ8QmnMKfXRWligdzrjNdwHTAJy5kdboEmtssOx9GSEaYF3leTteodNUbVt3SB_Z17Q-7KuJURgHfsBiFaiurAletcSSP_Iy6DvO4Mt6vQTlL4g-Z3jFHLo2w9sgWWjUc7gGZbvevEJjVReaKdS2MW-Z99jLT5VHsAzJj8Ue5BLsWGN9n149ze122h7nbwCFydWI3TxL1BovTfVeK65lw57PuhSdxogMSK14RahRFgekRdUyvyR733ND3OEWN4S614qpX_7-HVyNu78_hGhPZUrY-onQR9Zot7KyYub0-51VhV2Fai5sZwhNs2kPIXRP_hCaj6I0yUfFJJvm42mcus1nQpOkiOI0S4q4iLNJkhfJYUD-9m1HUTHOszxJJqNxnsbxKD78A5KLTkY">Mermaid Chart Playground</a></p>
<p>This solution uses a local MCP server that acts as a fast-loading proxy for the more powerful Google Apps Script (GAS) MCP server. This architecture significantly reduces the startup time for the Gemini CLI while retaining the secure, native authorization of Google Apps Script for all Workspace API calls.</p>
<h1 id="installation-and-configuration">Installation and Configuration</h1>
<p>Follow these steps to set up the environment.</p>
<h2 id="1-install-gemini-cli-and-default-settings">1. Install Gemini CLI and default settings</h2>
<p><strong>1. Install Gemini CLI</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm install -g @google/gemini-cli
</span></span></code></pre></div><p><strong>2. Authorization</strong></p>
<p>Follow the official instructions to authenticate the CLI with your Google account: <a href="https://github.com/google-gemini/gemini-cli?tab=readme-ov-file#-authentication-options">Gemini CLI Authentication Options</a>.</p>
<h2 id="2-copy-a-google-apps-script-project">2. Copy a Google Apps Script project</h2>
<p>After you log in to your Google account, access the following URL using your browser. And, copy the project by clicking the copy button at the top right.</p>
<p><a href="https://script.google.com/home/projects/1Qm9LgtuQLxDzdLUoJPrOEpmyTBivZZsCLiSUC7q-D3Gi4fISvxgcITWb">https://script.google.com/home/projects/1Qm9LgtuQLxDzdLUoJPrOEpmyTBivZZsCLiSUC7q-D3Gi4fISvxgcITWb</a></p>
<p>By this, the copied Google Apps Script project is automatically opened.</p>
<h2 id="3-deploy-web-apps">3. Deploy Web Apps</h2>
<p>To allow the Gemini CLI to communicate with our script, we must deploy it as a Web App. This creates a unique URL that acts as our MCP server endpoint.</p>
<p>You can find detailed information in <a href="https://developers.google.com/apps-script/guides/web#deploy_a_script_as_a_web_app">the official documentation</a>.</p>
<p>Please follow these steps to deploy the Web App in the script editor:</p>
<ol>
<li>In the script editor, at the top right, click <strong>Deploy</strong> -&gt; <strong>New deployment</strong>.</li>
<li>Click <strong>Select type</strong> -&gt; <strong>Web App</strong>.</li>
<li>Enter a description for the Web App in the fields under <strong>Deployment configuration</strong>.</li>
<li>Select <strong>&ldquo;Me&rdquo;</strong> for <strong>&ldquo;Execute as&rdquo;</strong>. This is crucial, as it allows the script to run with your permissions to access your Google services.</li>
<li>Select <strong>&ldquo;Anyone&rdquo;</strong> for <strong>&ldquo;Who has access&rdquo;</strong>. This makes the URL callable from the internet. Access is controlled by the unguessable URL and the <code>accessKey</code> defined in the script.</li>
<li>Click <strong>Deploy</strong>.</li>
<li>After authorizing the necessary scopes, copy the <strong>Web app URL</strong>. It will look similar to <code>https://script.google.com/macros/s/###/exec</code>. This is your MCP server endpoint.</li>
</ol>
<blockquote>
<p><strong>Important:</strong> If you modify the Apps Script code, you must redeploy the project to apply the changes. Go to <strong>Deploy</strong> &gt; <strong>Manage deployments</strong>, edit your active deployment, and select <strong>&ldquo;New version&rdquo;</strong>. <a href="https://github.com/tanaikech/taking-advantage-of-Web-Apps-with-google-apps-script?tab=readme-ov-file#redeploy">More info here</a>.</p>
</blockquote>
<h2 id="4-environmental-variables">4. Environmental variables</h2>
<p>This MCP server uses the following 2 environmental variables. Please set them.</p>
<p>API key for using Gemini API. (This variable might have already been set for using Gemini CLI and Gemini API, depending on the environment.)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>export GEMINI_API_KEY<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{Your API key}&#34;</span>
</span></span></code></pre></div><p>Web Apps URL retrieved from the above section.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>export MCP_WEB_APPS_URL<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://script.google.com/macros/s/###/exec?accessKey=sample&#34;</span>
</span></span></code></pre></div><blockquote>
<p><strong>Note:</strong> The value <code>sample</code> in <code>accessKey=sample</code> must match the key defined in your Google Apps Script project (<code>new MCPApp.mcpApp({ accessKey: &quot;sample&quot; })</code>). If you change the key in the script, you must update it here and redeploy the Web App.</p>
</blockquote>
<p>For persistence, add the <code>export</code> commands for <code>GEMINI_API_KEY</code> and <code>MCP_WEB_APPS_URL</code> to your shell&rsquo;s startup file (e.g., <code>.bashrc</code> or <code>.zshrc</code>).</p>
<h2 id="5-install-gemini-extension">5. Install Gemini extension</h2>
<p>Finally, install the extension using the following command. This will download the local MCP server and configure the tools.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gemini extensions install https://github.com/tanaikech/ToolsForMCPServer-extension
</span></span></code></pre></div><h2 id="6-testing">6. Testing</h2>
<p>To confirm that the setup is working correctly:</p>
<ol>
<li>Run the Gemini CLI:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gemini
</span></span></code></pre></div><ol start="2">
<li>Once the CLI is open, check the available MCP tools:</li>
</ol>
<pre tabindex="0"><code>/mcp
</code></pre><p>If you see a list of tools from your Google Apps Script project, the installation was successful.</p>
<h1 id="summary">Summary</h1>
<ul>
<li><strong>One-Command Installation:</strong> The Gemini Extension simplifies setup to a single <code>gemini extensions install</code> command after initial configuration.</li>
<li><strong>Secure Workspace Access:</strong> It leverages Google Apps Script for native, secure authorization to Google Workspace APIs like Gmail, Drive, and Calendar.</li>
<li><strong>Improved Performance:</strong> A local proxy MCP server dramatically reduces the CLI loading time compared to a direct Web App implementation.</li>
<li><strong>Powerful Automation Backend:</strong> Provides a robust foundation for creating custom tools that automate complex workflows within your Google Workspace environment.</li>
<li><strong>User-Controlled Security:</strong> Your project remains secure through your private access key and Google&rsquo;s established Web App infrastructure.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2025%2f10%2f15%2fsimplified-google-workspace-automation-with-gemini-cli-extensions%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2025%2f10%2f15%2fsimplified-google-workspace-automation-with-gemini-cli-extensions%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f10%2f15%2fsimplified-google-workspace-automation-with-gemini-cli-extensions%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2025%2f10%2f15%2fsimplified-google-workspace-automation-with-gemini-cli-extensions%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f10%2f15%2fsimplified-google-workspace-automation-with-gemini-cli-extensions%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f10%2f15%2fsimplified-google-workspace-automation-with-gemini-cli-extensions%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2025/10/12/recipient-of-the-outstanding-google-developer-expert-award/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2025/10/12/recipient-of-the-outstanding-google-developer-expert-award/">Recipient of the Outstanding Google Developer Expert Award</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2025/10/15/gemini-cli-extension-toolsformcpserver-extension/">Gemini CLI Extension: ToolsForMCPServer-extension</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2025/10/15/gemini-cli-extension-toolsformcpserver-extension/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

