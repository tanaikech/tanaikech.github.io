<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Next-Level Google Apps Script Development &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Next-Level Google Apps Script Development</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>29 Oct 2025, 16:41</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/model-context-protocol">Model Context Protocol</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/mcp">MCP</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>
    
  </div>
  
  

</div>

  <p><a href="https://github.com/tanaikech/Next-Level-Google-Apps-Script-Development">GitHub</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20251029a/fig1.jpg" alt=""></p>
<h2 id="abstract">Abstract</h2>
<p>This article introduces a powerful method for developing and testing Google Apps Script (GAS) locally. By leveraging the <code>gas-fakes</code> library, you can build a secure, local Model Context Protocol (MCP) server, enabling the creation of AI-powered tools for Google Workspace automation without deploying to the cloud.</p>
<h2 id="introduction">Introduction</h2>
<p><a href="https://github.com/brucemcpherson/gas-fakes">gas-fakes</a>, developed by Bruce McPherson, is an innovative library that enables Google Apps Script (GAS) code to run directly in a local environment by substituting GAS classes and methods with their corresponding Google APIs.</p>
<p>The introduction of this library has unlocked new possibilities in GAS development. Leveraging <code>gas-fakes</code>, I have explored the following technical advancements:</p>
<ol>
<li><strong>A Secure Sandbox for GAS</strong>: I reported on the feasibility of creating a secure sandbox that allows for the safe execution of code, including that generated by AI, by intentionally limiting the classes and methods available at runtime. <a href="https://medium.com/google-cloud/a-fake-sandbox-for-google-apps-script-a-feasibility-study-on-securely-executing-code-generated-by-cc985ce5dae3">Ref</a></li>
<li><strong>Dynamic Tool Creation with Gemini CLI Integration</strong>: By integrating <code>gas-fakes</code> with the <code>Gemini CLI</code>—a tool for interacting with Google&rsquo;s Gemini generative AI model—I demonstrated a method for dynamically creating and deleting tools for a local Model Context Protocol (MCP) server using Google Apps Script. <a href="https://medium.com/google-cloud/dynamic-tool-creation-for-google-workspace-automation-with-gemini-cli-f9618166aaed">Ref</a></li>
<li><strong>An Enhanced Developer Experience with a CLI and Extension</strong>: We developed a CLI tool and an MCP server for simply using <code>gas-fakes</code>, releasing it as a <a href="https://github.com/tanaikech/gas-development-kit-extension">Gemini CLI Extension</a>. This provides developers greater freedom and efficiency to run and test GAS code in their local environment. <a href="https://medium.com/google-cloud/secure-and-streamlined-google-apps-script-development-with-gas-fakes-cli-and-gemini-cli-extension-67bbce80e2c8">Ref</a></li>
</ol>
<p>These accomplishments demonstrate that combining <code>gas-fakes</code> with generative AI holds immense potential to dramatically automate and streamline GAS development with safety ensured. This article builds upon these findings to introduce and demonstrate a method for creating tools for an MCP server with GAS locally, all while ensuring security and seamless authorization integration.</p>
<p>By installing and authenticating the <code>gas-fakes</code> CLI, developers can freely execute GAS code from any directory in their local environment. This execution is always performed within a secure sandbox. This framework makes it possible to rapidly develop each tool for an MCP server using GAS and run them with secure, seamless authentication.</p>
<h2 id="prerequisites-and-installation">Prerequisites and Installation</h2>
<p>Before building the server, you must install and configure the necessary command-line tools.</p>
<h3 id="1-install-gemini-cli">1. Install Gemini CLI</h3>
<p>First, install the <a href="https://github.com/google-gemini/gemini-cli">Gemini CLI</a>, which allows interaction with Google&rsquo;s Gemini models.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm install -g @google/gemini-cli
</span></span></code></pre></div><p>After installation, authorize the CLI by following the instructions in the <a href="https://github.com/google-gemini/gemini-cli?tab=readme-ov-file#-authentication-options">official documentation</a>.</p>
<h3 id="2-install-gas-fakes-cli">2. Install gas-fakes CLI</h3>
<p>Next, install <a href="https://github.com/brucemcpherson/gas-fakes">gas-fakes</a>, the command-line tool for executing Google Apps Script locally.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm install -g @mcpher/gas-fakes
</span></span></code></pre></div><p>For authorization, refer to the official <a href="https://github.com/brucemcpherson/gas-fakes/blob/main/GETTING_STARTED.md">Getting Started guide</a>.</p>
<h3 id="3-verify-the-installation">3. Verify the Installation</h3>
<p>Confirm that the <code>gas-fakes</code> CLI is installed correctly by checking its help message:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes --help
</span></span></code></pre></div><p>Next, test your authorization by running a simple script to retrieve the name of your Google Drive&rsquo;s root folder:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes -s <span style="color:#e6db74">&#34;const rootFolder = DriveApp.getRootFolder(); const rootFolderName = rootFolder.getName(); console.log(rootFolderName);&#34;</span>
</span></span></code></pre></div><p>If the command successfully prints the folder name, your installation and authentication are working correctly.</p>
<h2 id="building-the-mcp-server">Building the MCP Server</h2>
<p>With the tools installed, you can now build the local MCP server.</p>
<h3 id="1-set-up-the-project-directory">1. Set Up the Project Directory</h3>
<p>Create a working directory for your project and install the required Node.js modules for the MCP server.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir sample
</span></span><span style="display:flex;"><span>cd sample
</span></span><span style="display:flex;"><span>npm install @modelcontextprotocol/sdk zod
</span></span></code></pre></div><p>All subsequent files in this guide will be created inside this <code>sample</code> directory.</p>
<h3 id="2-create-google-apps-script-tools">2. Create Google Apps Script Tools</h3>
<p>These JavaScript files will serve as the individual tools for your MCP server. All scripts can also be get from <a href="https://github.com/tanaikech/Next-Level-Google-Apps-Script-Development">https://github.com/tanaikech/Next-Level-Google-Apps-Script-Development</a>.</p>
<h4 id="get-sheet-names-from-a-spreadsheet">Get Sheet Names from a Spreadsheet</h4>
<p>Create <code>get_sheet_names.js</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Gets sheet names from a Google Spreadsheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param {Object} object
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>(<span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {}) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">spreadsheetId</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">spreadsheetId</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetNames</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">spreadsheet</span>.<span style="color:#a6e22e">getSheets</span>().<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">sheet</span>) =&gt; <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getName</span>());
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">sheetNames</span>);
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;error: Spreadsheet ID was not found.&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// The variable name &#34;args&#34; is fixed for passing arguments.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">myFunction</span>(<span style="color:#a6e22e">args</span>);
</span></span></code></pre></div><h4 id="get-values-from-a-spreadsheet">Get Values from a Spreadsheet</h4>
<p>Create <code>get_values_from_sheet.js</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Gets values from a Google Spreadsheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param {Object} object
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>(<span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {}) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">sheetName</span>, <span style="color:#a6e22e">range</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">spreadsheetId</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">sheetName</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">spreadsheet</span>.<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">?</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">range</span>).<span style="color:#a6e22e">getDisplayValues</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">:</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getDataRange</span>().<span style="color:#a6e22e">getDisplayValues</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">values</span>);
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;error: Spreadsheet ID or Sheet name were not found.&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// The variable name &#34;args&#34; is fixed for passing arguments.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">myFunction</span>(<span style="color:#a6e22e">args</span>);
</span></span></code></pre></div><h4 id="put-values-into-a-spreadsheet">Put Values into a Spreadsheet</h4>
<p>Create <code>set_values_to_sheet.js</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Puts values into a Google Spreadsheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param {Object} object
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>(<span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {}) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">sheetName</span>, <span style="color:#a6e22e">range</span>, <span style="color:#a6e22e">values</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">spreadsheetId</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">sheetName</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">values</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">spreadsheet</span>.<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">rng</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">range</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">r</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">range</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">rng</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getRange</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">getRow</span>(),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">getColumn</span>(),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">values</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">length</span>
</span></span><span style="display:flex;"><span>      );
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">rng</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getRange</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastRow</span>() <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">values</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">length</span>
</span></span><span style="display:flex;"><span>      );
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">rng</span>.<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">values</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">values</span>
</span></span><span style="display:flex;"><span>      )<span style="color:#e6db74">}</span><span style="color:#e6db74"> were put from the cell &#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">rng</span>.<span style="color:#a6e22e">getA1Notation</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;.`</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;error: Spreadsheet ID, Sheet name, or values were not found.&#34;</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// The variable name &#34;args&#34; is fixed for passing arguments.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">myFunction</span>(<span style="color:#a6e22e">args</span>);
</span></span></code></pre></div><h3 id="3-define-the-mcp-server">3. Define the MCP Server</h3>
<p>These two scripts define and run the MCP server.</p>
<p>First, create <code>mcp-server.js</code> to initialize the server:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @license
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Copyright 2025 Tanaike
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">McpServer</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;@modelcontextprotocol/sdk/server/mcp.js&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">StdioServerTransport</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;@modelcontextprotocol/sdk/server/stdio.js&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">tools</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;./tools.js&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">server</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">McpServer</span>({
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample-mcp-server&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;0.0.1&#34;</span>,
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">tools</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">schema</span>, <span style="color:#a6e22e">func</span> } <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">tools</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">registerTool</span>(<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">schema</span>, <span style="color:#a6e22e">func</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">transport</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">StdioServerTransport</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">await</span> <span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">connect</span>(<span style="color:#a6e22e">transport</span>);
</span></span></code></pre></div><p>Next, create <code>tools.js</code> to define the tools, their schemas, and the logic to execute them via the <code>gas-fakes</code> CLI.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">z</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;zod&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">exec</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;child_process&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">promisify</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;util&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">execAsync</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">promisify</span>(<span style="color:#a6e22e">exec</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">__gas_fakes</span>({ <span style="color:#a6e22e">cliArgs</span>, <span style="color:#a6e22e">functionArgs</span> }) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">functionArgs</span>).<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">cliArgs</span>.<span style="color:#a6e22e">push</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`-a &#39;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">functionArgs</span>).<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/\\\\&#39;|&#39;/g</span>, <span style="color:#e6db74">&#34;&#39;\\&#39;&#39;&#34;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;`</span>
</span></span><span style="display:flex;"><span>      );
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">command</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`gas-fakes </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">cliArgs</span>.<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34; &#34;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">stdout</span> } <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">execAsync</span>(<span style="color:#a6e22e">command</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">content</span><span style="color:#f92672">:</span> [{ <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;text&#34;</span>, <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">stdout</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#34;Execution finished.&#34;</span> }],
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">isError</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">err</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">content</span><span style="color:#f92672">:</span> [{ <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;text&#34;</span>, <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">message</span> }],
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">isError</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tools</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;get_sheet_names&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">schema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Use this to get the sheet names of all sheets in a Google Spreadsheet.&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">inputSchema</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">spreadsheetId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">string</span>().<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;Spreadsheet ID.&#34;</span>) },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">func</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">functionArgs</span> <span style="color:#f92672">=</span> {}) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">scriptFile</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;get_sheet_names.js&#34;</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Arguments for the gas-fakes CLI. Use `gas-fakes --help` for more options.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cliArgs</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">`-f &#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">scriptFile</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;`</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;-x&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">`-w &#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">functionArgs</span>.<span style="color:#a6e22e">spreadsheetId</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;`</span>,
</span></span><span style="display:flex;"><span>        ],
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">functionArgs</span>,
</span></span><span style="display:flex;"><span>      };
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">__gas_fakes</span>(<span style="color:#a6e22e">obj</span>);
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;get_values_from_sheet&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">schema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Use this to get values from a specific sheet in a Google Spreadsheet.&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">inputSchema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">spreadsheetId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">string</span>().<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;Spreadsheet ID.&#34;</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">sheetName</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">string</span>().<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;Sheet name of a Google Spreadsheet.&#34;</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">range</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">string</span>().<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;Cell range as A1Notation.&#34;</span>).<span style="color:#a6e22e">optional</span>(),
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">func</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">functionArgs</span> <span style="color:#f92672">=</span> {}) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">scriptFile</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;get_values_from_sheet.js&#34;</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cliArgs</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">`-f &#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">scriptFile</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;`</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;-x&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">`-w &#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">functionArgs</span>.<span style="color:#a6e22e">spreadsheetId</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;`</span>,
</span></span><span style="display:flex;"><span>        ],
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">functionArgs</span>,
</span></span><span style="display:flex;"><span>      };
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">__gas_fakes</span>(<span style="color:#a6e22e">obj</span>);
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;set_values_to_sheet&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">schema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Use this to put values in a specific sheet in a Google Spreadsheet.&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">inputSchema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">spreadsheetId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">string</span>().<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;Spreadsheet ID.&#34;</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">sheetName</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">string</span>().<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;Sheet name of a Google Spreadsheet.&#34;</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">range</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;Cell range as A1Notation. Optional for appending values.&#34;</span>)
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">optional</span>(),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">values</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">array</span>(<span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">array</span>(<span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">union</span>([<span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">number</span>(), <span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">string</span>()])))
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;Values to put into the cells.&#34;</span>),
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">func</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">functionArgs</span> <span style="color:#f92672">=</span> {}) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">scriptFile</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;set_values_to_sheet.js&#34;</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cliArgs</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">`-f &#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">scriptFile</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;`</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;-x&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">`--ww &#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">functionArgs</span>.<span style="color:#a6e22e">spreadsheetId</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;`</span>,
</span></span><span style="display:flex;"><span>        ],
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">functionArgs</span>,
</span></span><span style="display:flex;"><span>      };
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">__gas_fakes</span>(<span style="color:#a6e22e">obj</span>);
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>];
</span></span></code></pre></div><h2 id="configure-and-run-the-server">Configure and Run the Server</h2>
<p>Finally, configure the Gemini CLI to recognize your new MCP server.</p>
<h3 id="1-configure-gemini-cli">1. Configure Gemini CLI</h3>
<p>Create a <code>settings.json</code> file inside a <code>.gemini</code> directory within your project folder.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir .gemini
</span></span><span style="display:flex;"><span>cd .gemini
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;{&#34;security&#34;:{&#34;auth&#34;:{&#34;selectedType&#34;:&#34;gemini-api-key&#34;}},&#34;ui&#34;:{&#34;theme&#34;:&#34;Default&#34;},&#34;mcpServers&#34;:{&#34;sample&#34;:{&#34;command&#34;:&#34;node&#34;,&#34;args&#34;:[&#34;mcp-server.js&#34;]}}}&#39;</span> &gt; settings.json
</span></span><span style="display:flex;"><span>cd ..
</span></span></code></pre></div><p><strong>Note:</strong> If your Gemini CLI authorization method is not <code>gemini-api-key</code>, please update this file accordingly.</p>
<h3 id="2-launch-and-test">2. Launch and Test</h3>
<p>Start the Gemini CLI in your <code>sample</code> directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gemini
</span></span></code></pre></div><p>Once launched, list the available MCP servers to confirm yours is registered:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/mcp
</span></span></code></pre></div><p>You should see <code>sample-mcp-server</code> listed. If not, please review the previous steps for errors.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251029a/fig2.jpg" alt=""></p>
<h2 id="usage-examples">Usage Examples</h2>
<p>To test the tools, create a new Google Spreadsheet, add some sample data, and use its ID in the following prompts.</p>
<h3 id="1-get-sheet-names">1. Get Sheet Names</h3>
<p><strong>Prompt:</strong> (Replace <code>###</code> with your Spreadsheet ID)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Get sheet names from a Google Spreadsheet. Spreadsheet ID is `###`.
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20251029a/fig3.jpg" alt=""></p>
<h3 id="2-get-values-from-a-sheet">2. Get Values from a Sheet</h3>
<p><strong>Prompt:</strong> (Replace <code>###</code> with your Spreadsheet ID)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Get values from the &#34;Sheet1&#34; sheet. Spreadsheet ID is `###`.
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20251029a/fig4.jpg" alt=""></p>
<h3 id="3-put-values-into-a-sheet">3. Put Values into a Sheet</h3>
<p><strong>Prompt:</strong> (Replace <code>###</code> with your Spreadsheet ID)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Put values in the cell &#34;B2&#34; of the &#34;Sheet1&#34; sheet. Spreadsheet ID is `###`. Values are `[[&#34;sample1&#34;, &#34;sample2&#34;, &#34;sample3&#34;],[&#34;sample4&#34;, &#34;sample5&#34;, &#34;sample6&#34;]]`.
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20251029a/fig5.jpg" alt=""></p>
<h2 id="conclusion-and-future-outlook">Conclusion and Future Outlook</h2>
<p>This article demonstrates that a local MCP server can be successfully built using Google Apps Script, but this approach is broadly applicable to other local development scenarios. While the scripts here were created manually for clarity, this same methodology can be used to build Gemini CLI extensions, further automating the workflow.</p>
<p>The <code>gas-fakes</code> library is under active development. Although not all GAS classes and methods are available yet, the existing feature set is robust enough for creating and testing a wide range of Google Apps Scripts locally. As <code>gas-fakes</code> matures, it will become an increasingly indispensable tool for managing Google Workspace and developing powerful, AI-driven automations.</p>
<h2 id="summary">Summary</h2>
<ul>
<li><strong>Local Development:</strong> The <code>gas-fakes</code> library enables local execution of Google Apps Script, removing the need for cloud deployment during development and testing.</li>
<li><strong>Secure Sandbox:</strong> All local execution occurs within a secure sandbox, ensuring that scripts, including those generated by AI, run with limited and safe permissions.</li>
<li><strong>AI Tool Integration:</strong> You can build a local MCP server to create custom, AI-powered tools for models like Gemini to interact with Google Workspace.</li>
<li><strong>Step-by-Step Guide:</strong> The article provides a complete walkthrough for setting up a local server, from installing CLI tools to defining and running GAS-based tools.</li>
<li><strong>Streamlined Automation:</strong> This approach dramatically accelerates the development lifecycle for creating sophisticated, AI-driven automations for Google Sheets and other Workspace applications. dramatically accelerates the development lifecycle for creating sophisticated, AI-driven automations for Google Sheets and other Workspace applications.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2025%2f10%2f29%2fnext-level-google-apps-script-development%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2025%2f10%2f29%2fnext-level-google-apps-script-development%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f10%2f29%2fnext-level-google-apps-script-development%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2025%2f10%2f29%2fnext-level-google-apps-script-development%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f10%2f29%2fnext-level-google-apps-script-development%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f10%2f29%2fnext-level-google-apps-script-development%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2025/10/27/secure-and-streamlined-google-apps-script-development-with-gas-fakes-cli-and-gemini-cli-extension/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2025/10/27/secure-and-streamlined-google-apps-script-development-with-gas-fakes-cli-and-gemini-cli-extension/">Secure and Streamlined Google Apps Script Development with gas-fakes CLI and Gemini CLI Extension</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2025/10/30/bridging-the-gap-seamless-integration-for-local-google-apps-script-development/">Bridging the Gap: Seamless Integration for Local Google Apps Script Development</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2025/10/30/bridging-the-gap-seamless-integration-for-local-google-apps-script-development/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

