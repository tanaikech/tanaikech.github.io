<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="Official profile of Kanshi Tanaike, a Google Developer Expert (GDE) in Google Workspace and Physicist. Specializing in Google Apps Script, Gemini API, and innovative IT solutions.">
  <meta name="generator" content="Hugo 0.98.0" />

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tanaikech.github.io/img/og-main.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>tanaike - Google Apps Script, Gemini API Expert & Physicist</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Kanshi Tanaike",
  "alternateName": "tanaike",
  "url": "https://tanaikech.github.io/",
  "image": "https://tanaikech.github.io/img/og-main.png",
  "jobTitle": "Google Developer Expert",
  "honorificPrefix": "Ph.D.",
  "description": "Japanese scientist, Physicist and Google Developer Expert for Google Workspace.",
  "award": "First place in the Outstanding GDE Award 2025",
  "sameAs": [
    "https://twitter.com/tanaikech",
    "https://github.com/tanaikech",
    "https://stackoverflow.com/users/7108653/tanaike",
    "https://developers.google.com/community/experts/directory?text=tanaike",
    "https://zenn.dev/tanaike",
    "https://medium.com/@tanaike"
  ]
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2026. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Next-Generation Google Apps Script Development: Leveraging Antigravity and Gemini 3.0</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>21 Nov 2025, 15:20</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/model-context-protocol">Model Context Protocol</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/mcp">MCP</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/antigravity">Antigravity</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/886e334d639ae4da4f18fe59ef0db0f0">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20251121a/fig1.jpg" alt=""></p>
<h2 id="abstract">Abstract</h2>
<p>This article demonstrates a cutting-edge workflow for Google Apps Script development using Google Antigravity and Gemini 3.0. By integrating <code>gas-fakes</code> via the Model Context Protocol (MCP), we establish an environment where autonomous agents can generate, unit-test, and execute cloud-based scripts locally, revolutionizing the standard GAS development lifecycle.</p>
<h2 id="introduction">Introduction</h2>
<p>Google Antigravity has officially been released. <a href="https://antigravity.google/">Ref</a> This is a revolutionary &ldquo;Agent-first&rdquo; IDE powered by Gemini 3, designed to empower autonomous AI agents to plan, code, and verify tasks across the Editor, Terminal, and Browser. It is anticipated that this platform will trigger a paradigm shift in how we develop applications and auto-generate comprehensive documentation, moving the industry from simple code completion to fully agentic workflows.</p>
<p>I believe this technology brings a transformative evolution to the development of Google Apps Script (GAS) by finally bridging the gap between local AI agents and the GAS cloud runtime. I have previously published several articles on modernizing GAS development, specifically regarding secure local execution and sandboxing. <a href="https://medium.com/google-cloud/a-fake-sandbox-for-google-apps-script-a-feasibility-study-on-securely-executing-code-generated-by-cc985ce5dae3">Ref</a> and <a href="https://medium.com/google-cloud/modern-google-apps-script-workflow-building-on-the-cloud-2255dbd32ac3">Ref</a>.</p>
<p>In this article, as a practical test case, I introduce a next-generation development workflow where Google Antigravity&rsquo;s agents utilize the <a href="https://github.com/brucemcpherson/gas-fakes">gas-fakes</a> and <a href="https://github.com/google/clasp">clasp</a>. This combination allows the AI to autonomously generate, unit-test, and refactor GAS code in a local environment before deployment, solving the historical challenge of local GAS execution.</p>
<h2 id="environment-setup">Environment Setup</h2>
<p>To implement this workflow, we must first establish a communication bridge between the Antigravity IDE and the Google Apps Script runtime.</p>
<h3 id="1-install-google-antigravity">1. Install Google Antigravity</h3>
<p>Begin by setting up the IDE. Please check the official release and installation guide at <a href="https://antigravity.google/">https://antigravity.google/</a>.</p>
<h3 id="2-install-gas-fakes">2. Install gas-fakes</h3>
<p>We will use <code>gas-fakes</code> to emulate the GAS environment locally. Install the CLI tool via <code>npm</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm -g install @mcpher/gas-fakes
</span></span></code></pre></div><h3 id="3-authorize-access-to-google-services">3. Authorize Access to Google Services</h3>
<p>To allow <code>gas-fakes</code> to interact with your Google services (Drive, Sheets, etc.) for real-world testing, you must authorize the client.</p>
<p>First, create a <code>.env</code> file to store your project configuration. The tool will prompt you for the Project ID (which can be found in your GCP console).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes init
</span></span></code></pre></div><p>Next, run the authorization command. This will guide you through the OAuth flow to log into your Google account and grant the necessary permissions.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes auth
</span></span></code></pre></div><p>Finally, enable the required Google APIs for your project to ensure all necessary services are accessible.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes enableAPIs
</span></span></code></pre></div><p><strong>Verification:</strong></p>
<p>Once the setup is complete, run a simple test command to verify that <code>gas-fakes</code> is correctly configured. This command uses the tool&rsquo;s sandbox to execute a script that retrieves the name of the root folder in your Google Drive.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes -s <span style="color:#e6db74">&#34;const rootFolder = DriveApp.getRootFolder(); const rootFolderName = rootFolder.getName(); console.log(rootFolderName);&#34;</span>
</span></span></code></pre></div><p>If the command executes without errors and prints your root folder&rsquo;s name, your local environment is ready for development.</p>
<h3 id="4-install-clasp">4. Install Clasp</h3>
<p>Install <a href="https://github.com/google/clasp">Clasp</a>, the command-line tool for Google Apps Script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm install -g @google/clasp
</span></span></code></pre></div><p>Authorize Clasp by following the instructions in <a href="https://github.com/google/clasp?tab=readme-ov-file#authorization">the official GitHub repository</a>.</p>
<h2 id="integration-model-context-protocol-mcp">Integration: Model Context Protocol (MCP)</h2>
<p>The core of this workflow is the <strong>Model Context Protocol (MCP)</strong>. The <code>gas-fakes</code> and <code>clasp</code> CLI functions as an MCP server, allowing the Gemini 3 agents within Antigravity to execute tools and scripts directly. The official documentation for installing MCP servers can be viewed <a href="https://antigravity.google/docs/mcp">here</a>.</p>
<p>For this integration, the MCP server must be manually configured. Open a file named <code>mcp_config.json</code> and paste the following configuration:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;mcpServers&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;gas-fakes&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;command&#34;</span>: <span style="color:#e6db74">&#34;gas-fakes&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;args&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mcp&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;disabled&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;disabledTools&#34;</span>: []
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;clasp&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;command&#34;</span>: <span style="color:#e6db74">&#34;clasp&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;args&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mcp&#34;</span>
</span></span><span style="display:flex;"><span>      ]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>After saving the file, refresh the MCP server list in Antigravity. When installed correctly, the <code>gas-fakes</code> and <code>clasp</code> tools will become visible to the AI agent, as shown below:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251121a/fig2.jpg" alt=""></p>
<h2 id="practical-demonstration">Practical Demonstration</h2>
<p>With the environment configured, we can now task the Gemini 3 agent with creating and testing Google Apps Scripts. The agent plans the execution, writes the code, and uses the <code>gas-fakes</code> tool to verify the output.</p>
<h3 id="sample-1-document-creation">Sample 1: Document Creation</h3>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Create and run a Google Apps Script that generates a new Google Document named &#34;temp document&#34; containing the paragraph text &#34;sample&#34;.
</span></span></code></pre></div><p><strong>Result:</strong>
The agent successfully calls <code>DocumentApp</code> through the local bridge.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251121a/fig3.gif" alt=""></p>
<p>The generated script is as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">createDoc</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">doc</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DocumentApp</span>.<span style="color:#a6e22e">create</span>(<span style="color:#e6db74">&#34;temp document&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">body</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">doc</span>.<span style="color:#a6e22e">getBody</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">appendParagraph</span>(<span style="color:#e6db74">&#34;sample&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Document created: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">doc</span>.<span style="color:#a6e22e">getId</span>());
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">createDoc</span>();
</span></span></code></pre></div><h3 id="sample-2-spreadsheet-manipulation">Sample 2: Spreadsheet Manipulation</h3>
<p>This example tests the agent&rsquo;s ability to retrieve mathematical outputs from Google Sheets created in the script.</p>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Create a new Google Spreadsheet by putting a formula `=GOOGLEFINANCE(&#34;CURRENCY:USDJPY&#34;)` in cell &#34;A1&#34; of the first sheet. Then, get and show the value of cell &#34;A1&#34;. (Note: `gas-fakes` has no `getActiveSheet()` method. In this case, use `getSheets()[0]`.)
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20251121a/fig4.gif" alt=""></p>
<p><strong>Implementation Plan:</strong></p>
<p>The Antigravity agent analyzes the request and produces the following plan:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># Create and Read Google Spreadsheet
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>## Goal Description
</span></span><span style="display:flex;"><span>Create a new Google Spreadsheet, set the formula `=GOOGLEFINANCE(&#34;CURRENCY:USDJPY&#34;)` in cell A1, and retrieve the value of that cell using the `gas-fakes` MCP server.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>## Proposed Changes
</span></span><span style="display:flex;"><span>### Script Generation
</span></span><span style="display:flex;"><span>#### [NEW] [create_sheet.js](file:///temp/workspace/create_sheet.js)
</span></span><span style="display:flex;"><span>- Create a script that:
</span></span><span style="display:flex;"><span>    - Creates a new spreadsheet using `SpreadsheetApp.create()`.
</span></span><span style="display:flex;"><span>    - Gets the first sheet using `getSheets()[0]` (as `getActiveSheet()` is unavailable).
</span></span><span style="display:flex;"><span>    - Sets the formula in A1.
</span></span><span style="display:flex;"><span>    - Flushes the spreadsheet.
</span></span><span style="display:flex;"><span>    - Gets and logs the value of A1.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>## Verification Plan
</span></span><span style="display:flex;"><span>### Automated Tests
</span></span><span style="display:flex;"><span>- Run the script using `mcp0_run-gas-by-gas-fakes`.
</span></span><span style="display:flex;"><span>- Check the output for the logged value.
</span></span></code></pre></div><p><strong>Walkthrough:</strong></p>
<p>The agent executes the plan and confirms the results.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># Walkthrough - Create and Read Google Spreadsheet
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>I have successfully created a Google Spreadsheet, set a currency conversion formula, and retrieved the value using `gas-fakes`.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>## Execution Results
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The script [create_sheet.js](file:///temp/workspace/create_sheet.js) was executed.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>```javascript
</span></span><span style="display:flex;"><span>function createAndReadSheet() {
</span></span><span style="display:flex;"><span>  var ss = SpreadsheetApp.create(&#34;CurrencySheet&#34;);
</span></span><span style="display:flex;"><span>  var sheet = ss.getSheets()[0];
</span></span><span style="display:flex;"><span>  var cell = sheet.getRange(&#34;A1&#34;);
</span></span><span style="display:flex;"><span>  cell.setFormula(&#39;=GOOGLEFINANCE(&#34;CURRENCY:USDJPY&#34;)&#39;);
</span></span><span style="display:flex;"><span>  SpreadsheetApp.flush();
</span></span><span style="display:flex;"><span>  var value = cell.getValue();
</span></span><span style="display:flex;"><span>  console.log(&#34;Value in A1: &#34; + value);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>```
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>### Output
</span></span><span style="display:flex;"><span>The script outputted the following value for USD/JPY:
</span></span><span style="display:flex;"><span>```
</span></span><span style="display:flex;"><span>Value in A1: 157.21
</span></span><span style="display:flex;"><span>```
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>## Verification
</span></span><span style="display:flex;"><span>The value `157.21` confirms that:
</span></span><span style="display:flex;"><span>1.  The spreadsheet was created.
</span></span><span style="display:flex;"><span>2.  The formula `=GOOGLEFINANCE(&#34;CURRENCY:USDJPY&#34;)` was set and calculated.
</span></span><span style="display:flex;"><span>3.  The value was correctly retrieved and logged.
</span></span></code></pre></div><h3 id="sample-3-push-google-apps-script-to-google-drive">Sample 3: Push Google Apps Script to Google Drive</h3>
<p>This example tests the agentâ€™s ability to push the generated Google Apps Script to Google Drive.</p>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Create a new Google Apps Script project in Google Drive and push the script `create_doc.js`.
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20251121a/fig5.gif" alt=""></p>
<p><strong>Implementation Plan:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># Create GAS Project and Push Script
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>## Goal Description
</span></span><span style="display:flex;"><span>Create a new Google Apps Script project in the current directory and push the existing [create_doc.js](file:///temp/workspace/create_doc.js) file to it.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>## Proposed Changes
</span></span><span style="display:flex;"><span>### Google Apps Script Project
</span></span><span style="display:flex;"><span>#### [NEW] [.clasp.json](file:///temp/workspace/.clasp.json)
</span></span><span style="display:flex;"><span>- Created automatically by `clasp create`.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#### [MODIFY] [create_doc.js](file:///temp/workspace/create_doc.js)
</span></span><span style="display:flex;"><span>- Will be pushed to the GAS project.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>## Verification Plan
</span></span><span style="display:flex;"><span>### Automated Tests
</span></span><span style="display:flex;"><span>- Use `mcp0_list_projects` to verify the project exists.
</span></span><span style="display:flex;"><span>- Use `mcp0_pull_files` to verify the file was pushed (optional, or just trust push output).
</span></span></code></pre></div><p><strong>Walkthrough:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># Walkthrough - Create GAS Project and Push Script
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>I have successfully created a new Google Apps Script project and pushed the [create_doc.js](file:///temp/workspace/create_doc.js) script to it.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>## Changes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>### Google Apps Script Project
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#### [NEW] [.clasp.json](file:///temp/workspace/.clasp.json)
</span></span><span style="display:flex;"><span>- Created automatically by `clasp create`.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#### [MODIFY] [create_doc.js](file:///temp/workspace/create_doc.js)
</span></span><span style="display:flex;"><span>- Pushed to the GAS project.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>## Verification Results
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>### Automated Tests
</span></span><span style="display:flex;"><span>- Verified that the project `create_doc_project` exists using `clasp list`.
</span></span><span style="display:flex;"><span>- Verified that [create_doc.js](file:///temp/workspace/create_doc.js) was pushed using the output of `clasp push`.
</span></span></code></pre></div><h2 id="summary">Summary</h2>
<p>This article presented a paradigm shift in Google Apps Script (GAS) development by combining the &ldquo;Agent-first&rdquo; capabilities of <strong>Google Antigravity</strong> (powered by <strong>Gemini 3.0</strong>) with the local emulation power of <strong>gas-fakes</strong>.</p>
<p>Key takeaways from this next-generation workflow include:</p>
<ul>
<li><strong>The MCP Bridge:</strong> By utilizing the <strong>Model Context Protocol (MCP)</strong>, we successfully transformed the <code>gas-fakes</code> CLI and <code>clasp</code> into accessible tools for the IDE&rsquo;s AI agents. This creates a seamless bridge between the local development environment and the GAS cloud runtime.</li>
<li><strong>Autonomous Lifecycle Management:</strong> We demonstrated that Gemini 3.0 agents can autonomously handle the entire development lifecycle:
<ul>
<li><strong>Planning:</strong> Analyzing requirements to create implementation strategies.</li>
<li><strong>Coding &amp; Testing:</strong> Writing scripts and verifying logic locally (e.g., handling spreadsheet formulas) without needing to deploy to the cloud first.</li>
<li><strong>Deployment:</strong> Utilizing <code>clasp</code> to push verified code to production environments.</li>
</ul>
</li>
<li><strong>Self-Healing Workflows:</strong> The workflow allows agents to identify environment limitations (such as the absence of <code>getActiveSheet()</code> in the local emulator) and autonomously refactor code to ensure successful execution.</li>
</ul>
<p>By moving from simple code completion to fully agentic verification and deployment, developers can significantly reduce context switching and accelerate the delivery of robust Google Apps Script solutions.</p>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2025%2f11%2f21%2fnext-generation-google-apps-script-development-leveraging-antigravity-and-gemini-3.0%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2025%2f11%2f21%2fnext-generation-google-apps-script-development-leveraging-antigravity-and-gemini-3.0%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f11%2f21%2fnext-generation-google-apps-script-development-leveraging-antigravity-and-gemini-3.0%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2025%2f11%2f21%2fnext-generation-google-apps-script-development-leveraging-antigravity-and-gemini-3.0%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f11%2f21%2fnext-generation-google-apps-script-development-leveraging-antigravity-and-gemini-3.0%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f11%2f21%2fnext-generation-google-apps-script-development-leveraging-antigravity-and-gemini-3.0%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2025/11/20/gas-library-tableapp/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2025/11/20/gas-library-tableapp/">GAS Library - TableApp</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2025/11/22/agentic-automation-in-google-workspace-bridging-antigravity-and-gemini-3.0/">Agentic Automation in Google Workspace: Bridging Antigravity and Gemini 3.0</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2025/11/22/agentic-automation-in-google-workspace-bridging-antigravity-and-gemini-3.0/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

