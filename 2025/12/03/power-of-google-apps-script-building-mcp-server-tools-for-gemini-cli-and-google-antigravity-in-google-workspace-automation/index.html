<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Power of Google Apps Script: Building MCP Server Tools for Gemini CLI and Google Antigravity in Google Workspace Automation &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Power of Google Apps Script: Building MCP Server Tools for Gemini CLI and Google Antigravity in Google Workspace Automation</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>03 Dec 2025, 14:37</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/model-context-protocol">Model Context Protocol</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/mcp">MCP</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/antigravity">Antigravity</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/e7ddfd23e51c0c4fd0278f873f46d752">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig1.jpg" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>This article demonstrates how to build Model Context Protocol (MCP) tools directly using Google Apps Script. By leveraging the <code>gas-fakes</code> CLI, developers can execute Google Apps Script locally to automate Google Workspace via Gemini CLI and Google Antigravity, streamlining development and eliminating the overhead of dynamic tool creation.</p>
<h1 id="introduction">Introduction</h1>
<p>With the rapid advancement of generative AI, ensuring the security of executing AI-generated scripts is of paramount importance to prevent arbitrary code execution vulnerabilities. Addressing this, I previously published a secure sandbox environment for Google Apps Script (GAS) known as <code>gas-fakes</code>, which emulates the Apps Script environment locally. <a href="https://medium.com/google-cloud/a-fake-sandbox-for-google-apps-script-a-feasibility-study-on-securely-executing-code-generated-by-cc985ce5dae3">Ref</a></p>
<p>Building on this, I leveraged the Model Context Protocol (MCP) to conduct a proof-of-concept demonstrating the dynamic creation of MCP server tools using Google Apps Script. <a href="https://medium.com/google-cloud/dynamic-tool-creation-for-google-workspace-automation-with-gemini-cli-f9618166aaed">Ref</a> This study confirmed that MCP tools developed via GAS provide a seamless bridge to Google Workspace automation. However, the initial implementation faced several architectural limitations:</p>
<ul>
<li><strong>Directory Dependency:</strong> The <code>gas-fakes</code> library was strictly required to be installed in a specific directory.</li>
<li><strong>Boilerplate Overhead:</strong> Creating tools necessitated the manual inclusion of specific headers and footers to invoke <code>gas-fakes</code>.</li>
<li><strong>Rigid Deployment:</strong> The directory structure was fixed, reducing portability.</li>
</ul>
<p>To overcome these constraints, we developed the <strong><code>gas-fakes</code> CLI</strong>. This evolution allows Google Apps Script code to be executed securely from any location in the file system. It also streamlines OAuth scope management, allowing authorization directly via the command line. We subsequently released this integration as a Gemini CLI Extension. <a href="https://medium.com/google-cloud/modern-google-apps-script-workflow-building-on-the-cloud-2255dbd32ac3">Ref</a></p>
<p><strong>The Significance of Direct Execution</strong></p>
<p>It is highly significant that we can now create tools for MCP servers <em>directly</em> in Google Apps Script and run them locally. This approach synergizes the portable flexibility of the <code>gas-fakes</code> CLI with the architecture of MCP servers. Rather than relying on complex dynamic wrappers, developers can write standard GAS code that the MCP server utilizes to automate Google Workspace.</p>
<p>This article presents an advanced methodology for this direct tool creation, leveraging <code>gas-fakes</code> CLI atop the Gemini CLI and the Google Antigravity framework.</p>
<h1 id="prerequisites-and-installation">Prerequisites and Installation</h1>
<h2 id="1-install-gemini-cli">1. Install Gemini CLI</h2>
<p>First, install the <a href="https://github.com/google-gemini/gemini-cli">Gemini CLI</a> using npm:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm install -g @google/gemini-cli
</span></span></code></pre></div><p>Next, authorize the CLI by following the instructions in the <a href="https://github.com/google-gemini/gemini-cli?tab=readme-ov-file#-authentication-options">official documentation</a>.
<em>Note: In this article, the <a href="https://github.com/tanaikech/gas-development-kit-extension">Gemini CLI Extension for GAS Development Kit</a> is not used.</em></p>
<h2 id="2-install-google-antigravity">2. Install Google Antigravity</h2>
<p>Please check the official release and installation guide at <a href="https://antigravity.google/">https://antigravity.google/</a>.</p>
<h2 id="3-install-gas-fakes-cli">3. Install gas-fakes CLI</h2>
<p>We will use <code>gas-fakes</code> to emulate the GAS environment locally. Install the CLI tool via <code>npm</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm -g install @mcpher/gas-fakes
</span></span></code></pre></div><h2 id="4-authorize-access-to-google-services">4. Authorize Access to Google Services</h2>
<p>To allow <code>gas-fakes</code> to interact with your Google services (Drive, Sheets, etc.) for real-world testing, you must authorize the client.</p>
<p>First, create a <code>.env</code> file to store your project configuration. The tool will prompt you for the Project ID (found in your GCP console).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes init
</span></span></code></pre></div><p>Next, run the authorization command. This guides you through the OAuth flow to grant necessary permissions.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes auth
</span></span></code></pre></div><p>Finally, enable the required Google APIs for your project.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes enableAPIs
</span></span></code></pre></div><p><strong>Verification:</strong>
Run a simple test command to verify configuration. This executes a script in the sandbox to retrieve the root folder name of your Google Drive.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes -s <span style="color:#e6db74">&#34;const rootFolder = DriveApp.getRootFolder(); const rootFolderName = rootFolder.getName(); console.log(rootFolderName);&#34;</span>
</span></span></code></pre></div><p>If the command prints your root folder&rsquo;s name without errors, your local environment is ready.</p>
<h1 id="part-1-integration-with-gemini-cli">Part 1: Integration with Gemini CLI</h1>
<p>Add <code>mcpServers</code> to the setting file <code>.gemini/settings.json</code> as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;mcpServers&#34;</span><span style="color:#960050;background-color:#1e0010">:</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;gas-fakes&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;command&#34;</span>: <span style="color:#e6db74">&#34;gas-fakes&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;args&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mcp&#34;</span>
</span></span><span style="display:flex;"><span>      ]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>Launch Gemini CLI. If the <code>gas-fakes</code> CLI is correctly installed, you will see the <code>gas-fakes</code> MCP server tools available.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig2.jpg" alt=""></p>
<h2 id="sample-1-drive-search-tool">Sample 1: Drive Search Tool</h2>
<p>We will create a tool to search files on Google Drive using a filename.</p>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Create a tool of MCP server for search files on Google Drive using a filename with Google Apps Script.
</span></span></code></pre></div><p><strong>Follow-up Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Update settings.json
</span></span></code></pre></div><p>The actual execution flow is shown below:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig3a.jpg" alt=""></p>
<p><strong>Important:</strong> After <code>settings.json</code> is updated, <strong>please exit and reopen the Gemini CLI.</strong> The MCP server might require a restart to refresh requires a restart. Upon reopening and typing <code>/mcp</code>, the new tool appears:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig3b.jpg" alt=""></p>
<p>The following script is generated as <code>googleDriveSearchTool.js</code> in the current directory. Note that the function body is pure Google Apps Script.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">z</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;zod&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tools</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;searchGoogleDriveFiles&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">schema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Use this to search files by a filename on Google Drive.&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">inputSchema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">filename</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">string</span>().<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;Filename of the search file.&#34;</span>),
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">func</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {}) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">filename</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">files</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFilesByName</span>(<span style="color:#a6e22e">filename</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ar</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">hasNext</span>()) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">next</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">push</span>({ <span style="color:#a6e22e">filename</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getName</span>(), <span style="color:#a6e22e">fileId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getId</span>() });
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ar</span>;
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>];
</span></span></code></pre></div><p><strong>Testing the Tool:</strong></p>
<p><strong>Prompt:</strong> (Replace &ldquo;test spreadsheet&rdquo; with an actual file in your Drive)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Search a file &#34;test spreadsheet&#34; on Google Drive.
</span></span></code></pre></div><p>Result:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig3c.jpg" alt=""></p>
<p>The key takeaway is that the tool script resides in the current working directory and is executed locally.</p>
<h2 id="sample-2-spreadsheet-readwrite-tools">Sample 2: Spreadsheet Read/Write Tools</h2>
<p>Let&rsquo;s create tools for getting and putting values in Google Sheets.</p>
<p><em>Preparation: Create a new Google Spreadsheet, copy its ID, and add sample values to the first sheet as shown:</em></p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig4a.jpg" alt=""></p>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Create two distinct **Google Apps Script functions** that serve as server-side tools for the **MCP system**, focused on reading and writing data in a Google Spreadsheet.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>1.  **Read Function Specification:**
</span></span><span style="display:flex;"><span>    * **Name:** `getSpreadsheetData` (or similar)
</span></span><span style="display:flex;"><span>    * **Purpose:** To retrieve all values from a specified cell range.
</span></span><span style="display:flex;"><span>    * **Parameters:**
</span></span><span style="display:flex;"><span>        * `spreadsheetId` (String): The ID of the target Google Sheet.
</span></span><span style="display:flex;"><span>        * `a1Notation` (String): The A1 cell range (e.g., &#34;Sheet1!A1:B10&#34;).
</span></span><span style="display:flex;"><span>    * **Return:** A two-dimensional **Array of Arrays** (`[[value1, value2], [value3, value4]]`) containing the cell data.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>2.  **Write Function Specification:**
</span></span><span style="display:flex;"><span>    * **Name:** `setSpreadsheetData` (or similar)
</span></span><span style="display:flex;"><span>    * **Purpose:** To write a provided array of data into a specified cell range.
</span></span><span style="display:flex;"><span>    * **Parameters:**
</span></span><span style="display:flex;"><span>        * `spreadsheetId` (String): The ID of the target Google Sheet.
</span></span><span style="display:flex;"><span>        * `a1Notation` (String): The A1 cell range of the upper left cell. Use the whole cell range calculated from the provided values and the A1Notation in the script.
</span></span><span style="display:flex;"><span>        * `values` (Array of Arrays): The data to be written (must be in `[[value1, value2], ...]` format).
</span></span><span style="display:flex;"><span>    * **Return:** A confirmation object or string indicating success.
</span></span></code></pre></div><p><strong>Follow-up Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Update settings.json
</span></span></code></pre></div><p>Execution flow:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig4b.jpg" alt=""></p>
<p>After restarting Gemini CLI, two new tools are visible:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig4c.jpg" alt=""></p>
<p>The generated file <code>spreadsheetTools.js</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">z</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;zod&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tools</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;getSpreadsheetData&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">schema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Retrieves all values from a specified cell range in a Google Spreadsheet.&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">inputSchema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">spreadsheetId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;The ID of the target Google Sheet.&#34;</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">a1Notation</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;The A1 cell range (e.g., &#39;Sheet1!A1:B10&#39;).&#34;</span>),
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">func</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {}) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">a1Notation</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">spreadsheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">a1Notation</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getValues</span>();
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;setSpreadsheetData&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">schema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Writes a provided array of data into a specified cell range in a Google Spreadsheet.&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">inputSchema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">spreadsheetId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;The ID of the target Google Sheet.&#34;</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">a1Notation</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;The A1 cell range for the upper left cell where data writing should begin (e.g., &#39;Sheet1!A1&#39;).&#34;</span>
</span></span><span style="display:flex;"><span>          ),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">values</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">array</span>(<span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">array</span>(<span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">any</span>()))
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;The data to be written as a two-dimensional array (e.g., [[value1, value2], [value3, value4]]).&#34;</span>
</span></span><span style="display:flex;"><span>          ),
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">func</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {}) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">a1Notation</span>, <span style="color:#a6e22e">values</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">spreadsheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">a1Notation</span>).<span style="color:#a6e22e">getSheet</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Calculate the target range based on the top-left cell and the dimensions of the values array
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">startRow</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">spreadsheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">a1Notation</span>).<span style="color:#a6e22e">getRow</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">startColumn</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">spreadsheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">a1Notation</span>).<span style="color:#a6e22e">getColumn</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">numRows</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">numColumns</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">?</span> <span style="color:#a6e22e">values</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">length</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">numRows</span> <span style="color:#f92672">===</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">numColumns</span> <span style="color:#f92672">===</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> { <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;error&#34;</span>, <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;No values provided to write.&#34;</span> };
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">targetRange</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getRange</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">startRow</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">startColumn</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">numRows</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">numColumns</span>
</span></span><span style="display:flex;"><span>      );
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">targetRange</span>.<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">values</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;success&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Data successfully written to spreadsheet.&#34;</span>,
</span></span><span style="display:flex;"><span>      };
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>];
</span></span></code></pre></div><p><strong>Testing:</strong></p>
<ol>
<li><strong>Reading Data:</strong></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Get cell values from `&#39;Sheet1&#39;!A1:E5` of Google Spreadsheet (ID is `###`).
</span></span></code></pre></div><p>Result:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig4d.jpg" alt=""></p>
<ol start="2">
<li><strong>Writing Data:</strong></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Put values `[[&#34;sample1&#34;,&#34;sample2&#34;],[&#34;sample3&#34;,&#34;sample4&#34;],[&#34;sample5&#34;,&#34;sample6&#34;],[&#34;sample7&#34;,&#34;sample7&#34;]]` to the cell `&#39;Sheet1&#39;!A1` of Google Spreadsheet (ID is `###`).
</span></span></code></pre></div><p>Result:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig4e.jpg" alt=""></p>
<p>The spreadsheet is updated successfully:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig4f.jpg" alt=""></p>
<h1 id="part-2-integration-with-google-antigravity">Part 2: Integration with Google Antigravity</h1>
<p>Add <code>mcpServers</code> to the configuration file located at <code>/home/{user_name}/.gemini/antigravity/mcp_config.json</code>. This can also be accessed via &ldquo;Manage MCPs&rdquo; in Antigravity.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;mcpServers&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;gas-fakes&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;command&#34;</span>: <span style="color:#e6db74">&#34;gas-fakes&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;args&#34;</span>: [<span style="color:#e6db74">&#34;mcp&#34;</span>]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Once configured, the tools appear in the interface:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig5a.jpg" alt=""></p>
<h2 id="sample-1-drive-search-tool-1">Sample 1: Drive Search Tool</h2>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Create a tool of the MCP server for searching files on Google Drive using a filename with Google Apps Script. Create the script of the tool in the current working directory.
</span></span></code></pre></div><p><strong>Follow-up Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Install the created tool to the MCP server.
</span></span></code></pre></div><p>The tool creation process:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig5b.jpg" alt=""></p>
<p>Update <code>/home/{user_name}/.gemini/antigravity/mcp_config.json</code> to include the new tool file. After refreshing the MCP servers, the new tool is added:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig5c.jpg" alt=""></p>
<p>Generated script <code>drive_search_tool.js</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">z</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;zod&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tools</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;search_drive_files&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">schema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Search for files on Google Drive by filename.&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">inputSchema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">filename</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">string</span>().<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;The name of the file to search for.&#34;</span>),
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">func</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {}) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">filename</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">files</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFilesByName</span>(<span style="color:#a6e22e">filename</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">hasNext</span>()) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">next</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">push</span>({
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getName</span>(),
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">id</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getId</span>(),
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">url</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getUrl</span>(),
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">mimeType</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getMimeType</span>(),
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">result</span>;
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>];
</span></span></code></pre></div><p><strong>Testing:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Search a file &#34;test spreadsheet&#34; on Google Drive.
</span></span></code></pre></div><p>Result:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig5d.jpg" alt=""></p>
<h2 id="sample-2-adding-spreadsheet-capability">Sample 2: Adding Spreadsheet Capability</h2>
<p>We will add the read/write logic to the existing <code>drive_search_tool.js</code>.</p>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Add the following 2 tools to the existing tool file `drive_search_tool.js` for the MCP server, focused on reading and writing data in a Google Spreadsheet.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>... (Same specifications as Sample 2 in Gemini CLI section) ...
</span></span></code></pre></div><p>Antigravity execution:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig5e.jpg" alt=""></p>
<p>The updated <code>drive_search_tool.js</code> now contains three tools (Search, Get, Set). After refreshing, they are available:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig5f.jpg" alt=""></p>
<p><strong>Testing:</strong></p>
<ol>
<li><strong>Get Values:</strong></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Get cell values from `&#39;Sheet1&#39;!A1:E5` of Google Spreadsheet (ID is `###`).
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20251203a/fig5g.jpg" alt=""></p>
<ol start="2">
<li><strong>Put Values:</strong></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Put values `[[&#34;sample1&#34;,&#34;sample2&#34;],[&#34;sample3&#34;,&#34;sample4&#34;],[&#34;sample5&#34;,&#34;sample6&#34;],[&#34;sample7&#34;,&#34;sample7&#34;]]` to the cell `&#39;Sheet1&#39;!A1` of Google Spreadsheet (ID is `###`).
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20251203a/fig5h.jpg" alt=""></p>
<h2 id="sample-3-advanced-usage-with-libraries">Sample 3: Advanced Usage with Libraries</h2>
<p>We can also incorporate complex logic, such as the <a href="https://github.com/tanaikech/TableApp">TableApp</a> library (a GAS library for managing tables). The script logic is embedded directly into the MCP tool. <a href="https://gist.github.com/tanaikech/e4b5068e8d16e0192a08885a20b7caf1">See my Gist for full code</a>.</p>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Create a new table in a Google Spreadsheet. Spreadsheet ID, sheet name, range, and table name are `###`, `Sheet1`, `A1:E5`, and `sampleTable`, respectively.
</span></span></code></pre></div><p>Result:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig6a.jpg" alt=""></p>
<p>A new table is successfully created on the sheet:</p>
<p><img src="https://tanaikech.github.io/image-storage/20251203a/fig6b.jpg" alt=""></p>
<p>This demonstrates that even complex Google Apps Script logic can be effectively utilized within this local MCP architecture.</p>
<h1 id="summary">Summary</h1>
<p>The integration of <code>gas-fakes</code> CLI with MCP servers represents a significant leap forward in Google Workspace automation. By enabling the direct execution of Google Apps Script locally, we bridge the gap between AI agents and cloud data.</p>
<ul>
<li><strong>Direct Execution Power:</strong> Developers can write and execute Google Apps Script directly on their local machine to serve as MCP tools, eliminating the need for cloud-based deployment or dynamic wrapper overhead.</li>
<li><strong>Enhanced Portability:</strong> The <code>gas-fakes</code> CLI removes directory dependencies, allowing tools to be created and managed in any workspace location.</li>
<li><strong>Seamless Gemini CLI Integration:</strong> Users can dynamically generate, configure, and execute GAS-based MCP tools entirely within the Gemini CLI environment.</li>
<li><strong>Antigravity Compatibility:</strong> The same tools work natively within Google Antigravity, expanding the ecosystem for local AI agents.</li>
<li><strong>Scalability for Complexity:</strong> As demonstrated with the TableApp library, this architecture supports not just simple API calls but complex, logic-heavy scripts for sophisticated automation tasks.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f03%2fpower-of-google-apps-script-building-mcp-server-tools-for-gemini-cli-and-google-antigravity-in-google-workspace-automation%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f03%2fpower-of-google-apps-script-building-mcp-server-tools-for-gemini-cli-and-google-antigravity-in-google-workspace-automation%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f03%2fpower-of-google-apps-script-building-mcp-server-tools-for-gemini-cli-and-google-antigravity-in-google-workspace-automation%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f03%2fpower-of-google-apps-script-building-mcp-server-tools-for-gemini-cli-and-google-antigravity-in-google-workspace-automation%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f03%2fpower-of-google-apps-script-building-mcp-server-tools-for-gemini-cli-and-google-antigravity-in-google-workspace-automation%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f03%2fpower-of-google-apps-script-building-mcp-server-tools-for-gemini-cli-and-google-antigravity-in-google-workspace-automation%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2025/12/01/a-new-era-for-google-apps-script-unlocking-the-future-of-google-workspace-automation-with-natural-language/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2025/12/01/a-new-era-for-google-apps-script-unlocking-the-future-of-google-workspace-automation-with-natural-language/">A New Era for Google Apps Script: Unlocking the Future of Google Workspace Automation with Natural Language</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2025/12/11/modularizing-ai-agents-integrating-google-apps-script-libraries-with-gemini-cli-and-antigravity/">Modularizing AI Agents: Integrating Google Apps Script Libraries with Gemini CLI and Antigravity</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2025/12/11/modularizing-ai-agents-integrating-google-apps-script-libraries-with-gemini-cli-and-antigravity/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

