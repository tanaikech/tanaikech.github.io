<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Modularizing AI Agents: Integrating Google Apps Script Libraries with Gemini CLI and Antigravity &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fab fa-medium fa-fw"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Modularizing AI Agents: Integrating Google Apps Script Libraries with Gemini CLI and Antigravity</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>11 Dec 2025, 13:39</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/model-context-protocol">Model Context Protocol</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/mcp">MCP</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/antigravity">Antigravity</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/fb1526466e4b53d1f00981d4536659b8">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20251211a/fig1.jpg" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>This article introduces a major update to <code>gas-fakes</code> enabling dynamic loading of Google Apps Script libraries. This enhancement allows developers to build modular, maintainable Model Context Protocol (MCP) servers. We demonstrate this by integrating sophisticated library-based tools with Gemini CLI and Google Antigravity for seamless Google Workspace automation.</p>
<h1 id="introduction">Introduction</h1>
<p>I recently published an article titled &ldquo;<a href="https://medium.com/google-cloud/power-of-google-apps-script-building-mcp-server-tools-for-gemini-cli-and-google-antigravity-in-71e754e4b740">Power of Google Apps Script: Building MCP Server Tools for Gemini CLI and Google Antigravity in Google Workspace Automation</a>.&rdquo; In that piece, I demonstrated how to bridge the Model Context Protocol (MCP) with Google Workspace by implementing an MCP server using Google Apps Script (GAS) and <code>gas-fakes</code>. This successfully established a communication channel for sophisticated AI agents—such as the Gemini CLI and Google Antigravity—to interact directly with Workspace data.</p>
<p>However, the initial implementation faced a significant technical hurdle regarding dependency management. As noted in my <a href="https://gist.github.com/tanaikech/e4b5068e8d16e0192a08885a20b7caf1">previous findings</a>, <code>gas-fakes</code> could not dynamically load external GAS libraries at the time. This forced developers to manually inject library source code directly into the main script to ensure execution compatibility. This monolithic approach resulted in high maintenance overhead and reduced code readability, severely limiting the complexity of tools that could be deployed efficiently. This restriction was a major obstacle to achieving true modularization in AI-driven automation.</p>
<p>To overcome this architectural limitation and enable truly <strong>Modularizing AI</strong> solutions, I have implemented a native function within <code>gas-fakes</code> to support the direct utilization of Google Apps Script libraries. This major enhancement mimics the GAS runtime environment more accurately, allowing developers to maintain modular codebases. It is now possible to execute complex scripts that rely on external libraries without the need for manual code bundling.</p>
<p>In this article, I will introduce practical examples of scripts that leverage this new functionality. We will explore how to build sophisticated and maintainable MCP tools that seamlessly integrate standard GAS libraries, significantly expanding the automation capabilities available to AI agents. The robust, modular MCP server demonstrated below was successfully tested using the Gemini CLI and Google Antigravity.</p>
<h1 id="prerequisites-and-installation">Prerequisites and Installation</h1>
<h2 id="1-install-gemini-cli">1. Install Gemini CLI</h2>
<p>First, install the <a href="https://github.com/google-gemini/gemini-cli">Gemini CLI</a> using npm:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm install -g @google/gemini-cli
</span></span></code></pre></div><p>Next, authorize the CLI by following the instructions in the <a href="https://github.com/google-gemini/gemini-cli?tab=readme-ov-file#-authentication-options">official documentation</a>.
<em>Note: In this article, the <a href="https://github.com/tanaikech/gas-development-kit-extension">Gemini CLI Extension for GAS Development Kit</a> is not used.</em></p>
<h2 id="2-install-google-antigravity">2. Install Google Antigravity</h2>
<p>Please check the official release and installation guide at <a href="https://antigravity.google/">https://antigravity.google/</a>.</p>
<h2 id="3-install-gas-fakes-cli">3. Install gas-fakes CLI</h2>
<p>We will use <a href="https://github.com/brucemcpherson/gas-fakes"><code>gas-fakes</code></a> to emulate the GAS environment locally. Install the CLI tool via <code>npm</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm -g install @mcpher/gas-fakes
</span></span></code></pre></div><h2 id="4-authorize-access-to-google-services">4. Authorize Access to Google Services</h2>
<p>To allow <code>gas-fakes</code> to interact with your Google services (Drive, Sheets, etc.) for real-world testing, you must authorize the client.</p>
<p>First, create a <code>.env</code> file to store your project configuration. The tool will prompt you for the Project ID (found in your GCP console).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes init
</span></span></code></pre></div><p>Next, run the authorization command. This guides you through the OAuth flow to grant necessary permissions.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes auth
</span></span></code></pre></div><p>Finally, enable the required Google APIs for your project.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes enableAPIs
</span></span></code></pre></div><p><strong>Verification:</strong>
Run a simple test command to verify configuration. This executes a script in the sandbox to retrieve the root folder name of your Google Drive.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes -s <span style="color:#e6db74">&#34;const rootFolder = DriveApp.getRootFolder(); const rootFolderName = rootFolder.getName(); console.log(rootFolderName);&#34;</span>
</span></span></code></pre></div><p>If the command prints your root folder&rsquo;s name without errors, your local environment is ready.</p>
<h1 id="basic-verification-using-libraries-in-gas-fakes">Basic Verification: Using Libraries in gas-fakes</h1>
<p>Before building the MCP server, let&rsquo;s verify that <code>gas-fakes</code> can correctly load and execute a library.</p>
<p><strong>1. Create a library file</strong></p>
<p>Create a sample library file named <code>sampleLib.js</code> by copying and pasting the following script.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">function1</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;function1&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">value1</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;value1&#34;</span>;
</span></span></code></pre></div><p><strong>2. Create a main script</strong></p>
<p>Create a sample script named <code>sample.js</code> that utilizes the library. In this example, the library identifier is defined as <code>LIB</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">LIB</span>.<span style="color:#a6e22e">function1</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">LIB</span>.<span style="color:#a6e22e">value1</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>({ <span style="color:#a6e22e">res1</span>, <span style="color:#a6e22e">res2</span> });
</span></span></code></pre></div><p><strong>3. Run the script</strong></p>
<p>Execute the following command to link the library file to the identifier <code>LIB</code> and run the script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes -f sample.js -l LIB@sampleLib.js
</span></span></code></pre></div><p><strong>Output:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ gas-fakes -f sample.js -l LIB@sampleLib.js
</span></span><span style="display:flex;"><span>...using env file in /workspace/.env
</span></span><span style="display:flex;"><span>...using gasfakes settings file in /workspace/gasfakes.json
</span></span><span style="display:flex;"><span>[Worker] ...importing Drive API
</span></span><span style="display:flex;"><span>[Worker] ...importing Sheets API
</span></span><span style="display:flex;"><span>[Worker] ...importing Slides API
</span></span><span style="display:flex;"><span>[Worker] ...didnt find /workspace/gasfakes.json ... skipping
</span></span><span style="display:flex;"><span>[Worker] ...didnt find /workspace/appsscript.json ... skipping
</span></span><span style="display:flex;"><span>[Worker] ...didnt find /workspace/.clasp.json ... skipping
</span></span><span style="display:flex;"><span>[Worker] ...cache will be in /tmp/gas-fakes/cache
</span></span><span style="display:flex;"><span>[Worker] ...properties will be in /tmp/gas-fakes/properties
</span></span><span style="display:flex;"><span>[Worker] ...writing to /workspace/gasfakes.json
</span></span><span style="display:flex;"><span>[Worker] ...initializing auth and discovering project ID
</span></span><span style="display:flex;"><span>[Worker] ...discovered and set projectId to for-testing
</span></span><span style="display:flex;"><span>...gas-fakes version 1.2.##
</span></span><span style="display:flex;"><span>{ res1: &#39;function1&#39;, res2: &#39;value1&#39; }
</span></span><span style="display:flex;"><span>...terminating worker thread
</span></span></code></pre></div><p>The output confirms that the function and variable from the library were correctly retrieved.</p>
<h1 id="building-the-mcp-server-with-libraries">Building the MCP Server with Libraries</h1>
<p>Now we will prepare the actual scripts to be used with the Gemini CLI and Antigravity.</p>
<h2 id="library-configuration-notes">Library Configuration Notes</h2>
<p>We will use the following GAS library:</p>
<ul>
<li><strong>TableApp</strong>: <a href="https://github.com/tanaikech/TableApp">GitHub Repository</a></li>
<li><strong>Library Key</strong>: <code>1G4RVvyLtwPjQl6x_p8j3X65-yYVU3w2dMXxHDuzCgorucjs8P3Clv5Qt</code></li>
</ul>
<p><strong>Important Note on Permissions:</strong></p>
<p>In the updated <code>gas-fakes</code>, the library key can be used directly. However, for this to work via the API, the Google Apps Script project of the library should ideally be a <strong>Standalone</strong> script type.</p>
<ul>
<li><strong>Container-bound scripts</strong> require the Google Apps Script API and the scope <code>https://www.googleapis.com/auth/script.projects.readonly</code>.</li>
<li><strong>Standalone scripts</strong> require the Drive API and the scope <code>https://www.googleapis.com/auth/drive.readonly</code>.</li>
</ul>
<p>Since <code>gas-fakes</code> is already authorized for the Drive API, using a Standalone library avoids additional scope configuration.</p>
<p><em>Disclaimer: I am not certain if every published library is compatible with gas-fakes. If errors occur, minor modifications to the library script may be required.</em></p>
<h2 id="sample-custom-tool-implementation">Sample Custom Tool Implementation</h2>
<p>Create a file named <code>sample.js</code>. This script defines the tools for the MCP server, utilizing <code>TableApp</code> (via library key) and a local helper library <code>TableMng</code>. Replace <code>{your path}</code> with the actual path and test it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">z</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;zod&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tools</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;create-sample-google-sheets&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">schema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Use this to create a sample Google Spreadsheet including sample data.&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">inputSchema</span><span style="color:#f92672">:</span> {},
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">func</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {}) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>        [<span style="color:#e6db74">&#34;a1_sample1&#34;</span>, <span style="color:#e6db74">&#34;b1_sample2&#34;</span>, <span style="color:#e6db74">&#34;c1_sample3&#34;</span>],
</span></span><span style="display:flex;"><span>        [<span style="color:#e6db74">&#34;a2_sample4&#34;</span>, <span style="color:#e6db74">&#34;b2_sample5&#34;</span>, <span style="color:#e6db74">&#34;c2_sample6&#34;</span>],
</span></span><span style="display:flex;"><span>        [<span style="color:#e6db74">&#34;a3_sample7&#34;</span>, <span style="color:#e6db74">&#34;b3_sample8&#34;</span>, <span style="color:#e6db74">&#34;c3_sample9&#34;</span>],
</span></span><span style="display:flex;"><span>      ];
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">create</span>(<span style="color:#e6db74">&#34;sample&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getSheets</span>()[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">setName</span>(<span style="color:#e6db74">&#34;Sheet1&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span>, <span style="color:#a6e22e">values</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">length</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">values</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">textStyle</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">newTextStyle</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">setBold</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">setForegroundColor</span>(<span style="color:#e6db74">&#34;red&#34;</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">build</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">r</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">r</span>) =&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">c</span>) =&gt;
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">newRichTextValue</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">setText</span>(<span style="color:#a6e22e">c</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">setTextStyle</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#a6e22e">textStyle</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">build</span>()
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>      );
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">setRichTextValues</span>(<span style="color:#a6e22e">r</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#e6db74">`Spreadsheet ID of the created Google Spreadsheet is \`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getId</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">\`. The data range is \`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getA1Notation</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">\`.`</span>;
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;create-table-to-google-sheets&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">schema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Use this to create a new table to Google Spreadsheet.&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">inputSchema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">spreadsheetId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;The ID of the target Google Sheet.&#34;</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">tableName</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Table name. This name will be used to the created new table.&#34;</span>
</span></span><span style="display:flex;"><span>          ),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">sheetName</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">string</span>().<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;Sheet name.&#34;</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">range</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;The cell range of the table as A1Notation. The table will be created to this range.&#34;</span>
</span></span><span style="display:flex;"><span>          ),
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">func</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {}) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">sheetName</span>, <span style="color:#a6e22e">range</span>, <span style="color:#a6e22e">tableName</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">table</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">TableApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">range</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">create</span>(<span style="color:#a6e22e">tableName</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#e6db74">`Created Table ID: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">table</span>.<span style="color:#a6e22e">getId</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">libraries</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;TableApp@1G4RVvyLtwPjQl6x_p8j3X65-yYVU3w2dMXxHDuzCgorucjs8P3Clv5Qt&#34;</span>,
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;get-table-to-google-sheets&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">schema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Use this to get tables in a Google Spreadsheet.&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">inputSchema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">spreadsheetId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;The ID of the target Google Sheet.&#34;</span>),
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">func</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {}) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tables</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">TableMng</span>.<span style="color:#a6e22e">getTables</span>({ ...<span style="color:#a6e22e">object</span>, <span style="color:#a6e22e">TableApp</span> });
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">tables</span>);
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">libraries</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;TableApp@1G4RVvyLtwPjQl6x_p8j3X65-yYVU3w2dMXxHDuzCgorucjs8P3Clv5Qt&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;TableMng@{your path}/tableManager.js&#34;</span>,
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;get-values-from-table-on-google-sheets&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">schema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Use this to get values from a table in a Google Spreadsheet.&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">inputSchema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">spreadsheetId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;The ID of the target Google Sheet.&#34;</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">tableName</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Table name in the target Google Sheet. Provide table name or table ID.&#34;</span>
</span></span><span style="display:flex;"><span>          )
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">optional</span>(),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">tableId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Table ID in the target Google Sheet. Provide table name or table ID.&#34;</span>
</span></span><span style="display:flex;"><span>          )
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">optional</span>(),
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">func</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {}) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">table</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">TableMng</span>.<span style="color:#a6e22e">getTable</span>({ ...<span style="color:#a6e22e">object</span>, <span style="color:#a6e22e">TableApp</span> });
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">table</span>.<span style="color:#a6e22e">getValues</span>());
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">libraries</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;TableApp@1G4RVvyLtwPjQl6x_p8j3X65-yYVU3w2dMXxHDuzCgorucjs8P3Clv5Qt&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;TableMng@{your path}/tableManager.js&#34;</span>,
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;reverse-table-on-google-sheets&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">schema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Use this to reverse a table in a Google Spreadsheet.&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">inputSchema</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">spreadsheetId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(<span style="color:#e6db74">&#34;The ID of the target Google Sheet.&#34;</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">tableName</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Table name in the target Google Sheet. Provide table name or table ID.&#34;</span>
</span></span><span style="display:flex;"><span>          )
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">optional</span>(),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">tableId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">z</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">string</span>()
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">describe</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Table ID in the target Google Sheet. Provide table name or table ID.&#34;</span>
</span></span><span style="display:flex;"><span>          )
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">optional</span>(),
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">func</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {}) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">table</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">TableMng</span>.<span style="color:#a6e22e">getTable</span>({ ...<span style="color:#a6e22e">object</span>, <span style="color:#a6e22e">TableApp</span> });
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">reverseMsg</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">table</span>.<span style="color:#a6e22e">reverse</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">reverseMsg</span>;
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">libraries</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;TableApp@1G4RVvyLtwPjQl6x_p8j3X65-yYVU3w2dMXxHDuzCgorucjs8P3Clv5Qt&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;TableMng@{your path}/tableManager.js&#34;</span>,
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>];
</span></span></code></pre></div><p>Create the helper library file <code>tableManager.js</code> at the path specified in <code>TableMng@{your path}/tableManager.js</code> inside your tool definitions:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getTables</span>(<span style="color:#a6e22e">object</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">TableApp</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tables</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tableApp</span>.<span style="color:#a6e22e">getTables</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">tables</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getTable</span>(<span style="color:#a6e22e">object</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">tableName</span>, <span style="color:#a6e22e">tableId</span>, <span style="color:#a6e22e">TableApp</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tableApp</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">TableApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">table</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">tableName</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">table</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tableApp</span>.<span style="color:#a6e22e">getTableByName</span>(<span style="color:#a6e22e">tableName</span>);
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">tableId</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">table</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tableApp</span>.<span style="color:#a6e22e">getTableById</span>(<span style="color:#a6e22e">tableId</span>);
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Table name or table ID is required.&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">table</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="integration-settings">Integration Settings</h2>
<h3 id="for-gemini-cli">For Gemini CLI</h3>
<p>To register these tools with the Gemini CLI, modify your <code>.gemini/settings.json</code> file as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#e6db74">&#34;mcpServers&#34;</span><span style="color:#960050;background-color:#1e0010">:</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;gas-fakes&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;command&#34;</span>: <span style="color:#e6db74">&#34;gas-fakes&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;args&#34;</span>: [<span style="color:#e6db74">&#34;mcp&#34;</span>, <span style="color:#e6db74">&#34;--tools&#34;</span>, <span style="color:#e6db74">&#34;{your path}/sample.js&#34;</span>]
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>After launching the Gemini CLI, run the command <code>/mcp</code> to verify that the custom tools are successfully loaded.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251211a/fig2.jpg" alt=""></p>
<h3 id="for-google-antigravity">For Google Antigravity</h3>
<p>To register these tools with Google Antigravity, modify the file <code>/home/{user_name}/.gemini/antigravity/mcp_config.json</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;mcpServers&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;gas-fakes&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;command&#34;</span>: <span style="color:#e6db74">&#34;gas-fakes&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;args&#34;</span>: [<span style="color:#e6db74">&#34;mcp&#34;</span>, <span style="color:#e6db74">&#34;--tools&#34;</span>, <span style="color:#e6db74">&#34;{your path}/sample.js&#34;</span>]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When you launch Google Antigravity and check the MCP servers, the custom tools should be visible.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251211a/fig3.jpg" alt=""></p>
<h1 id="real-world-testing">Real-world Testing</h1>
<h2 id="test-using-gemini-cli">Test using Gemini CLI</h2>
<p>The following section demonstrates the workflow using the Gemini CLI.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251211a/fig4c.jpg" alt=""></p>
<h3 id="1-create-a-sample-spreadsheet">1. Create a sample Spreadsheet</h3>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Create a new sample Google Spreadsheet using a tool create-sample-google-sheets. Show the URL of the created Google Spreadsheet. Run it without a sandbox.
</span></span></code></pre></div><p><strong>Result:</strong></p>
<p>A new Google Spreadsheet is created successfully.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251211a/fig4a.jpg" alt=""></p>
<h3 id="2-create-a-new-table">2. Create a new table</h3>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Create the data range of the created Spreadsheet as a new table. The table name is &#34;sampleTable&#34;. Use the spreadsheet as whitelistWrite.
</span></span></code></pre></div><p><strong>Result:</strong></p>
<p>The table is created within the sheet.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251211a/fig4b.jpg" alt=""></p>
<p><em>Alternative command using gas-fakes CLI:</em></p>
<p>You can achieve the same result using the CLI directly by passing the <code>TableApp</code> library key:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes -s <span style="color:#e6db74">&#39;const spreadsheetId = &#34;{spreadsheetId}&#34;, tableName = &#34;sampleTable&#34;, sheetName = &#34;Sheet1&#34;, range = &#34;A1:C3&#34;; const table = TableApp.openById(spreadsheetId).getSheetByName(sheetName).getRange(range).create(tableName); console.log(`Created Table ID: ${table.getId()}`);&#39;</span> -l <span style="color:#e6db74">&#34;TableApp@1G4RVvyLtwPjQl6x_p8j3X65-yYVU3w2dMXxHDuzCgorucjs8P3Clv5Qt&#34;</span>
</span></span></code></pre></div><h3 id="3-get-values-from-a-table">3. Get values from a table</h3>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Get values from the table. Use the spreadsheet as whitelistRead.
</span></span></code></pre></div><p><strong>Result:</strong></p>
<p>The values <code>[[&quot;a1_sample1&quot;,&quot;b1_sample2&quot;,&quot;c1_sample3&quot;],[&quot;a2_sample4&quot;,&quot;b2_sample5&quot;,&quot;c2_sample6&quot;],[&quot;a3_sample7&quot;,&quot;b3_sample8&quot;,&quot;c3_sample9&quot;]]</code> are returned from the &ldquo;sampleTable&rdquo;.</p>
<p><em>Alternative command using gas-fakes CLI:</em></p>
<p>This command demonstrates loading both a remote library (by key) and a local library (by path):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes -s <span style="color:#e6db74">&#39;const object = {spreadsheetId: &#34;{spreadsheetId}&#34;, tableName: &#34;sampleTable&#34;, sheetName: &#34;Sheet1&#34;, range: &#34;A1:C3&#34;}; const table = TableMng.getTable({ ...object, TableApp }); console.log(JSON.stringify(table.getValues()));&#39;</span> -l <span style="color:#e6db74">&#34;TableApp@1G4RVvyLtwPjQl6x_p8j3X65-yYVU3w2dMXxHDuzCgorucjs8P3Clv5Qt&#34;</span> -l <span style="color:#e6db74">&#34;TableMng@{your path}/tableManager.js&#34;</span>
</span></span></code></pre></div><h3 id="4-reverse-a-table">4. Reverse a table</h3>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Reverse the table. Use the spreadsheet as whitelistWrite.
</span></span></code></pre></div><p><strong>Result:</strong></p>
<p>The table formatting is removed, leaving only the values.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251211a/fig4a.jpg" alt=""></p>
<p><em>Alternative command using gas-fakes CLI:</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gas-fakes -s <span style="color:#e6db74">&#39;const object = {spreadsheetId: &#34;{spreadsheetId}&#34;, tableName: &#34;sampleTable&#34;}; const table = TableMng.getTable({ ...object, TableApp }); const reverseMsg = table.reverse(); console.log(reverseMsg);&#39;</span> -l <span style="color:#e6db74">&#34;TableApp@1G4RVvyLtwPjQl6x_p8j3X65-yYVU3w2dMXxHDuzCgorucjs8P3Clv5Qt&#34;</span> -l <span style="color:#e6db74">&#34;TableMng@{your path}/tableManager.js&#34;</span>
</span></span></code></pre></div><h2 id="test-using-google-antigravity">Test using Google Antigravity</h2>
<p>For this test, I configured Antigravity with the rule: <code>Use the MCP server preferentially by understanding the prompt.</code> This ensured that tasks were routed smoothly to the MCP tools.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251211a/fig5a.jpg" alt=""></p>
<p>The testing process for <strong>Creating a Spreadsheet</strong>, <strong>Creating a Table</strong>, <strong>Getting Values</strong>, and <strong>Reversing a Table</strong> yielded identical results to the Gemini CLI tests. This confirms that the MCP server functionality is consistent across different AI agent environments when powered by the updated <code>gas-fakes</code> library support.</p>
<h1 id="summary">Summary</h1>
<ul>
<li><strong>Overcoming Limitations</strong>: Previous versions of <code>gas-fakes</code> required monolithic scripts because they lacked dynamic library loading, which hindered code maintainability.</li>
<li><strong>Library Integration</strong>: The updated <code>gas-fakes</code> now supports native loading of Google Apps Script libraries (both remote keys and local files), enabling true modularity.</li>
<li><strong>Enhanced MCP Servers</strong>: Developers can now build sophisticated MCP servers that leverage existing GAS libraries (<code>TableApp</code>, etc.) without manually bundling code.</li>
<li><strong>Seamless Automation</strong>: The demonstrated scripts successfully bridge the gap between AI agents and Google Workspace, allowing for complex operations like table management in Sheets.</li>
<li><strong>Verified Compatibility</strong>: The solution was rigorously tested and proven to work identically on both the Gemini CLI and Google Antigravity platforms.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f11%2fmodularizing-ai-agents-integrating-google-apps-script-libraries-with-gemini-cli-and-antigravity%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f11%2fmodularizing-ai-agents-integrating-google-apps-script-libraries-with-gemini-cli-and-antigravity%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f11%2fmodularizing-ai-agents-integrating-google-apps-script-libraries-with-gemini-cli-and-antigravity%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f11%2fmodularizing-ai-agents-integrating-google-apps-script-libraries-with-gemini-cli-and-antigravity%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f11%2fmodularizing-ai-agents-integrating-google-apps-script-libraries-with-gemini-cli-and-antigravity%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f11%2fmodularizing-ai-agents-integrating-google-apps-script-libraries-with-gemini-cli-and-antigravity%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2025/12/03/power-of-google-apps-script-building-mcp-server-tools-for-gemini-cli-and-google-antigravity-in-google-workspace-automation/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2025/12/03/power-of-google-apps-script-building-mcp-server-tools-for-gemini-cli-and-google-antigravity-in-google-workspace-automation/">Power of Google Apps Script: Building MCP Server Tools for Gemini CLI and Google Antigravity in Google Workspace Automation</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2025/12/12/updated-gas-library-utlapp/">Updated: GAS Library - UtlApp</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2025/12/12/updated-gas-library-utlapp/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

