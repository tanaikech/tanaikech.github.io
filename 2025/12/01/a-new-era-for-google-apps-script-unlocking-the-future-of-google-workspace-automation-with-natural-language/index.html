<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>A New Era for Google Apps Script: Unlocking the Future of Google Workspace Automation with Natural Language &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>A New Era for Google Apps Script: Unlocking the Future of Google Workspace Automation with Natural Language</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>01 Dec 2025, 10:19</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/model-context-protocol">Model Context Protocol</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/mcp">MCP</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/antigravity">Antigravity</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/611d0cc0fe9733994ae547ab4dbe667c">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig1.jpg" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>This article redefines Google Apps Script (GAS) as a central integration hub in the AI era. It introduces the forefront of Google Workspace automation, realized through the fusion of the Model Context Protocol (MCP), Agent2Agent (A2A), and the Gemini CLI ecosystem. I cover everything from data integration bridging local and cloud environments (RAG) and sandbox technologies for safely executing AI-generated GAS, to the coordination of autonomous agents on the newly released Google Antigravity. We will explore next-generation work styles and implementation methods where complex workflows are completed autonomously through simple natural language instructions.</p>
<h1 id="introduction">Introduction</h1>
<p>The rise of Artificial Intelligence (AI), particularly Large Language Models (LLMs), is fundamentally changing how we automate systems. Until now, script execution has followed an &ldquo;imperative&rdquo; approach: developers write code and trigger it manually or via events. This has also been true for Google Apps Script (GAS), the automation engine for Google Workspace. As described in the <a href="https://developers.google.com/apps-script">official documentation</a>, GAS has long established itself as a reliable automation tool, being &ldquo;the only low-code platform that makes it quick and easy to build business solutions that integrate, automate, and extend Google Workspace.&rdquo; <a href="https://workspace.google.com/products/apps-script/">Ref</a></p>
<p>However, the evolution of AI is now adding new dimensions of &ldquo;autonomy&rdquo; and &ldquo;dialogue&rdquo; to this traditional paradigm. We are moving toward a workflow where humans convey intent (prompts) via natural language, and AI agents interpret them, select appropriate tools, and execute tasks. At the heart of this new style is the <strong>Model Context Protocol (MCP)</strong>, a communication standard connecting AI with external tools. <a href="https://modelcontextprotocol.io/">Ref</a> Through MCP, AI evolves from a simple text generator into an agent capable of coordinating multiple scripts to perform practical work.</p>
<p>This transformation spread to the terminal environment—the most native habitat for developers—with the arrival of the <strong>Gemini CLI</strong>. <a href="https://blog.google/technology/developers/introducing-gemini-cli-open-source-ai-agent/">Ref</a> Furthermore, <strong>Gemini CLI Extensions</strong> have expanded the ecosystem, accelerating terminal-based AI-driven development. <a href="https://cloud.google.com/blog/products/databases/gemini-cli-extensions-for-google-data-cloud?e=48754805">Ref</a> Currently, with the advent of <strong>Agent2Agent (A2A)</strong> <a href="https://developers.googleblog.com/en/a2a-a-new-era-of-agent-interoperability/">Ref</a>, a next-generation protocol allowing AI agents to collaborate to solve tasks, and the supporting platform <strong>Google Antigravity</strong> <a href="https://antigravity.google/">Ref</a>, automation is shifting from processing individual tasks to the autonomous completion of complex workflows.</p>
<p>In this article, I will systematically review the initiatives I have undertaken over this year. I will delve deep into the practical knowledge and new possibilities for Google Apps Script opened up by the Gemini CLI ecosystem—redefining GAS as an &ldquo;integration hub for the AI era,&rdquo; utilizing it as an MCP/A2A server, building RAG to eliminate data silos between local and cloud environments, and implementing sandbox technologies to safely execute AI-generated code.</p>
<h1 id="application-of-google-apps-script-to-ai">Application of Google Apps Script to AI</h1>
<p>Here, I will introduce my journey of exploration along with the articles I have published. As this is not just a technical explanation but a record of trial and error, I will write from a subjective perspective.</p>
<h2 id="building-an-mcp-server-with-google-apps-script">Building an MCP Server with Google Apps Script</h2>
<p>When I first encountered the concept of MCP, I intuitively understood it as a protocol standardizing AI Function Calling. At the time, sample code was predominantly Python. However, as I tested it and grasped its potential, I became convinced that linking this with Google Workspace would bring revolutionary convenience to many users. This is because the biggest barrier to manipulating Google Workspace from a local environment has always been the complexity of OAuth authentication. Questions regarding authentication are frequent on Stack Overflow, suggesting it is a major bottleneck for many users trying to access Google Workspace externally. By using GAS, authentication is handled automatically during script execution, allowing users to access data seamlessly. I believed this characteristic of GAS was the key to eliminating the bottleneck in AI agent utilization.</p>
<p>After analyzing the MCP server specifications, I determined it could be implemented using the Web Apps feature of GAS and immediately began developing a prototype. (Ref A1) I started by building a simple MCP server in GAS and verifying that it operated according to the protocol by calling it from Claude Desktop and a self-made GAS client. (Ref A2, A3) The moment I was able to manipulate Gmail with a single natural language instruction, I was convinced this was the new tide of automation.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig2.gif" alt=""></p>
<h3 id="related-articles-a">Related Articles A</h3>
<p><strong>Medium:</strong></p>
<ol>
<li><a href="https://medium.com/google-cloud/building-model-context-protocol-mcp-server-with-google-apps-script-9ff1fe58653c">Building Model Context Protocol (MCP) Server with Google Apps Script</a></li>
<li><a href="https://medium.com/google-cloud/gmail-processing-using-mcp-network-powered-by-google-apps-script-5ede2a25c94e">Gmail Processing using MCP Network Powered by Google Apps Script</a></li>
</ol>
<p><strong>GitHub:</strong></p>
<ol start="3">
<li><a href="https://github.com/tanaikech/MCPApp">https://github.com/tanaikech/MCPApp</a></li>
</ol>
<h2 id="connecting-from-gemini-cli-to-gas-mcp-server">Connecting from Gemini CLI to GAS MCP Server</h2>
<p>The arrival of the Gemini CLI opened the door to the next stage. Since the GAS-based MCP server I built was protocol-based and client-independent, I assumed it could be used as is, and immediately tested it. As expected, I succeeded in calling tools on GAS from the terminal and manipulating Google Workspace seamlessly. (Ref B1, B2)</p>
<p>This combination compensated for the weaknesses of GAS while maximizing its strengths. Traditionally, GAS struggled with local file interaction and the 6-minute execution time limit. However, via the Gemini CLI, AI agents can effectively overcome these limits by instructing multiple executions. Furthermore, the terminal is the foundation of all development environments, including local machines, Google Cloud Shell, and Firebase Studio. Since authentication is complete the moment it is deployed as a GAS Web App, you can safely manipulate Google Workspace data using natural language from anywhere. This was a major step in unleashing the potential of GAS from the cloud to local environments and every development scene.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig3.gif" alt=""></p>
<p>Following this success, I developed a suite of tools specialized for various Google Workspace services and released them as libraries. (Ref B3, B13) This allowed for the natural language control of a wide range of services including Docs, Sheets, Slides, Forms, Calendar, Maps, Classroom, and Analytics, dramatically expanding the scope of application from data analysis to content generation. (Ref B4-B11) In fact, I am utilizing this very system for drafting this article. (Ref B12)</p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig4.gif" alt=""></p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig5.gif" alt=""></p>
<h3 id="related-articles-b">Related Articles B</h3>
<p><strong>Medium:</strong></p>
<ol>
<li><a href="https://medium.com/google-cloud/gemini-cli-with-mcp-server-built-by-web-apps-of-google-apps-script-47046afdf3be">Gemini CLI with MCP Server Built by Web Apps of Google Apps Script</a></li>
<li><a href="https://medium.com/google-cloud/gemini-cli-with-mcp-server-expanding-possibilities-with-google-apps-script-4626c661ac81">Gemini CLI with MCP Server: Expanding Possibilities with Google Apps Script</a></li>
<li><a href="https://medium.com/google-cloud/gemini-cli-featuring-an-enhanced-toolsformcpserver-7afaadfb5cfa">Gemini CLI: Featuring an Enhanced ToolsForMCPServer</a></li>
<li><a href="https://medium.com/google-cloud/next-level-data-automation-gemini-cli-google-sheets-and-mcp-e6628a382e90">Next-Level Data Automation: Gemini CLI, Google Sheets, and MCP</a></li>
<li><a href="https://medium.com/google-cloud/managing-google-docs-sheets-and-slides-by-natural-language-with-gemini-cli-and-mcp-62f4dfbef2d5">Managing Google Docs, Sheets, and Slides by Natural Language with Gemini CLI and MCP</a></li>
<li><a href="https://medium.com/google-cloud/next-level-data-automation-gemini-cli-google-calendar-and-mcp-1b9e39e75f34">Next-Level Data Automation: Gemini CLI, Google Calendar, and MCP</a></li>
<li><a href="https://medium.com/google-cloud/enhanced-guide-to-using-prompts-in-the-gemini-cli-817cbce97e46">Enhanced Guide to Using Prompts in Gemini CLI</a></li>
<li><a href="https://medium.com/google-cloud/next-level-classroom-automation-gemini-cli-google-classroom-and-mcp-ac4bb9103fa6">Next-Level Classroom Automation: Gemini CLI, Google Classroom, and MCP</a></li>
<li><a href="https://medium.com/google-cloud/unifying-google-workspace-with-natural-language-integrated-collaboration-through-gemini-cli-and-a40489ddf17e">Unifying Google Workspace with Natural Language: Integrated Collaboration through Gemini CLI and MCP</a></li>
<li><a href="https://medium.com/google-cloud/streamlining-web-page-insights-with-natural-language-using-gemini-cli-google-analytics-and-mcp-1774d2b735b7">Streamlining Web Page Insights with Natural Language using Gemini CLI, Google Analytics, and MCP</a></li>
<li><a href="https://medium.com/google-cloud/google-maps-with-natural-language-integrated-collaboration-through-gemini-cli-and-mcp-07ba309593b3">Google Maps with Natural Language: Integrated Collaboration through Gemini CLI and MCP</a></li>
<li><a href="https://medium.com/google-cloud/streamlining-content-creation-a-guide-to-using-gemini-cli-mcp-server-and-vscode-e623c42419f5">Streamlining Content Creation: A Guide to Using Gemini CLI, MCP Server, and VSCode</a></li>
</ol>
<p><strong>GitHub:</strong></p>
<ol start="13">
<li><a href="https://github.com/tanaikech/ToolsForMCPServer">https://github.com/tanaikech/ToolsForMCPServer</a></li>
</ol>
<h2 id="accelerating-gas-mcp-servers-as-gemini-cli-extensions">Accelerating GAS MCP Servers as Gemini CLI Extensions</h2>
<p>As I moved towards practical implementation, a new challenge emerged: the initial load time of the GAS MCP server. Due to MCP specifications, at least four HTTP requests occur for the client to retrieve the tool list. (See workflow below) As the number of GAS MCP servers increased, this overhead became impossible to ignore.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig6.jpg" alt=""></p>
<p>To solve this, I devised an architecture that places a locally running Node.js MCP server as a wrapper between the Gemini CLI and the GAS server. (Ref C1) This wrapper caches tool definitions, minimizing requests to the GAS side. As a result, I succeeded in dramatically shortening the initial load time—reducing it by a factor of 15. Furthermore, aligning with the release of Gemini CLI Extensions, I packaged this as an extension to make it easily installable for anyone. (Ref C2, C5)</p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig7.jpg" alt=""></p>
<p>Currently, this extension contains over 160 tools, yet the initial load time is only about 1 second. The tool execution speed is comparable to calling GAS directly, achieving both convenience and performance.</p>
<p>On November 18, 2025, the new development platform <strong>Google Antigravity</strong> was released. <a href="https://antigravity.google/">Ref</a> Google Antigravity provides an <strong>&ldquo;AI Agent-First&rdquo; environment where multiple AI agents coordinate to autonomously complete complex workflows</strong>, rather than just executing single tasks. Naturally, integration with MCP servers is natively supported. With this, Google Workspace automation has entered a new phase. We can now differentiate usage based on the scenario: use Gemini CLI for tasks requiring immediacy, and entrust complex tasks requiring long inference or multi-step processes to autonomous agents on Google Antigravity. (Ref C3)</p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig7b.gif" alt=""></p>
<p>On November 25, 2025, the official Gemini CLI Extension for Google Workspace was released. <a href="https://allen.hutchison.org/2025/11/19/bringing-the-office-to-the-terminal/">Ref</a> The greatest feature of this Extension is its smooth authentication flow. After installation, launching the Gemini CLI automatically opens the browser, and once authentication is completed, it is immediately ready for use. The mechanism involves sending requests directly from the local environment to the Google Workspace API to retrieve and process data. Due to its high convenience, development using this Extension is expected to become the standard. Furthermore, as shown in the figure below, I attempted to use the MCP server from this official Google Workspace Extension within Google Antigravity. (Ref C4) Enabling the use of Google Workspace within Google Antigravity is likely to lead to applications and discoveries in even more diverse scenarios.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig7c.gif" alt=""></p>
<h3 id="related-articles-c">Related Articles C</h3>
<p><strong>Medium:</strong></p>
<ol>
<li><a href="https://medium.com/google-cloud/accelerating-gemini-cli-a-node-js-wrapper-for-google-apps-script-mcp-servers-a4295283d2ca">Accelerating Gemini CLI: A Node.js Wrapper for Google Apps Script MCP Servers</a></li>
<li><a href="https://medium.com/google-cloud/simplified-google-workspace-automation-with-gemini-cli-extensions-cbd86bcd7948">Simplified Google Workspace Automation with Gemini CLI Extensions</a></li>
<li><a href="https://medium.com/google-cloud/agentic-automation-in-google-workspace-bridging-antigravity-and-gemini-3-0-3b1220ec144a">Agentic Automation in Google Workspace: Bridging Antigravity and Gemini 3.0</a></li>
<li><a href="https://medium.com/google-cloud/integrating-google-antigravity-unlocking-the-google-workspace-extension-for-gemini-cli-fd646d5db2a3">Integrating Google Antigravity: Unlocking the Google Workspace Extension for Gemini CLI</a></li>
</ol>
<p><strong>GitHub:</strong></p>
<ol start="5">
<li><a href="https://github.com/tanaikech/ToolsForMCPServer-extension">https://github.com/tanaikech/ToolsForMCPServer-extension</a></li>
</ol>
<h2 id="seamless-integration-of-local-and-workspace-data-into-file-search">Seamless Integration of Local and Workspace Data into File Search</h2>
<p>I have shown that the combination of Gemini CLI and GAS MCP servers can bridge local and cloud data. As the next application of this architecture, I focused on the new &ldquo;File Search&rdquo; feature of the Gemini API. (Ref D1)</p>
<p>While uploading local files to the File Search data store is simple, uploading data from Google Drive docs or spreadsheets involves the hassle of downloading them locally first. To solve this data silo problem, I developed a GAS tool that directly uploads files on Google Workspace to the File Search store. This paved the way for realizing cross-functional RAG (Retrieval-Augmented Generation) by integrating local files and Google Workspace information into a single data store. (Ref D2, D3)</p>
<h3 id="related-articles-d">Related Articles D</h3>
<p><strong>Medium:</strong></p>
<ol>
<li><a href="https://medium.com/google-cloud/integrating-file-search-with-the-gemini-cli-extension-0d9e04ecde7d">Integrating File Search with the Gemini CLI Extension</a></li>
<li><a href="https://medium.com/google-cloud/from-data-silos-to-unified-rag-gemini-cli-extensions-unify-local-and-google-workspace-for-a-29bc94614603">From Data Silos to Unified RAG: Gemini CLI Extensions Unify Local and Google Workspace for a Powerful File Search</a></li>
</ol>
<p><strong>GitHub:</strong></p>
<ol start="3">
<li><a href="https://github.com/tanaikech/FileSearchStore-extension">https://github.com/tanaikech/FileSearchStore-extension</a></li>
</ol>
<h2 id="challenge-of-building-an-a2a-network-with-google-apps-script">Challenge of Building an A2A Network with Google Apps Script</h2>
<p>After my success with MCP, my gaze turned to the next-generation protocol, <strong>Agent2Agent (A2A)</strong>. A2A realizes a world where AI agents interact autonomously and collaborate to solve tasks. I hypothesized that GAS could serve as a hub here as well and began verification.</p>
<p>However, A2A had different technical requirements than MCP. Specifically, access to a specific path <code>.well-known/agent.json</code> was mandatory, which could not be directly supported by the standard URL structure of GAS Web Apps. I knew from experience that accessing this path would currently require an access token with Drive scope. Therefore, I modified an existing A2A client to include an access token in the request, bypassing this issue. Thus, I successfully confirmed the operation of an A2A server using GAS. (Ref E1, E4)</p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig8.gif" alt=""></p>
<p>Furthermore, by implementing the client side in GAS as well, I reasoned that authentication could be handled seamlessly, allowing for the construction of a complete A2A network within the GAS ecosystem. I worked on its implementation as shown in the workflow diagram below. (Ref E2)</p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig9.jpg" alt=""></p>
<p>This enables more advanced automation, such as multiple AI agents collaborating to process data based on the value of an active cell in Google Sheets, as shown in the figure below.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig10.gif" alt=""></p>
<p>Finally, I integrated the functions of the MCP server and A2A server into a single GAS project, constructing a hybrid server that switches protocols according to the request from the client, as shown in the workflow diagram below. (Ref E3) I believe this integrated server will become a powerful gateway for connecting Google Workspace with diverse external agents in the coming era of AI agents.</p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig11.jpg" alt=""></p>
<h3 id="related-articles-e">Related Articles E</h3>
<p><strong>Medium:</strong></p>
<ol>
<li><a href="https://medium.com/google-cloud/building-agent2agent-a2a-server-with-google-apps-script-d3efd32c7ca7">Building Agent2Agent (A2A) Server with Google Apps Script</a></li>
<li><a href="https://medium.com/google-cloud/enabling-collaborative-agent-systems-through-google-apps-script-based-agent2agent-a2a-network-19e3d0472eaa">Enabling Collaborative Agent Systems through Google Apps Script-based Agent2Agent (A2A) Network</a></li>
<li><a href="https://medium.com/google-cloud/consolidating-generative-ai-protocols-a-single-server-solution-for-mcp-and-a2a-84e1e75ccbcf">Consolidating Generative AI Protocols: A Single Server Solution for MCP and A2A</a></li>
</ol>
<p><strong>GitHub:</strong></p>
<ol start="4">
<li><a href="https://github.com/tanaikech/taking-advantage-of-Web-Apps-with-google-apps-script">https://github.com/tanaikech/taking-advantage-of-Web-Apps-with-google-apps-script</a></li>
</ol>
<h2 id="in-search-of-a-safe-execution-environment-for-ai-generated-gas-code">In Search of a Safe Execution Environment for AI-Generated GAS Code</h2>
<p>The Gemini CLI is also a very powerful assistant for generating GAS code. However, executing AI-generated code without verification carries significant security risks. Since GAS often requires access rights to all files in Google Drive, establishing a safe execution environment (sandbox) was essential. I had envisioned a sandbox for GAS even before generative AI became publicly available, but development had stalled due to the difficulty of realization.</p>
<p>The turning point was receiving an invitation from <a href="https://github.com/brucemcpherson">Mr. Bruce McPherson</a> to participate in his <a href="https://github.com/brucemcpherson/gas-fakes"><code>gas-fakes</code></a> project. <code>gas-fakes</code> is a grand project aiming to replicate all GAS classes and methods in a local Node.js environment, enabling the same code to run both in the cloud and locally. When I understood this, I was convinced that the sandbox concept I had nearly given up on could be realized with <code>gas-fakes</code>.</p>
<p>Through discussion and joint development with Bruce, we finally completed a prototype of a GAS sandbox and were the first in the world to demonstrate its feasibility. (Ref F1) This sandbox safely executes AI-generated GAS code while finely controlling access to files, folders, and usable methods. Furthermore, by publishing this sandbox function as an MCP server, we established a workflow (shown below) where GAS code can be safely generated and executed via natural language from the Gemini CLI. (Ref F2)</p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig12.jpg" alt=""></p>
<p>Subsequently, to further enhance the convenience of <code>gas-fakes</code>, we developed it into a CLI tool and released it as the Gemini CLI Extension &ldquo;GAS Development Kit.&rdquo; (Ref F3, F4, F9) This created an environment where the latest GAS development workflow can be practiced anywhere there is a terminal, whether locally or in the cloud (Google Cloud Shell, Firebase Studio, etc.). (Ref F5, F6)</p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig13.gif" alt=""></p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig14.gif" alt=""></p>
<p>This secure execution foundation foreshadows the future style of automation. I also succeeded in an experiment to dynamically add real-time generated scripts as tools to the MCP server, making them reusable. (Ref F7) In the future, fixed MCP servers may become unnecessary; we may see a world where AI generates the optimal code (or something similar) on the spot to solve a task given by a prompt and executes it immediately within a sandbox. At that time, groups of AI agents specialized for individual tasks and protocols like A2A that connect them will play a decisive role.</p>
<p><strong>Google Antigravity</strong> becomes the critical piece in realizing this vision. The combination of Gemini 3.0&rsquo;s advanced reasoning capabilities and the Antigravity execution environment allows the cycle of &ldquo;Code Generation → Verification in Sandbox → Execution&rdquo; to be run autonomously without human intervention. Moving forward, in addition to prototyping with Gemini CLI, &ldquo;AI Agent-First&rdquo; GAS development on Antigravity is expected to take root as the new standard. (Ref F8)</p>
<p><img src="https://tanaikech.github.io/image-storage/20251201a/fig15.gif" alt=""></p>
<h3 id="related-articles-f">Related Articles F</h3>
<p><strong>Medium:</strong></p>
<ol>
<li><a href="https://medium.com/google-cloud/a-fake-sandbox-for-google-apps-script-a-feasibility-study-on-securely-executing-code-generated-by-cc985ce5dae3">A Fake-Sandbox for Google Apps Script: A Feasibility Study on Securely Executing Code Generated by Gemini CLI</a></li>
<li><a href="https://medium.com/google-cloud/secure-and-conversational-google-workspace-automation-integrating-gemini-cli-with-a-gas-fakes-mcp-0a5341559865">Secure and Conversational Google Workspace Automation: Integrating Gemini CLI with a gas-fakes MCP Server</a></li>
<li><a href="https://medium.com/google-cloud/streamlining-google-apps-script-development-with-gemini-cli-extensions-and-vscode-d69e9eaea22a">Streamlining Google Apps Script Development with Gemini CLI Extensions and VSCode</a></li>
<li><a href="https://medium.com/google-cloud/secure-and-streamlined-google-apps-script-development-with-gas-fakes-cli-and-gemini-cli-extension-67bbce80e2c8">Secure and Streamlined Google Apps Script Development with gas-fakes CLI and Gemini CLI Extension</a></li>
<li><a href="https://medium.com/google-cloud/bridging-the-gap-seamless-integration-for-local-google-apps-script-development-9b9b973aeb02">Bridging the Gap: Seamless Integration for Local Google Apps Script Development</a></li>
<li><a href="https://medium.com/google-cloud/modern-google-apps-script-workflow-building-on-the-cloud-2255dbd32ac3">Modern Google Apps Script Workflow Building on the Cloud</a></li>
<li><a href="https://medium.com/google-cloud/dynamic-tool-creation-for-google-workspace-automation-with-gemini-cli-f9618166aaed">Dynamic Tool Creation for Google Workspace Automation with Gemini CLI</a></li>
<li><a href="https://medium.com/google-cloud/next-generation-google-apps-script-development-leveraging-antigravity-and-gemini-3-0-c4d5affbc1a8">Next-Generation Google Apps Script Development: Leveraging Antigravity and Gemini 3.0</a></li>
</ol>
<p><strong>GitHub:</strong></p>
<ol start="9">
<li><a href="https://github.com/tanaikech/gas-development-kit-extension">https://github.com/tanaikech/gas-development-kit-extension</a></li>
</ol>
<h1 id="summary">Summary</h1>
<p>Through the review of one year of practice and the latest technological trends in this article, the fusion of Google Apps Script (GAS) and AI technology has moved beyond simple task automation into a phase of autonomous business execution.</p>
<ul>
<li><strong>Redefinition as an Integration Hub in the AI Era:</strong> The Web Apps functionality and robust authentication mechanisms of GAS serve as a crucial &ldquo;hub&rdquo; connecting AI agents and Google Workspace in protocols like MCP and A2A. With the arrival of the official Google Workspace Extension, this connection has become more standardized and accessible.</li>
<li><strong>Dissolution of Boundaries between Local and Cloud:</strong> The integration with Gemini CLI has liberated GAS from the closed environment of the cloud. Starting from the terminal, local resources, Google Workspace, and AI platforms like Google Antigravity connect seamlessly, realizing a location-independent hybrid development environment.</li>
<li><strong>Overcoming Performance via Architecture:</strong> The challenge of initial response speed (cold start) has been resolved through architectural ingenuity using Gemini CLI Extensions and caching strategies, ensuring fast responses suitable for practical operation.</li>
<li><strong>Elimination of Data Silos and Deepening of RAG:</strong> By making GAS function as a gateway, data within Workspace can be directly integrated into external contexts like File Search, building an advanced Retrieval-Augmented Generation (RAG) foundation that is agnostic to where information is stored (local/cloud).</li>
<li><strong>&ldquo;Safe Execution Foundation&rdquo; Supporting Autonomy:</strong> Sandbox technology using <code>gas-fakes</code> is essential for dynamically and safely executing code generated by AI. This is a core technology for shifting from a stage of simply using prepared tools to a world where AI generates, verifies, and executes code on the spot to solve problems.</li>
<li><strong>Evolution to &ldquo;Agentic Automation&rdquo;:</strong> The advent of Google Antigravity and Gemini 3.0 has determined a future where multiple AI agents coordinate to complete complex workflows. In this new ecosystem, GAS will increase in importance as the operational force of agents or the glue between them.</li>
</ul>
<h1 id="acknowledgements">Acknowledgements</h1>
<p>I would like to express my sincere gratitude to Mr. Bruce McPherson for the many constructive discussions and valuable insights provided during the joint development of <code>gas-fakes</code>.</p>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f01%2fa-new-era-for-google-apps-script-unlocking-the-future-of-google-workspace-automation-with-natural-language%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f01%2fa-new-era-for-google-apps-script-unlocking-the-future-of-google-workspace-automation-with-natural-language%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f01%2fa-new-era-for-google-apps-script-unlocking-the-future-of-google-workspace-automation-with-natural-language%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f01%2fa-new-era-for-google-apps-script-unlocking-the-future-of-google-workspace-automation-with-natural-language%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f01%2fa-new-era-for-google-apps-script-unlocking-the-future-of-google-workspace-automation-with-natural-language%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f12%2f01%2fa-new-era-for-google-apps-script-unlocking-the-future-of-google-workspace-automation-with-natural-language%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2025/11/25/integrating-google-antigravity-unlocking-the-google-workspace-extension-for-gemini-cli/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2025/11/25/integrating-google-antigravity-unlocking-the-google-workspace-extension-for-gemini-cli/">Integrating Google Antigravity: Unlocking the Google Workspace Extension for Gemini CLI</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2025/12/03/power-of-google-apps-script-building-mcp-server-tools-for-gemini-cli-and-google-antigravity-in-google-workspace-automation/">Power of Google Apps Script: Building MCP Server Tools for Gemini CLI and Google Antigravity in Google Workspace Automation</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2025/12/03/power-of-google-apps-script-building-mcp-server-tools-for-gemini-cli-and-google-antigravity-in-google-workspace-automation/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

