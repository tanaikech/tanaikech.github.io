<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Accelerating Gemini CLI: A Node.js Wrapper for Google Apps Script MCP Servers &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>X</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Accelerating Gemini CLI: A Node.js Wrapper for Google Apps Script MCP Servers</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Sep 2025, 16:09</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/library">Library</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/model-context-protocol">Model Context Protocol</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/mcp">MCP</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/1d7f0090834431d03194e58ebffdb660">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20250917a/fig1.jpg" alt=""></p>
<h2 id="abstract">Abstract</h2>
<p>This article introduces a Node.js wrapper that dramatically reduces the startup time for the Gemini CLI when used with MCP servers built on Google Apps Script. This optimization enhances user experience by accelerating the initialization process, achieving a speed boost of approximately 15 times.</p>
<h2 id="1-introduction">1. Introduction</h2>
<p>The Model Context Protocol (MCP) is a vital open standard enabling AI agents to connect with external tools and data sources for complex, real-world tasks. To integrate the Gemini AI agent with Google Workspace, I developed two open-source tools: <a href="https://github.com/tanaikech/MCPApp">MCPApp</a>, for managing the MCP server lifecycle, and <a href="https://github.com/tanaikech/ToolsForMCPServer">ToolsForMCPServer</a>, a suite of tools for interacting with services like Gmail and Drive. These are built with Google Apps Script for use with the <a href="https://github.com/google-gemini/gemini-cli">Gemini CLI</a>.</p>
<p>A significant bottleneck with this setup was the slow startup speed of the Gemini CLI, which often took around 30 seconds to launch. This article presents a new approach using a Node.js wrapper to resolve this performance issue, resulting in a 15-fold reduction in startup time and making the integration far more efficient.</p>
<h2 id="2-the-problem-slow-startup-with-google-apps-script">2. The Problem: Slow Startup with Google Apps Script</h2>
<p>It is considered that the delay in launching the Gemini CLI stems from its synchronous initialization process and the latency at the Google Apps Script Web Apps side. When the CLI starts, it makes a series of blocking HTTP requests to the Google Apps Script Web App to load the MCP server&rsquo;s tools and prompts.</p>
<p>The typical startup flow involves these steps:</p>
<p><img src="https://tanaikech.github.io/image-storage/20250917a/fig2.jpg" alt=""></p>
<p><a href="https://mermaidchart.com/play?utm_source=mermaid_live_editor&amp;utm_medium=share#pako:eNqtU09PwjAU_yrNO8PYurmtPXDBxJhgYjRezC7NVqCRtbPtjEL47r6BTJQQibrT3svvb9quoTSVBA5OPrdSl_JSibkVdaEJfo2wXpWqEdqTByft8fZK1kqryfSaCPcxEJyOgTeT23tpX6TtgDiQ3VToHbRTH47HvRwnUUDuWn2k2SMQ3WtyQhHdNXCeFFBLvzBVAbwAxHollmolC9gJ9KThV7-4U_Ct1WRmTb2N6D4ifvc9YCUnfLXxaqZK4ZXRbvSZotrHONHj4s890l_1yP65R35Cr8FMjXejpXL-pybs_CYHzlF4wtobszzPOIrOdUZed3ORghdwKlpdLg5uLAxgblUF3NtWDjCLrUU3wrrTwUQLWeN5cvythH3qYm2Qg-_l0Zh6T7OmnS-Az8TS4dQ2lfD7V9pvrdSVtBPTag-chulWBPgaXoHHMQ0oi_MsSVMWJzTPBvCG6yBJYspymsUsTRKWbAaw2tqGAUtzRmmY5WnIkJVu3gE8r1Uh">Mermaid Chart Playground</a></p>
<p>Each request to the Google Apps Script server (steps 2, 5, 8, and 10) introduces a delay, leading to the slow overall startup time.</p>
<h2 id="3-the-solution-a-nodejs-wrapper">3. The Solution: A Node.js Wrapper</h2>
<p>To accelerate the startup, a new approach was developed using a local Node.js wrapper. This wrapper acts as an intermediary MCP server that communicates with the Gemini CLI via standard I/O (stdio), which is significantly faster than HTTP requests.</p>
<p><strong>With the new approach, the initialization process (steps 2-11) runs asynchronously on the local machine.</strong> The Node.js server handles the initial handshake with the Gemini CLI almost instantly. It only makes an HTTP request to the Google Apps Script Web App when a tool is actually executed.</p>
<p><strong>Flow when using a tool:</strong></p>
<ol>
<li>Gemini CLI sends a <code>&quot;method&quot;:&quot;tools/call&quot;</code> request to the local Node.js wrapper via stdio.</li>
<li>The Node.js wrapper makes an HTTP request to the Google Apps Script Web App.</li>
<li>The result is returned from the Web App to the Gemini CLI through the Node.js wrapper.</li>
</ol>
<p>This change means the startup is fast, and the overhead of an HTTP request is only incurred during tool execution, which is a much more acceptable user experience.</p>
<h2 id="4-usage-guide">4. Usage Guide</h2>
<p>Follow these steps to set up and test the performance improvement.</p>
<h3 id="step-1-install-gemini-cli">Step 1: Install Gemini CLI</h3>
<p>First, ensure you have the Gemini CLI installed.</p>
<ul>
<li><strong>Installation Guide:</strong> <a href="https://github.com/google-gemini/gemini-cli">https://github.com/google-gemini/gemini-cli</a></li>
</ul>
<h3 id="step-2-deploy-google-apps-script-mcp-server">Step 2: Deploy Google Apps Script MCP Server</h3>
<p>Next, deploy the MCP server using Google Apps Script.</p>
<ul>
<li><strong>Setup Instructions:</strong> <a href="https://github.com/tanaikech/ToolsForMCPServer?tab=readme-ov-file#usage">https://github.com/tanaikech/ToolsForMCPServer?tab=readme-ov-file#usage</a></li>
</ul>
<h3 id="step-3-test-the-original-slow-approach">Step 3: Test the Original (Slow) Approach</h3>
<p>To experience the baseline performance, configure the Gemini CLI to connect directly to your deployed Web App.</p>
<p>Modify your <code>settings.json</code> file with the following, replacing the URL with your own:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;theme&#34;</span>: <span style="color:#e6db74">&#34;Default&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;selectedAuthType&#34;</span>: <span style="color:#e6db74">&#34;### your setting ###&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;mcpServers&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;gas_web_apps&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;command&#34;</span>: <span style="color:#e6db74">&#34;npx&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;args&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mcp-remote&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;https://script.google.com/macros/s/###/exec?accessKey=sample&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;env&#34;</span>: {}
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Run <code>$ gemini</code> and note the slow startup speed. You can verify the tools are loaded with the <code>/mcp</code> command.</p>
<h3 id="step-4-test-the-new-fast-approach">Step 4: Test the New (Fast) Approach</h3>
<p>Now, implement the Node.js wrapper to accelerate the startup.</p>
<ol>
<li>Create a new workspace directory and navigate into it.</li>
<li>Install the necessary libraries: <code>npm install @modelcontextprotocol/sdk zod@3</code>.</li>
<li>Download the two required script files <code>wrapped_gas_web_apps.js</code> and <code>tools.js</code> from <a href="https://github.com/tanaikech/ToolsForMCPServer/tree/master/Wrapper_for_reduce_load_time_of_MCP">my repository</a>.</li>
<li>Modify <code>settings.json</code> to use the Node.js wrapper. Replace <code>{your path}</code> with the absolute path to <code>wrapped_gas_web_apps.js</code>.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;theme&#34;</span>: <span style="color:#e6db74">&#34;Default&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;selectedAuthType&#34;</span>: <span style="color:#e6db74">&#34;### your setting ###&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;mcpServers&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;wrapped_gas_web_apps&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;command&#34;</span>: <span style="color:#e6db74">&#34;node&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;args&#34;</span>: [<span style="color:#e6db74">&#34;{your path}/wrapped_gas_web_apps.js&#34;</span>]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Run <code>$ gemini</code> again. You should observe a significantly faster startup. In my tests, the startup time was reduced by approximately 15 times. While the performance of individual tool execution remains the same, the improved startup time makes the CLI much more practical and user-friendly.</p>
<h2 id="5-summary">5. Summary</h2>
<p>Here are the key takeaways from this new approach:</p>
<ul>
<li><strong>Problem:</strong> The Gemini CLI&rsquo;s synchronous HTTP requests to Google Apps Script MCP servers cause slow startup times of around 30 seconds.</li>
<li><strong>Solution:</strong> A local Node.js wrapper is used to handle the CLI&rsquo;s initialization process via fast stdio transport.</li>
<li><strong>Performance:</strong> The new approach reduces the startup time by approximately 15 times, dramatically improving the user experience.</li>
<li><strong>Mechanism:</strong> The Node.js wrapper only makes HTTP requests to the Google Apps Script server when a tool is executed, not during the initial launch.</li>
<li><strong>Impact:</strong> This optimization makes the integration of Gemini CLI with Google Workspace tools more efficient and practical for daily use.</li>
</ul>
<h2 id="6-additional-information">6. Additional information</h2>
<ul>
<li>In this approach, by changing <code>mcpServers</code> of <code>settings.json</code> between the original approach and the new approach, you can switch the approach method.</li>
<li>When this wrapper is used, an additional advantage is that requests made from Node.js to Google Apps Script Web Apps can run with an access token. Specifically, you can access Web Apps using an access token retrieved by OAuth2 and a service account. This will lead to highly secure access.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2025%2f09%2f17%2faccelerating-gemini-cli-a-node.js-wrapper-for-google-apps-script-mcp-servers%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2025%2f09%2f17%2faccelerating-gemini-cli-a-node.js-wrapper-for-google-apps-script-mcp-servers%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f09%2f17%2faccelerating-gemini-cli-a-node.js-wrapper-for-google-apps-script-mcp-servers%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2025%2f09%2f17%2faccelerating-gemini-cli-a-node.js-wrapper-for-google-apps-script-mcp-servers%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f09%2f17%2faccelerating-gemini-cli-a-node.js-wrapper-for-google-apps-script-mcp-servers%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f09%2f17%2faccelerating-gemini-cli-a-node.js-wrapper-for-google-apps-script-mcp-servers%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2025/09/15/updated-gas-library-toolsformcpserver/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2025/09/15/updated-gas-library-toolsformcpserver/">Updated: GAS Library - ToolsForMCPServer</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

