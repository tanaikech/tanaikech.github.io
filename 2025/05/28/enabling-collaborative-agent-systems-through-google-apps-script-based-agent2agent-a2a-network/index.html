<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="Official profile of Kanshi Tanaike, a Google Developer Expert (GDE) in Google Workspace and Physicist. Specializing in Google Apps Script, Gemini API, and innovative IT solutions.">
  <meta name="generator" content="Hugo 0.98.0" />

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tanaikech.github.io/img/og-main.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>tanaike - Google Apps Script, Gemini API Expert & Physicist</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Kanshi Tanaike",
  "alternateName": "tanaike",
  "url": "https://tanaikech.github.io/",
  "image": "https://tanaikech.github.io/img/og-main.png",
  "jobTitle": "Google Developer Expert",
  "honorificPrefix": "Ph.D.",
  "description": "Japanese scientist, Physicist and Google Developer Expert for Google Workspace.",
  "award": "First place in the Outstanding GDE Award 2025",
  "sameAs": [
    "https://twitter.com/tanaikech",
    "https://github.com/tanaikech",
    "https://stackoverflow.com/users/7108653/tanaike",
    "https://developers.google.com/community/experts/directory?text=tanaike",
    "https://zenn.dev/tanaike",
    "https://medium.com/@tanaike"
  ]
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://www.youtube.com/@tanaike" rel="me" target="_blank"><i class="fab fa-youtube-square fa-fw"></i>YouTube</a>
    </li>
    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2026. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Enabling Collaborative Agent Systems through Google Apps Script-based Agent2Agent (A2A) Network</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>28 May 2025, 09:49</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/agent2agent">agent2agent</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/a2a">A2A</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/0dcee0009d8037262b60c8723283e9a5">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20250528a/fig1.jpg" alt=""></p>
<h1 id="abstract">Abstract</h1>
<p>This report details the Agent2Agent (A2A) network built with Google Apps Script&rsquo;s Web Apps. It facilitates communication between diverse AI agents, overcoming platform limitations. Key improvements include parallel task execution with asynchronous processes and enhanced security through secure access token handling and user-specific Web App availability, demonstrating a robust and secure A2A implementation.</p>
<h1 id="introduction">Introduction</h1>
<p>This report details an updated implementation of <strong>Agent2Agent (A2A)</strong>, an open protocol designed to enable communication and collaboration between diverse AI agents. The goal of A2A is to overcome limitations of isolated platforms, allowing AI agents to work together on complex tasks while maintaining their internal structures. I recently published a report titled &ldquo;Building Agent2Agent (A2A) Server with Google Apps Script&rdquo;. <a href="https://medium.com/google-cloud/building-agent2agent-a2a-server-with-google-apps-script-d3efd32c7ca7">Ref</a> This updated report focuses on successfully creating an <strong>A2A network</strong> using <strong>Google Apps Script&rsquo;s Web Apps functionality</strong>.</p>
<p>The new implementation leverages Google Apps Script to facilitate a decentralized and interoperable AI agent ecosystem. Key improvements include the use of the <strong>fetchAll</strong> method, which retrieves agent cards and executes tasks in parallel, reducing processing costs. Enhanced security is achieved through the ease of seamlessly obtaining and using access tokens in Google Apps Script, allowing secure access to agents in Web Apps. This resolves a previous issue where access tokens were temporarily placed in query parameters, like my previous report. Additionally, Web Apps can now be made available only to specific users, further improving security. This advancement demonstrates the practical application of Google Apps Script in building a robust and secure A2A network.</p>
<h1 id="advantages-of-using-a2a-server-and-client-with-google-apps-script">Advantages of Using A2A Server and Client with Google Apps Script</h1>
<p>Here are the advantages of using an A2A (Agent-to-Agent) server and client with Google Apps Script:</p>
<ul>
<li><strong>Integration with Google Workspace</strong>: It allows direct management of active Google Docs and Sheets when using the A2A client.</li>
<li><strong>Seamless Integration with Google Resources</strong>: Effortlessly connects with Google services like Google APIs, Docs, Sheets, Slides, Gmail, and Calendar, leveraging secure authorization scopes.</li>
<li><strong>Enhanced Security via Access Tokens</strong>: Simplifies access token acquisition for Web Apps, eliminating the need for temporary token inclusion in Python client queries for agent card retrieval.</li>
<li><strong>Improved User Restriction</strong>: Web Apps can be restricted to specific users, increasing security.</li>
<li><strong>Automated Script Execution</strong>: Supports automatic script execution via triggers, beneficial for client-side operations. This client can interact with various A2A servers (Google Apps Script, Python, Node.js, etc.).</li>
<li><strong>Easy Deployment</strong>: Web Apps can be readily deployed as A2A servers, accessible by various A2A clients (Google Apps Script, Python, Node.js, etc.).</li>
<li><strong>Decentralized Agent Communication</strong>: Enables direct communication between AI agents, fostering a decentralized AI ecosystem.</li>
</ul>
<h1 id="repository">Repository</h1>
<p><a href="https://github.com/tanaikech/A2AApp">https://github.com/tanaikech/A2AApp</a></p>
<h1 id="usage">Usage</h1>
<p>Here, the following sample is used for testing.</p>
<p><img src="https://tanaikech.github.io/image-storage/20250528a/fig2.jpg" alt=""></p>
<p>Please do the following steps.</p>
<h2 id="1-ger-api-key">1. Ger API key</h2>
<p>In order to use the scripts in this report, please use your API key. <a href="https://ai.google.dev/gemini-api/docs/api-key">Ref</a> This API key is used to access the Gemini API.</p>
<h2 id="2-copy-sample-files">2. Copy sample files</h2>
<p>Here, an A2A client and 4 A2A servers are used. Those files can be copied by the following simple Google Apps Script. Please copy and paste the following script to the script editor of Google Apps Script, and run <code>myFunction</code>. By this, the requirement files are copied to your Google Drive. The whole scripts can also be seen on <a href="https://github.com/tanaikech/A2AApp">this repository</a>.</p>
<p>When <code>dstFolder</code> is <code>root</code>, the files are copied to the root folder. If you want to copy them to the specific folder, please set your folder ID.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">dstFolderId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;root&#34;</span>; <span style="color:#75715e">// Please set your destination folder ID. The default is the root folder.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// These file IDs are the sample client and servers.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fileIds</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;1IcUv4yQtlzbiAqRXCEpIfilFRaY4_RS5idKEEdzNWgk&#34;</span>, <span style="color:#75715e">// A2A client,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#34;103RvSs0xWgblNHqEssVMo-ar7Ae8Fe-NyUsyL1m4k0u428hB7v7Jmnby&#34;</span>, <span style="color:#75715e">// A2A server 1_Google Sheets Manager Agent
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#34;1z8bDFo8n4ssco8UeBXatLp3yMPUVkbqEofZE8y1-XYstEqYiGifvVSwf&#34;</span>, <span style="color:#75715e">// A2A server 2_Google Drive Manager Agent,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#34;1FltchXoOfbo731KAWJd0hGbrN75aZ_lg76og-ooldk5B-uAE142RppWa&#34;</span>, <span style="color:#75715e">// A2A server 3_Google Calendar Manager Agent,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#34;1k3-JwyKBJ2DsGeWeT0dTucdzm0DHSd_1XlaevFA4_pJhGL67vDRYD0ym&#34;</span>, <span style="color:#75715e">// A2A server 4_APIs Manager Agent,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  ];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">folder</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFolderById</span>(<span style="color:#a6e22e">dstFolderId</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">headers</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">authorization</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Bearer &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">getOAuthToken</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Content-Type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json&#34;</span>,
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">reqs</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">fileIds</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">fileId</span>) =&gt; ({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">url</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`https://www.googleapis.com/drive/v3/files/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">fileId</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/copy`</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">headers</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">payload</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">parents</span><span style="color:#f92672">:</span> [<span style="color:#a6e22e">dstFolderId</span>],
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">fileId</span>).<span style="color:#a6e22e">getName</span>(),
</span></span><span style="display:flex;"><span>    }),
</span></span><span style="display:flex;"><span>  }));
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetchAll</span>(<span style="color:#a6e22e">reqs</span>).<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">id</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">getContentText</span>());
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">moveTo</span>(<span style="color:#a6e22e">folder</span>);
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//  If an error is related to Drive API, please enable Drive API v3 at Advanced Google services.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p>When this function is run, the following files are copied.</p>
<ul>
<li>&ldquo;A2A client&rdquo;</li>
<li>&ldquo;A2A server 1_Google Sheets Manager Agent&rdquo;</li>
<li>&ldquo;A2A server 2_Google Drive Manager Agent,&rdquo;</li>
<li>&ldquo;A2A server 3_Google Calendar Manager Agent&rdquo;</li>
<li>&ldquo;A2A server 4_APIs Manager Agent&rdquo;</li>
</ul>
<h2 id="2-setting">2. Setting</h2>
<h3 id="1-a2a-servers">1. A2A servers</h3>
<p>For 4 A2A servers, please follow the following steps.</p>
<h4 id="1-set-api-key">1. Set API key</h4>
<p>Open the script editors of &ldquo;A2A server 1&rdquo;, &ldquo;A2A server 2&rdquo;, &ldquo;A2A server 3&rdquo;, and &ldquo;A2A server 4&rdquo;. And, please set your API key for using the Gemini API to <code>apiKey</code> in <code>A2Aserver1.gs</code>, <code>A2Aserver2.gs</code>, <code>A2Aserver3.gs</code>, and <code>A2Aserver4.gs</code>.</p>
<h4 id="2-deploy-web-apps">2. Deploy Web Apps</h4>
<p>To allow access from the A2A client, the server side uses Web Apps built with Google Apps Script. <a href="https://developers.google.com/apps-script/guides/web">Ref</a> The A2A client can access the A2A server using a GET and POST HTTP request. Thus, the Web Apps can be used as the A2A server.</p>
<p>Detailed information can be found in <a href="https://developers.google.com/apps-script/guides/web#deploy_a_script_as_a_web_app">the official documentation</a>.</p>
<p>Please follow these steps to deploy the Web App in the script editors for 4 A2A servers.</p>
<ol>
<li>In the script editor, at the top right, click &ldquo;Deploy&rdquo; -&gt; &ldquo;New deployment&rdquo;.</li>
<li>Click &ldquo;Select type&rdquo; -&gt; &ldquo;Web App&rdquo;.</li>
<li>Enter the information about the Web App in the fields under &ldquo;Deployment configuration&rdquo;.</li>
<li>Select <strong>&ldquo;Me&rdquo;</strong> for <strong>&ldquo;Execute as&rdquo;</strong>.</li>
<li>Select <strong>&ldquo;Anyone&rdquo;</strong> for <strong>&ldquo;Who has access to the app:&rdquo;</strong>. In this sample, a simple approach allows requests without an access token. However, a custom API key is used for accessing the Web App.</li>
<li>Click &ldquo;Deploy&rdquo;.</li>
<li>On the script editor, at the top right, click &ldquo;Deploy&rdquo; -&gt; &ldquo;Test deployments&rdquo;.</li>
<li>Please run the function <code>getServerURL</code> with the script editor. By this, the URL like <code> https://script.google.com/macros/s/###/dev?accessKey=sample</code> is retrieved. Please copy each Web Apps URL for 4 A2A servers.</li>
</ol>
<p><strong>It is important to note that when you modify the Google Apps Script for the Web App, you must modify the deployment as a new version.</strong> This ensures the modified script is reflected in the Web App. Please be careful about this. Also, you can find more details on this in my report &ldquo;<a href="https://gist.github.com/tanaikech/ebf92d8f427d02d53989d6c3464a9c43">Redeploying Web Apps without Changing URL of Web Apps for new IDE</a>&rdquo;.</p>
<p>In this sample, after the client with Google Apps Script was tested, the servers will be tested by a Python script. So, <code>Execute as: Me</code> and <code>Who has access to the app: Anyone</code> are used.</p>
<h3 id="2-a2a-client">2. A2A client</h3>
<p>For the A2A client, please follow the following steps.</p>
<h4 id="1-set-api-key-1">1. Set API key</h4>
<p>Open the Google Spreadsheet of &ldquo;A2A client&rdquo;, and open the script editor of Google Apps Script. And, please set your API key for using Gemini API to <code>apiKey</code> in <code>main.gs</code>.</p>
<h4 id="2-set-web-apps-urls">2. Set Web Apps URLs</h4>
<p>Please set your Web Apps URLs for 4 A2A servers to <code>agentCardUrls</code>. And, save the script. In this sample, 4 Web Apps URLs are set.</p>
<h2 id="3-testing">3. Testing</h2>
<p>Please reopen the Google Spreadsheet of the A2A client. By this, you can see the custom menu <code>Run</code>. Please run <code>Open sidebar</code>. When you see the authorization dialog open, please authorize all scopes. By this, the sidebar is opened. When the above steps were correctly done, you can test it. The demonstration of this is as follows.</p>
<h3 id="sample-1">Sample 1</h3>
<p>In the 1st sample, the active Spreadsheet is used.</p>
<p><img src="https://tanaikech.github.io/image-storage/20250528a/fig3.gif" alt=""></p>
<p>First, the value of the active cell is retrieved.</p>
<p>Prompt: <strong>Get the active cells. Return the values from the active cells.</strong>
Response: <strong>The active cell is B2 in Sheet1 of the spreadsheet with ID ###. The value of this cell is &ldquo;sample text&rdquo;</strong></p>
<p>Next, the values are put into the active cell.</p>
<p>Prompt: <strong>Get the active cells. Put values &lsquo;[[&ldquo;a1&rdquo;, &ldquo;b1&rdquo;],[&ldquo;a2&rdquo;, &ldquo;b2&rdquo;],[&ldquo;a3&rdquo;, &ldquo;b3&rdquo;]]&rsquo; to the active cell.
Response: The active cell is A5 in Sheet1 of the spreadsheet with ID ###. The values &lsquo;[[&quot;a1&quot;, &quot;b1&quot;],[&quot;a2&quot;, &quot;b2&quot;],[&quot;a3&quot;, &quot;b3&quot;]]&rsquo; have been successfully placed into cells A5:B7 of the same sheet and spreadsheet.</strong></p>
<p>The information of the active cell is retrieved on the A2A client, and the information is used in the A2A server (Google Sheets Manager Agent). This result indicates the advantage of using the A2A client built by Google Apps Script.</p>
<h3 id="sample-2">Sample 2</h3>
<p>In the 2nd sample, image data is retrieved from Google Drive.</p>
<p><img src="https://tanaikech.github.io/image-storage/20250528a/fig4.gif" alt=""></p>
<p>Prompt: <strong>Show the image of CherryBlossom from Google Drive.</strong>
Response: <strong>OK. I have downloaded the image &quot;CherryBlossom.png&quot; from Google Drive.</strong></p>
<h3 id="sample-3">Sample 3</h3>
<p>In the 3rd sample, multiple agents are used.</p>
<p><img src="https://tanaikech.github.io/image-storage/20250528a/fig5.gif" alt=""></p>
<p>Prompt: <strong>Check tomorrow&rsquo;s weather conditions at 12 PM around Shinagawa Station and exchange 100 US Dollars for Japanese Yen. Under this condition, will we enjoy eating lunch outside for 1 hour at the retrieved location and that day? Finally, create it as a schedule in Google Calendar.</strong></p>
<p>Response: <strong>OK. Here&rsquo;s a summary based on your question and the provided answers: The weather in Shinagawa Station at 12 PM on May 28, 2025, is predicted to be mainly clear, partly cloudy, and overcast. The exchange rate is 100 USD to approximately 14,290 JPY. A Google Calendar event titled &lsquo;Lunch at Shinagawa Station&rsquo; has been created for May 28, 2025, from 12:00 to 13:00, including the weather conditions and JPY value in the description. To determine if eating lunch outside for an hour is suitable, factors like temperature, wind, and personal preferences should be considered along with the mainly clear, partly cloudy, and overcast conditions.</strong></p>
<p>This process automatically creates an event in Google Calendar as follows.</p>
<p><img src="https://tanaikech.github.io/image-storage/20250528a/fig6.png" alt=""></p>
<p>In this case, this response was created using &ldquo;create_schedule_to_Google_Calendar&rdquo; of &ldquo;Google Calendar Manager Agent&rdquo; and &ldquo;get_exchange_rate&rdquo; and &ldquo;get_current_weather&rdquo; of &ldquo;APIs Manager Agent&rdquo; together with the A2A client. Also, an event was automatically created in Google Calendar. From this result, you can confirm that AI agents are working together.</p>
<h1 id="summary">Summary</h1>
<p>The successful communication between the A2A client and A2A servers, both developed using Google Apps Script, demonstrates the viability of building such a system within the Google ecosystem. This setup leverages the power of active Google services like Google Sheets and Google Docs, enhancing their utility through the A2A client.</p>
<p>A key proposed enhancement for this system is the implementation of an exclusive server that would centralize and provide the URLs of all A2A servers to clients. This approach would enable more efficient management of A2A servers on a per-client basis. Furthermore, it suggests the potential for an A2A server designed to manage Gmail, facilitating automated tasks such as autoreplies and Google Calendar event creation by periodically reading incoming emails.</p>
<h1 id="additional-information-testing-a2a-client-with-python-using-a2a-servers-built-by-google-apps-script">Additional Information: Testing A2A Client with Python Using A2A Servers Built by Google Apps Script</h1>
<p>The 4 A2A servers built by Google Apps Script, shown in the image above, can also be used with Google&rsquo;s Python demo UI, as shown in the following demo video. <a href="https://github.com/google-a2a/">Ref</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20250528a/fig7.gif" alt=""></p>
<p>The detailed setting of the Python client can be seen at <a href="https://github.com/tanaikech/A2AApp">my repository</a>.</p>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2025%2f05%2f28%2fenabling-collaborative-agent-systems-through-google-apps-script-based-agent2agent-a2a-network%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2025%2f05%2f28%2fenabling-collaborative-agent-systems-through-google-apps-script-based-agent2agent-a2a-network%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f05%2f28%2fenabling-collaborative-agent-systems-through-google-apps-script-based-agent2agent-a2a-network%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2025%2f05%2f28%2fenabling-collaborative-agent-systems-through-google-apps-script-based-agent2agent-a2a-network%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f05%2f28%2fenabling-collaborative-agent-systems-through-google-apps-script-based-agent2agent-a2a-network%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f05%2f28%2fenabling-collaborative-agent-systems-through-google-apps-script-based-agent2agent-a2a-network%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2025/05/21/updated-gas-library-geminiwithfiles/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2025/05/21/updated-gas-library-geminiwithfiles/">Updated: GAS Library - GeminiWithFiles</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2025/05/29/updated-gas-library-a2aapp/">Updated: GAS Library - A2AApp</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2025/05/29/updated-gas-library-a2aapp/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

