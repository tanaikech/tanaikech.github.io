<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>A Fake-Sandbox for Google Apps Script: A Feasibility Study on Securely Executing Code Generated by Gemini CLI &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>A Fake-Sandbox for Google Apps Script: A Feasibility Study on Securely Executing Code Generated by Gemini CLI</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Aug 2025, 16:31</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/nodetips">NodeTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/node.js">Node.js</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/0896697c24cf4b9e1b1038303cf734ae">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20250830a/fig1.jpg" alt=""></p>
<h2 id="abstract">Abstract</h2>
<p>Generating Google Apps Script (GAS) with Gemini CLI from natural language introduces security risks due to broad permissions. This report investigates a &ldquo;Fake-Sandbox&rdquo; using the <code>gas-fakes</code> library, translating GAS calls into granularly-scoped API requests to securely execute scripts created from user prompts.</p>
<h2 id="introduction">Introduction</h2>
<h3 id="1-background-generative-ai-and-the-challenge-of-secure-script-execution">1. Background: Generative AI and the Challenge of Secure Script Execution</h3>
<p>The emergence of Generative AI now makes it possible to generate executable scripts directly from natural language instructions, particularly through interfaces like the <strong>Gemini CLI</strong>. For locally executable languages such as JavaScript (Node.js) and Python, code generated from a simple prompt can be run directly. However, Google Apps Script (GAS) presents a unique challenge as it operates within Google&rsquo;s server-side infrastructure. Executing locally generated GAS code requires the remote invocation of a server-side function via the <code>scripts.run</code> method of the Apps Script API. This process highlights the critical need for a <strong>sandbox environment</strong> to manage permissions effectively and mitigate the risks associated with executing code generated from natural language, which can sometimes produce unintended or insecure outcomes.</p>
<h3 id="2-existing-sandbox-strategies-and-their-inherent-limitations">2. Existing Sandbox Strategies and Their Inherent Limitations</h3>
<p>Implementing a sandbox—an isolated, secure environment for code execution—for Google Apps Script involves several potential strategies, each with significant drawbacks:</p>
<ul>
<li>
<p><strong>Dedicated Execution Accounts:</strong> A highly secure method involves creating a dedicated Google account solely for script execution. This approach effectively contains any potential impact within the confines of that account. However, the administrative overhead and cost associated with managing numerous accounts render this solution impractical for large-scale deployments.</p>
</li>
<li>
<p><strong>Service Accounts:</strong> While service accounts are a standard for programmatic authentication within Google Cloud, they are not currently permitted to directly execute GAS functions through the Apps Script API, making this a non-viable option.</p>
</li>
<li>
<p><strong>Permission Scoping with OAuth:</strong> A more promising strategy involves restricting permissions using OAuth scopes. The <code>https://www.googleapis.com/auth/drive.file</code> scope is particularly appealing, as it limits an application&rsquo;s access to only those files it creates or that a user explicitly opens with that application. This approach, however, introduces a fundamental trade-off. Core GAS services, such as <code>SpreadsheetApp</code>, often require broad scopes (e.g., <code>https://www.googleapis.com/auth/spreadsheets</code>) that grant access to all of a user&rsquo;s spreadsheets. This conflict between granular permissions and the requirements of high-level GAS services makes it difficult to adhere to the principle of least privilege.</p>
</li>
<li>
<p><strong>Execution Interception:</strong> In theory, a wrapper script could intercept the execution of a Google Apps Script to enforce restrictions on specific files and methods. By doing so, it would be possible to run the script in a more controlled manner. However, no such mechanism for intercepting and sandboxing GAS execution currently exists.</p>
</li>
</ul>
<h3 id="3-a-novel-approach-a-fake-sandbox-with-gas-fakes">3. A Novel Approach: A Fake-Sandbox with <code>gas-fakes</code></h3>
<p>The Node.js package <code>gas-fakes</code>, developed by Bruce McPherson, offers a potential solution to this dilemma. This library functions as a local runtime environment for GAS, translating calls to standard GAS services (e.g., <code>SpreadsheetApp.openById(&quot;###&quot;)</code>) into their equivalent Google API requests (e.g., Google Sheets API). This abstraction allows developers to write scripts using familiar GAS syntax while the underlying operations are executed via Google APIs that support more granular permission controls.</p>
<p>This mechanism makes it possible to operate on a specific spreadsheet using standard GAS methods while restricting access to designated files and methods. This approach effectively decouples the developer experience from the underlying permission model, combining <strong>the security benefits of fine-grained permissions with the development efficiency of native GAS services</strong>. This capability suggests its potential as a <strong>&ldquo;Fake-Sandbox&rdquo;</strong> for executing code generated from natural language with tightly controlled access.</p>
<h3 id="4-objective-of-this-report">4. Objective of This Report</h3>
<p>This report aims to examine the feasibility of constructing this <strong>Fake-Sandbox</strong> environment for Google Apps Script. We will investigate the use of the <code>gas-fakes</code> library as a means to safely execute scripts generated from natural language prompts using <strong>Gemini CLI</strong> by intercepting and managing their execution. While <code>gas-fakes</code> does not yet have comprehensive coverage of all GAS classes and methods, our preliminary findings suggest that this approach represents a promising pathway toward secure and scalable automation with Google Apps Script.</p>
<h2 id="conceptual-workflow">Conceptual Workflow</h2>
<p>The following diagram illustrates the process of executing a Google Apps Script generated by the Gemini CLI within the fake-sandbox environment:</p>
<p><img src="https://tanaikech.github.io/image-storage/20250830a/flow.png" alt=""></p>
<p><a href="https://mermaidchart.com/play?utm_source=mermaid_live_editor&amp;utm_medium=share#pako:eNp1Vdtu2zgQ_ZWBXuoADmvFd6ENkKRtkEXbLWrsLrAwkNLSWGYjkSxJee0N8u8dknLlXOonk5w553DmDHWf5KrAJEss_mhQ5vhO8NLweimBfpobJ3KhuXTwl0XzfPcaayHF7dXHG-C2XQGtnkd-VDmvfFD8815uhVGyRjrqfSYN7Ls9eQF_8cHnlNyervkdUrZYGW72L0TeXnyJIpQqKwRaWXizMq_Pe8hK1ofFBtFZv3_yYrbWR9n_KHNnNc8Jh_aPYdqAgEZAEcoX5_T8vKtGBimDL0ZtRUGiOWijau1ASJDcNYYKUHFZNrzECA7L5BoduA3CllcNwpoSIMeqgqvUpwU-uAS1hoU2yAsbNi6WSVTQUT_RccboTKLhDrvaaG1hkRtBknz_YcUtFqBkEBC1vgAbOpfBkMH7HeaNB_TxZQtfgI2QIuJUodHYNTpCBpQObcQOSlDyVUWYlstipXZQe2WxOt9iCOlmt7cr3PCtUIb5wEu1--Tj3oIzDX57TEHuyWDM4EZu1V3ow_XFAmp0G1UAhVSxzF5sKz3StYbp6uyJlUZ5ub8peq8YY69OWInuK_UQe7RsHUV8B9aJZ3VoctQulslTB05STWK5tFXoiTiwCukUScyVMWi1koWQ5ZGbwfgRte4RlTd9BlMGn8J0cAm8ITJJxg4d8XmBtLEeLTdY-ENe2e7qv-lTwO44Zgz-RiPWgmiOYfxtbE7FAY2mFtYKJe0zBK0zmD_xDeWQbSj8YDzHDRUVuNaVl-9PYmXa0QvtiN3SmJOUPE5I67cnk9kq0Pq0u0Q6YPAVaQBlxGlLSoUquOMHngAaxvDk-CKH1qbpExD-X9sf3zWL0Ptj8efn55ZIaRQ_KFPz1hCPcqj1tajpRvHG_hx3dEuvzTtHrb7TApShFE8Nbq-xo-jmKR0-VrcOjB6GuJrKeaagupHSWyIa_3huCMu_ZwRFs_lOWF3xfYslJDlFNU43zr9ER4PToja_vhJJPymNKJLMz2U_qckc3C-Te3--TCi6xmWS0d-Cmzv_jj1QDr3G_ypVH9KMaspNkq3JabRqNLXp8In6tWtQFmiuVCNdkqXDgJFk98kuySZjNjibjGazwWAwOksno36y9zETNhxO57Oz2TQdj8bzh37yfyAdsPlkOh6PR4PhdDAfpenk4Sd8rVZC">Mermaid Playground</a></p>
<h2 id="practical-implementation">Practical Implementation</h2>
<h3 id="1-install-gemini-cli">1. Install Gemini CLI</h3>
<p>Instructions for installing the Gemini CLI can be found at <a href="https://github.com/google-gemini/gemini-cli">https://github.com/google-gemini/gemini-cli</a>.</p>
<h4 id="gemini-cli-configuration">Gemini CLI Configuration</h4>
<p>To execute Google Apps Script within the fake-sandbox, you need to configure the Gemini CLI. Add the following text to the <code>GEMINI.md</code> file located in the <code>.gemini</code> directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># Generate and run Google Apps Script
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Generate the script by referring to the sample scripts at &#34;StackOverflow&#34; obtained using a Google search. If an error occurs, modify the script by referring to StackOverflow again.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In order to run the script of Google Apps Script, use &#34;@mcpher/gas-fakes&#34;. The base of the script is as follows: &#34;BaseScript&#34;. Google Apps Script is safely run in the sandbox. As additional information, in the current stage, gas-fakes cannot use `Logger.log`. So, please use `console.log` instead of it.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;BaseScript&gt;
</span></span><span style="display:flex;"><span>```javascript
</span></span><span style="display:flex;"><span>import &#34;@mcpher/gas-fakes/main.js&#34;
</span></span><span style="display:flex;"><span>ScriptApp.__behavior.sandBoxMode = true;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>//---
</span></span><span style="display:flex;"><span>// Generated Google Apps Script
</span></span><span style="display:flex;"><span>//---
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ScriptApp.__behavior.trash();
</span></span><span style="display:flex;"><span>```
</span></span><span style="display:flex;"><span>&lt;/BaseScript&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Please replace the comment lines in &#34;BaseScript&#34; with the generated Google Apps Script. And, run the script by `node [filename.js]`.
</span></span></code></pre></div><p>The prompt <code>Generate the script by referring to the sample scripts at &quot;StackOverflow&quot; obtained using a Google search.</code> is included to guide Gemini towards generating code that uses current and effective methods.</p>
<h3 id="2-install-gas-fakes">2. Install gas-fakes</h3>
<p>You can find instructions for installing <code>gas-fakes</code> at <a href="https://github.com/brucemcpherson/gas-fakes">https://github.com/brucemcpherson/gas-fakes</a>.</p>
<h3 id="3-example-use-cases">3. Example Use Cases</h3>
<p>Run the Gemini CLI by entering <code>$ gemini</code> in your terminal.</p>
<h4 id="example-1-create-spreadsheet-and-populate-with-values">Example 1: Create Spreadsheet and Populate with Values</h4>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Create the following application using Google Apps Script and run the script.
</span></span><span style="display:flex;"><span>1. Create a new Google Spreadsheet as &#34;temp spreadsheet&#34;.
</span></span><span style="display:flex;"><span>2. Insert a new sheet as &#34;temp&#34; to the created Spreadsheet.
</span></span><span style="display:flex;"><span>3. Put a value of `[[&#34;header1&#34;, &#34;header2&#34;, &#34;header3&#34;], [&#34;a2&#34;, &#34;b2&#34;,&#34;c2&#34;]]` into the &#34;temp&#34; sheet.
</span></span></code></pre></div><p><strong>Result:</strong>
The Gemini CLI will generate and execute a script that safely performs these actions within the fake-sandbox.</p>
<p><img src="https://tanaikech.github.io/image-storage/20250830a/fig2.jpg" alt=""></p>
<p>The generated script is as follows. The core logic within the <code>createAndPopulateSpreadsheet</code> function is also compatible with the standard Google Apps Script editor.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#34;@mcpher/gas-fakes/main.js&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">__behavior</span>.<span style="color:#a6e22e">sandBoxMode</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//---
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// Generated Google Apps Script
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//---
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">createAndPopulateSpreadsheet</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 1. Create a new Google Spreadsheet as &#34;temp spreadsheet&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">create</span>(<span style="color:#e6db74">&#34;temp spreadsheet&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Spreadsheet created: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getName</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74"> (ID: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getId</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">)`</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 2. Insert a new sheet as &#34;temp&#34; to the created Spreadsheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// Get the default sheet and rename it, or create a new one and delete the default.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// Let&#39;s create a new one and delete the default for clarity.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tempSheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">insertSheet</span>(<span style="color:#e6db74">&#34;temp&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Created new sheet: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">tempSheet</span>.<span style="color:#a6e22e">getName</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Delete the default &#34;Sheet1&#34; if it exists
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">defaultSheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#e6db74">&#34;Sheet1&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">defaultSheet</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">deleteSheet</span>(<span style="color:#a6e22e">defaultSheet</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Deleted default &#39;Sheet1&#39;.&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 3. Put a value of [[&#34;header1&#34;, &#34;header2&#34;, &#34;header3&#34;], [&#34;a2&#34;, &#34;b2&#34;,&#34;c2&#34;]] into the &#34;temp&#34; sheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    [<span style="color:#e6db74">&#34;header1&#34;</span>, <span style="color:#e6db74">&#34;header2&#34;</span>, <span style="color:#e6db74">&#34;header3&#34;</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#e6db74">&#34;a2&#34;</span>, <span style="color:#e6db74">&#34;b2&#34;</span>, <span style="color:#e6db74">&#34;c2&#34;</span>],
</span></span><span style="display:flex;"><span>  ];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tempSheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">length</span>, <span style="color:#a6e22e">data</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">length</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">data</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Values have been added to the &#39;temp&#39; sheet.&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`URL: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getUrl</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">createAndPopulateSpreadsheet</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">__behavior</span>.<span style="color:#a6e22e">trash</span>();
</span></span></code></pre></div><h4 id="example-2-create-spreadsheet-and-move-to-a-folder">Example 2: Create Spreadsheet and Move to a Folder</h4>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Create the following application using Google Apps Script and run the script.
</span></span><span style="display:flex;"><span>1. Create a new Google Spreadsheet as &#34;temp spreadsheet&#34;.
</span></span><span style="display:flex;"><span>2. Create a new folder of &#34;tempFolder&#34;.
</span></span><span style="display:flex;"><span>3. Move the Spreadsheet to the folder.
</span></span></code></pre></div><p><strong>Result:</strong>
The script is generated and executed securely, demonstrating file and folder manipulation.</p>
<p><img src="https://tanaikech.github.io/image-storage/20250830a/fig3.jpg" alt=""></p>
<p>The generated script can also be used in the Google Apps Script editor.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#34;@mcpher/gas-fakes/main.js&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">__behavior</span>.<span style="color:#a6e22e">sandBoxMode</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//---
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// Generated Google Apps Script
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//---
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">createSpreadsheetCreateFolderMoveFile</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;temp spreadsheet&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">folderName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tempFolder&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 1. Create a new folder
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">newFolder</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFolder</span>(<span style="color:#a6e22e">folderName</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Folder &#39;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">folderName</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39; created with ID: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">newFolder</span>.<span style="color:#a6e22e">getId</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 2. Create a new spreadsheet in the root (initially)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">newSpreadsheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">create</span>(<span style="color:#a6e22e">spreadsheetName</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">`Spreadsheet &#39;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">spreadsheetName</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39; created with ID: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">newSpreadsheet</span>.<span style="color:#a6e22e">getId</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 3. Get the file object of the newly created spreadsheet
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">newSpreadsheet</span>.<span style="color:#a6e22e">getId</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 4. Move the spreadsheet to the new folder
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">moveTo</span>(<span style="color:#a6e22e">newFolder</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">`Spreadsheet &#39;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">spreadsheetName</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39; moved to folder &#39;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">folderName</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;.`</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Optional: Log URLs for verification
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`New Folder URL: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">newFolder</span>.<span style="color:#a6e22e">getUrl</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`New Spreadsheet URL: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">newSpreadsheet</span>.<span style="color:#a6e22e">getUrl</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Call the main function
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">createSpreadsheetCreateFolderMoveFile</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">__behavior</span>.<span style="color:#a6e22e">trash</span>();
</span></span></code></pre></div><h4 id="example-3-create-populate-and-organize-a-spreadsheet">Example 3: Create, Populate, and Organize a Spreadsheet</h4>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Create the following application using Google Apps Script and run the script.
</span></span><span style="display:flex;"><span>1. Create a new Google Spreadsheet as &#34;temp spreadsheet&#34;.
</span></span><span style="display:flex;"><span>2. Insert a new sheet as &#34;temp&#34; to the created Spreadsheet.
</span></span><span style="display:flex;"><span>3. Put a value of `[[&#34;header1&#34;, &#34;header2&#34;, &#34;header3&#34;], [&#34;a2&#34;, &#34;b2&#34;,&#34;c2&#34;]]` into the &#34;temp&#34; sheet.
</span></span><span style="display:flex;"><span>4. Freeze the 1st row and 1st column of the &#34;temp&#34; sheet.
</span></span><span style="display:flex;"><span>5. Create a new folder of &#34;tempFolder&#34;.
</span></span><span style="display:flex;"><span>6. Move the Spreadsheet to the folder.
</span></span></code></pre></div><p><strong>Result:</strong>
This more complex workflow is also handled securely by the fake-sandbox.</p>
<p><img src="https://tanaikech.github.io/image-storage/20250830a/fig4.jpg" alt=""></p>
<p>The generated script is as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#34;@mcpher/gas-fakes/main.js&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">__behavior</span>.<span style="color:#a6e22e">sandBoxMode</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 1. Create a new Google Spreadsheet as &#34;temp spreadsheet&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;temp spreadsheet&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">create</span>(<span style="color:#a6e22e">spreadsheetName</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheetId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">spreadsheet</span>.<span style="color:#a6e22e">getId</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`Created spreadsheet: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">spreadsheetName</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> (ID: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">spreadsheetId</span><span style="color:#e6db74">}</span><span style="color:#e6db74">)`</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 2. Insert a new sheet as &#34;temp&#34; to the created Spreadsheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">newSheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;temp&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">spreadsheet</span>.<span style="color:#a6e22e">insertSheet</span>(<span style="color:#a6e22e">newSheetName</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Inserted new sheet: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">newSheetName</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Remove the default &#34;Sheet1&#34; if it exists and is empty
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">defaultSheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">spreadsheet</span>.<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#e6db74">&#34;Sheet1&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">defaultSheet</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">spreadsheet</span>.<span style="color:#a6e22e">deleteSheet</span>(<span style="color:#a6e22e">defaultSheet</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Deleted default &#39;Sheet1&#39;.&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 3. Put a value of `[[&#34;header1&#34;, &#34;header2&#34;, &#34;header3&#34;], [&#34;a2&#34;, &#34;b2&#34;,&#34;c2&#34;]]` into the &#34;temp&#34; sheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;header1&#34;</span>, <span style="color:#e6db74">&#34;header2&#34;</span>, <span style="color:#e6db74">&#34;header3&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;a2&#34;</span>, <span style="color:#e6db74">&#34;b2&#34;</span>, <span style="color:#e6db74">&#34;c2&#34;</span>],
</span></span><span style="display:flex;"><span>    ];
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">length</span>, <span style="color:#a6e22e">data</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">length</span>).<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">data</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Inserted values into the sheet.&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 4. Freeze the 1st row and 1st column of the &#34;temp&#34; sheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">setFrozenRows</span>(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">setFrozenColumns</span>(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Frozen first row and first column.&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 5. Create a new folder of &#34;tempFolder&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">folderName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tempFolder&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">folder</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFolder</span>(<span style="color:#a6e22e">folderName</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">folderId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">folder</span>.<span style="color:#a6e22e">getId</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Created new folder: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">folderName</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> (ID: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">folderId</span><span style="color:#e6db74">}</span><span style="color:#e6db74">)`</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 6. Move the Spreadsheet to the folder.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">spreadsheetId</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">moveTo</span>(<span style="color:#a6e22e">folder</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`Moved spreadsheet &#39;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">spreadsheetName</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39; to folder &#39;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">folderName</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;.`</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;An error occurred: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">toString</span>());
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">main</span>(); <span style="color:#75715e">// Call the main function
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">__behavior</span>.<span style="color:#a6e22e">trash</span>();
</span></span></code></pre></div><h4 id="example-4-create-a-document-and-add-a-paragraph">Example 4: Create a Document and Add a Paragraph</h4>
<p><strong>Prompt:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Create the following application using Google Apps Script and run the script.
</span></span><span style="display:flex;"><span>1. Create a new Google Document as &#34;temp document&#34;.
</span></span><span style="display:flex;"><span>2. Add a paragraph as a text of &#34;sample&#34;.
</span></span></code></pre></div><p><strong>Result:</strong>
This example demonstrates that the fake-sandbox can also handle other Google Workspace applications like Google Docs.</p>
<p><img src="https://tanaikech.github.io/image-storage/20250830a/fig5.jpg" alt=""></p>
<p>The generated script is as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#34;@mcpher/gas-fakes/main.js&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">__behavior</span>.<span style="color:#a6e22e">sandBoxMode</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//---
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// Generated Google Apps Script
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//---
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">createDocumentAndAddText</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">docTitle</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;temp document&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">textContent</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sample&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">doc</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DocumentApp</span>.<span style="color:#a6e22e">create</span>(<span style="color:#a6e22e">docTitle</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">body</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">doc</span>.<span style="color:#a6e22e">getBody</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">appendParagraph</span>(<span style="color:#a6e22e">textContent</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`Successfully created document: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">doc</span>.<span style="color:#a6e22e">getName</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74"> (ID: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">doc</span>.<span style="color:#a6e22e">getId</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">)`</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Document URL: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">doc</span>.<span style="color:#a6e22e">getUrl</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">`Failed to create document: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">message</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Call the function to execute the script
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">createDocumentAndAddText</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">__behavior</span>.<span style="color:#a6e22e">trash</span>();
</span></span></code></pre></div><h2 id="summary">Summary</h2>
<p>This feasibility study demonstrates a promising approach to securely executing Google Apps Script code generated by AI. The key takeaways are as follows:</p>
<ul>
<li><strong>Addresses a Critical Security Gap:</strong> The &ldquo;Fake-Sandbox&rdquo; concept directly addresses the security risks of executing AI-generated GAS. By translating GAS calls into API requests, it becomes possible to restrict the script&rsquo;s access to specific files and methods, a significant improvement over the broad permissions typically required by native GAS services.</li>
<li><strong>Leverages <code>gas-fakes</code> for Translation:</strong> The <code>gas-fakes</code> library is the core component of this approach, translating high-level GAS service calls into specific, permission-controlled Google API requests.</li>
<li><strong>Maintains Developer Experience:</strong> Scripts can be written using familiar GAS syntax, decoupling the development process from the underlying security implementation.</li>
<li><strong>Enables Secure AI-Powered Automation:</strong> By integrating with the Gemini CLI, this method allows users to safely automate Google Workspace tasks using natural language prompts.</li>
<li><strong>Feasibility and Future Potential:</strong> While the <code>gas-fakes</code> library&rsquo;s coverage is not yet exhaustive, this study confirms the viability of the fake-sandbox approach and highlights its potential for broader application as the library evolves.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2025%2f08%2f30%2fa-fake-sandbox-for-google-apps-script-a-feasibility-study-on-securely-executing-code-generated-by-gemini-cli%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2025%2f08%2f30%2fa-fake-sandbox-for-google-apps-script-a-feasibility-study-on-securely-executing-code-generated-by-gemini-cli%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f08%2f30%2fa-fake-sandbox-for-google-apps-script-a-feasibility-study-on-securely-executing-code-generated-by-gemini-cli%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2025%2f08%2f30%2fa-fake-sandbox-for-google-apps-script-a-feasibility-study-on-securely-executing-code-generated-by-gemini-cli%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f08%2f30%2fa-fake-sandbox-for-google-apps-script-a-feasibility-study-on-securely-executing-code-generated-by-gemini-cli%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2025%2f08%2f30%2fa-fake-sandbox-for-google-apps-script-a-feasibility-study-on-securely-executing-code-generated-by-gemini-cli%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2025/08/22/updated-gas-library-toolsformcpserver/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2025/08/22/updated-gas-library-toolsformcpserver/">Updated: GAS Library - ToolsForMCPServer</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2025/09/11/google-maps-with-natural-language-integrated-collaboration-through-gemini-cli-and-mcp/">Google Maps with Natural Language: Integrated Collaboration through Gemini CLI and MCP</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2025/09/11/google-maps-with-natural-language-integrated-collaboration-through-gemini-cli-and-mcp/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

