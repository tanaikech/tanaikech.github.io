<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>Benchmark: Process Costs for Retrieving 1st Empty Cell and 1st Non Empty Cell of Specific Column in Google Spreadsheet using Google Apps Script &middot; tanaike - Google Apps Script, Gemini API, and Developer Tips</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": "tanaike",
  "author": {
    "@type": "Person",
    "name": "Kanshi Tanaike"
  },
  "description": "Technical blog about Google Apps Script, Google API, Node.js and AI.",
  "url": "https://tanaikech.github.io/"
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Benchmark: Process Costs for Retrieving 1st Empty Cell and 1st Non Empty Cell of Specific Column in Google Spreadsheet using Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>19 May 2021, 13:47</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/benchmark">Benchmark</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/61cbda29436795f199a9e4244e0bf5fe">Gists</a></p>
<h2 id="introduction">Introduction</h2>
<p>Here, I would like to report the process costs for retrieving the 1st empty cell or 1st non empty cell of the specific column of Google Spreadsheet using Google Apps Script (GAS). For this situations, the following 2 patterns can be considered.</p>
<ol>
<li>
<p>Retrieving 1st empty cell of specific column by searching from <strong>TOP</strong> of sheet</p>
</li>
<li>
<p>Retrieving 1st NON empty cell of specific column by searching from <strong>BOTTOM</strong> of sheet</p>
</li>
</ol>
<p>Actually, when I create the applications using GAS, there is the case that it&rsquo;s required to retrieve the 1st empty cell or 1st non empty cell of the specific column. But, in such case, I would like to make the process cost of this as low as possible comparing with other part of the application. From such my experience, I thought that when the process cost of this can be reduced, it will be also useful for other users. So in this report, I would like to introduce the process cost of this situation. And, the following results were obtained.</p>
<ul>
<li>
<p>In order to retrieve the 1st empty cell of the specific column by searching from <strong>TOP</strong> of sheet, the process cost of method using <code>getNextDataCell</code> is the lowest of all methods.</p>
</li>
<li>
<p>In order to retrieve 1st NON empty cell of specific column by searching from <strong>BOTTOM</strong> of sheet, the process cost of method using <code>TextFinder</code> is the lowest of all methods.</p>
</li>
</ul>
<h2 id="experimental-procedure">Experimental procedure</h2>
<p>At first, I would like to mention about &ldquo;Retrieving 1st empty cell of specific column by searching from TOP of sheet&rdquo; and &ldquo;Retrieving 1st NON empty cell of specific column by searching from BOTTOM of sheet&rdquo;. You can see a simple sample Spreadsheet for explaining them at Fig.1.</p>
<!-- raw HTML omitted -->
<p><img src="https://tanaikech.github.io/img/20210519a-fig1.png" alt=""></p>
<p>Fig 1. Simple sample Spreadsheet for explaining about &ldquo;Retrieving 1st empty or non empty cell of specific column&rdquo;.</p>
<!-- raw HTML omitted -->
<p>From the Fig. 1, for the column &ldquo;C&rdquo;,</p>
<ul>
<li>
<p>When 1st empty cell is retrieved by searching from TOP of sheet, the cell &ldquo;<strong>C6</strong>&rdquo; should be obtained.</p>
</li>
<li>
<p>When 1st NON empty cell is retrieved by searching from BOTTOM of sheet, the cell &ldquo;<strong>C9</strong>&rdquo; should be obtained.</p>
</li>
</ul>
<p>All scripts using in this report are filled this condition.</p>
<!-- raw HTML omitted -->
<p>In this report, in order to measure the process cost, the following sample Spreadsheet was used.</p>
<p>The sample Spreadsheet has one sheet. The sheet has 5 columns and 200,000 rows. The columns &ldquo;A&rdquo;, &ldquo;B&rdquo; and &ldquo;D&rdquo; are no cell values for all rows. The column &ldquo;C&rdquo; has the cell value of &ldquo;sample&rdquo; in the rows from 1 to 100,000, and no cell values in the rows from 100,001 to 200,000. All rows from 1 to 200,000 of the column &ldquo;E&rdquo; have the cell value of &ldquo;sample&rdquo;.</p>
<p>In order to measure the process cost, the column &ldquo;C&rdquo; was used. Under this sample Spreadsheet, when the 1st empty cell of the column &ldquo;C&rdquo; by searching from TOP of sheet is retrieved, <code>C100001</code> should be obtained. Also, when the 1st NON empty cell of the column &ldquo;C&rdquo; by searching from BOTTOM of sheet is retrieved, <code>C100000</code> should be obtained.</p>
<p>Here, it thinks of the situation retrieving the 1st empty cell of the specific column. In this case, it is considered the following 2 patterns.</p>
<ol>
<li>
<p>Retrieve all cell values from the column and check the 1st empty cell from TOP of sheet and 1st non empty cell from BOTTOM of sheet. In this case, the process for searching the cell is run at the client side of Google Apps Script.</p>
<ul>
<li>In this report, 2 methods of the for loop and the while loop were used.</li>
</ul>
</li>
<li>
<p>Give the range of column to the built-in method and directly retrieve the required range from the method. In this case, the process for searching the cell is run at the internal server side.</p>
<ul>
<li>
<p>In this report, 2 methods of <code>getNextDataCell</code> and <code>TextFinder</code> were used.</p>
</li>
<li>
<p>From my previous reports (<a href="https://gist.github.com/tanaikech/0a6f03970b471ffa286f1dac0b79359e">Ref1</a>, <a href="https://gist.github.com/tanaikech/030203c695b308606041587e6da269e7">Ref2</a>, <a href="https://gist.github.com/tanaikech/d102c9600ba12a162c667287d2f20fe4">Ref3</a>), it has already been found that when the process is run at the internal server side, the process cost becomes low.</p>
</li>
</ul>
</li>
</ol>
<p>At the following figures of result data for above 4 methods in the section of &ldquo;Results and discussions&rdquo;, 4 labels of &ldquo;<strong>for loop</strong>&rdquo;, &ldquo;<strong>while</strong>&rdquo;, &ldquo;<strong>getNextDataCell</strong>&rdquo; and &ldquo;<strong>TextFinder</strong>&rdquo; are used. And, you can see these sample script for measuring the process cost at <a href="#appendix">Appendix</a>.</p>
<p>By the way, at GAS, the processing time is not stable as you know. So the average value for more than 200 times measurements was used for each data point which is shown by figures. At this time, the fluctuation of the average values was less than 1 %. I worry that each detailed-data point at my environment might be different from that at other userâ€™s environment. But I think that the trend of this result can be used.</p>
<h2 id="results-and-discussions">Results and discussions</h2>
<h3 id="1-retrieving-1st-empty-cell-of-specific-column-by-searching-from-top-of-sheet">1. Retrieving 1st empty cell of specific column by searching from TOP of sheet</h3>
<!-- raw HTML omitted -->
<p><img src="https://tanaikech.github.io/img/20210519a-fig2.png" alt=""></p>
<p>Fig 2. Process time vs 4 methods for retrieving 1st empty cell of specific column by searching from TOP of sheet.</p>
<!-- raw HTML omitted -->
<p>From Fig. 2, it was found that the ascending order of the process costs of these methods was &ldquo;getNextDataCell&rdquo;, &ldquo;TextFinder&rdquo;, &ldquo;while&rdquo; and &ldquo;for loop&rdquo;. When the process speed (v axis) of Fig. 2 is seen, the speed of &ldquo;getNextDataCell&rdquo; is 1.7 times faster than &ldquo;TextFinder&rdquo;, 12.9 times faster than &ldquo;while&rdquo; and 23.3 times faster than &ldquo;for loop&rdquo;. The process costs of &ldquo;getNextDataCell&rdquo; and &ldquo;TextFinder&rdquo; are much lower than those of &ldquo;for loop&rdquo; and &ldquo;while&rdquo;. This result is as same as expected from these references. (<a href="https://gist.github.com/tanaikech/0a6f03970b471ffa286f1dac0b79359e">Ref1</a>, <a href="https://gist.github.com/tanaikech/030203c695b308606041587e6da269e7">Ref2</a>, <a href="https://gist.github.com/tanaikech/d102c9600ba12a162c667287d2f20fe4">Ref3</a>)</p>
<h3 id="2-retrieving-1st-non-empty-cell-of-specific-column-by-searching-from-bottom-of-sheet">2. Retrieving 1st non empty cell of specific column by searching from BOTTOM of sheet</h3>
<!-- raw HTML omitted -->
<p><img src="https://tanaikech.github.io/img/20210519a-fig3.png" alt=""></p>
<p>Fig 3. Process time vs 4 methods for retrieving 1st non empty cell of specific column by searching from BOTTOM of sheet.</p>
<!-- raw HTML omitted -->
<p>From Fig. 3, it was found that the ascending order of the process cost of these methods was &ldquo;TextFinder&rdquo;, &ldquo;while&rdquo;, &ldquo;for loop&rdquo; and &ldquo;getNextDataCell&rdquo;. When the process speed (v axis) of Fig. 3 is seen, the speed of &ldquo;TextFinder&rdquo; is 10.0 times faster than &ldquo;while&rdquo;, 10.3 times faster than &ldquo;for loop&rdquo; and 17.5 times faster than &ldquo;getNextDataCell&rdquo;. In this case, it was found that the process cost of the method using &ldquo;TextFinder&rdquo; is lowest of all, and, the process cost of &ldquo;getNextDataCell&rdquo; is highest of all. This is the interesting result. At &ldquo;getNextDataCell&rdquo;, when all cell values of the column are empty and no empty, the 1st empty cell cannot be directly retrieved using <code>SpreadsheetApp.Direction.DOWN</code> and <code>SpreadsheetApp.Direction.UP</code>. By this, it is required to add more script for retrieving the 1st empty and the 1st non empty cell. It is considered that the reason of this high cost is due to this additional script. When <a href="#appendix">the scripts for 1st empty cell and 1st non empty cell of specific column by searching from TOP (<code>patternA3_</code>) and BOTTOM (<code>patternB3_</code>) of sheet, respectively</a> are seen, it can understand the differences of process costs for &ldquo;getNextDataCell&rdquo; shown in Fig. 2 and 3. From this result, it was found that although the process cost of &ldquo;getNextDataCell&rdquo; is low, when &ldquo;getNextDataCell&rdquo; is used for retrieving the 1st non empty cell from the bottom of sheet, it is required to be careful. And, it was found that for &ldquo;for loop&rdquo; and &ldquo;while&rdquo;, the process cost is almost the same.</p>
<p>By the way, I also measured the method for retrieving the 1st empty cell using <code>isBlank()</code> of Class Range. But, in this case, when the script is run for above sample Spreadsheet, an error of <code>Exceeded maximum execution time</code> occurred. By this, it is not included in this result.</p>
<h2 id="summary">Summary</h2>
<p>In this report, the process costs for retrieving the 1st empty cell and 1st non empty cell of the specific column on Google Spreadsheet using Google Apps Script have been investigated. As the result, the following results could be obtained.</p>
<ol>
<li>
<p>In order to retrieve the 1st empty cell of the specific column by searching from TOP of sheet, &ldquo;getNextDataCell&rdquo; is suitable.</p>
</li>
<li>
<p>In order to retrieve the 1st empty cell of the specific column by searching from BOTTOM of sheet, &ldquo;TextFinder&rdquo; is suitable.</p>
</li>
<li>
<p>From above result, when the 1st empty cell of the specific column on Google Spreadsheet using Google Apps Script is retrieved, the methods which are running at the internal server side are suitable.</p>
</li>
</ol>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h2 id="sample-scripts-obtained-from-this-report">Sample scripts obtained from this report</h2>
<p>From this report, I could obtain the following 2 sample scripts for retrieving the 1st empty cell and the 1st non empty cell of the column.</p>
<h3 id="1-retrieving-1st-empty-row-of-specific-column-by-searching-from-top-of-sheet">1. Retrieving 1st empty row of specific column by searching from <strong>TOP</strong> of sheet</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>Object.<span style="color:#a6e22e">prototype</span>.<span style="color:#a6e22e">get1stEmptyRowFromTop</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">columnNumber</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">offsetRow</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">offsetRow</span>, <span style="color:#a6e22e">columnNumber</span>, <span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getDisplayValues</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">values</span>[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">values</span>[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getNextDataCell</span>(<span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">Direction</span>.<span style="color:#a6e22e">DOWN</span>).<span style="color:#a6e22e">getRow</span>() <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">values</span>[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">values</span>[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">offsetRow</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">offsetRow</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Please run this function.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>().<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#e6db74">&#34;Sheet1&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">get1stEmptyRowFromTop</span>(<span style="color:#ae81ff">3</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>); <span style="color:#75715e">// Retrieve the 1st empty row of column &#34;C&#34; by searching from TOP of sheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><ul>
<li>Please give the sheet object and column number.</li>
<li>In this script, when 2nd argument is used, you can set the offset row. For example, when the 1st and 2nd rows are the header rows, you can use this script as <code>const res = sheet.get1stEmptyRowFromTop(3, 2);</code>.</li>
</ul>
<h3 id="2-retrieving-1st-non-empty-row-of-specific-column-by-searching-from-bottom-of-sheet">2. Retrieving 1st NON empty row of specific column by searching from <strong>BOTTOM</strong> of sheet</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>Object.<span style="color:#a6e22e">prototype</span>.<span style="color:#a6e22e">get1stNonEmptyRowFromBottom</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">columnNumber</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">offsetRow</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">search</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">offsetRow</span>, <span style="color:#a6e22e">columnNumber</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getMaxRows</span>())
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#e6db74">&#34;.&#34;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">useRegularExpression</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">findPrevious</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">search</span> <span style="color:#f92672">?</span> <span style="color:#a6e22e">search</span>.<span style="color:#a6e22e">getRow</span>() <span style="color:#f92672">:</span> <span style="color:#a6e22e">offsetRow</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Please run this function.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>().<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#e6db74">&#34;Sheet1&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">get1stNonEmptyRowFromBottom</span>(<span style="color:#ae81ff">3</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>); <span style="color:#75715e">// Retrieve the 1st non empty row of column &#34;C&#34; by searching from BOTTOM of sheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><ul>
<li>Please give the sheet object and column number.</li>
<li>In this script, when 2nd argument is used, you can set the offset row. For example, when the 1st and 2nd rows are the header rows, you can use this script as <code>const res = sheet.get1stNonEmptyRowFromBottom(3, 2);</code>.</li>
</ul>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h2 id="appendix">Appendix</h2>
<h3 id="scripts">Scripts</h3>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h4 id="retrieving-1st-empty-cell-of-specific-column-by-searching-from-top-of-sheet">Retrieving 1st empty cell of specific column by searching from TOP of sheet</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// Pattern 1: for loop
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">patternA1_</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">columnNumber</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">ssId</span>).<span style="color:#a6e22e">getSheets</span>()[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">columnNumber</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastRow</span>())
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getDisplayValues</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">row</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#a6e22e">row</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">row</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">row</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">values</span>[<span style="color:#a6e22e">row</span>][<span style="color:#ae81ff">0</span>]) <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">row</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Pattern 2: while
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// Ref: https://stackoverflow.com/a/9102463
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// In this script, when all cells of the column have the values, an error &#34;Cannot read property &#39;0&#39; of undefined&#34; occurred. So I modified the condition of while.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">patternA2_</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">columnNumber</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">ssId</span>).<span style="color:#a6e22e">getSheets</span>()[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">columnNumber</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastRow</span>())
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getDisplayValues</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">len</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">row</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">row</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">len</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">values</span>[<span style="color:#a6e22e">row</span>][<span style="color:#ae81ff">0</span>]) <span style="color:#a6e22e">row</span><span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">row</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Pattern 3: getNextDataCell
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">patternA3_</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">columnNumber</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">ssId</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getSheets</span>()[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">columnNumber</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getDisplayValue</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">?</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getNextDataCell</span>(<span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">Direction</span>.<span style="color:#a6e22e">DOWN</span>).<span style="color:#a6e22e">getRow</span>() <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Pattern 4: TextFinder
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">patternA4_</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">columnNumber</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">ssId</span>).<span style="color:#a6e22e">getSheets</span>()[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">search</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">columnNumber</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastRow</span>())
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#e6db74">&#34;^$&#34;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">useRegularExpression</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">matchEntireCell</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">findNext</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">search</span> <span style="color:#f92672">?</span> <span style="color:#a6e22e">search</span>.<span style="color:#a6e22e">getRow</span>() <span style="color:#f92672">:</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastRow</span>() <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h4 id="retrieving-1st-empty-cell-of-specific-column-by-searching-from-buttom-of-sheet">Retrieving 1st empty cell of specific column by searching from BUTTOM of sheet</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// Pattern 1: for loop
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">patternB1_</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">columnNumber</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">ssId</span>).<span style="color:#a6e22e">getSheets</span>()[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">columnNumber</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastRow</span>())
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getDisplayValues</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">row</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#a6e22e">row</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">row</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">row</span><span style="color:#f92672">--</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">values</span>[<span style="color:#a6e22e">row</span>][<span style="color:#ae81ff">0</span>]) <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">row</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Pattern 2: while
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">patternB2_</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">columnNumber</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">ssId</span>).<span style="color:#a6e22e">getSheets</span>()[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">columnNumber</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastRow</span>())
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getDisplayValues</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">row</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">row</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">values</span>[<span style="color:#a6e22e">row</span>][<span style="color:#ae81ff">0</span>]) <span style="color:#a6e22e">row</span><span style="color:#f92672">--</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">row</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Pattern 3: getNextDataCell
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">patternB3_</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">columnNumber</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">ssId</span>).<span style="color:#a6e22e">getSheets</span>()[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">maxRow</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getMaxRows</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">columnNumber</span>, <span style="color:#a6e22e">maxRow</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">v</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getDisplayValues</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">v</span>[<span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">maxRow</span>;
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">v</span>[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">range</span>
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">offset</span>(<span style="color:#a6e22e">maxRow</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">getNextDataCell</span>(<span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">Direction</span>.<span style="color:#a6e22e">UP</span>)
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">getRow</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Pattern 4: TextFinder
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">patternB4_</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">columnNumber</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">ssId</span>).<span style="color:#a6e22e">getSheets</span>()[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">search</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">columnNumber</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getMaxRows</span>())
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#e6db74">&#34;.&#34;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">useRegularExpression</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">findPrevious</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">search</span> <span style="color:#f92672">?</span> <span style="color:#a6e22e">search</span>.<span style="color:#a6e22e">getRow</span>() <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><ul>
<li>I answered for <a href="https://stackoverflow.com/a/44563639">this thread</a> in Stackoverflow.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2021%2f05%2f19%2fbenchmark-process-costs-for-retrieving-1st-empty-cell-and-1st-non-empty-cell-of-specific-column-in-google-spreadsheet-using-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2021%2f05%2f19%2fbenchmark-process-costs-for-retrieving-1st-empty-cell-and-1st-non-empty-cell-of-specific-column-in-google-spreadsheet-using-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2021%2f05%2f19%2fbenchmark-process-costs-for-retrieving-1st-empty-cell-and-1st-non-empty-cell-of-specific-column-in-google-spreadsheet-using-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2021%2f05%2f19%2fbenchmark-process-costs-for-retrieving-1st-empty-cell-and-1st-non-empty-cell-of-specific-column-in-google-spreadsheet-using-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2021%2f05%2f19%2fbenchmark-process-costs-for-retrieving-1st-empty-cell-and-1st-non-empty-cell-of-specific-column-in-google-spreadsheet-using-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2021%2f05%2f19%2fbenchmark-process-costs-for-retrieving-1st-empty-cell-and-1st-non-empty-cell-of-specific-column-in-google-spreadsheet-using-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2021/05/01/retrieving-access-token-using-service-account-for-php-without-using-googleapis/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2021/05/01/retrieving-access-token-using-service-account-for-php-without-using-googleapis/">Retrieving Access Token using Service Account for PHP without using googleapis</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2021/05/21/retrieving-hidden-rows-and-showing-rows-by-filter-view-on-google-spreadsheet-using-google-apps-script/">Retrieving Hidden Rows and Showing Rows by Filter View on Google Spreadsheet using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2021/05/21/retrieving-hidden-rows-and-showing-rows-by-filter-view-on-google-spreadsheet-using-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

