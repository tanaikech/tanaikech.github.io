<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Taking Advantage of TextFinder for Google Spreadsheet &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Taking Advantage of TextFinder for Google Spreadsheet</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Oct 2021, 16:29</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/39f719bd10ccbb27edd694c33242e496">Gists</a></p>
<p>There is Class TextFinder in Spreadsheet service for Google Apps Script. <a href="https://developers.google.com/apps-script/reference/spreadsheet/text-finder">Ref</a> The TextFinder can search and replace the texts in the Spreadsheet using Google Apps Script. There is the method for <code>createTextFinder</code> in Class Spreadsheet, Class Sheet and Class Range. When these methods are used, you can search and replace the texts for all sheets in a Spreadsheet, the specific sheet, and the specific range in the specific sheet.</p>
<p>In this post, I would like to introduce the sample scripts for taking advantage of TextFinder.</p>
<p>I think that TextFinder is the strong method for searching values in Google Spreadsheet. <a href="https://tanaikech.github.io/2020/09/30/benchmark-process-costs-for-searching-values-in-spreadsheet-using-google-apps-script/">Ref</a> So I think that when this can be taken advantage of, the process cost of the script will become low.</p>
<h2 id="sample-script-1">Sample script 1</h2>
<p>This sample search <code>searchText</code> from all cells of all sheets in a Google Spreadsheet. And the result value is returned as the range list including A1Notation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">searchText</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sample&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">rangeList</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#a6e22e">searchText</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">matchEntireCell</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">findAll</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">r</span>) =&gt; <span style="color:#e6db74">`&#39;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">getSheet</span>().<span style="color:#a6e22e">getSheetName</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;!</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">getA1Notation</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">rangeList</span>);
</span></span></code></pre></div><ul>
<li>When <code>replaceAllWith(&quot;updatedText&quot;)</code> is used instead of <code>findAll()</code>, all searched cells are replaced with <code>updatedText</code>.</li>
</ul>
<h2 id="sample-script-2">Sample script 2</h2>
<p>This sample search <code>searchText</code> from all cells of the specific sheet in a Google Spreadsheet. And the result value is returned as the range list including A1Notation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">searchText</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sample&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sheet1&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">rangeList</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#a6e22e">searchText</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">matchEntireCell</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">findAll</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">r</span>) =&gt; <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">getA1Notation</span>());
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">rangeList</span>);
</span></span></code></pre></div><ul>
<li>When <code>replaceAllWith(&quot;updatedText&quot;)</code> is used instead of <code>findAll()</code>, all searched cells are replaced with <code>updatedText</code>.</li>
</ul>
<h2 id="sample-script-3">Sample script 3</h2>
<p>This sample search <code>searchText</code> from the specific range on the specific sheet in a Google Spreadsheet. And the result value is returned as the range list including A1Notation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">searchText</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sample&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sheet1&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;A1:A10&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">rangeList</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">range</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#a6e22e">searchText</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">matchEntireCell</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">findAll</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">r</span>) =&gt; <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">getA1Notation</span>());
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">rangeList</span>);
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20211017a/fig1.png" alt=""></p>
<p>When this sample sheet is used, <code>[&quot;A4&quot;,&quot;A7&quot;,&quot;A8&quot;]</code> is retrieved.</p>
<h2 id="sample-script-4">Sample script 4</h2>
<p>TextFinder can also search the texts using the regex. This sample search <code>regex</code> from the specific sheet in a Google Spreadsheet. In this case, the cells which don&rsquo;t have the text of <code>sample</code> in the top letter are retrieved. And the result value is returned as the range list including A1Notation. This result is the opposite result from &ldquo;Sample script 3&rdquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">regex</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;^(?!sample).+$&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sheet1&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;A1:A10&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">rangeList</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">range</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#a6e22e">regex</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">useRegularExpression</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">matchEntireCell</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">findAll</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">r</span>) =&gt; <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">getA1Notation</span>());
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">rangeList</span>);
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20211017a/fig2.png" alt=""></p>
<p>When this sample sheet is used, <code>[&quot;A1&quot;,&quot;A2&quot;,&quot;A3&quot;,&quot;A5&quot;,&quot;A6&quot;,&quot;A9&quot;,&quot;A10&quot;]</code> is retrieved.</p>
<h2 id="sample-script-5">Sample script 5</h2>
<p>This sample search <code>searchText</code> from all cells of all sheets in a Google Spreadsheet. And when <code>searchText</code> is found, <code>true</code> is returned. When that is not found, <code>false</code> is returned.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">searchText</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sample&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">search</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#a6e22e">searchText</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">matchEntireCell</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">findNext</span>()
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">?</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">search</span>);
</span></span></code></pre></div><ul>
<li>This situation can be also achieved for the specific sheet and the specific range.</li>
</ul>
<h2 id="sample-script-6">Sample script 6</h2>
<p>This sample script searches the 1st empty cell of the specific column of the active sheet. When <code>^$</code> is used as the regex for TextFinder, the empty cells can be retrieved. This sample script retrieves the 1st empty cell of the specific column.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">columnNumber</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>; <span style="color:#75715e">// 2 is column &#34;B&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSheet</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">search</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">columnNumber</span>, <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getMaxRows</span>())
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#e6db74">&#34;^$&#34;</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">useRegularExpression</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">matchEntireCell</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">findNext</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">rowNumber</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">search</span> <span style="color:#f92672">?</span> <span style="color:#a6e22e">search</span>.<span style="color:#a6e22e">getRow</span>() <span style="color:#f92672">:</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastRow</span>() <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">rowNumber</span>);
</span></span></code></pre></div><h2 id="sample-script-7">Sample script 7</h2>
<p>This sample script searches the cells including <code>test</code> from &ldquo;A1:A10&rdquo; of the active sheet, and the values of searched cells are retrieved.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">searchText</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;test&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sheet1&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;A1:A10&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">range</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#a6e22e">searchText</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">useRegularExpression</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">findAll</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">r</span>) =&gt; <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">getValue</span>());
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">values</span>);
</span></span></code></pre></div><p>When this script is used for the large range and the many sheets, the process cost will become high. In that case, you can reduce the process cost by using Sheets API as follows. When you use the following sample script, please enable Sheets API at Advanced Google services. <a href="https://developers.google.com/apps-script/guides/services/advanced#enable_advanced_services">Ref</a> When Sheets API is used, the values can be retrieved from the individual cell ranges by one API call.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">searchText</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;test&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sheet1&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;A1:A10&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ranges</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">range</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#a6e22e">searchText</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">useRegularExpression</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">findAll</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">r</span>) =&gt; <span style="color:#e6db74">`&#39;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">sheetName</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;!</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">getA1Notation</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Sheets</span>.<span style="color:#a6e22e">Spreadsheets</span>.<span style="color:#a6e22e">Values</span>.<span style="color:#a6e22e">batchGet</span>(<span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getId</span>(), {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ranges</span>,
</span></span><span style="display:flex;"><span>}).<span style="color:#a6e22e">valueRanges</span>.<span style="color:#a6e22e">flatMap</span>(({ <span style="color:#a6e22e">values</span> }) =&gt; <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">flat</span>());
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">values</span>);
</span></span></code></pre></div><p><img src="https://tanaikech.github.io/image-storage/20211017a/fig3.png" alt=""></p>
<p>When this sample sheet is used, for both scripts, the values of <code>[ 'A_testa4', 'A_testa6', 'A_testa8' ]</code> are retrieved.</p>
<h2 id="sample-script-8">Sample script 8</h2>
<p>The sample input and output situations are as follows.</p>
<h3 id="input-situation">Input situation</h3>
<p>This value is put to the cell &ldquo;A1&rdquo; of &ldquo;Sheet1&rdquo;.</p>
<pre tabindex="0"><code>sample=sample1,sample=sample2,sample=sample3
</code></pre><h3 id="output-situation">Output situation</h3>
<p>The above value of the cell &ldquo;A1&rdquo; are changed to the following situation.</p>
<pre tabindex="0"><code>(sample1,sample2,sample3)
</code></pre><h3 id="sample-script">Sample script</h3>
<p>The sample script for achieving above situation is as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sheet1&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getRange</span>(<span style="color:#e6db74">&#34;A1&#34;</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#e6db74">&#34;sample\\=(.+),sample\\=(.+),sample\\=(.+)&#34;</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">useRegularExpression</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">replaceAllWith</span>(<span style="color:#e6db74">&#34;($1,$2,$3)&#34;</span>);
</span></span></code></pre></div><ul>
<li>At the replace text of TextFinder, the group can be used.</li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="https://developers.google.com/apps-script/reference/spreadsheet/text-finder">Class TextFinder</a></li>
<li><a href="https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet#createtextfinderfindtext">createTextFinder(findText) of Class Spreadsheet</a></li>
<li><a href="https://developers.google.com/apps-script/reference/spreadsheet/sheet#createTextFinder(String)">createTextFinder(findText) of Class Sheet</a></li>
<li><a href="https://developers.google.com/apps-script/reference/spreadsheet/range#createTextFinder(String)">createTextFinder(findText) of Class Range</a></li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2021%2f10%2f17%2ftaking-advantage-of-textfinder-for-google-spreadsheet%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2021%2f10%2f17%2ftaking-advantage-of-textfinder-for-google-spreadsheet%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2021%2f10%2f17%2ftaking-advantage-of-textfinder-for-google-spreadsheet%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2021%2f10%2f17%2ftaking-advantage-of-textfinder-for-google-spreadsheet%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2021%2f10%2f17%2ftaking-advantage-of-textfinder-for-google-spreadsheet%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2021%2f10%2f17%2ftaking-advantage-of-textfinder-for-google-spreadsheet%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2021/10/16/announcing-the-google-forms-api/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2021/10/16/announcing-the-google-forms-api/">Announcing the Google Forms API</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2021/10/20/updated-gas-library-richtextapp/">Updated: GAS Library - RichTextApp</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2021/10/20/updated-gas-library-richtextapp/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

