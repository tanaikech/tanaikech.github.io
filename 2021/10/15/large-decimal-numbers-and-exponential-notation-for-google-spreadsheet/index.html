<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.61.0" />

  <title>Large Decimal Numbers and Exponential Notation for Google Spreadsheet &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Large Decimal Numbers and Exponential Notation for Google Spreadsheet</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15 Oct 2021, 09:14</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/a1b32bdace0ebdd6c92a547b6f4dfbeb">Gists</a></p>
<p>In this report, it has investigated the large decimal numbers and the exponential notation for Google Spreadsheet. When the large decimal numbers are put to the Spreadsheet, the Spreadsheet automatically sets the display value using the exponential notation. In this report, the result when the values are retrieved by Spreadsheet service and Sheets API is shown.</p>
<h2 id="sample-script">Sample script</h2>
<p>At first, please create new Spreadsheet and open the script editor. And please copy and paste the following script. And, <a href="https://developers.google.com/apps-script/guides/services/advanced#enable_advanced_services">please enable Sheets API at Advanced Google services</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sheet1&#34;</span>;

  <span style="color:#75715e">// Set values to Spreadsheet.
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>();
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">maxDigit</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span>;
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> Array(<span style="color:#a6e22e">maxDigit</span>)
    .<span style="color:#a6e22e">fill</span>(<span style="color:#e6db74">&#34;&#34;</span>)
    .<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">i</span>) =&gt; {
      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">v</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> Array(<span style="color:#a6e22e">i</span>).<span style="color:#a6e22e">fill</span>(<span style="color:#ae81ff">0</span>).<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;&#34;</span>);
      <span style="color:#66d9ef">return</span> [<span style="color:#a6e22e">v</span>, <span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">length</span>];
    });
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>
    .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span>, <span style="color:#a6e22e">values</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">length</span>)
    .<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">values</span>);
  <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">flush</span>();

  <span style="color:#75715e">// Retrieve the values using Spreadsheet service and Sheets API.
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">valuesFromSpreadsheetService1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getValues</span>();
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">valuesFromSpreadsheetService2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getDisplayValues</span>();
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">valuesFromSheetsAPI1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Sheets</span>.<span style="color:#a6e22e">Spreadsheets</span>.<span style="color:#a6e22e">Values</span>.<span style="color:#a6e22e">get</span>(
    <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getId</span>(),
    <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">sheetName</span><span style="color:#e6db74">}</span><span style="color:#e6db74">!</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getA1Notation</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>
  ).<span style="color:#a6e22e">values</span>;
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">valuesFromSheetsAPI2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Sheets</span>.<span style="color:#a6e22e">Spreadsheets</span>.<span style="color:#a6e22e">Values</span>.<span style="color:#a6e22e">get</span>(
    <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getId</span>(),
    <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">sheetName</span><span style="color:#e6db74">}</span><span style="color:#e6db74">!</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getA1Notation</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
    { <span style="color:#a6e22e">valueRenderOption</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;UNFORMATTED_VALUE&#34;</span> }
  ).<span style="color:#a6e22e">values</span>;

  <span style="color:#75715e">// Show the result.
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">valuesFromSpreadsheetService1</span>);
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">valuesFromSpreadsheetService2</span>);
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">valuesFromSheetsAPI1</span>);
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">valuesFromSheetsAPI2</span>);
}
</code></pre></div><p>When this script is run, the following values are put to the sheet &ldquo;Sheet1&rdquo;.</p>
<p><img src="https://tanaikech.github.io/image-storage/20211015a/fig1.png" alt=""></p>
<p>And, the put values are retrieved by Spreadsheet service and Sheets API.</p>
<h2 id="result">Result</h2>
<ul>
<li>
<p><code>console.log(valuesFromSpreadsheetService1);</code></p>
<pre><code>[ [ 1, 1 ],
[ 10, 2 ],
[ 100, 3 ],
[ 1000, 4 ],
[ 10000, 5 ],
[ 100000, 6 ],
[ 1000000, 7 ],
[ 10000000, 8 ],
[ 100000000, 9 ],
[ 1000000000, 10 ],
[ 10000000000, 11 ],
[ 100000000000, 12 ],
[ 1000000000000, 13 ],
[ 10000000000000, 14 ],
[ 100000000000000, 15 ],
[ 1000000000000000, 16 ],
[ 10000000000000000, 17 ],
[ 100000000000000000, 18 ],
[ 1000000000000000000, 19 ],
[ 10000000000000000000, 20 ],
[ 100000000000000000000, 21 ],
[ 1e+21, 22 ],
[ 1e+22, 23 ],
[ 1e+23, 24 ],
[ 1e+24, 25 ],
[ 1e+25, 26 ],
[ 1e+26, 27 ],
[ 1e+27, 28 ],
[ 1e+28, 29 ],
[ 1e+29, 30 ] ]
</code></pre></li>
<li>
<p><code>console.log(valuesFromSpreadsheetService2);</code></p>
<pre><code>[ [ '1', '1' ],
[ '10', '2' ],
[ '100', '3' ],
[ '1000', '4' ],
[ '10000', '5' ],
[ '100000', '6' ],
[ '1000000', '7' ],
[ '10000000', '8' ],
[ '100000000', '9' ],
[ '1000000000', '10' ],
[ '10000000000', '11' ],
[ '100000000000', '12' ],
[ '1000000000000', '13' ],
[ '10000000000000', '14' ],
[ '100000000000000', '15' ],
[ '1E+15', '16' ],
[ '1E+16', '17' ],
[ '1E+17', '18' ],
[ '1E+18', '19' ],
[ '1E+19', '20' ],
[ '1E+20', '21' ],
[ '1E+21', '22' ],
[ '1E+22', '23' ],
[ '1E+23', '24' ],
[ '1E+24', '25' ],
[ '1E+25', '26' ],
[ '1E+26', '27' ],
[ '1E+27', '28' ],
[ '1E+28', '29' ],
[ '1E+29', '30' ] ]
</code></pre></li>
<li>
<p><code>console.log(valuesFromSheetsAPI1);</code></p>
<pre><code>[ [ '1', '1' ],
[ '10', '2' ],
[ '100', '3' ],
[ '1000', '4' ],
[ '10000', '5' ],
[ '100000', '6' ],
[ '1000000', '7' ],
[ '10000000', '8' ],
[ '100000000', '9' ],
[ '1000000000', '10' ],
[ '10000000000', '11' ],
[ '100000000000', '12' ],
[ '1000000000000', '13' ],
[ '10000000000000', '14' ],
[ '100000000000000', '15' ],
[ '1E+15', '16' ],
[ '1E+16', '17' ],
[ '1E+17', '18' ],
[ '1E+18', '19' ],
[ '1E+19', '20' ],
[ '1E+20', '21' ],
[ '1E+21', '22' ],
[ '1E+22', '23' ],
[ '1E+23', '24' ],
[ '1E+24', '25' ],
[ '1E+25', '26' ],
[ '1E+26', '27' ],
[ '1E+27', '28' ],
[ '1E+28', '29' ],
[ '1E+29', '30' ] ]
</code></pre></li>
<li>
<p><code>console.log(valuesFromSheetsAPI2);</code></p>
<pre><code>[ [ 1, 1 ],
[ 10, 2 ],
[ 100, 3 ],
[ 1000, 4 ],
[ 10000, 5 ],
[ 100000, 6 ],
[ 1000000, 7 ],
[ 10000000, 8 ],
[ 100000000, 9 ],
[ 1000000000, 10 ],
[ 10000000000, 11 ],
[ 100000000000, 12 ],
[ 1000000000000, 13 ],
[ 10000000000000, 14 ],
[ 100000000000000, 15 ],
[ 1000000000000000, 16 ],
[ 10000000000000000, 17 ],
[ 100000000000000000, 18 ],
[ 1000000000000000000, 19 ],
[ 10000000000000000000, 20 ],
[ 100000000000000000000, 21 ],
[ 1e+21, 22 ],
[ 1e+22, 23 ],
[ 1e+23, 24 ],
[ 1e+24, 25 ],
[ 1e+25, 26 ],
[ 1e+26, 27 ],
[ 1e+27, 28 ],
[ 1e+28, 29 ],
[ 1e+29, 30 ] ]
</code></pre></li>
</ul>
<h2 id="summary">Summary</h2>
<p>From the retrieved values, the following results were obtained.</p>
<ul>
<li>
<p>Values retrieved by <code>getDisplayValues</code> are the same with the method of spreadsheets.values.get in Sheets API with the default option.</p>
<ul>
<li>
<p><strong>The number of 15 digits can be retrieved as the raw number.</strong></p>
</li>
<li>
<p>At Sheets API, the methods spreadsheets.values.get, spreadsheets.values.batchGet and spreadsheets.get are the same result.</p>
</li>
</ul>
</li>
<li>
<p>Values retrieved by <code>getValues</code> are the same with the method of spreadsheets.values.get in Sheets API with the option of <code>valueRenderOption: &quot;UNFORMATTED_VALUE&quot;</code>.</p>
<ul>
<li>
<p><strong>The number of 21 digits can be retrieved as the raw number.</strong></p>
</li>
<li>
<p>In this case, the option of <code>valueRenderOption: &quot;UNFORMATTED_VALUE&quot;</code> can be used for the methods of spreadsheets.values.get and spreadsheets.values.batchGet. But the method of spreadsheets.get has no option. So in this case, the method of spreadsheets.get cannot retrieve the large decimal numbers.</p>
</li>
<li>
<p>Also, the result of <code>getValues</code> is the same with the method of <code>getSheetValues</code>.</p>
</li>
</ul>
</li>
</ul>

  


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2021/10/14/google-cloud-champion-innovators/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2021/10/14/google-cloud-champion-innovators/">Google Cloud Champion Innovators</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    }
  });
</script>


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-84325623-1', 'auto');
    ga('send', 'pageview');
  }
</script>





<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

