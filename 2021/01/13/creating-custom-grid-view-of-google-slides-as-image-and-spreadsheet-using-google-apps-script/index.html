<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Creating Custom Grid View of Google Slides as Image and Spreadsheet using Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Creating Custom Grid View of Google Slides as Image and Spreadsheet using Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Jan 2021, 12:19</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/slides">slides</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/slides">slides</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/c94b79819167e96f6d9268d066989112">Gists</a></p>
<p>This is a sample script for creating the custom grid view of Google Slides as an image using Google Apps Script.</p>
<h2 id="demo">Demo</h2>
<p><img src="https://tanaikech.github.io/img/20210113a-fig1.gif" alt=""></p>
<h2 id="usage">Usage</h2>
<p>In order to use this script, please do the following flow.</p>
<h3 id="1-install-gas-library">1. Install GAS library</h3>
<p>This sample script uses a library of <a href="https://github.com/tanaikech/DocsServiceApp">DocsServiceApp</a>. So please install DocsServiceApp. You can see the method for installing it at <a href="https://github.com/tanaikech/DocsServiceApp#how-to-install">here</a>.</p>
<h3 id="2-enable-apis">2. Enable APIs</h3>
<p>This sample script uses 2 APIs of Drive API and Slides API. So please enable them at Advanced Google services. <a href="https://developers.google.com/apps-script/guides/services/advanced#enable_advanced_services">Ref</a></p>
<h3 id="3-sample-script">3. Sample script</h3>
<p>Please copy and paste the following script and set the variable of <code>obj</code>. And, please run <code>main()</code> at the script editor. By this, all slides in the Google Slides of <code>obj.presentationId</code> are retrieved and create the custom grid view, and it is saved as an PNG image to the root folder.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Please set object for creating image.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">filename</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample.png&#34;</span>, <span style="color:#75715e">// Filename of output file. In the current stage, the file is saved as PNG format.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">width</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1000</span>, <span style="color:#75715e">// Image width of output image. The unit is pixel. The height is automatically set by the number of slides.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">horizontalSlides</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3</span>, <span style="color:#75715e">// Number of slides for one row.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">margin</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">50</span>, <span style="color:#75715e">// Margin of each slide. The unit is pixel. If you are not required to use the margin, please remove this property.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">presentationId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span>, <span style="color:#75715e">// Google Slides ID you want to use.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 1. Retrieve all slides from the Google Slides as images.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SlidesApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">presentationId</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">slidesAsImageObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">getSlides</span>().<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Slides</span>.<span style="color:#a6e22e">Presentations</span>.<span style="color:#a6e22e">Pages</span>.<span style="color:#a6e22e">getThumbnail</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">presentationId</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">getObjectId</span>(),
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;thumbnailProperties.mimeType&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;PNG&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;thumbnailProperties.thumbnailSize&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;LARGE&#34;</span>,
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">imageObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetchAll</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">slidesAsImageObj</span>.<span style="color:#a6e22e">map</span>(({ <span style="color:#a6e22e">contentUrl</span> }) =&gt; <span style="color:#a6e22e">contentUrl</span>)
</span></span><span style="display:flex;"><span>  ).<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">i</span>) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">getResponseCode</span>() <span style="color:#f92672">==</span> <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">?</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">blob</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">getBlob</span>(),
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">width</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">slidesAsImageObj</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">width</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">height</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">slidesAsImageObj</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">height</span>,
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">:</span> <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">imageObj</span>.<span style="color:#a6e22e">some</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">e</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Slide cannot be retrieved as the image.&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ar</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">imageObj</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">imageObj</span>.<span style="color:#a6e22e">splice</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">horizontalSlides</span>));
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">hasOwnProperty</span>(<span style="color:#e6db74">&#34;margin&#34;</span>)) <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">margin</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">maxWidth</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">max</span>(
</span></span><span style="display:flex;"><span>    ...<span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">map</span>(
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">r</span>) =&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">w</span>, { <span style="color:#a6e22e">width</span> }) =&gt; (<span style="color:#a6e22e">w</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">width</span>), <span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">margin</span> <span style="color:#f92672">*</span> (<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">maxHeight</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">h</span>, <span style="color:#a6e22e">r</span>) =&gt; (<span style="color:#a6e22e">h</span> <span style="color:#f92672">+=</span> Math.<span style="color:#a6e22e">max</span>(...<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">map</span>(({ <span style="color:#a6e22e">height</span> }) =&gt; <span style="color:#a6e22e">height</span>))), <span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">margin</span> <span style="color:#f92672">*</span> (<span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 2. Create new Google Slides with the custom page size using DocsServiceApp. This is used as the temporal Slides.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample title&#34;</span>, <span style="color:#75715e">// Title of created Slides.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">width</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">unit</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;pixel&#34;</span>, <span style="color:#a6e22e">size</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">maxWidth</span> },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">height</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">unit</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;pixel&#34;</span>, <span style="color:#a6e22e">size</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">maxHeight</span> },
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">presentationId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DocsServiceApp</span>.<span style="color:#a6e22e">createNewSlidesWithPageSize</span>(<span style="color:#a6e22e">object</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 3. Arrange each slide image to the 1st slide.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">temps</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SlidesApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">presentationId</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">slide</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">temps</span>.<span style="color:#a6e22e">getSlides</span>()[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">top</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">r</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">left</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">maxH</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">forEach</span>(({ <span style="color:#a6e22e">blob</span>, <span style="color:#a6e22e">width</span>, <span style="color:#a6e22e">height</span> }) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">slide</span>.<span style="color:#a6e22e">insertImage</span>(<span style="color:#a6e22e">blob</span>, <span style="color:#a6e22e">left</span>, <span style="color:#a6e22e">top</span>, <span style="color:#a6e22e">width</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0.75</span>, <span style="color:#a6e22e">height</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0.75</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">left</span> <span style="color:#f92672">+=</span> (<span style="color:#a6e22e">width</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">margin</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">0.75</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">maxH</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">height</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">maxH</span> <span style="color:#f92672">?</span> <span style="color:#a6e22e">height</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">maxH</span>;
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">top</span> <span style="color:#f92672">+=</span> (<span style="color:#a6e22e">maxH</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">margin</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">0.75</span>;
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">temps</span>.<span style="color:#a6e22e">saveAndClose</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 4. Output the image file.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tempObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Slides</span>.<span style="color:#a6e22e">Presentations</span>.<span style="color:#a6e22e">Pages</span>.<span style="color:#a6e22e">getThumbnail</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">presentationId</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">slide</span>.<span style="color:#a6e22e">getObjectId</span>(),
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;thumbnailProperties.thumbnailSize&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;LARGE&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;thumbnailProperties.mimeType&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;PNG&#34;</span>,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tempObj</span>.<span style="color:#a6e22e">contentUrl</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/=s\d+/</span>, <span style="color:#e6db74">&#34;=s&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">width</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">resultBlob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">url</span>).<span style="color:#a6e22e">getBlob</span>().<span style="color:#a6e22e">setName</span>(<span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">filename</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">resultBlob</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">presentationId</span>).<span style="color:#a6e22e">setTrashed</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="another-sample-script">Another sample script</h2>
<p>This is a sample script for creating the custom grid view of Google Slides as a Spreadsheet using Google Apps Script. In this sample script, all slides in a Google Slides are put to the cells on Google Spreadsheet as the images using Google Apps Script.</p>
<h3 id="demo-1">Demo</h3>
<p><img src="https://tanaikech.github.io/img/20210113a-fig2.png" alt=""></p>
<h3 id="usage-1">Usage</h3>
<p>In order to use this script, please do the following flow.</p>
<h4 id="1-install-gas-library-1">1. Install GAS library</h4>
<p>This sample script uses a library of <a href="https://github.com/tanaikech/DocsServiceApp">DocsServiceApp</a>. So please install DocsServiceApp. You can see the method for installing it at <a href="https://github.com/tanaikech/DocsServiceApp#how-to-install">here</a>.</p>
<h4 id="2-enable-apis-1">2. Enable APIs</h4>
<p>This sample script uses 3 APIs of Drive API, Slides API and Sheets API. So please enable them at Advanced Google services. <a href="https://developers.google.com/apps-script/guides/services/advanced#enable_advanced_services">Ref</a></p>
<h4 id="3-sample-script-1">3. Sample script</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Please set object for creating image.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">spreadsheetId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span>, <span style="color:#75715e">// Spreadsheet ID of Spreadsheet that the each slide image is put.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">horizontalSlides</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3</span>, <span style="color:#75715e">// Number of slides for one row.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">presentationId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span>, <span style="color:#75715e">// Google Slides ID you want to use.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SlidesApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">presentationId</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">slidesAsImageObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">getSlides</span>().<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Slides</span>.<span style="color:#a6e22e">Presentations</span>.<span style="color:#a6e22e">Pages</span>.<span style="color:#a6e22e">getThumbnail</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">presentationId</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">getObjectId</span>(),
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;thumbnailProperties.mimeType&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;PNG&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;thumbnailProperties.thumbnailSize&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;MEDIUM&#34;</span>,
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">imageObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetchAll</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">slidesAsImageObj</span>.<span style="color:#a6e22e">map</span>(({ <span style="color:#a6e22e">contentUrl</span> }) =&gt; <span style="color:#a6e22e">contentUrl</span>)
</span></span><span style="display:flex;"><span>  ).<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">i</span>) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">getResponseCode</span>() <span style="color:#f92672">==</span> <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">?</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">blob</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">getBlob</span>(),
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">width</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">slidesAsImageObj</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">width</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">height</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">slidesAsImageObj</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">height</span>,
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">:</span> <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">imageObj</span>.<span style="color:#a6e22e">some</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">e</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Slide cannot be retrieved as the image.&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ar</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">imageObj</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">imageObj</span>.<span style="color:#a6e22e">splice</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">horizontalSlides</span>));
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">flatMap</span>((<span style="color:#a6e22e">r</span>, <span style="color:#a6e22e">i</span>) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">map</span>(({ <span style="color:#a6e22e">blob</span> }, <span style="color:#a6e22e">j</span>) =&gt; ({
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">blob</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">blob</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">range</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">row</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">column</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> },
</span></span><span style="display:flex;"><span>    }))
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">DocsServiceApp</span>.<span style="color:#a6e22e">openBySpreadsheetId</span>(<span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">spreadsheetId</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#e6db74">&#34;Sheet1&#34;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">insertImage</span>(<span style="color:#a6e22e">object</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="note">Note</h2>
<ul>
<li>The important point of this sample script is to create new Google Slides by giving the page size. But in the current stage, this cannot be directly achieved using Slides service and Slides API. So I created <a href="https://github.com/tanaikech/DocsServiceApp">DocsServiceApp</a>.</li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/tanaikech/DocsServiceApp">DocsServiceApp</a></li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2021%2f01%2f13%2fcreating-custom-grid-view-of-google-slides-as-image-and-spreadsheet-using-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2021%2f01%2f13%2fcreating-custom-grid-view-of-google-slides-as-image-and-spreadsheet-using-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2021%2f01%2f13%2fcreating-custom-grid-view-of-google-slides-as-image-and-spreadsheet-using-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2021%2f01%2f13%2fcreating-custom-grid-view-of-google-slides-as-image-and-spreadsheet-using-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2021%2f01%2f13%2fcreating-custom-grid-view-of-google-slides-as-image-and-spreadsheet-using-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2021%2f01%2f13%2fcreating-custom-grid-view-of-google-slides-as-image-and-spreadsheet-using-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2021/01/13/updated-gas-library-batchrequest/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2021/01/13/updated-gas-library-batchrequest/">Updated: GAS Library - BatchRequest</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2021/01/16/trend-of-google-apps-script-tag-on-stackoverflow-2021/">Trend of google-apps-script Tag on Stackoverflow 2021</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2021/01/16/trend-of-google-apps-script-tag-on-stackoverflow-2021/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

