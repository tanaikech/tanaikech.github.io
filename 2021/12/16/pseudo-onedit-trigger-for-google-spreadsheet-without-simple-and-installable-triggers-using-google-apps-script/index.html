<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Pseudo OnEdit Trigger for Google Spreadsheet without Simple and Installable Triggers using Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>X</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Pseudo OnEdit Trigger for Google Spreadsheet without Simple and Installable Triggers using Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>16 Dec 2021, 17:46</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/05d9922a947232dbda5143b6ac6dc71f">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20211216a/fig1.gif" alt=""></p>
<p>This is a sample script for achieving the pseudo OnEdit trigger for Google Spreadsheet without the simple and the installable triggers using Google Apps Script.</p>
<p>Today, I saw <a href="https://stackoverflow.com/q/70367955/7108653">a question</a> at Stackoverflow. The goal of this question is as follows.</p>
<ul>
<li>There is a Google Spreadsheet created by a service account.</li>
<li>Goal is to use OnEdit trigger on this Spreadsheet.</li>
</ul>
<p>I thought a workaround for achieving this goal.</p>
<h2 id="issue-and-workaround">Issue and workaround:</h2>
<p>In the current stage, unfortunately, when the owner of Google Spreadsheet is the service account. The Google Apps Script cannot be run. By this, even when <code>onEdit</code> function is put to the script editor, this script cannot be run. It seems that this is the current specification of the Google side. Unfortunately, in the current stage, this goal cannot be directly achieved.</p>
<p>But, I thought that a workaround might be able to be proposed. Fortunately, the built-in functions of the Spreadsheet can be also used in the Spreadsheet created by the service account. I thought that this might be able to be used as a workaround.</p>
<p>And, I remembered the following my posts.</p>
<ul>
<li><a href="https://tanaikech.github.io/2017/12/23/automatic-recalculation-of-custom-function-on-spreadsheet-part-1/">Automatic Recalculation of Custom Function on Spreadsheet Part 1</a></li>
<li><a href="https://tanaikech.github.io/2021/11/15/letting-users-running-google-apps-script-on-google-spreadsheet-without-both-authorizing-scopes-and-showing-script/">Letting Users Running Google Apps Script on Google Spreadsheet without both Authorizing Scopes and Showing Script</a></li>
</ul>
<p>I thought that when these posts are used, a workaround might be able to be proposed. In this post, I would like to propose a workaround for achieving this goal. So, please think of this as the pseudo OnEdit trigger.</p>
<p>The flow of this workaround is as follows.</p>
<ol>
<li>Prepare 2 Spreadsheets.</li>
<li>Prepare Web Apps.
<ul>
<li>This Web Apps is deployed at the Google Apps Script project created by the Google account that the script can be run. Please be careful about this.</li>
</ul>
</li>
<li>When the pseudo OnEdit trigger is used in &ldquo;Sheet1&rdquo;, put <code>IMPORTXML</code> to a cell. <code>IMPORTXML</code> requests to the Web Apps.
<ul>
<li>This Spreadsheet is the Spreadsheet created by the service account.</li>
</ul>
</li>
<li>When the cells in &ldquo;Sheet1&rdquo; are edited, the formula is refreshed.</li>
</ol>
<p>By this flow, when the cells are edited, the Google Apps Script of Web Apps can be run by refreshing the formula. This is the pseudo OnEdit trigger as this workaround.</p>
<h2 id="usage">Usage:</h2>
<h3 id="1-create-2-spreadsheets">1. Create 2 Spreadsheets</h3>
<ul>
<li>
<p><strong>Spreadsheet &ldquo;A&rdquo;</strong>: Create this using the service account.</p>
<ul>
<li>Please share this Spreadsheet with your Google account as the writer.</li>
<li>Please set the sheet name to &ldquo;Sheet1&rdquo;.</li>
</ul>
</li>
<li>
<p><strong>Spreadsheet &ldquo;B&rdquo;</strong>: Create this using your Google account.</p>
<ul>
<li>This Spreadsheet is used as the storage and Web Apps.</li>
<li>Please set the sheet name to &ldquo;Sheet1&rdquo;.</li>
</ul>
</li>
</ul>
<h3 id="2-sample-script">2. Sample script:</h3>
<p>Please copy and paste the following script to the script editor of Spreadsheet &ldquo;B&rdquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">targetSpreadsheetId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the target Spreadsheet created by the service account.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sheet1&#34;</span>; <span style="color:#75715e">// In this sample, both sheet names of target and storage are the same.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// This function is used as the pseudo OnEdit trigger.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">doGet</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">v</span>) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ContentService</span>.<span style="color:#a6e22e">createTextOutput</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`&lt;result&gt;Edited at </span><span style="color:#e6db74">${</span><span style="color:#66d9ef">new</span> Date().<span style="color:#a6e22e">toISOString</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">. </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">v</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;/result&gt;`</span>
</span></span><span style="display:flex;"><span>    ).<span style="color:#a6e22e">setMimeType</span>(<span style="color:#a6e22e">ContentService</span>.<span style="color:#a6e22e">MimeType</span>.<span style="color:#a6e22e">XML</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">parameter</span>.<span style="color:#a6e22e">key</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;sample&#34;</span>) <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">response</span>(<span style="color:#e6db74">&#34;Wrong key.&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">range</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">parameter</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">lock</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">LockService</span>.<span style="color:#a6e22e">getDocumentLock</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">res</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">lock</span>.<span style="color:#a6e22e">tryLock</span>(<span style="color:#ae81ff">350000</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">targetSheet</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">targetSpreadsheetId</span>).<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">targetValues</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">targetSheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">range</span>).<span style="color:#a6e22e">getDisplayValues</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">storageSheet</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>().<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">storageValues</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">storageSheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">range</span>).<span style="color:#a6e22e">getDisplayValues</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">check</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">targetValues</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">ar</span>, <span style="color:#a6e22e">r</span>, <span style="color:#a6e22e">i</span>) =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">c</span>, <span style="color:#a6e22e">j</span>) =&gt; {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">storageValues</span>[<span style="color:#a6e22e">i</span>][<span style="color:#a6e22e">j</span>]) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">push</span>({
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">newValue</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">c</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">oldValue</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">storageValues</span>[<span style="color:#a6e22e">i</span>][<span style="color:#a6e22e">j</span>],
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">row</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">col</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ar</span>;
</span></span><span style="display:flex;"><span>      }, []);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">check</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">targetSheet</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">getRangeList</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">check</span>.<span style="color:#a6e22e">map</span>(({ <span style="color:#a6e22e">row</span>, <span style="color:#a6e22e">col</span> }) =&gt;
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">targetSheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">row</span>, <span style="color:#a6e22e">col</span>).<span style="color:#a6e22e">getA1Notation</span>()
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>          )
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">setBackground</span>(<span style="color:#e6db74">&#34;red&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">check</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">storageSheet</span>.<span style="color:#a6e22e">clear</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">storageSheet</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">targetValues</span>.<span style="color:#a6e22e">length</span>, <span style="color:#a6e22e">targetValues</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">length</span>)
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">targetValues</span>);
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;No change.&#34;</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">err</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">response</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">err</span>));
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">finally</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">lock</span>.<span style="color:#a6e22e">releaseLock</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">response</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">res</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">response</span>(<span style="color:#e6db74">&#34;timeout&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// At first, please run this script. By this, the current target sheet is saved.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// This workaround uses this saved sheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">copyCurrentSheet</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">targetValues</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">targetSpreadsheetId</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getDataRange</span>()
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getDisplayValues</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">storageSheet</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>().<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">storageSheet</span>.<span style="color:#a6e22e">clear</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">storageSheet</span>
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">targetValues</span>.<span style="color:#a6e22e">length</span>, <span style="color:#a6e22e">targetValues</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">length</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">targetValues</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="3-deploy-web-apps">3. Deploy Web Apps.</h3>
<p>The detailed information can be seen at <a href="https://developers.google.com/apps-script/guides/web#deploy_a_script_as_a_web_app">the official document</a>.</p>
<ol>
<li>On the script editor, at the top right of the script editor, please click &ldquo;click Deploy&rdquo; -&gt; &ldquo;New deployment&rdquo;.</li>
<li>Please click &ldquo;Select type&rdquo; -&gt; &ldquo;Web App&rdquo;.</li>
<li>Please input the information about the Web App in the fields under &ldquo;Deployment configuration&rdquo;.</li>
<li>Please select <strong>&ldquo;Me&rdquo;</strong> for <strong>&ldquo;Execute as&rdquo;</strong>.
<ul>
<li>This is the importance of this workaround.</li>
</ul>
</li>
<li>Please select <strong>&ldquo;Anyone&rdquo;</strong> for <strong>&ldquo;Who has access&rdquo;</strong>.
<ul>
<li>In your situation, I thought that this setting might be suitable.</li>
</ul>
</li>
<li>Please click &ldquo;Deploy&rdquo; button.</li>
<li>Copy the URL of the Web App. It&rsquo;s like <code>https://script.google.com/macros/s/###/exec</code>.
<ul>
<li><strong>When you modified the Google Apps Script, please modify the deployment as a new version. By this, the modified script is reflected in Web Apps. Please be careful this.</strong></li>
<li>You can see the detail of this in the report of &ldquo;<a href="https://gist.github.com/tanaikech/ebf92d8f427d02d53989d6c3464a9c43">Redeploying Web Apps without Changing URL of Web Apps for new IDE</a>&rdquo;.</li>
</ul>
</li>
</ol>
<h3 id="3-testing">3. Testing.</h3>
<p>You can see the demonstration at the top of image.</p>
<ol>
<li>
<p>In this sample script, please put the following formula to a cell &ldquo;D1&rdquo;. In this case, please use your Web Apps URL. If this cannot be done, please check the above flow again.</p>
<pre tabindex="0"><code>=IMPORTXML(&#34;https://script.google.com/macros/s/###/exec?key=sample&amp;values=&#34;&amp;TEXTJOIN(&#34;,&#34;,TRUE,Sheet1!A1:C5)&amp;&#34;&amp;range=A1:C5&#34;,&#34;/result&#34;)
</code></pre><ul>
<li>This sample OnEdit trigger uses the cells &ldquo;A1:C5&rdquo; of &ldquo;Sheet1&rdquo;.</li>
<li>This formula is a sample formula. So, please modify the range and formula for your actual situation.</li>
</ul>
</li>
<li>
<p>Please edit the cells &ldquo;A1:C5&rdquo; on &ldquo;Sheet1&rdquo;. By this, the formula of cell &ldquo;D1&rdquo; is refreshed, and by this refresh, Google Apps Script of Web Apps is run. This is the pseudo OnEdit trigger as this workaround.</p>
</li>
</ol>
<h2 id="note">Note:</h2>
<ul>
<li><strong>When you modified the Google Apps Script, please modify the deployment as a new version. By this, the modified script is reflected in Web Apps. Please be careful this.</strong></li>
<li>You can see the detail of this in the report of &ldquo;<a href="https://gist.github.com/tanaikech/ebf92d8f427d02d53989d6c3464a9c43">Redeploying Web Apps without Changing URL of Web Apps for new IDE</a>&rdquo;.</li>
<li>In this workaround, I think that you can retrieve the edited cells by checking the difference between before and after the edited sheet. But, this is a simple script for explaining this workaround. So, if you use this workaround, please modify the script for your actual situation.</li>
</ul>
<h2 id="references">References:</h2>
<ul>
<li><a href="https://developers.google.com/apps-script/guides/web">Web Apps</a></li>
<li><a href="https://github.com/tanaikech/taking-advantage-of-Web-Apps-with-google-apps-script">Taking advantage of Web Apps with Google Apps Script</a></li>
<li><a href="https://support.google.com/docs/answer/3093342">IMPORTXML</a></li>
<li>Referenced my posts.
<ul>
<li><a href="https://tanaikech.github.io/2017/12/23/automatic-recalculation-of-custom-function-on-spreadsheet-part-1/">Automatic Recalculation of Custom Function on Spreadsheet Part 1</a></li>
<li><a href="https://tanaikech.github.io/2021/11/15/letting-users-running-google-apps-script-on-google-spreadsheet-without-both-authorizing-scopes-and-showing-script/">Letting Users Running Google Apps Script on Google Spreadsheet without both Authorizing Scopes and Showing Script</a></li>
</ul>
</li>
<li>I answered this workaround to <a href="https://stackoverflow.com/q/70367955/7108653">this thread of Stackoverflow</a>.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2021%2f12%2f16%2fpseudo-onedit-trigger-for-google-spreadsheet-without-simple-and-installable-triggers-using-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2021%2f12%2f16%2fpseudo-onedit-trigger-for-google-spreadsheet-without-simple-and-installable-triggers-using-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2021%2f12%2f16%2fpseudo-onedit-trigger-for-google-spreadsheet-without-simple-and-installable-triggers-using-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2021%2f12%2f16%2fpseudo-onedit-trigger-for-google-spreadsheet-without-simple-and-installable-triggers-using-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2021%2f12%2f16%2fpseudo-onedit-trigger-for-google-spreadsheet-without-simple-and-installable-triggers-using-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2021%2f12%2f16%2fpseudo-onedit-trigger-for-google-spreadsheet-without-simple-and-installable-triggers-using-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2021/12/11/using-google-forms-api-with-google-apps-script/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2021/12/11/using-google-forms-api-with-google-apps-script/">Using Google Forms API with Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2021/12/17/github-google-forms-api-apps-script-web-app/">GitHub: Google Forms API Apps Script Web app</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2021/12/17/github-google-forms-api-apps-script-web-app/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

