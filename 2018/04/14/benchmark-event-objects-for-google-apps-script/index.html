<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.49.2" />

  <title>Benchmark: Event Objects for Google Apps Script &middot; tanaike</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://plus.google.com/+KanshiTanaike" target="_blank"><i class="fa fa-google-plus-square fa-fw"></i>Google+</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" target="_blank"><i class="fa fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Benchmark: Event Objects for Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>14 Apr 2018, 14:45</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/benchmark">Benchmark</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

</div>

  

<p><a href="https://gist.github.com/tanaikech/4892c97df7ac0504ffd715c2dd6cd546">Gists</a></p>

<h1 id="introduction">Introduction</h1>

<p>There are event objects at Google Apps Script. Typically, users which use Spreadsheet often use <code>onEdit(event)</code>. Here, I would like to introduce the process costs for the event objects using this <code>onEdit(event)</code>.</p>

<p>When <code>onEdit(event)</code> is used for the spreadsheet, <code>event</code> of <code>onEdit(event)</code> has the following structure.</p>

<pre><code class="language-json">{
  &quot;authMode&quot;: {},
  &quot;range&quot;: {
    &quot;columnStart&quot;: 1,
    &quot;rowStart&quot;: 1,
    &quot;rowEnd&quot;: 1,
    &quot;columnEnd&quot;: 1
  },
  &quot;source&quot;: {},
  &quot;oldValue&quot;: &quot;old sample text&quot;,
  &quot;user&quot;: {
    &quot;nickname&quot;: &quot;sampleName&quot;,
    &quot;email&quot;: &quot;sample email&quot;
  },
  &quot;value&quot;: &quot;sample text&quot;
}
</code></pre>

<p>In this structure, for example, the range of active cell is <code>&quot;range&quot;: {&quot;columnStart&quot;: 1, &quot;rowStart&quot;: 1, &quot;rowEnd&quot;: 1, &quot;columnEnd&quot;: 1 }</code>. Namely, it&rsquo;s &ldquo;A1&rdquo;. Users can use the range of active cell using this event object. In this report, I have investigated the process cost for retrieving the range of active cell as a sample.</p>

<h1 id="experimental-procedure">Experimental procedure</h1>

<p>The sample script is as follows.</p>

<pre><code class="language-javascript">function onEdit(e) {
  var start = Date.now();
  for (var i = 0; i &lt; 5000; i++) {
    var range = e.range.getA1Notation(); // A1
  }
  Logger.log(&quot;%s [s]&quot;, (Date.now() - start) / 1000);

  var start = Date.now();
  for (var i = 0; i &lt; 5000; i++) {
    var range = e.source.getActiveCell().getA1Notation(); // A1
  }
  Logger.log(&quot;%s [s]&quot;, (Date.now() - start) / 1000);

  var start = Date.now();
  for (var i = 0; i &lt; 5000; i++) {
    var range = SpreadsheetApp.getActiveSheet().getActiveCell().getA1Notation(); // A1
  }
  Logger.log(&quot;%s [s]&quot;, (Date.now() - start) / 1000);
}
</code></pre>

<p>In this sample script, the range of active cell is retrieved for 5000 times, and the time is measured. In this experiment, the average values of 10 times were used as the result.</p>

<h1 id="results">Results</h1>

<table>
<thead>
<tr>
<th align="left">method</th>
<th align="center">Time in 5000 times [s]</th>
<th align="center">Time in 1 times [ms]</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">e.range.getA1Notation()</td>
<td align="center">0.784</td>
<td align="center">0.157</td>
</tr>

<tr>
<td align="left">e.source.getActiveCell().getA1Notation()</td>
<td align="center">4.048</td>
<td align="center">0.810</td>
</tr>

<tr>
<td align="left">SpreadsheetApp.getActiveSheet().getActiveCell().getA1Notation()</td>
<td align="center">7.370</td>
<td align="center">1.474</td>
</tr>
</tbody>
</table>

<p>From above table, it was found that the process cost of <code>e.range.getA1Notation()</code> was 20 % and 10 % for those of <code>e.source.getActiveCell().getA1Notation()</code> and <code>SpreadsheetApp.getActiveSheet().getActiveCell().getA1Notation()</code>, respectively. It is considered that these process costs depend on the number of use of APIs. As the result, it was found that the event objects can decrease the process cost in the scripts. Although this is the general result, also I think that it is important to quantitatively know this.</p>

<h1 id="reference">Reference</h1>

<ul>
<li><a href="https://developers.google.com/apps-script/guides/triggers/events">Event Objects</a></li>
</ul>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2018/03/16/unicode-normalization-using-google-apps-script/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2018/03/16/unicode-normalization-using-google-apps-script/">Unicode normalization using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2018/04/16/benchmark-loop-for-array-processing-using-google-apps-script/">Benchmark: Loop for Array Processing using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2018/04/16/benchmark-loop-for-array-processing-using-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    }
  });
</script>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>
<meta http-equiv="X-UA-Compatible" CONTENT="IE=EmulateIE7" />


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-84325623-1', 'auto');
    ga('send', 'pageview');
  }
</script>





</body>
</html>

