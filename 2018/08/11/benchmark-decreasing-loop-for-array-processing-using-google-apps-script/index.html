<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.49.2" />

  <title>Benchmark: Decreasing Loop for Array Processing using Google Apps Script &middot; tanaike</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://plus.google.com/+KanshiTanaike" target="_blank"><i class="fa fa-google-plus-square fa-fw"></i>Google+</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" target="_blank"><i class="fa fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Benchmark: Decreasing Loop for Array Processing using Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>11 Aug 2018, 16:25</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/benchmark">Benchmark</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

</div>

  

<p><a href="https://gist.github.com/tanaikech/fdd8462a46179efb156cfa0550695c6e">Gists</a></p>

<p><a name="TOP"></a></p>

<h1 id="benchmark-decreasing-loop-for-array-processing-using-google-apps-script">Benchmark: Decreasing Loop for Array Processing using Google Apps Script</h1>

<p><center>
August 11, 2018
    Published.</p>

<p>Kanshi Tanaike
</center></p>

<h1 id="introduction">Introduction</h1>

<p><strong>Please be careful! This result can be only used for Google Apps Script.</strong></p>

<p>There are a limit executing time for Google Apps Script (GAS). That is 6 minutes. <a href="#References"><sup>1</sup></a> So users always have to pay attention to reducing the process cost of the scripts. Especially, it is very important to know the process cost for the array processing, because the array processing is often used for spreadsheet and Google APIs. I have already reported the process costs for various processes as reports. <a href="#References"><sup>2-7</sup></a> In this report, the process cost of &ldquo;Decreasing loop&rdquo; for the array processing using GAS has been investigated.</p>

<h1 id="experimental-procedure">Experimental procedure</h1>

<p>In this report, one dimensional array was used as the sample array. The array processing was performed by &ldquo;Decreasing for loop&rdquo;, &ldquo;Increasing for loop using reversed array&rdquo; and &ldquo;filter using reversed array&rdquo;. About the reversed array, &ldquo;Array.prototype.reverse()&rdquo; was used for the created sample array. <a href="#References"><sup>8</sup></a> The results of array processing of &ldquo;Increasing for loop&rdquo; and &ldquo;filter&rdquo; were used as the references. The process time was measured and the results were compared. In order to measure the process cost of array processing, the script which retrieves the multiple of 5 from the elements of arrays was used as a sample script. The sample scripts of GAS which were used for this report are here. <a href="#SampleScripts"><sup>a</sup></a> For measuring the process cost, the cost for creating array to use at the methods is not included. By the way, at GAS, the processing time is not stable as you know. So the average value for more than 100 times measurements was used for each data point which is shown by figures. At this time, the fluctuation of the average values was less than 1 %. I worry that each detailed-data point at my environment might be different from that at other user&rsquo;s environment. But I think that the trend of this result can be used.</p>

<h1 id="results">Results</h1>

<p><img src="https://tanaikech.github.io/img/20180811a-fig1.png" alt="" /></p>

<p>Fig 1. Number of elements vs. processing time.</p>

<p><br></p>

<p>Figure 1 shows number of elements vs. processing time. &ldquo;Decreasing for loop&rdquo;, &ldquo;Increasing for loop&rdquo;, &ldquo;Increasing for loop using reversed array&rdquo;, &ldquo;filter using reversed array&rdquo; and &ldquo;filter&rdquo; are shown as blue dots, red dots, yellow dots, green dots and orange dots, respectively. You can see each script at <a href="#SampleScripts">here</a>. From this figure, it is found that the cost of &ldquo;filter using reversed array&rdquo; is lower than that of &ldquo;Decreasing for loop&rdquo;. For quantitatively evaluation, &ldquo;filter using reversed array&rdquo; makes the process cost be 43 % lower compare with &ldquo;Decreasing for loop&rdquo;. Also it is found that &ldquo;Decreasing for loop&rdquo; is almost the same with &ldquo;Increasing for loop&rdquo;. This is an interesting results. From &ldquo;Increasing for loop using reversed array&rdquo; and &ldquo;Increasing for loop&rdquo;, the cost of &ldquo;reverse()&rdquo; is 9 % of &ldquo;Increasing for loop&rdquo;. And from &ldquo;filter using reversed array&rdquo; and &ldquo;filter&rdquo;, the cost of &ldquo;reverse()&rdquo; is 6 % of &ldquo;filter&rdquo;. This indicates that the cost of &ldquo;reverse()&rdquo; is sufficiently small for each process. From these results, it was found that when the array process is run with decreasing loop, &ldquo;filter using reversed array&rdquo; is the best way for GAS.</p>

<h1 id="summary">Summary</h1>

<p>In this report, the process cost for the array processing with decreasing loop has been investigated. From this investigation, the following results were obtained.</p>

<ol>
<li>&ldquo;filter using reversed array&rdquo; makes the process cost be 43 % lower compare with &ldquo;Decreasing for loop&rdquo;.

<ul>
<li>&ldquo;reversed array&rdquo; was obtained using &ldquo;Array.prototype.reverse()&rdquo; for the created a sample array.</li>
</ul></li>
<li>&ldquo;Decreasing for loop&rdquo; is almost the same with &ldquo;Increasing for loop&rdquo;.</li>
<li>Cost of &ldquo;reverse()&rdquo; is sufficiently small for &ldquo;for loop&rdquo; and &ldquo;filter&rdquo;.</li>
</ol>

<p>As a note, I have to describe that this is the result for Google Apps Script. For other languages, this result might be difference. And also, the process cost of this report might be modified by future update of Google.</p>

<p><a name="References"></a></p>

<h1 id="references">References</h1>

<ol>
<li><a href="https://developers.google.com/apps-script/guides/services/quotas#current_limitations">Current limitations at Quotas for Google Services</a></li>
<li><a href="https://gist.github.com/tanaikech/eda9234822b5dec80549216a43c52652">Benchmark: Search for Array Processing using Google Apps Script</a></li>
<li><a href="https://gist.github.com/tanaikech/848aeafaac1ec676900bb78e3ce220b6">Benchmark: Loop for Array Processing using Google Apps Script</a></li>
<li><a href="https://gist.github.com/tanaikech/4892c97df7ac0504ffd715c2dd6cd546">Benchmark: Event Objects for Google Apps Script</a></li>
<li><a href="https://gist.github.com/tanaikech/c0f383034045ab63c19604139ecb0728">Benchmark: fetchAll method in UrlFetch service for Google Apps Script</a></li>
<li><a href="https://tanaikech.github.io/2016/10/13/improved-algorithms-for-summation-of-array-elements/">Improved Algorithms for Summation of Array Elements</a></li>
<li><a href="https://gist.github.com/tanaikech/cef47530a58f2d8692cdb1a9d257907b">Benchmark: Conditional Branch using Google Apps Script</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reverse">Array.prototype.reverse()</a></li>
</ol>

<h1 id="appendix">Appendix</h1>

<p><a name="SampleScripts"></a></p>

<h2 id="scripts">Scripts</h2>

<h3 id="creating-sample-arrays">Creating sample arrays</h3>

<p>The function for creating array is as follows.</p>

<pre><code class="language-javascript">function make1dArray(row) {
  var ar = [];
  for (var i = 0; i &lt; row; i++) {
    ar[i] = i + 1;
  }
  return ar;
}
</code></pre>

<h3 id="for-1-dimensional-array">For 1 dimensional array</h3>

<pre><code class="language-javascript">// Decreasing for loop
var result = [];
for (var i = array.length - 1; i &gt;= 0; i--) {
  if (array[i] % 5 == 0) {
    result.push(array[i]);
  }
}

// Increasing for loop using reversed array
array = array.reverse();
var result = [];
for (var i = 0; i &lt; array.length; i++) {
  if (array[i] % 5 == 0) {
    result.push(array[i]);
  }
}

// filter using reversed array
var result = array.reverse().filter(function(e) {return e % 5 == 0});


// Increasing for loop
var result = [];
for (var i = 0; i &lt; array.length; i++) {
  if (array[i] % 5 == 0) {
    result.push(array[i]);
  }
}

// filter
var result = array.filter(function(e) {return e % 5 == 0});
</code></pre>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2018/08/05/retrieving-screen-shots-of-sites-using-google-apps-script/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2018/08/05/retrieving-screen-shots-of-sites-using-google-apps-script/">Retrieving Screen Shots of Sites using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2018/08/13/upload-files-to-google-drive-using-javascript/">Upload Files to Google Drive using Javascript</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2018/08/13/upload-files-to-google-drive-using-javascript/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    }
  });
</script>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>
<meta http-equiv="X-UA-Compatible" CONTENT="IE=EmulateIE7" />


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-84325623-1', 'auto');
    ga('send', 'pageview');
  }
</script>





</body>
</html>

