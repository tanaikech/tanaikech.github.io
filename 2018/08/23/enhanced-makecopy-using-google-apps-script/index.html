<!DOCTYPE html>
<html lang="en">
<meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.88.1" />

  <title>Enhanced makeCopy() using Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Enhanced makeCopy() using Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>23 Aug 2018, 14:28</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/file">file</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/cpoy">cpoy</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/ac1b0d50fe1ffaa40e95bbe9faf908b9">Gists</a></p>
<h2 id="overview">Overview</h2>
<p>This is sample scripts for copying files to a specific folder in Google Drive using Google Apps Script (GAS).</p>
<h2 id="description">Description</h2>
<p>When the files in Google Drive are copied to a specific folder using GAS, most users will use <a href="https://developers.google.com/apps-script/reference/drive/file#makecopydestination">makeCopy(destination)</a>. When the files are copied using makeCopy(), you might have already noticed that only the standalone projects cannot be copied to the specific folder. They are copied to the root folder (My Drive). Also this situation can be also seen even when &ldquo;copy&rdquo; of Drive API v2 and v3 is used. I think that this might be a bug. So I would like to introduce 2 sample scripts as the workaround. In the workaround, it uses Drive API.</p>
<h2 id="sample-script-1">Sample script 1</h2>
<p>This sample is very simple.</p>
<ol>
<li>Retrieve files in source folder.</li>
<li>Copy the files to destination folder.</li>
<li>If the file is the standalone project, the file is moved from the root folder to the destination folder using &ldquo;update&rdquo; method of Drive API.</li>
</ol>
<p>When you use this sample, please enable Drive API at Advanced Google Services and API console.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">makeCopy</span>(<span style="color:#a6e22e">srcFolderId</span>, <span style="color:#a6e22e">dstFolderId</span>) {
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">srcFolder</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFolderById</span>(<span style="color:#a6e22e">srcFolderId</span>);
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">dstFolder</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFolderById</span>(<span style="color:#a6e22e">dstFolderId</span>);
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">files</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">srcFolder</span>.<span style="color:#a6e22e">getFiles</span>();
  <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">hasNext</span>()) {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">next</span>();
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">f</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">makeCopy</span>(<span style="color:#a6e22e">dstFolder</span>);
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getMimeType</span>() <span style="color:#f92672">==</span> <span style="color:#a6e22e">MimeType</span>.<span style="color:#a6e22e">GOOGLE_APPS_SCRIPT</span>) {
      <span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">update</span>({<span style="color:#e6db74">&#34;parents&#34;</span><span style="color:#f92672">:</span> [{<span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">dstFolderId</span>}]}, <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">getId</span>());
    }
  }
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">run</span>() {
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">srcFolderId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;### folder ID with source files ###&#34;</span>;
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">dstFolderId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;### destination folder ID ###&#34;</span>;
  <span style="color:#a6e22e">makeCopy</span>(<span style="color:#a6e22e">srcFolderId</span>, <span style="color:#a6e22e">dstFolderId</span>);
}
</code></pre></div><p>If you want to use DriveApp instead of Drive API, please modify as follows.</p>
<h4 id="from">From:</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">update</span>({<span style="color:#e6db74">&#34;parents&#34;</span><span style="color:#f92672">:</span> [{<span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">dstFolderId</span>}]}, <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">getId</span>());
</code></pre></div><h4 id="to">To:</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">dstFolder</span>.<span style="color:#a6e22e">addFile</span>(<span style="color:#a6e22e">file</span>);
<span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">getParents</span>().<span style="color:#a6e22e">next</span>().<span style="color:#a6e22e">removeFile</span>(<span style="color:#a6e22e">file</span>);
</code></pre></div><h2 id="sample-script-2">Sample script 2</h2>
<p>In the sample script 1, the Drive API is required to be called for the number of the standalone projects. In order to reduce the number of calling Drive API, this sample uses the batch request. The flow is as follows.</p>
<ol>
<li>Retrieve files in source folder.</li>
<li>Create the request body for copying files to the destination folder using &ldquo;copy&rdquo; of Drive API.</li>
<li>Run the request body by the batch request.</li>
<li>Create the request body for moving files (the standalone projects) from the root to the destination folder using &ldquo;update&rdquo; of Drive API.</li>
<li>Run the request body by the batch request.</li>
</ol>
<p>From this flow, when the number of total files is less than 100, the number of API calls is 2. And the batch request is worked by the asynchronous processing. So the copy speed of sample 2 is faster than that of sample 1.</p>
<p>When you use this sample, please enable Drive API at API console. And please install <a href="https://github.com/tanaikech/BatchRequest">the GAS library (BatchRequest) for using batch request at GAS</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">makeCopy</span>(<span style="color:#a6e22e">srcFolderId</span>, <span style="color:#a6e22e">dstFolderId</span>) {
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">parseBatchRes</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">res</span>) {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">splittedRes</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;--batch&#34;</span>);
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">splittedRes</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">splittedRes</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">map</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e</span>) {
      <span style="color:#66d9ef">return</span> {
        <span style="color:#a6e22e">contentId</span><span style="color:#f92672">:</span> Number(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">match</span>(<span style="color:#e6db74">/Content-ID: response-(\d+)/</span>)[<span style="color:#ae81ff">1</span>]),
        <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> Number(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">match</span>(<span style="color:#e6db74">/HTTP\/\d+.\d+ (\d+)/</span>)[<span style="color:#ae81ff">1</span>]),
        <span style="color:#a6e22e">object</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">match</span>(<span style="color:#e6db74">/{[\S\s]+}/</span>)[<span style="color:#ae81ff">0</span>]),
      };
    });
  };
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">baseUrl</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://www.googleapis.com/drive/v3/files/&#34;</span>;
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">fields</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;fields=id%2CmimeType%2Cname%2Cparents&#34;</span>;
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">folder</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFolderById</span>(<span style="color:#a6e22e">srcFolderId</span>);
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">files</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">folder</span>.<span style="color:#a6e22e">getFiles</span>();
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">req1</span> <span style="color:#f92672">=</span> {
    <span style="color:#a6e22e">batchPath</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;batch/drive/v3&#34;</span>,
    <span style="color:#a6e22e">requests</span><span style="color:#f92672">:</span> [],
  };
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">project</span> <span style="color:#f92672">=</span> [];
  <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">hasNext</span>()) {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">next</span>();
    <span style="color:#a6e22e">req1</span>.<span style="color:#a6e22e">requests</span>.<span style="color:#a6e22e">push</span>({
      <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;POST&#34;</span>,
      <span style="color:#a6e22e">endpoint</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">baseUrl</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getId</span>() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/copy?&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">fields</span>,
      <span style="color:#a6e22e">requestBody</span><span style="color:#f92672">:</span> {<span style="color:#a6e22e">parents</span><span style="color:#f92672">:</span> [<span style="color:#a6e22e">dstFolderId</span>], <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getName</span>()},
    });
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">getMimeType</span>() <span style="color:#f92672">==</span> <span style="color:#a6e22e">MimeType</span>.<span style="color:#a6e22e">GOOGLE_APPS_SCRIPT</span>) {
      <span style="color:#a6e22e">project</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">req1</span>.<span style="color:#a6e22e">requests</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>);
    }
  }
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">res1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">BatchRequest</span>.<span style="color:#a6e22e">Do</span>(<span style="color:#a6e22e">req1</span>).<span style="color:#a6e22e">getContentText</span>();
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">r1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">parseBatchRes</span>(<span style="color:#a6e22e">res1</span>);
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">req2</span> <span style="color:#f92672">=</span> {
    <span style="color:#a6e22e">batchPath</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;batch/drive/v3&#34;</span>,
    <span style="color:#a6e22e">requests</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">project</span>.<span style="color:#a6e22e">map</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e</span>) {<span style="color:#66d9ef">return</span> {
        <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;PATCH&#34;</span>,
        <span style="color:#a6e22e">endpoint</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">baseUrl</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">r1</span>[<span style="color:#a6e22e">e</span>].<span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">id</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;?addParents=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">dstFolderId</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&amp;removeParents=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">r1</span>[<span style="color:#a6e22e">e</span>].<span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">parents</span>[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&amp;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">fields</span>,
      },
    }),
  };
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">res2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">BatchRequest</span>.<span style="color:#a6e22e">Do</span>(<span style="color:#a6e22e">req2</span>).<span style="color:#a6e22e">getContentText</span>();
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">r2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">parseBatchRes</span>(<span style="color:#a6e22e">res2</span>);
  <span style="color:#a6e22e">project</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">i</span>) {
    <span style="color:#a6e22e">r1</span>[<span style="color:#a6e22e">e</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">r2</span>[<span style="color:#a6e22e">i</span>];
  });
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">r1</span>.<span style="color:#a6e22e">map</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e</span>){<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">object</span>});
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">run</span>() {
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">srcFolderId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;### folder ID with source files ###&#34;</span>;
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">dstFolderId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;### destination folder ID ###&#34;</span>;
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">makeCopy</span>(<span style="color:#a6e22e">srcFolderId</span>, <span style="color:#a6e22e">dstFolderId</span>);
  <span style="color:#a6e22e">Logger</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>)
}
</code></pre></div><h2 id="note">Note</h2>
<ul>
<li>At &ldquo;update&rdquo; of Drive API v2, the parent ID can be directly overwritten. But at Drive API v3, it cannot do it. So the file is moved using <code>addParents</code> and <code>removeParents</code>.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2018%2f08%2f23%2fenhanced-makecopy-using-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2018%2f08%2f23%2fenhanced-makecopy-using-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2018%2f08%2f23%2fenhanced-makecopy-using-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2018%2f08%2f23%2fenhanced-makecopy-using-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2018%2f08%2f23%2fenhanced-makecopy-using-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2018%2f08%2f23%2fenhanced-makecopy-using-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2018/08/20/replacing-text-to-image-for-google-document-using-google-apps-script/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2018/08/20/replacing-text-to-image-for-google-document-using-google-apps-script/">Replacing Text to Image for Google Document using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2018/09/02/gas-library-downloadlargefilesbyurl/">GAS Library - DownloadLargeFilesByUrl</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2018/09/02/gas-library-downloadlargefilesbyurl/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    }
  });
</script>






<script async src="https://www.googletagmanager.com/gtag/js?id=UA-84325623-1"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-84325623-1');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-J3Z6T50WL5');
</script>

</body>
</html>

