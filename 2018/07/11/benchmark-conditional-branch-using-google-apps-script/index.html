<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.49.2" />

  <title>Benchmark: Conditional Branch using Google Apps Script &middot; tanaike</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" target="_blank"><i class="fa fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Benchmark: Conditional Branch using Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>11 Jul 2018, 13:36</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/benchmark">Benchmark</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/conditional-branch">conditional branch</a>
    
  </div>
  
  

</div>

  

<p><a href="https://gist.github.com/tanaikech/cef47530a58f2d8692cdb1a9d257907b">Gists</a></p>

<p><a name="TOP"></a></p>

<h1 id="benchmark-conditional-branch-using-google-apps-script">Benchmark: Conditional Branch using Google Apps Script</h1>

<p><center>
July 11, 2018</p>

<p>Kanshi Tanaike
</center></p>

<h1 id="introduction">Introduction</h1>

<p><strong>Please be careful! This result can be only used for Google Apps Script.</strong></p>

<p>There are a limit executing time for Google Apps Script (GAS). That is 6 minutes.<a href="#References"><sup>1</sup></a> So users always have to pay attention to reducing the process cost of the scripts. Especially, it is very important to know the process cost for the array processing, because the array processing is often used for spreadsheet and Google APIs. Recently, I have already published some reports about the process cost using GAS.<a href="#References"><sup>2-6</sup></a> From these reports, it has found that GAS shows much different process cost from other languages. So it is important to investigate the process cost for various scenes. In this report, the process cost of &ldquo;conditional branch&rdquo; using GAS has been investigated.</p>

<p>Here, the following 4 methods for the conditional branch were used. And as the sample situation, a single condition branch and multiple condition branches (10 branches) are used for measuring the process cost. In this report, for example, a single conditional branch is <code>if (value === &quot;value&quot;) {r = &quot;true&quot;} else {r = &quot;false&quot;}</code>.</p>

<ol>
<li>If</li>
<li>Switch</li>
<li>Ternary operator</li>
<li>Logical operator</li>
</ol>

<p>As the result, it was found that the cost of &ldquo;Ternary operator&rdquo; was the lowest of all methods and conditions. Namely, it was the fastest of all. About 2nd rank, the interesting results were obtained. For the single conditional branch, 2nd one was &ldquo;If&rdquo;. But for the multiple conditional branches, &ldquo;Switch&rdquo; was the 2nd one. This indicates that &ldquo;If&rdquo; and &ldquo;Switch&rdquo; are suitable for the single and multiple conditional branches, respectively. &ldquo;Logical operator&rdquo; was the lowest rank for the single and multiple conditional branches.</p>

<h1 id="experimental-procedure">Experimental procedure</h1>

<p>In the experiment, the sample scripts for GAS were used.<a href="#Appendix"><sup>Appendix</sup></a> For 4 methods of &ldquo;If&rdquo;, &ldquo;Switch&rdquo;, &ldquo;Ternary operator&rdquo; and &ldquo;Logical operator&rdquo;, 2 conditions were used for measuring the process cost. Namely, the process times of them were measured. Those were the single conditional branch and the multiple conditional branches (10 branches). By the way, at GAS, the processing time is not stable as you know. So for each method, the average values which measured 1,000,000 times were used as the process time (process cost). Furthermore, the average value for more than 100 times measurements was used for each data point which is shown by figures. At this time, the fluctuation of the average values was less than 1 %. I worry that each detailed-data point at my environment might be different from that at other userâ€™s environment. But I think that the trend of this result can be used.</p>

<h1 id="results">Results</h1>

<p><img src="https://tanaikech.github.io/img/20180711a-fig1.png" alt="" /></p>

<p>Fig 1. Processing time (process cost) for single conditional branch.</p>

<p><br></p>

<p>Figure 1 shows the processing time (process cost) for single conditional branch. Since the absolute process time is microsecond order, it is considered that the differences of each method is a little. But when such conditional branch is used for many places in the script, the process cost will get to be able to be ignored. From Fig. 1, in the case of the single conditional branch, the process cost becomes higher in order of &ldquo;Ternary operator&rdquo;, &ldquo;If&rdquo;, &ldquo;Switch&rdquo; and &ldquo;Logical operator&rdquo;. For the single conditional branch, using Fig. 1, the quantitative differences of these methods are as follows.</p>

<ul>
<li>Cost of &ldquo;If&rdquo; is 8 % larger than that of &ldquo;Ternary operator&rdquo;.</li>
<li>Cost of &ldquo;Switch&rdquo; is 15 % larger than that of &ldquo;Ternary operator&rdquo;.</li>
<li>Cost of &ldquo;Logical operator&rdquo; is 16 % larger than that of &ldquo;Ternary operator&rdquo;.</li>
<li>When &ldquo;If&rdquo; is used for the single conditional branches, it can reduce the cost of 6 % for &ldquo;Switch&rdquo;.</li>
</ul>

<p><img src="https://tanaikech.github.io/img/20180711a-fig2.png" alt="" /></p>

<p>Fig 2. Processing time (process cost) for multiple conditional branches (10 branches). The solid lines with the color of blue, red, orange and green mean the result from &ldquo;If&rdquo;, &ldquo;Switch&rdquo;, &ldquo;Ternary operator&rdquo; and &ldquo;Logical operator&rdquo;, respectively. Horizontal axis means the process time of the position of branch when true is obtained. For example, when the condition is true at 7th branch, the position is 7.</p>

<p><br></p>

<p>Figure 2 shows the processing time (process cost) for multiple conditional branches (10 branches). The solid lines with the color of blue, red, orange and green mean the result from &ldquo;If&rdquo;, &ldquo;Switch&rdquo;, &ldquo;Ternary operator&rdquo; and &ldquo;Logical operator&rdquo;, respectively. Horizontal axis means the process time of the position of branch when true is obtained. For example, when the condition is true at 7th branch, the position is 7. From Fig. 2, the process cost linearly increases with the increase in the position of condition. For one method, it is found that the comparison of the variable is carried out every branch and each cost is the same. This means that the cost can be reduced by put the condition with the high possibility of &ldquo;true&rdquo; to the fore. In the case of multiple conditional branches (more than 2 branches), the process cost becomes higher in order of &ldquo;Ternary operator&rdquo;, &ldquo;Switch&rdquo;, &ldquo;If&rdquo; and &ldquo;Logical operator&rdquo;. For the multiple conditional branches, using Fig. 2, the quantitative differences of these methods are as follows.</p>

<ul>
<li>Cost of &ldquo;If&rdquo; is 25 % larger than that of &ldquo;Ternary operator&rdquo;.</li>
<li>Cost of &ldquo;Switch&rdquo; is 2 % larger than that of &ldquo;Ternary operator&rdquo;.</li>
<li>Cost of &ldquo;Logical operator&rdquo; is 96 % larger than that of &ldquo;Ternary operator&rdquo;.</li>
<li>When &ldquo;Switch&rdquo; is used for the multiple conditional branches, it can reduce the cost of 25 % for &ldquo;If&rdquo;.</li>
</ul>

<p>When it looks carefully at Figs. 1 and Fig. 2, it is found that the process costs of &ldquo;If&rdquo; and &ldquo;Switch&rdquo; invert between Fig. 1 and Fig. 2. When the slope of Fig. 2 is calculated, the difference can be found well.</p>

<p><img src="https://tanaikech.github.io/img/20180711a-fig3.png" alt="" /></p>

<p>Fig 3. Slope for each method calculated from Fig. 2.</p>

<p><br></p>

<p>Figure 3 shows the the slope for each method calculated from Fig. 2. So the unit is microseconds/position. From Fig. 3, it is found that at the case of multiple conditional branches, &ldquo;Switch&rdquo; is more suitable than &ldquo;If&rdquo;. So from Figs. 1, 2 and 3, It is considered that this indicates that &ldquo;If&rdquo; and &ldquo;Switch&rdquo; are suitable for the single conditional branch and the multiple conditional branches, respectively. And it is found that &ldquo;Ternary operator&rdquo; can be used for both conditional branches with the low cost. On the other hand, it is considered that &ldquo;Logical operator&rdquo; is not suitable for the general use, because of the high cost and low readability.</p>

<h1 id="summary">Summary</h1>

<p>In this report, the process cost of &ldquo;conditional branch&rdquo; using GAS has been investigated. 4 methods of &ldquo;If&rdquo;, &ldquo;Switch&rdquo;, &ldquo;Ternary operator&rdquo; and &ldquo;Logical operator&rdquo; were used for this report. The following results were obtained.</p>

<ol>
<li>It was found that the cost of &ldquo;Ternary operator&rdquo; was the lowest of all methods and conditions.</li>
<li>For the single conditional branch, 2nd one was &ldquo;If&rdquo;. But for the multiple conditional branches, &ldquo;Switch&rdquo; was the 2nd one. This indicates that &ldquo;If&rdquo; and &ldquo;Switch&rdquo; are suitable for the single and multiple conditional branches (more than 2 branches), respectively.</li>
<li>In the case of the multiple conditional branches, the process cost can be reduced by put the condition with the high possibility of &ldquo;true&rdquo; to the fore.</li>
<li>&ldquo;Logical operator&rdquo; was the lowest rank for the single and multiple conditional branches. It is considered that &ldquo;Logical operator&rdquo; is not suitable for the general use, because of the high cost and low readability.</li>
</ol>

<p>As a note, I have to describe that this is the result for Google Apps Script. For other languages, this result might be difference. And also, the process cost of this report might be modified by future update of Google.</p>

<p><a name="References"></a></p>

<h1 id="references">References</h1>

<ol>
<li><a href="https://developers.google.com/apps-script/guides/services/quotas#current_limitations">Current limitations at Quotas for Google Services</a></li>
<li><a href="https://gist.github.com/tanaikech/eda9234822b5dec80549216a43c52652">Benchmark: Search for Array Processing using Google Apps Script</a></li>
<li><a href="https://gist.github.com/tanaikech/848aeafaac1ec676900bb78e3ce220b6">Benchmark: Loop for Array Processing using Google Apps Script</a></li>
<li><a href="https://gist.github.com/tanaikech/4892c97df7ac0504ffd715c2dd6cd546">Benchmark: Event Objects for Google Apps Script</a></li>
<li><a href="https://gist.github.com/tanaikech/c0f383034045ab63c19604139ecb0728">Benchmark: fetchAll method in UrlFetch service for Google Apps Script</a></li>
<li><a href="https://tanaikech.github.io/2016/10/13/improved-algorithms-for-summation-of-array-elements/">Improved Algorithms for Summation of Array Elements</a></li>
</ol>

<p><a name="Appendix"></a></p>

<h2 id="appendix">Appendix</h2>

<h3 id="scripts">Scripts</h3>

<h4 id="sample-scripts-for-a-single-conditional-branch">Sample scripts for a single conditional branch.</h4>

<pre><code class="language-javascript">// If
if (value === &quot;value&quot;) {
  r = &quot;true&quot;;
} else {
  r = &quot;false&quot;;
}


// Switch
switch (value) {
  case &quot;value&quot;:
    r = &quot;true&quot;;
    break;
  default:
    r = &quot;false&quot;;
    break;
}


// Ternary operator
r = value === &quot;value&quot; ? &quot;true&quot; : &quot;false&quot;;


// Logical operator
r = value === &quot;value&quot; &amp;&amp; &quot;true&quot; || &quot;false&quot;;
</code></pre>

<h4 id="sample-scripts-for-the-multiple-conditional-branches-10-branches">Sample scripts for the multiple conditional branches (10 branches).</h4>

<pre><code class="language-javascript">// If
if (value === &quot;value1&quot;) {
  r = &quot;value1&quot;;
} else if (value === &quot;value2&quot;) {
  r = &quot;value2&quot;;
} else if (value === &quot;value3&quot;) {
  r = &quot;value3&quot;;
} else if (value === &quot;value4&quot;) {
  r = &quot;value4&quot;;
} else if (value === &quot;value5&quot;) {
  r = &quot;value5&quot;;
} else if (value === &quot;value6&quot;) {
  r = &quot;value6&quot;;
} else if (value === &quot;value7&quot;) {
  r = &quot;value7&quot;;
} else if (value === &quot;value8&quot;) {
  r = &quot;value8&quot;;
} else if (value === &quot;value9&quot;) {
  r = &quot;value9&quot;;
} else if (value === &quot;value10&quot;) {
  r = &quot;value10&quot;;
} else {
  r = &quot;false&quot;;
}


// Switch
switch (value) {
  case &quot;value1&quot;:
    r = &quot;value1&quot;;
    break;
  case &quot;value2&quot;:
    r = &quot;value2&quot;;
    break;
  case &quot;value3&quot;:
    r = &quot;value3&quot;;
    break;
  case &quot;value4&quot;:
    r = &quot;value4&quot;;
    break;
  case &quot;value5&quot;:
    r = &quot;value5&quot;;
    break;
  case &quot;value6&quot;:
    r = &quot;value6&quot;;
    break;
  case &quot;value7&quot;:
    r = &quot;value7&quot;;
    break;
  case &quot;value8&quot;:
    r = &quot;value8&quot;;
    break;
  case &quot;value9&quot;:
    r = &quot;value9&quot;;
    break;
  case &quot;value10&quot;:
    r = &quot;value10&quot;;
    break;
  default:
    r = &quot;false&quot;;
    break;
}


// Ternary operator
r = value === &quot;value1&quot; ? &quot;value1&quot;
  : value === &quot;value2&quot; ? &quot;value2&quot;
  : value === &quot;value3&quot; ? &quot;value3&quot;
  : value === &quot;value4&quot; ? &quot;value4&quot;
  : value === &quot;value5&quot; ? &quot;value5&quot;
  : value === &quot;value6&quot; ? &quot;value6&quot;
  : value === &quot;value7&quot; ? &quot;value7&quot;
  : value === &quot;value8&quot; ? &quot;value8&quot;
  : value === &quot;value9&quot; ? &quot;value9&quot;
  : value === &quot;value10&quot; ? &quot;value10&quot;
  : &quot;false&quot;;


// Logical operator
r = value === &quot;value1&quot; &amp;&amp; &quot;value1&quot;
  || value === &quot;value2&quot; &amp;&amp; &quot;value2&quot;
  || value === &quot;value3&quot; &amp;&amp; &quot;value3&quot;
  || value === &quot;value4&quot; &amp;&amp; &quot;value4&quot;
  || value === &quot;value5&quot; &amp;&amp; &quot;value5&quot;
  || value === &quot;value6&quot; &amp;&amp; &quot;value6&quot;
  || value === &quot;value7&quot; &amp;&amp; &quot;value7&quot;
  || value === &quot;value8&quot; &amp;&amp; &quot;value8&quot;
  || value === &quot;value9&quot; &amp;&amp; &quot;value9&quot;
  || value === &quot;value10&quot; &amp;&amp; &quot;value10&quot;
  || &quot;false&quot;;
</code></pre>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2018/07/11/updated-gas-library---manifestsapp/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2018/07/11/updated-gas-library---manifestsapp/">Updated: GAS Library - ManifestsApp</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2018/07/12/adding-query-parameters-to-url-using-google-apps-script/">Adding Query Parameters to URL using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2018/07/12/adding-query-parameters-to-url-using-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    }
  });
</script>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>
<meta http-equiv="X-UA-Compatible" CONTENT="IE=EmulateIE7" />


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-84325623-1', 'auto');
    ga('send', 'pageview');
  }
</script>





</body>
</html>

