<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.88.1" />

  <title>Benchmark: Process Costs for Searching Values in Spreadsheet using Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Benchmark: Process Costs for Searching Values in Spreadsheet using Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Sep 2020, 11:42</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/benchmark">Benchmark</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/0a6f03970b471ffa286f1dac0b79359e">Gists</a></p>
<h2 id="introduction">Introduction</h2>
<p>Here, I would like to report the process costs for searching values in Spreadsheet using Google Apps Script (GAS). When the values are searched in Google Spreadsheet, the following 3 patterns can be considered. <a href="https://stackoverflow.com/a/56663884">Ref</a></p>
<ol>
<li>Retrieve all values using <code>getValues</code>, and the values are searched from the retrieved array.</li>
<li>Use TextFinder.</li>
<li>Use Query language.</li>
</ol>
<p>In these cases, it has already been found that the lowest process cost is to use the Query language. And about finding values from an array, I have already been reported as &ldquo;<a href="https://gist.github.com/tanaikech/eda9234822b5dec80549216a43c52652">Benchmark: Search for Array Processing using Google Apps Script</a>&rdquo;. But I had never summarized the process costs for TextFinder and find values from an array. So in this report, I would like to introduce this. As the result, the importance of TextFinder for retrieving the row numbers and the row values by searching a value could be understand.</p>
<h2 id="experimental-procedure">Experimental procedure</h2>
<p><img src="https://tanaikech.github.io/img/20200929a-fig1.png" alt=""></p>
<p>4 sample Spreadsheets of the 10,000, 40,000, 70,000 and 100,000 rows and 10 columns were used for measuring the process cost. In each Spreadsheet, the search value is put every 2000 rows, and the search value is set to the column &ldquo;A&rdquo;, &ldquo;E&rdquo; and &ldquo;J&rdquo;. For example, in the case of the sample Spreadsheet of 10,000 rows, the search value is set to the columns &ldquo;A&rdquo;, &ldquo;E&rdquo; and &ldquo;J&rdquo; for 2000, 4000 and 6000 rows, respectively. The process costs to search the search value from these Spreadsheet are measured.</p>
<p>In this experiment, the sample scripts for GAS were used with enabling V8 runtime. The scripts for measuring the search costs of TextFinder and finding values from an array can be seen at Appendix section. <a href="#appendix">Ref</a></p>
<p>By the way, at GAS, the processing time is not stable as you know. So the average value for more than 200 times measurements was used for each data point which is shown by figures. At this time, the fluctuation of the average values was less than 1 %. I worry that each detailed-data point at my environment might be different from that at other userâ€™s environment. But I think that the trend of this result can be used.</p>
<h2 id="results-and-discussions">Results and discussions</h2>
<p><img src="https://tanaikech.github.io/img/20200929a-fig2.png" alt=""></p>
<p>Fig 1. Process costs for retrieving searched row numbers. Blue and red lines are for TextFinder (<a href="#textfinderscript1">script</a>) and find values from array (<a href="#findvaluesfromarray1">script</a>), respectively.
<!-- raw HTML omitted --></p>
<p>From Fig. 1, it is found that when the row numbers are retrieved by searching values, the process cost of TextFinder is lower than that of find values from array. In this case, the cost can be reduced about 55 % for the cost of &ldquo;find value from array&rdquo; in the average.</p>
<p><img src="https://tanaikech.github.io/img/20200929a-fig3.png" alt=""></p>
<p>Fig 2. Process costs for retrieving searched row values. Blue, yellow and red lines are for TextFinder (values from row number. <a href="#textfinderscript2">script</a>), TextFinder (values from getValues in loop. <a href="#textfinderscript3">script</a>) and find values from array (<a href="#findvaluesfromarray2">script</a>), respectively.
<!-- raw HTML omitted --></p>
<p>From Fig. 2, it is found that when the row values are retrieved by searching values, the process cost is different from that of Fig. 1. The cost of TextFinder (values from row number) is higher than that of &ldquo;find value from array&rdquo;. In the case of TextFinder (values from row number), the row values are retrieved from <code>const values = sheet.getDataRange().getValues()</code>. On the other hand, in the case of TextFinder(values from getValues in loop), the cost is lower than that of &ldquo;values from row number&rdquo;. This means that the cost of <code>sheet.getRange(range.getRow(), 1, 1, col).getValues()[0]</code> in the loop is lower than that of method for retrieving the row values using the index of array. This is the interesting result. This result indicates that the size of range strongly affects to the process cost. Because when the range of the same size is retrieved, the cost of <code>getDataRange</code> are almost the same with that of <code>getRange</code>.</p>
<p>As the next step, the process costs of the method for retrieving row numbers and row values are compared. Figure 3 shows the process costs for retrieving searched row numbers and row values in TextFinder.</p>
<p><img src="https://tanaikech.github.io/img/20200929a-fig4.png" alt=""></p>
<p>Fig 3. Process costs for retrieving searched row numbers and row values in TextFinder. Blue and red lines are for the cost for retrieving row numbers <a href="#textfinderscript1">script</a> and row values <a href="#textfinderscript3">script</a>, respectively.
<!-- raw HTML omitted --></p>
<p>When the Fig. 3 is seen, it is found that the cost for retrieving the row numbers is lower than that for retrieving the row values.</p>
<p>Figure 4 shows the process costs for retrieving searched row numbers and row values in &ldquo;find value from array&rdquo;.</p>
<p><img src="https://tanaikech.github.io/img/20200929a-fig5.png" alt=""></p>
<p>Fig 4. Process costs for retrieving searched row numbers and row values in &ldquo;find value from array&rdquo;. Blue and red lines are for the cost for retrieving row numbers <a href="#findvaluesfromarray1">script</a> and row values <a href="#findvaluesfromarray2">script</a>, respectively.
<!-- raw HTML omitted --></p>
<p>When the Fig. 4 is seen, it is found that the cost for retrieving the row numbers is almost the same with that for retrieving the row values. In this case, the difference is that the value or the index are retrieved from the values retrieved with <code>.getDataRange().getValues()</code>. By this, the cost becomes almost the same. But at the TextFinder, only range list is returned from <code>.createTextFinder(findText).findAll()</code>. By this, the cost for retrieving the values from the range list is increased for the method for retrieving the row numbers.</p>
<h2 id="summary">Summary</h2>
<p>In this report, I investigated the process costs of search value from Spreadsheet using TextFinder and the find value from array. From this investigation, the following results could be obtained.</p>
<ol>
<li>When the row numbers of searched rows are required to be retrieved, using TextFinder is suitable.</li>
<li>When the row values are retrieved, both TextFinder and &ldquo;find value from array&rdquo; can be used.
<ul>
<li>In this case, at TextFinder, the cost with <code>getValues()</code> in the loop is lower than that with <code>getValues()</code> outside of the loop.</li>
</ul>
</li>
<li>It is considered that when the range is retrieved from Spreadsheet, the size of range strongly affects to the process cost.</li>
</ol>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h2 id="appendix">Appendix</h2>
<h3 id="scripts">Scripts</h3>
<h4 id="for-textfinder">For TextFinder</h4>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>This is a sample script for measuring the process cost of TextFinder. In this case, the row numbers are retrieved.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">sheetName</span>, <span style="color:#a6e22e">findText</span>) =&gt;
  <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>)
    .<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>)
    .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#a6e22e">findText</span>)
    .<span style="color:#a6e22e">findAll</span>()
    .<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">range</span>) =&gt; <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getRow</span>());
</code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>This is a sample script for measuring the process cost of TextFinder. In this case, the row values are retrieved from <code>sheet.getDataRange().getValues()</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">sheetName</span>, <span style="color:#a6e22e">findText</span>) =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>).<span style="color:#a6e22e">getSheetByName</span>(
    <span style="color:#a6e22e">sheetName</span>
  );
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getDataRange</span>().<span style="color:#a6e22e">getValues</span>();
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">sheet</span>
    .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#a6e22e">findText</span>)
    .<span style="color:#a6e22e">findAll</span>()
    .<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">range</span>) =&gt; <span style="color:#a6e22e">values</span>[<span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getRow</span>() <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>]);
};
</code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>This is a sample script for measuring the process cost of TextFinder. In this case, the row values are retrieved by running <code>sheet.getRange(range.getRow(), 1, 1, col).getValues()[0]</code> in the loop.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">sheetName</span>, <span style="color:#a6e22e">findText</span>) =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>).<span style="color:#a6e22e">getSheetByName</span>(
    <span style="color:#a6e22e">sheetName</span>
  );
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">col</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastColumn</span>();
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">sheet</span>
    .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#a6e22e">findText</span>)
    .<span style="color:#a6e22e">findAll</span>()
    .<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">range</span>) =&gt; <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getRow</span>(), <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">col</span>).<span style="color:#a6e22e">getValues</span>()[<span style="color:#ae81ff">0</span>]);
};
</code></pre></div><h4 id="for-finding-values-from-array">For Finding values from Array</h4>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>This is a sample script for measuring the process cost of finding values from array. In this case, the row numbers are retrieved.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">sheetName</span>, <span style="color:#a6e22e">findText</span>) =&gt;
  <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>)
    .<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>)
    .<span style="color:#a6e22e">getDataRange</span>()
    .<span style="color:#a6e22e">getValues</span>()
    .<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">ar</span>, <span style="color:#a6e22e">row</span>, <span style="color:#a6e22e">i</span>) =&gt; {
      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">row</span>.<span style="color:#a6e22e">indexOf</span>(<span style="color:#a6e22e">findText</span>) <span style="color:#f92672">&gt;</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ar</span>;
    }, []);
</code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>This is a sample script for measuring the process cost of finding values from array. In this case, the row values are retrieved.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">sheetName</span>, <span style="color:#a6e22e">findText</span>) =&gt;
  <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>)
    .<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>)
    .<span style="color:#a6e22e">getDataRange</span>()
    .<span style="color:#a6e22e">getValues</span>()
    .<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">ar</span>, <span style="color:#a6e22e">row</span>) =&gt; {
      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">row</span>.<span style="color:#a6e22e">indexOf</span>(<span style="color:#a6e22e">findText</span>) <span style="color:#f92672">&gt;</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">row</span>);
      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ar</span>;
    }, []);
</code></pre></div><h3 id="sample-script-for-measuring-the-cost">Sample script for measuring the cost:</h3>
<p>Above result could be obtained by the following sample script. When you measure other pattern, you can add them.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pattern1_</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">sheetName</span>, <span style="color:#a6e22e">findText</span>) =&gt; <span style="color:#a6e22e">SpreadsheetApp</span>
  .<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>)
  .<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>)
  .<span style="color:#a6e22e">createTextFinder</span>(<span style="color:#a6e22e">findText</span>)
  .<span style="color:#a6e22e">findAll</span>()
  .<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">range</span> =&gt; <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getRow</span>());

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pattern2_</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">sheetName</span>, <span style="color:#a6e22e">findText</span>) =&gt; <span style="color:#a6e22e">SpreadsheetApp</span>
  .<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>)
  .<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>)
  .<span style="color:#a6e22e">getDataRange</span>()
  .<span style="color:#a6e22e">getValues</span>()
  .<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">ar</span>, <span style="color:#a6e22e">row</span>, <span style="color:#a6e22e">i</span>) =&gt; {
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">row</span>.<span style="color:#a6e22e">indexOf</span>(<span style="color:#a6e22e">findText</span>) <span style="color:#f92672">&gt;</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ar</span>;
  }, []);

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">run</span>() {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">measureSpreadsheetIds</span> <span style="color:#f92672">=</span> [
    {<span style="color:#a6e22e">c</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">10000</span>, <span style="color:#a6e22e">id</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span>},
    {<span style="color:#a6e22e">c</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">40000</span>, <span style="color:#a6e22e">id</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span>},
    {<span style="color:#a6e22e">c</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">70000</span>, <span style="color:#a6e22e">id</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span>},
    {<span style="color:#a6e22e">c</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">100000</span>, <span style="color:#a6e22e">id</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;###&#34;</span>},
  ];
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">functions</span> <span style="color:#f92672">=</span> [
    {<span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;pattern 1&#34;</span>, <span style="color:#a6e22e">f</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">pattern1_</span>},
    {<span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;pattern 2&#34;</span>, <span style="color:#a6e22e">f</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">pattern2_</span>},
  ];
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">functions</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">ar</span>, {<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">f</span>}) =&gt; {
    <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">name</span>);
    <span style="color:#a6e22e">measureSpreadsheetIds</span>.<span style="color:#a6e22e">forEach</span>(({<span style="color:#a6e22e">c</span>, <span style="color:#a6e22e">id</span>}) =&gt; {
      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">processStart</span> <span style="color:#f92672">=</span> Date.<span style="color:#a6e22e">now</span>();
      <span style="color:#a6e22e">f</span>(<span style="color:#a6e22e">id</span>, <span style="color:#e6db74">&#34;Sheet1&#34;</span>, <span style="color:#e6db74">&#34;sampleValue&#34;</span>);
      <span style="color:#a6e22e">ar</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">concat</span>([<span style="color:#a6e22e">c</span>, (Date.<span style="color:#a6e22e">now</span>() <span style="color:#f92672">-</span> <span style="color:#a6e22e">processStart</span>) <span style="color:#f92672">/</span> <span style="color:#ae81ff">1000</span>]);
    });
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ar</span>;
  }, [<span style="color:#66d9ef">new</span> Date()]);
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>)
}
</code></pre></div>
  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2020%2f09%2f30%2fbenchmark-process-costs-for-searching-values-in-spreadsheet-using-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2020%2f09%2f30%2fbenchmark-process-costs-for-searching-values-in-spreadsheet-using-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2020%2f09%2f30%2fbenchmark-process-costs-for-searching-values-in-spreadsheet-using-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2020%2f09%2f30%2fbenchmark-process-costs-for-searching-values-in-spreadsheet-using-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2020%2f09%2f30%2fbenchmark-process-costs-for-searching-values-in-spreadsheet-using-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2020%2f09%2f30%2fbenchmark-process-costs-for-searching-values-in-spreadsheet-using-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2020/09/25/creating-spreadsheet-with-custom-header-and-footer-using-google-apps-script/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2020/09/25/creating-spreadsheet-with-custom-header-and-footer-using-google-apps-script/">Creating Spreadsheet with Custom Header and Footer using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2020/10/04/running-specific-function-when-specific-sheet-is-edited-on-google-spreadsheet/">Running Specific Function When Specific Sheet is Edited on Google Spreadsheet</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2020/10/04/running-specific-function-when-specific-sheet-is-edited-on-google-spreadsheet/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    }
  });
</script>






<script async src="https://www.googletagmanager.com/gtag/js?id=UA-84325623-1"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-84325623-1');
  }
</script>








<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-J3Z6T50WL5');
</script>

</body>
</html>

