<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.61.0" />

  <title>Creating Spreadsheet with Custom Header and Footer using Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Creating Spreadsheet with Custom Header and Footer using Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>25 Sep 2020, 09:52</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/0430c7a8cf28508aa3cb80c22136f7f9">Gists</a></p>
<p>In order to print and export as PDF file, this is a sample script for converting Spreadsheet to Spreadsheet which has the custom header and footer.</p>
<p>In this sample script, <a href="https://github.com/tanaikech/DocsServiceApp">DocsServiceApp</a>, which is Google Apps Script library, is used. And, in this case, <strong>the Spreadsheet with the custom header and footer is created as new Spreadsheet.</strong></p>
<p>Before you use this script, please install <a href="https://github.com/tanaikech/DocsServiceApp">DocsServiceApp</a> and <a href="https://developers.google.com/apps-script/guides/services/advanced#enabling_advanced_services">enable Drive API at Advanced Google services</a>.</p>
<h2 id="sample-script">Sample script:</h2>
<p>Please put this script to the container-bound script of Spreadsheet you want to use.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>() {
  <span style="color:#75715e">// Source Spreadsheet.
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">srcSS</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>();
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">copiedSheets</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">srcSS</span>.<span style="color:#a6e22e">getSheets</span>().<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">s</span>) =&gt; {
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">srcName</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">getSheetName</span>();
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cs</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">copyTo</span>(<span style="color:#a6e22e">srcSS</span>).<span style="color:#a6e22e">setName</span>(<span style="color:#e6db74">&#34;temp_&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">srcName</span>);
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cr</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">cs</span>.<span style="color:#a6e22e">getDataRange</span>();
    <span style="color:#a6e22e">cr</span>.<span style="color:#a6e22e">copyTo</span>(<span style="color:#a6e22e">cr</span>, { <span style="color:#a6e22e">contentsOnly</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> });
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">cs</span>;
  });

  <span style="color:#75715e">// Destination Spreadsheet as temporal.
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {
    <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;newSpreadsheet&#34;</span>,
    <span style="color:#a6e22e">header</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">l</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;left header&#34;</span>, <span style="color:#a6e22e">c</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;center header&#34;</span>, <span style="color:#a6e22e">r</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;right header&#34;</span> },
    <span style="color:#a6e22e">footer</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">l</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;left footer&#34;</span>, <span style="color:#a6e22e">c</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;center footer&#34;</span>, <span style="color:#a6e22e">r</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;right footer&#34;</span> },
  };
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">dstSpreadsheetId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DocsServiceApp</span>.<span style="color:#a6e22e">createNewSpreadsheetWithCustomHeaderFooter</span>(
    <span style="color:#a6e22e">object</span>
  );
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">dstSS</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">dstSpreadsheetId</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">topSheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">dstSS</span>.<span style="color:#a6e22e">getSheets</span>()[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">setName</span>(<span style="color:#a6e22e">Utilities</span>.<span style="color:#a6e22e">getUuid</span>());
  <span style="color:#a6e22e">copiedSheets</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">s</span>) =&gt; {
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">srcName</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">getSheetName</span>().<span style="color:#a6e22e">slice</span>(<span style="color:#ae81ff">5</span>);
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">src</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">copyTo</span>(<span style="color:#a6e22e">dstSS</span>);
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">dst</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">topSheet</span>.<span style="color:#a6e22e">copyTo</span>(<span style="color:#a6e22e">dstSS</span>).<span style="color:#a6e22e">setName</span>(<span style="color:#a6e22e">srcName</span>);
    <span style="color:#a6e22e">src</span>.<span style="color:#a6e22e">getDataRange</span>().<span style="color:#a6e22e">copyTo</span>(<span style="color:#a6e22e">dst</span>.<span style="color:#a6e22e">getDataRange</span>());
    <span style="color:#a6e22e">srcSS</span>.<span style="color:#a6e22e">deleteSheet</span>(<span style="color:#a6e22e">s</span>);
    <span style="color:#a6e22e">dstSS</span>.<span style="color:#a6e22e">deleteSheet</span>(<span style="color:#a6e22e">src</span>);
  });
  <span style="color:#a6e22e">dstSS</span>.<span style="color:#a6e22e">deleteSheet</span>(<span style="color:#a6e22e">dstSS</span>.<span style="color:#a6e22e">getSheets</span>()[<span style="color:#ae81ff">0</span>]);
}
</code></pre></div><ul>
<li>When you run this script, new Spreadsheet is created to the root folder. And when you open the created Spreadsheet, you can see the custom header and footer. <a href="https://github.com/tanaikech/DocsServiceApp#4-createnewspreadsheetwithcustomheaderfooter">Ref</a></li>
</ul>
<h2 id="important">IMPORTANT</h2>
<ul>
<li>When you use this sample script, I would like to recommend to use a sample Spreadsheet.</li>
<li>In the current stage, the custom header and footer cannot be inserted using Spreadsheet service and Sheets API. And it seems that when Google Spreadsheet with the custom header and footer is exported as a PDF data, unfortunately, the custom header and footer cannot be included. When the Spreadsheet is manually exported as a PDF file, the custom header and footer can be included. When <code>sheetnames=true&amp;printtitle=true</code> is added to the query parameter, these can be included in the PDF data. So I thought that in the current stage, the PDF data including the custom header and footer might not be able to be created using a script.</li>
</ul>

  


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2020/09/24/updated-gas-library-imgapp/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2020/09/24/updated-gas-library-imgapp/">Updated: GAS Library - ImgApp</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2020/09/30/benchmark-process-costs-for-searching-values-in-spreadsheet-using-google-apps-script/">Benchmark: Process Costs for Searching Values in Spreadsheet using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2020/09/30/benchmark-process-costs-for-searching-values-in-spreadsheet-using-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    }
  });
</script>


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-84325623-1', 'auto');
    ga('send', 'pageview');
  }
</script>







</body>
</html>

