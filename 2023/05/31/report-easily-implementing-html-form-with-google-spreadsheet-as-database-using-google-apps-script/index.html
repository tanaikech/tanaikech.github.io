<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Report: Easily Implementing HTML Form with Google Spreadsheet as Database using Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fab fa-medium fa-fw"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Report: Easily Implementing HTML Form with Google Spreadsheet as Database using Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>31 May 2023, 10:02</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">Spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">Spreadsheet</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/form">form</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/7dcadf189d9bdfd7dc0ae330ab0d84f5">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230531a/fig1.png" alt=""></p>
<h2 id="abstract">Abstract</h2>
<p>This report introduces the method for easily implementing HTML forms with a Google Spreadsheet as a database using Google Apps Script. There are 2 patterns for the HTML form using Google Apps Script. One is that an HTML form is put into the same Google Apps Script project. Another is that an HTML form is put to a different server from a Google Apps Script project. In this report, the methods for easily implementing both patterns are introduced using the sample scripts.</p>
<h2 id="introduction">Introduction</h2>
<p>You might have a situation that is required to populate the data to a database using an HTML form. In this case, an HTML form with a Google Spreadsheet as a database using Google Apps Script will be useful. There are 2 patterns for the HTML form using Google Apps Script as shown in Figs. 1 and 2.</p>
<p><img src="https://tanaikech.github.io/image-storage/20230531a/fig2.png" alt=""></p>
<p>Fig 1. An HTML form is put into the same Google Apps Script project.</p>
<!-- raw HTML omitted -->
<p><img src="https://tanaikech.github.io/image-storage/20230531a/fig3.png" alt=""></p>
<p>Fig 2. An HTML form is put to a different server from a Google Apps Script project.</p>
<!-- raw HTML omitted -->
<p>In Fig. 1, the HTML form is included in the same Google Apps Script project. In this case, the HTML form can be loaded to the Web Apps, the dialog and the sidebar of Google Docs (Document, Spreadsheet, Slides, and so on). For example, when you want to make users input the values while they are working on a Google Spreadsheet, this pattern is suitable.</p>
<p>In Fig. 2, the HTML form is put to a different server from a Google Apps Script project. In this case, the HTML form is placed on a server outside of Google. For example, this pattern is suitable when you want to put the HTML form on your own site.</p>
<p>In the current stage, there are several official documents for HTML form. <a href="https://developers.google.com/apps-script/guides/html">Ref1</a>, <a href="https://developers.google.com/apps-script/guides/web">Ref2</a>, and <a href="https://developers.google.com/apps-script/guides/html/best-practices">Ref3</a> But, the detailed official documents related to the HTML form with a Google Spreadsheet as a database cannot be found. And, when I see questions on Stackoverflow, a lot of questions related to the HTML form can be seen. Furthermore, I personally have a lot of questions related to this from other users. As one more important point, in the current stage, the multiple files from the input tag with &ldquo;multiple&rdquo; cannot be parsed by &ldquo;google.script.run&rdquo;. Only 1st one file is retrieved. From this situation, it is considered that when the detailed document is published by including the sample scripts, it will be useful for a lot of developers. With this motivation, I have written this report.</p>
<p>I would like to introduce 2 sample scripts for both patterns in this report.</p>
<h2 id="sample-html-form">Sample HTML form</h2>
<p>In this report, the following 2 sample situations are introduced.</p>
<ol>
<li>HTML form on a sidebar of Google Spreadsheet</li>
<li>HTML form on a server outside of Google</li>
</ol>
<p>Both HTML forms are the same. the 5 input tags of 2 text inputs, 1 dropdown list, 1 input file (multiple selections), and a submit button are included in the HTML form. When the values are inputted and the button is clicked, the inputted values are stored in a Google Spreadsheet.</p>
<h2 id="google-apps-script-library-and-javascript-library-for-managing-html-form">Google Apps Script library and Javascript Library for managing HTML form</h2>
<p>I&rsquo;m worried that the script for managing the HTML form with Google Apps Script is complicated a little. I thought that this might be one of the reasons for the bottleneck that the users try to implement the HTML form. And, I thought that when the script is simple, it will help implement the HTML form by a lot of users. So, I created the following 2 libraries.</p>
<ul>
<li>
<p>Google Apps Script library: <a href="https://github.com/tanaikech/HtmlFormApp">HtmlFormApp</a></p>
<ul>
<li>Parsing the form object from the HTML form to the Google Spreadsheet.</li>
</ul>
</li>
<li>
<p>Javascript library: <a href="https://github.com/tanaikech/HtmlFormObjectParserForGoogleAppsScript_js">HtmlFormObjectParserForGoogleAppsScript_js</a></p>
<ul>
<li>Parser for Sending HTML Form Object to Google Apps Script using google.script.run.</li>
</ul>
</li>
</ul>
<p>These libraries can lead to easily implementing HTML forms with simpler scripts.</p>
<h2 id="html-form-on-a-sidebar-of-google-spreadsheet">HTML form on a sidebar of Google Spreadsheet</h2>
<p>In order to test this sample script, please do the following flow.</p>
<h3 id="1-prepare-google-spreadsheet">1. Prepare Google Spreadsheet</h3>
<p>Please create a new Google Spreadsheet. And, open the script editor.</p>
<h3 id="2-install-a-google-apps-script-library">2. Install a Google Apps Script library</h3>
<p>Please install the Google Apps Script library (<a href="https://github.com/tanaikech/HtmlFormApp">HtmlFormApp</a>) with the script editor. You can see the method for installing the library in <a href="https://developers.google.com/apps-script/guides/libraries#add_a_library_to_your_script_project">the official document</a>.</p>
<p>The library key (Script ID shown in the official document) is as follows.</p>
<pre tabindex="0"><code>1uLJrVXGaI-ceHFl_VC1U5jcynKpR2qnNG2tNPd03QJZw1jCcKw2_Oiwh
</code></pre><h3 id="3-sample-script">3. Sample script</h3>
<p>Please copy and paste the following Google Apps Script and HTML to the script editor.</p>
<h4 id="google-apps-script-codegs">Google Apps Script: Code.gs</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// Please run this function. Sidebar is opened on Spreadsheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">openSidebar</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">html</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">HtmlService</span>.<span style="color:#a6e22e">createHtmlOutputFromFile</span>(<span style="color:#e6db74">&#34;index&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getUi</span>().<span style="color:#a6e22e">showSidebar</span>(<span style="color:#a6e22e">html</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// This function is run from the Javascript side.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>(<span style="color:#a6e22e">formData</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheetId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>().<span style="color:#a6e22e">getId</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">HtmlFormApp</span>.<span style="color:#a6e22e">appendFormData</span>({ <span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#a6e22e">formData</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Done&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="html-and-javascript-indexhtml">HTML and Javascript: index.html</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">base</span> <span style="color:#a6e22e">target</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;_top&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>      Text1: &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sampleText1&#34;</span> /&gt;&lt;<span style="color:#f92672">br</span> /&gt;
</span></span><span style="display:flex;"><span>      Text2: &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sampleText2&#34;</span> /&gt;&lt;<span style="color:#f92672">br</span> /&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">select</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sampleDropdown1&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">option</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sampleOption1&#34;</span>&gt;sample1&lt;/<span style="color:#f92672">option</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">option</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sampleOption2&#34;</span>&gt;sample2&lt;/<span style="color:#f92672">option</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">option</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sampleOption3&#34;</span>&gt;sample3&lt;/<span style="color:#f92672">option</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#f92672">select</span>&gt;
</span></span><span style="display:flex;"><span>      File: &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sampleFiles&#34;</span> <span style="color:#a6e22e">multiple</span> /&gt;&lt;<span style="color:#f92672">br</span> /&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">input</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;button&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;run(this);return false;&#34;</span>
</span></span><span style="display:flex;"><span>      /&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/gh/tanaikech/HtmlFormObjectParserForGoogleAppsScript_js/htmlFormObjectParserForGoogleAppsScript_js.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">run</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">ParseFormObjectForGAS</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">parentNode</span>, <span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">google</span>.<span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">run</span>
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">withFailureHandler</span>((<span style="color:#a6e22e">err</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">message</span>))
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">withSuccessHandler</span>((<span style="color:#a6e22e">res</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>))
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">main</span>(<span style="color:#a6e22e">obj</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><h3 id="4-testing">4. Testing</h3>
<p>In order to test this script, please run the function <code>openSidebar</code> with the script editor. By this, the sidebar is opened on the Google Spreadsheet.</p>
<p>When you input texts, select a dropdown list, and select files (less than 50 MB), and then, you click the button, the following flow is run.</p>
<ol>
<li>Parsing the inputted values using <a href="https://github.com/tanaikech/HtmlFormObjectParserForGoogleAppsScript_js">HtmlFormObjectParserForGoogleAppsScript_js</a>.</li>
<li>Send the parsed values to Google Apps Script using &ldquo;<a href="https://developers.google.com/apps-script/guides/html/reference/run">google.script.run</a>&rdquo;.</li>
<li>The values are put into the 1st tab in the Google Spreadsheet using <a href="https://github.com/tanaikech/HtmlFormApp">HtmlFormApp</a>.</li>
</ol>
<p>The uploaded files are put into the root folder as the default. When you want to put the uploaded files into the specific folder, please add <code>folderId: &quot;###folderId###&quot;</code> like <code>HtmlFormApp.appendFormData({ spreadsheetId, formData, folderId: &quot;###folderId###&quot; })</code>. <a href="https://github.com/tanaikech/HtmlFormApp#appendformdata">Ref</a></p>
<p>In the case of 1st submission, the header row is automatically created. After 2nd submission, the values are appended by following the header row. The sample output situation is as follows.</p>
<p><img src="https://tanaikech.github.io/image-storage/20230531a/fig4.png" alt=""></p>
<p>Fig 3. Sample result situation from HTML form.</p>
<!-- raw HTML omitted -->
<h2 id="html-form-on-a-server-outside-of-google">HTML form on a server outside of Google</h2>
<p>In order to test this sample script, please do the following flow.</p>
<h3 id="1-prepare-google-spreadsheet-1">1. Prepare Google Spreadsheet</h3>
<p>Please create a new Google Spreadsheet. And, open the script editor.</p>
<h3 id="2-install-a-google-apps-script-library-1">2. Install a Google Apps Script library</h3>
<p>Please install the Google Apps Script library (<a href="https://github.com/tanaikech/HtmlFormApp">HtmlFormApp</a>) with the script editor. You can see the method for installing the library in <a href="https://developers.google.com/apps-script/guides/libraries#add_a_library_to_your_script_project">the official document</a>.</p>
<p>The library key (Script ID shown in the official document) is as follows.</p>
<pre tabindex="0"><code>1uLJrVXGaI-ceHFl_VC1U5jcynKpR2qnNG2tNPd03QJZw1jCcKw2_Oiwh
</code></pre><h3 id="3-sample-script-1">3. Sample script 1</h3>
<p>Please copy and paste the following Google Apps Script and HTML to the script editor.</p>
<h4 id="google-apps-script-codegs-1">Google Apps Script: Code.gs</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">doPost</span>(<span style="color:#a6e22e">formData</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheetId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>().<span style="color:#a6e22e">getId</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">HtmlFormApp</span>.<span style="color:#a6e22e">appendFormData</span>({ <span style="color:#a6e22e">formData</span>, <span style="color:#a6e22e">spreadsheetId</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ContentService</span>.<span style="color:#a6e22e">createTextOutput</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Done&#34;</span>, <span style="color:#a6e22e">row</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getRow</span>() })
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="4-deploy-web-apps">4. Deploy Web Apps</h3>
<p>Please set this using the script editor as follows. Detailed information can be also seen in <a href="https://developers.google.com/apps-script/guides/web#deploy_a_script_as_a_web_app">the official document</a>.</p>
<ol>
<li>On the script editor, at the top right of the script editor, please click &ldquo;<strong>click Deploy</strong>&rdquo; -&gt; &ldquo;<strong>New deployment</strong>&rdquo;.</li>
<li>Please click &ldquo;<strong>Select type</strong>&rdquo; -&gt; &ldquo;<strong>Web App</strong>&rdquo;.</li>
<li>Please input the information about the Web App in the fields under &ldquo;<strong>Deployment configuration</strong>&rdquo;.</li>
<li>Please select &ldquo;<strong>Me</strong>&rdquo; for &ldquo;<strong>Execute as</strong>&rdquo;.</li>
<li>Please select &ldquo;<strong>Anyone</strong>&rdquo; for &ldquo;<strong>Who has access</strong>&rdquo;.
<ul>
<li>In this case, this setting is used as a simple test.</li>
</ul>
</li>
<li>Please click &ldquo;<strong>Deploy</strong>&rdquo; button.</li>
<li>When &ldquo;The Web App requires you to authorize access to your data.&rdquo; is shown, please click &ldquo;<strong>Authorize access</strong>&rdquo; button. And, please authorize the scopes.</li>
<li>Copy the URL of the Web App. It&rsquo;s like <code>https://script.google.com/macros/s/###/exec</code>. This URL is used for your HTML.</li>
</ol>
<p>By this flow, doPost can be accessed by the HTTP request from outside.</p>
<h3 id="5-sample-script-2">5. Sample script 2</h3>
<p>Please create a new text file by including the following HTML. This is not required to be included in the Google Apps Script project. The inputted values are sent to the Web Apps created by Google Apps Script using the fetch API of Javascript. In this sample, as a test, the HTML is opened by your own browser.</p>
<h4 id="html-and-javascript-indexhtml-1">HTML and Javascript: index.html</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">base</span> <span style="color:#a6e22e">target</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;_top&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>      Text1: &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sampleText1&#34;</span> /&gt;&lt;<span style="color:#f92672">br</span> /&gt;
</span></span><span style="display:flex;"><span>      Text2: &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sampleText2&#34;</span> /&gt;&lt;<span style="color:#f92672">br</span> /&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">select</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sampleDropdown1&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">option</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sampleOption1&#34;</span>&gt;sample1&lt;/<span style="color:#f92672">option</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">option</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sampleOption2&#34;</span>&gt;sample2&lt;/<span style="color:#f92672">option</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">option</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sampleOption3&#34;</span>&gt;sample3&lt;/<span style="color:#f92672">option</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#f92672">select</span>&gt;
</span></span><span style="display:flex;"><span>      File: &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sampleFiles&#34;</span> <span style="color:#a6e22e">multiple</span> /&gt;&lt;<span style="color:#f92672">br</span> /&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">input</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;button&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;run(this);return false;&#34;</span>
</span></span><span style="display:flex;"><span>      /&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/gh/tanaikech/HtmlFormObjectParserForGoogleAppsScript_js/htmlFormObjectParserForGoogleAppsScript_js.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">run</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://script.google.com/macros/s/###/exec&#34;</span>; <span style="color:#75715e">// Please set your Web Apps URL here.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">ParseFormObjectForGAS</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">parentNode</span>, <span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">url</span>, { <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;POST&#34;</span>, <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">obj</span>) })
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">res</span>) =&gt; <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>())
</span></span><span style="display:flex;"><span>          .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">res</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>));
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><h3 id="6-testing">6. Testing</h3>
<p>In order to test this script, please open the HTML with your browser.</p>
<p>When you input texts, select a dropdown list, and select files (less than 50 MB), and then, you click the button, the same flow with the above section is run. There is only one different point from the above section. In this sample, the parsed values are sent to Google Apps Script using the fetch API of Javascript. This makes placing the HTML outside of Google possible. The sample output situation is the same as in Fig. 3.</p>
<h2 id="limitation">Limitation</h2>
<p>In the case of the above sample scripts, there are several limitations.</p>
<ul>
<li>The maximum number of concurrent accesses to Web Apps is 30. <a href="https://developers.google.com/apps-script/guides/services/quotas">Ref</a> When LockService is used, it is 60. <a href="https://tanaikech.github.io/2021/09/15/benchmark-concurrent-writing-to-google-spreadsheet-using-form/">Ref</a> But, in this case, it depends on the processing time of the script. In this report, LockService is not used. When you want to use it, please modify the script.</li>
<li>The maximum file size is 50 MB.</li>
</ul>
<h2 id="note">Note</h2>
<ul>
<li>These sample scripts are simple scripts. Please modify them to your actual situation.</li>
<li>When you modified the Google Apps Script of Web Apps, please modify the deployment as a new version. By this, the modified script is reflected in Web Apps. Please be careful about this.</li>
<li>You can see the detail of this in my report &ldquo;<a href="https://gist.github.com/tanaikech/ebf92d8f427d02d53989d6c3464a9c43">Redeploying Web Apps without Changing URL of Web Apps for new IDE</a>&rdquo;.</li>
<li><a href="https://github.com/tanaikech/HtmlFormApp">HtmlFormApp</a> has <a href="https://github.com/tanaikech/HtmlFormApp#input-object">several useful options</a>. You can use the options.</li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="https://developers.google.com/apps-script/guides/web">Web Apps</a></li>
<li><a href="https://github.com/tanaikech/taking-advantage-of-Web-Apps-with-google-apps-script">Taking advantage of Web Apps with Google Apps Script</a></li>
<li><a href="https://github.com/tanaikech/HtmlFormApp">HtmlFormApp of Google Apps Script library</a></li>
<li><a href="https://github.com/tanaikech/HtmlFormObjectParserForGoogleAppsScript_js">HtmlFormObjectParserForGoogleAppsScript_js of Javascript library</a></li>
<li><a href="https://tanaikech.github.io/2021/09/15/benchmark-concurrent-writing-to-google-spreadsheet-using-form/">Benchmark: Concurrent Writing to Google Spreadsheet using Form</a></li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2023%2f05%2f31%2freport-easily-implementing-html-form-with-google-spreadsheet-as-database-using-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2023%2f05%2f31%2freport-easily-implementing-html-form-with-google-spreadsheet-as-database-using-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f05%2f31%2freport-easily-implementing-html-form-with-google-spreadsheet-as-database-using-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2023%2f05%2f31%2freport-easily-implementing-html-form-with-google-spreadsheet-as-database-using-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f05%2f31%2freport-easily-implementing-html-form-with-google-spreadsheet-as-database-using-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f05%2f31%2freport-easily-implementing-html-form-with-google-spreadsheet-as-database-using-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2023/05/29/updated-gas-library-htmlformapp/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2023/05/29/updated-gas-library-htmlformapp/">Updated: GAS Library - HtmlFormApp</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2023/06/06/trend-of-google-apps-script-tag-on-stackoverflow-in-first-half-of-2023/">Trend of google-apps-script Tag on Stackoverflow in first half of 2023</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2023/06/06/trend-of-google-apps-script-tag-on-stackoverflow-in-first-half-of-2023/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

