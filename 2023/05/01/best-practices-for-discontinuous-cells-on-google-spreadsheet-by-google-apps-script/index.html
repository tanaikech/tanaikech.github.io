<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Best Practices for Discontinuous Cells on Google Spreadsheet by Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter fa-fw"></i>X</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Best Practices for Discontinuous Cells on Google Spreadsheet by Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>01 May 2023, 09:18</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">Spreadsheet</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/benchmark">Benchmark</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/bestpractice">BestPractice</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">Spreadsheet</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/dba916ae25f7351819e062b42bb5be10">Gists</a></p>
<h2 id="abstract">Abstract</h2>
<p>It has already been known that Google Apps Script is a strong tool for managing Google Spreadsheets. When the values are retrieved and/or put for Google Spreadsheet, there is a case that the discontinuous cells are required to be used. This report suggests the Best Practices for processing the discontinuous cells on Google Spreadsheet. From the results of process costs, it could understand the usefulness of using the discontinuous cells with low cost using Sheets API and Class RangeList of Spreadsheet service with Google Apps Script.</p>
<h2 id="introduction">Introduction</h2>
<p>When Google Spreadsheet is used by Google Apps Script, there is a case that the values are retrieved and/or are put for the continuous cells and the discontinuous cells. When continuous cells are used, the values can be retrieved and put for the cells from a single range using &ldquo;getValues&rdquo; and &ldquo;setValues&rdquo; methods in the Spreadsheet service as the typical methods. This has already been published as the official Best Practice of the official document. <a href="https://developers.google.com/apps-script/guides/support/best-practices">Ref</a></p>
<p>On the other hand, for example, in the case that the discontinuous cells are used, when the values are retrieved from 3 ranges like &ldquo;A1:B1&rdquo;, &ldquo;C5:D5&rdquo; and &ldquo;E10:F10&rdquo;, those values are retrieved from the values retrieved from one range of &ldquo;A1:F10&rdquo; and/or are retrieved from those 3 ranges in a loop. In this case, the process cost will become high because of using &ldquo;getValues&rdquo; in the loop process. This situation is not mentioned in the official Best Practices. And also, the questions related to this situation can be often seen in Stackoverflow. Furthermore, there is the maximum execution time of Google Apps Script. From this situation, it is considered that the suggestion of the Best Practice for processing the discontinuous cells on Google Spreadsheet using Google Apps Script will be more useful for a lot of users. This report introduces the Best Practices for processing the continuous cells on Google Spreadsheet with low process cost. Reducing process costs of script leads to sustainability, and also it is very important for modern society to achieve such a situation.</p>
<p>From this report, the following results were obtained.</p>
<ol>
<li>
<p>When the values are retrieved from the discontinuous cells, Sheets API is suitable.</p>
</li>
<li>
<p>When the different values are put into the discontinuous cells, Sheets API is suitable.</p>
</li>
<li>
<p>When the same value is put into the discontinuous cells, the Class RangeList of Spreadsheet service is suitable.</p>
</li>
</ol>
<p>These results could understand the usefulness of discontinuous cells using Sheets API and Class RangeList of Spreadsheet service with Google Apps Script.</p>
<p>In the case of the methods which are introduced in this report, not only the values but also the formulas can be used. And also, the methods using Sheets API can be also applied to the languages except for Google Apps Script.</p>
<h2 id="sample-situations-and-scripts">Sample situations and scripts</h2>
<p>Here, 3 sample situations and scripts using the discontinuous cells are introduced.</p>
<h3 id="1-retrieve-cell-values-from-discontinuous-cells">1. Retrieve cell values from discontinuous cells.</h3>
<p>In this section, it introduces the method for retrieving cell values from the discontinuous cells.</p>
<p>When there is a range list including A1Notation like <code>[&quot;A1:B1&quot;, &quot;B2:C2&quot;, &quot;C3:D3&quot;,,,]</code> and you want to retrieve the values from the ranges of A1Notations, the sample script using the general method is as follows. This sample script puts each value into each range in a loop.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample1A</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheetId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ranges</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;&#39;Sheet1&#39;!A1:B1&#34;</span>, <span style="color:#e6db74">&#34;&#39;Sheet1&#39;!E1:F1&#34;</span>, , ,];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ranges</span>.<span style="color:#a6e22e">reduce</span>(
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">o</span>, <span style="color:#a6e22e">r</span>) =&gt; ((<span style="color:#a6e22e">o</span>[<span style="color:#a6e22e">r</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">r</span>).<span style="color:#a6e22e">getValues</span>()), <span style="color:#a6e22e">o</span>),
</span></span><span style="display:flex;"><span>    {}
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>On the other hand, when Sheets API is used in this situation, the script is as follows. In this case, &ldquo;<a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values/batchGet">Method: spreadsheets.values.batchGet</a>&rdquo; is used. When you use this script, please enable Sheets API at Advanced Google services. In the case of this script, all values from all ranges of A1Notations can be retrieved by one API call.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample1B</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheetId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ranges</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;&#39;Sheet1&#39;!A1:B1&#34;</span>, <span style="color:#e6db74">&#34;&#39;Sheet1&#39;!E1:F1&#34;</span>, , ,];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">valueRanges</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">Sheets</span>.<span style="color:#a6e22e">Spreadsheets</span>.<span style="color:#a6e22e">Values</span>.<span style="color:#a6e22e">batchGet</span>(<span style="color:#a6e22e">spreadsheetId</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ranges</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ranges</span>.<span style="color:#a6e22e">reduce</span>(
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">o</span>, <span style="color:#a6e22e">r</span>, <span style="color:#a6e22e">i</span>) =&gt; ((<span style="color:#a6e22e">o</span>[<span style="color:#a6e22e">r</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">valueRanges</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">values</span>), <span style="color:#a6e22e">o</span>),
</span></span><span style="display:flex;"><span>    {}
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Both sample scripts returns the following value.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;&#39;Sheet1&#39;!A1:B1&#34;</span>:[[<span style="color:#e6db74">&#34;A1&#34;</span>,<span style="color:#e6db74">&#34;B1&#34;</span>]],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;&#39;Sheet1&#39;!E1:F1&#34;</span>:[[<span style="color:#e6db74">&#34;E1&#34;</span>,<span style="color:#e6db74">&#34;F1&#34;</span>]],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;&#39;Sheet1&#39;!I1:J1&#34;</span>:[[<span style="color:#e6db74">&#34;I1&#34;</span>,<span style="color:#e6db74">&#34;J1&#34;</span>]],
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">,</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="2-put-different-values-into-discontinuous-cells">2. Put different values into discontinuous cells.</h3>
<p>In this section, it introduces the method for putting different values into the discontinuous cells.</p>
<p>When there is a range and value like <code>[{&quot;range&quot;:&quot;A1:B1&quot;,&quot;values&quot;:[[&quot;A1&quot;,&quot;B1&quot;]]},{&quot;range&quot;:&quot;B2:C2&quot;,&quot;values&quot;:[[&quot;B2&quot;,&quot;C2&quot;]]},{&quot;range&quot;:&quot;C3:D3&quot;,&quot;values&quot;:[[&quot;C3&quot;,&quot;D3&quot;]]},,,]</code> and you want to put each value to each range, the sample script using the general method is as follows. This sample script puts into each value using each range in a loop.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample2A</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheetId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">range</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#39;Sheet1&#39;!A1:B1&#34;</span>, <span style="color:#a6e22e">values</span><span style="color:#f92672">:</span> [[<span style="color:#e6db74">&#34;A1&#34;</span>, <span style="color:#e6db74">&#34;B1&#34;</span>]] },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">range</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#39;Sheet1&#39;!E1:F1&#34;</span>, <span style="color:#a6e22e">values</span><span style="color:#f92672">:</span> [[<span style="color:#e6db74">&#34;E1&#34;</span>, <span style="color:#e6db74">&#34;F1&#34;</span>]] },
</span></span><span style="display:flex;"><span>    ,
</span></span><span style="display:flex;"><span>    ,
</span></span><span style="display:flex;"><span>  ];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">forEach</span>(({ <span style="color:#a6e22e">range</span>, <span style="color:#a6e22e">values</span> }) =&gt; <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">range</span>).<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">values</span>));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>On the other hand, when Sheets API is used in this situation, the script is as follows. In this case, &ldquo;<a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values/batchUpdate">Method: spreadsheets.values.batchUpdate</a>&rdquo; is used. In the case of this script, each value can be put to each range by multiple ranges with one API call. The detailed process costs are introduced in the next section of this report.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample2B</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheetId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">range</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#39;Sheet1&#39;!A1:B1&#34;</span>, <span style="color:#a6e22e">values</span><span style="color:#f92672">:</span> [[<span style="color:#e6db74">&#34;A1&#34;</span>, <span style="color:#e6db74">&#34;B1&#34;</span>]] },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">range</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#39;Sheet1&#39;!E1:F1&#34;</span>, <span style="color:#a6e22e">values</span><span style="color:#f92672">:</span> [[<span style="color:#e6db74">&#34;E1&#34;</span>, <span style="color:#e6db74">&#34;F1&#34;</span>]] },
</span></span><span style="display:flex;"><span>    ,
</span></span><span style="display:flex;"><span>    ,
</span></span><span style="display:flex;"><span>  ];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Sheets</span>.<span style="color:#a6e22e">Spreadsheets</span>.<span style="color:#a6e22e">Values</span>.<span style="color:#a6e22e">batchUpdate</span>(
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">valueInputOption</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;USER_ENTERED&#34;</span> },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">spreadsheetId</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>It introduces another approach under this situation using Sheets API as follows. The sample script can be seen at <code>sample2C()</code>. In the case of Sheets API, when <code>null</code> value is used, it is not affected by the existing cell value of the destination sheet. <a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values">Ref</a> By this, the values except for <code>null</code> can be put into the destination sheet by a single range with one API call.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample2C</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheetId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    [<span style="color:#e6db74">&#34;A1&#34;</span>, <span style="color:#e6db74">&#34;B1&#34;</span>, <span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;E1&#34;</span>, <span style="color:#e6db74">&#34;F1&#34;</span>, <span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;I1&#34;</span>, <span style="color:#e6db74">&#34;J1&#34;</span>, <span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;M1&#34;</span>, <span style="color:#e6db74">&#34;N1&#34;</span>, <span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;Q1&#34;</span>, <span style="color:#e6db74">&#34;R1&#34;</span>, <span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">null</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;C2&#34;</span>, <span style="color:#e6db74">&#34;D2&#34;</span>, <span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;G2&#34;</span>, <span style="color:#e6db74">&#34;H2&#34;</span>, <span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;K2&#34;</span>, <span style="color:#e6db74">&#34;L2&#34;</span>, <span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;O2&#34;</span>, <span style="color:#e6db74">&#34;P2&#34;</span>, <span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;S2&#34;</span>, <span style="color:#e6db74">&#34;T2&#34;</span>],
</span></span><span style="display:flex;"><span>    ,
</span></span><span style="display:flex;"><span>    ,
</span></span><span style="display:flex;"><span>  ];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Sheets</span>.<span style="color:#a6e22e">Spreadsheets</span>.<span style="color:#a6e22e">Values</span>.<span style="color:#a6e22e">update</span>({ <span style="color:#a6e22e">values</span> }, <span style="color:#a6e22e">spreadsheetId</span>, <span style="color:#e6db74">&#34;Sheet1&#34;</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">valueInputOption</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;USER_ENTERED&#34;</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>As another method for <code>values</code> of <code>sample2C()</code> using the Spreadsheet service, the following flow can be also considered.</p>
<ol>
<li>Retrieve values from the destination sheet using <code>getValues</code>.</li>
<li>Create an array by merging the existing values and new values using <code>setValues</code>.</li>
<li>Put the created array.</li>
</ol>
<p>However, this process has the following problem. If the destination sheet has the values, it is required to retrieve values from the destination sheet. And, when the formulas and the rich texts are included in the destination cells, those cells are overwritten by the values without the formulas and the rich texts. If this method is used, it is required to be chosen by the situation.</p>
<p>When those scripts shown in this section are run, the results of all scripts are the same as shown in Fig. 1.</p>
<!-- raw HTML omitted -->
<p><img src="https://tanaikech.github.io/image-storage/20230501a/fig1.png" alt=""></p>
<p>Fig. 1. Result of spreadsheet image before and after the scripts for putting different values into discontinuous cells is run.</p>
<!-- raw HTML omitted -->
<h3 id="3-put-the-same-values-into-discontinuous-cells">3. Put the same values into discontinuous cells.</h3>
<p>In this section, it introduces the method for putting the same value into the discontinuous cells.</p>
<p>When the same values are put into the discontinuous cells, the same value is used for <code>values</code> of <code>sample2A()</code> and <code>sample2B()</code> in section 2. The process costs are the same. So, here, the sample script is not shown.</p>
<p>In the case of putting the same value to the discontinuous cells, there is a good method. That is <a href="https://developers.google.com/apps-script/reference/spreadsheet/sheet#getrangelista1notations">getRangeList(a1Notations)</a>. This method has been added on April 11, 2018. And, Class RangeList has also been added. <a href="https://developers.google.com/apps-script/releases/2018#april_11_2018">Ref</a> When this method is used, the script can be written as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample3A</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheetId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">rangeList</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;A1:B1&#34;</span>, <span style="color:#e6db74">&#34;E1:F1&#34;</span>, , ,];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sample&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">spreadsheetId</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#e6db74">&#34;Sheet1&#34;</span>).<span style="color:#a6e22e">getRangeList</span>(<span style="color:#a6e22e">rangeList</span>).<span style="color:#a6e22e">setValue</span>(<span style="color:#a6e22e">value</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>After Class RangeList was added, this is the best way for processing not only the same values but also the same style to the discontinuous cells with the low process cost using the Spreadsheet service. For example, this can be applied for clearing the cell contents of the discontinuous cells, and also, for checking and unchecking the checkboxes of the discontinuous cells.</p>
<p>When this script is run, the result is as shown in Fig. 2.</p>
<!-- raw HTML omitted -->
<p><img src="https://tanaikech.github.io/image-storage/20230501a/fig2.png" alt=""></p>
<p>Fig. 2. Result of spreadsheet image before and after the scripts for putting the same value into discontinuous cells is run.</p>
<!-- raw HTML omitted -->
<h2 id="results-and-discussions">Results and discussions</h2>
<p>The process costs of scripts mentioned in the section &ldquo;Sample situations and scripts&rdquo; are shown as follows. In Figs. 3, 4, and 5, the vertical and horizontal axes are the processing time and the number of ranges, respectively. The vertical axis in all figures is the log scale.</p>
<!-- raw HTML omitted -->
<p><img src="https://tanaikech.github.io/image-storage/20230501a/fig3.png" alt=""></p>
<p>Fig. 3. Process times for retrieving cell values from discontinuous cells using Spreadsheet service and Sheets API. The results of <code>sample1A()</code> and <code>sample1B()</code> in the above sample scripts are the orange line and green line, respectively.</p>
<!-- raw HTML omitted -->
<p>Figure 3 shows the process times for retrieving the cell values from the discontinuous cells using the Spreadsheet service and Sheets API. This figure indicates that when <code>getValues</code> of the Spreadsheet service is used in a loop, the process cost is much higher than that using Sheets API. And also, the ratio of increase in the process cost of Spreadsheet service is larger than that of Sheets API. As the specific feature point, in the case of the Spreadsheet service, the processing time is increased with the increase in the number of ranges. On the other hand, the process cost of Sheets API is almost the same by increasing the number of ranges. It is considered that this difference is due to whether the loop process is used.</p>
<!-- raw HTML omitted -->
<p><img src="https://tanaikech.github.io/image-storage/20230501a/fig4.png" alt=""></p>
<p>Fig. 4. Process times for putting different values into discontinuous cells using Spreadsheet service and Sheets API. The results of <code>sample2A()</code>, <code>sample2B()</code> and <code>sample2C()</code> in the above sample scripts are the orange line, green line, and blue line, respectively.</p>
<!-- raw HTML omitted -->
<p>Figure 4 shows the process times for putting the different values into the discontinuous cells using the Spreadsheet service and Sheets API. This figure indicates that when <code>setValues</code> of the Spreadsheet service is used in a loop, the process cost is much higher than that using Sheets API. And also, the ratio of increase in the process cost of Spreadsheet service is larger than that of Sheets API. This is almost the same trend as the flow for retrieving the cell values from the discontinuous cells. In the case of the blue line for <code>sample2C()</code>, it is required to create an array by adding <code>null</code> value. When this method is used, it is required to consider this cost. It is considered that there is also the case that <code>sample2B()</code> with multiple ranges is useful for the process cost. This is an important point.</p>
<!-- raw HTML omitted -->
<p><img src="https://tanaikech.github.io/image-storage/20230501a/fig5.png" alt=""></p>
<p>Fig. 5. Process times for putting the same value into discontinuous cells using Spreadsheet service and Sheets API. The results of <code>sample2B()</code> with the same value, <code>sample2C()</code> with the same value and <code>sample3A()</code> in the above sample scripts are the green line, blue line, and purple line, respectively.</p>
<!-- raw HTML omitted -->
<p>Figure 5 shows the process times for putting the same value into the discontinuous cells using the Spreadsheet service and Sheets API. In this case, the notable feature can be seen. When RangeList of Spreadsheet service is used, the process cost is the lowest of all. Namely, the process cost of RangeList of Spreadsheet service is lower than that of Sheets API. The questions related to the situation that the same value and style are put into the discontinuous cells can be often seen on Stackoverflow. It is considered that taking advantage of RangeList will be more useful for reducing the process cost and being a simpler script.</p>
<h2 id="summary">Summary</h2>
<p>In this report, in order to define the Best Practices for processing discontinuous cells, it has been investigated the efficient process of discontinuous cells on a Google Spreadsheet using Google Apps Script. From this report. the following results were obtained.</p>
<ul>
<li>
<p>When the cell values are retrieved from the discontinuous cells, Sheets API is suitable.</p>
</li>
<li>
<p>When the different values are put into the discontinuous cells, Sheets API is suitable. When the array including the source values and <code>null</code> values can be created at a low cost, Sheets API with a single range is suitable.</p>
</li>
<li>
<p>When the same value is put into the discontinuous cells, the RangeList of Spreadsheet service is suitable.</p>
</li>
</ul>
<p>It is considered that these results are the Best Practices for processing discontinuous cells.</p>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2023%2f05%2f01%2fbest-practices-for-discontinuous-cells-on-google-spreadsheet-by-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2023%2f05%2f01%2fbest-practices-for-discontinuous-cells-on-google-spreadsheet-by-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f05%2f01%2fbest-practices-for-discontinuous-cells-on-google-spreadsheet-by-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2023%2f05%2f01%2fbest-practices-for-discontinuous-cells-on-google-spreadsheet-by-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f05%2f01%2fbest-practices-for-discontinuous-cells-on-google-spreadsheet-by-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f05%2f01%2fbest-practices-for-discontinuous-cells-on-google-spreadsheet-by-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2023/04/20/my-report-has-been-published-at-champion-innovators-content-library/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2023/04/20/my-report-has-been-published-at-champion-innovators-content-library/">My report has been published at Champion Innovators Content Library</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2023/05/11/unpivot-on-google-spreadsheet-using-google-apps-script/">Unpivot on Google Spreadsheet using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2023/05/11/unpivot-on-google-spreadsheet-using-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

