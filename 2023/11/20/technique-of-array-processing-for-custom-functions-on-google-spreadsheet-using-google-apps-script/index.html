<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="Official profile of Kanshi Tanaike, a Google Developer Expert (GDE) in Google Workspace and Physicist. Specializing in Google Apps Script, Gemini API, and innovative IT solutions.">
  <meta name="generator" content="Hugo 0.98.0" />

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tanaikech.github.io/img/og-main.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>tanaike - Google Apps Script, Gemini API Expert & Physicist</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": "tanaike",
  "author": {
    "@type": "Person",
    "name": "Kanshi Tanaike"
  },
  "description": "Technical blog about Google Apps Script, Google API, Node.js and AI.",
  "url": "https://tanaikech.github.io/"
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2026. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Technique of Array Processing for Custom Functions on Google Spreadsheet using Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>20 Nov 2023, 10:53</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/e3f0bf29aad48d6e2e4ca096269e5a9d">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20231120a/fig1.png" alt=""></p>
<h2 id="description">Description</h2>
<p>At Google Spreadsheet, custom functions created by Google Apps Script can be used. <a href="https://developers.google.com/apps-script/guides/sheets/functions">Ref</a> When the custom function is used, the users can create a function for expanding the built-in functions for Spreadsheet. One day, you might have a situation for executing the custom function using an array. For example, under the situation that your custom function uses a single value instead of an array as the argument, when you want to use an array for each argument of the custom function, it is required to modify the original script of the custom function or the function calling the custom function. In this report, I would like to introduce a technique of array processing for the custom functions on Google Spreadsheets.</p>
<h2 id="initial-situation">Initial situation</h2>
<p>As a simple sample situation, it supposes the following situation.</p>
<ul>
<li>Cells &ldquo;A1:A5&rdquo; have the values of &ldquo;a1&rdquo;, &ldquo;a2&rdquo;, &ldquo;a3&rdquo;, &ldquo;a4&rdquo;, and &ldquo;a5&rdquo;, respectively.</li>
<li>Cells &ldquo;B1:B5&rdquo; have the values of &ldquo;b1&rdquo;, &ldquo;b2&rdquo;, &ldquo;b3&rdquo;, &ldquo;b4&rdquo;, and &ldquo;b5&rdquo;, respectively.</li>
</ul>
<p>The script of the sample custom function is as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">SAMPLE</span>(<span style="color:#a6e22e">argument1</span>, <span style="color:#a6e22e">argument2</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ <span style="color:#a6e22e">argument1</span>, <span style="color:#a6e22e">argument2</span> });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When a custom function of <code>=SAMPLE(A1,B1)</code> is put into cell &ldquo;C1&rdquo;, the following result is obtained.</p>
<p><img src="https://tanaikech.github.io/image-storage/20231120a/fig2.png" alt=""></p>
<p>When <code>A1</code> and <code>B1</code> are used as the arguments of <code>SAMPLE</code>, <code>{&quot;argument1&quot;:&quot;a1&quot;,&quot;argument2&quot;:&quot;b1&quot;}</code> is returned. From this result, it is found that the function <code>SAMPLE</code> is run with the values of cells &ldquo;A1&rdquo; and &ldquo;B1&rdquo;. This is a basic result of this sample custom function.</p>
<p>In this report, I would like to introduce several sample results for the array processing using this situation.</p>
<h2 id="using-array-to-custom-function">Using array to custom function</h2>
<p>When a custom function of <code>=ARRAYFORMULA(SAMPLE(A1:A5,B1:B5))</code> is put into cell &ldquo;C1&rdquo;, the following result is obtained.</p>
<p><img src="https://tanaikech.github.io/image-storage/20231120a/fig3.png" alt=""></p>
<p>In this case, the values of &ldquo;A1:A5&rdquo; and &ldquo;B1:B5&rdquo; are <code>[&quot;a1&quot;, &quot;a2&quot;, &quot;a3&quot;, &quot;a4&quot;, &quot;a5&quot;]</code> and <code>[&quot;b1&quot;, &quot;b2&quot;, &quot;b3&quot;, &quot;b4&quot;, &quot;b5&quot;]</code>, respectively. By this, the arguments of <code>argument1</code>, <code>argument2</code> in the script are <code>[&quot;a1&quot;, &quot;a2&quot;, &quot;a3&quot;, &quot;a4&quot;, &quot;a5&quot;]</code> and <code>[&quot;b1&quot;, &quot;b2&quot;, &quot;b3&quot;, &quot;b4&quot;, &quot;b5&quot;]</code>, and such the result is returned. If you want this result, you can use this without modifying the custom function and the script.</p>
<p>However, if your expected result was <code>{&quot;argument1&quot;:&quot;a1&quot;,&quot;argument2&quot;:&quot;b1&quot;}</code>, <code>{&quot;argument1&quot;:&quot;a2&quot;,&quot;argument2&quot;:&quot;b2&quot;}</code>, <code>{&quot;argument1&quot;:&quot;a3&quot;,&quot;argument2&quot;:&quot;b3&quot;}</code>,,, in &ldquo;C1:C5&rdquo;, respectively, it is required to modify the custom function or the script. Each pattern is introduced in the next sections.</p>
<h2 id="modifying-custom-function">Modifying custom function</h2>
<p>In this pattern, the expected result is obtained by modifying the custom function. In this case, it is not required to modify the script.</p>
<p>The modified custom function is as follows.</p>
<pre tabindex="0"><code>=MAP(A1:A5,B1:B5,LAMBDA(value1,value2,SAMPLE(value1,value2)))
</code></pre><p>When this formula is used, the following result is obtained.</p>
<p><img src="https://tanaikech.github.io/image-storage/20231120a/fig4.png" alt=""></p>
<p>From this image, it is found that the expected result could be obtained by using <a href="https://support.google.com/docs/answer/12568985">MAP function</a>.</p>
<h2 id="modifying-script-of-custom-function">Modifying script of custom function</h2>
<p>In this pattern, the final result is obtained by modifying the original script of the custom function. In this case, it is not required to modify the custom function from <code>=ARRAYFORMULA(SAMPLE(A1:A5,B1:B5))</code>.</p>
<p>The modified script is as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">SAMPLE</span>(<span style="color:#a6e22e">argument1</span>, <span style="color:#a6e22e">argument2</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">argument1</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">i</span>) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ <span style="color:#a6e22e">argument1</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span>[<span style="color:#ae81ff">0</span>], <span style="color:#a6e22e">argument2</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">argument2</span>[<span style="color:#a6e22e">i</span>][<span style="color:#ae81ff">0</span>] })
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When a custom function of <code>=ARRAYFORMULA(SAMPLE(A1:A5,B1:B5))</code> is put into cell &ldquo;C1&rdquo;, the following result is obtained.</p>
<p><img src="https://tanaikech.github.io/image-storage/20231120a/fig5.png" alt=""></p>
<p>But, in this modified script, when <code>=SAMPLE(A1,B1)</code> is used, an error like <code>TypeError: argument1.map is not a function</code> occurs. Because the values of &ldquo;A1&rdquo; and &ldquo;B1&rdquo; are not an array. When you want to use both <code>=ARRAYFORMULA(SAMPLE(A1:A5,B1:B5))</code> and <code>=SAMPLE(A1,B1)</code>, the following modification can be used.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">SAMPLE</span>(<span style="color:#a6e22e">argument1</span>, <span style="color:#a6e22e">argument2</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ([<span style="color:#a6e22e">argument1</span>, <span style="color:#a6e22e">argument2</span>].<span style="color:#a6e22e">every</span>((<span style="color:#a6e22e">e</span>) =&gt; Array.<span style="color:#a6e22e">isArray</span>(<span style="color:#a6e22e">e</span>))) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">argument1</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">i</span>) =&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ <span style="color:#a6e22e">argument1</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span>[<span style="color:#ae81ff">0</span>], <span style="color:#a6e22e">argument2</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">argument2</span>[<span style="color:#a6e22e">i</span>][<span style="color:#ae81ff">0</span>] })
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ <span style="color:#a6e22e">argument1</span>, <span style="color:#a6e22e">argument2</span> });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In this case, the following script can be also used.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">SAMPLE</span>(<span style="color:#a6e22e">argument1</span>, <span style="color:#a6e22e">argument2</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ([<span style="color:#a6e22e">argument1</span>, <span style="color:#a6e22e">argument2</span>].<span style="color:#a6e22e">every</span>((<span style="color:#a6e22e">e</span>) =&gt; Array.<span style="color:#a6e22e">isArray</span>(<span style="color:#a6e22e">e</span>))) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">argument1</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">i</span>) =&gt; <span style="color:#a6e22e">SAMPLE</span>(<span style="color:#a6e22e">e</span>[<span style="color:#ae81ff">0</span>], <span style="color:#a6e22e">argument2</span>[<span style="color:#a6e22e">i</span>][<span style="color:#ae81ff">0</span>]));
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ <span style="color:#a6e22e">argument1</span>, <span style="color:#a6e22e">argument2</span> });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="note">Note</h2>
<p>As additional information, in the current stage, when the number of cells is large, the custom function cannot be used because of the current specification of the Spreadsheet. If an error related to the number of cells occurs in the custom function, please directly use the Google Apps Script instead of the custom function as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sheet1&#34;</span>; <span style="color:#75715e">// Please set your sheet name.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">onEdit</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">range</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getSheet</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getSheetName</span>() <span style="color:#f92672">!=</span> <span style="color:#a6e22e">sheetName</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">columnStart</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">myFunction</span>(<span style="color:#a6e22e">sheet</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myFunction</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>().<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#a6e22e">sheetName</span>)
</span></span><span style="display:flex;"><span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">range</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#e6db74">&#34;A1:B&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getLastRow</span>());
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">getValues</span>()
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">map</span>(([<span style="color:#a6e22e">argument1</span>, <span style="color:#a6e22e">argument2</span>]) =&gt; [
</span></span><span style="display:flex;"><span>      [<span style="color:#a6e22e">argument1</span>, <span style="color:#a6e22e">argument2</span>].<span style="color:#a6e22e">includes</span>(<span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">?</span> [<span style="color:#66d9ef">null</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ <span style="color:#a6e22e">argument1</span>, <span style="color:#a6e22e">argument2</span> }),
</span></span><span style="display:flex;"><span>    ]);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">offset</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span>, <span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">values</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When you test this script, please set your sheet name to <code>sheetName</code>, and run <code>myFunction</code>. By this, the result values are put into column &ldquo;C&rdquo;. And also, when you edit the cells &ldquo;A1:A&rdquo; and &ldquo;B1:B&rdquo;, the values of column &ldquo;C&rdquo; are updated by the function <code>onEdit</code> of the simple trigger.</p>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2023%2f11%2f20%2ftechnique-of-array-processing-for-custom-functions-on-google-spreadsheet-using-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2023%2f11%2f20%2ftechnique-of-array-processing-for-custom-functions-on-google-spreadsheet-using-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f11%2f20%2ftechnique-of-array-processing-for-custom-functions-on-google-spreadsheet-using-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2023%2f11%2f20%2ftechnique-of-array-processing-for-custom-functions-on-google-spreadsheet-using-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f11%2f20%2ftechnique-of-array-processing-for-custom-functions-on-google-spreadsheet-using-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f11%2f20%2ftechnique-of-array-processing-for-custom-functions-on-google-spreadsheet-using-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2023/11/13/technique-for-processing-google-spreadsheet-including-merged-cells-using-google-apps-script/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2023/11/13/technique-for-processing-google-spreadsheet-including-merged-cells-using-google-apps-script/">Technique for Processing Google Spreadsheet Including Merged Cells using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2023/11/24/workaround-making-users-edit-protected-cells-using-google-apps-script/">Workaround: Making Users Edit Protected Cells using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2023/11/24/workaround-making-users-edit-protected-cells-using-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

