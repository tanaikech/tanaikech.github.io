<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Flexible Labeling for Gmail using Gemini Pro API with Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>X</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Flexible Labeling for Gmail using Gemini Pro API with Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>19 Dec 2023, 09:19</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/gemini">Gemini</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/ai">AI</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/llm">LLM</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/cdfa63b670b223e482e457703b9cdeb6">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20231219a/fig1.png" alt=""></p>
<h2 id="abstract">Abstract</h2>
<p>The release of Gemini API is expected to expand the future of Google Apps Script. This report introduces a sample script for flexible email labeling in Gmail using Gemini API with Google Apps Script.</p>
<h2 id="introduction">Introduction</h2>
<p>The recent release of the LLM model Gemini as an API on Vertex AI and Google AI Studio opens a world of possibilities. <a href="https://deepmind.google/technologies/gemini/#introduction">Ref</a> and <a href="https://blog.google/technology/ai/google-gemini-ai/#sundar-note">Ref</a> I believe Gemini API significantly expands the potential of Google Apps Script and paves the way for diverse applications. In this report, I present a sample script for flexible email labeling in Gmail using Gemini Pro API with Google Apps Script.</p>
<p>Currently, Gmail email labeling relies on directly checking for specific words. This becomes cumbersome when users want to label emails based on their overall content, requiring manual review and understanding. Flexible labeling promises significant value in managing large volumes of emails. This report delves into the possibility of automating this process with a simple script leveraging Gemini API.</p>
<h2 id="usage">Usage</h2>
<p>In order to test this script, please do the following flow.</p>
<h3 id="1-create-an-api-key">1. Create an API key</h3>
<p>Please access <a href="https://makersuite.google.com/app/apikey">https://makersuite.google.com/app/apikey</a> and create your API key. At that time, please enable Generative Language API at the API console. This API key is used for this sample script.</p>
<p>This official document can be also seen. <a href="https://ai.google.dev/">Ref</a>.</p>
<h3 id="2-create-a-google-apps-script-project">2. Create a Google Apps Script project</h3>
<p>Please create a standalone Google Apps Script project. Of course, this script can be also used with the container-bound script.</p>
<p>And, please open the script editor of the Google Apps Script project.</p>
<h3 id="3-sample-script">3. Sample script</h3>
<p>Please copy and paste the following script to the script editor, set your API key, and save the script.</p>
<p>Also, please modify <code>labalObj</code> to your actual situation.</p>
<p>When you run the function <code>setLabelByGeminiAPI</code>, the script retrieves the recent emails and adds labels using an object <code>labalObj</code>. This function can be run independently. If you want to run this function by the time-driven trigger, please run the function <code>setTimeDrivenTrigger</code>. By this, the function <code>setLabelByGeminiAPI</code> is automatically run every 10 minutes.</p>
<p>This script labels to emails using the object <code>labalObj</code>. In the case of sample value <code>const labalObj = { &quot;academic&quot;: &quot;sampleLabel1&quot;, &quot;finance&quot;: &quot;sampleLabel2&quot;, &quot;advertisement&quot;: &quot;sampleLabel3&quot;, &quot;other&quot;: &quot;INBOX&quot; }</code>, when the email is related to <code>academic</code>, <code>finance</code>, and <code>advertisement</code>, the labels <code>sampleLabel1</code>, <code>sampleLabel2</code>, and <code>sampleLabel3</code> are added, respectively. When the email is not related to <code>academic</code>, <code>finance</code>, and <code>advertisement</code>, the script is stopped.</p>
<p><strong>This sample script uses <code>v1beta</code>. If the version is changed, please modify the endpoint. Also, please confirm the specifications of the new version.</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">setLabelByGeminiAPI</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiKey</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set your API key.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Please set the keywards and the label names of the keywards.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">labalObj</span> <span style="color:#f92672">=</span> { <span style="color:#e6db74">&#34;academic&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sampleLabel1&#34;</span>, <span style="color:#e6db74">&#34;finance&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sampleLabel2&#34;</span>, <span style="color:#e6db74">&#34;advertisement&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sampleLabel3&#34;</span>, <span style="color:#e6db74">&#34;other&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;INBOX&#34;</span> };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">now</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Date();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">nowTime</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">now</span>.<span style="color:#a6e22e">getTime</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">p</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">PropertiesService</span>.<span style="color:#a6e22e">getScriptProperties</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">prev</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;prev&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">prev</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">prev</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">nowTime</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">60</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">60</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">1000</span>; <span style="color:#75715e">// If you run this script for the first time or prev is undefined, emails from your inbox in the past 1 hour are retrieved.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">threads</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">GmailApp</span>.<span style="color:#a6e22e">getInboxThreads</span>().<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">t</span> =&gt; <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">getLastMessageDate</span>().<span style="color:#a6e22e">getTime</span>() <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">prev</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">threads</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">keys</span> <span style="color:#f92672">=</span> Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">labalObj</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">threads</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#a6e22e">t</span> =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">lastMessageDate</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">getLastMessageDate</span>().<span style="color:#a6e22e">getTime</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">lastMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">getMessages</span>().<span style="color:#a6e22e">find</span>(<span style="color:#a6e22e">m</span> =&gt; <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">getDate</span>().<span style="color:#a6e22e">getTime</span>() <span style="color:#f92672">==</span> <span style="color:#a6e22e">lastMessageDate</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">text</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">lastMessage</span>.<span style="color:#a6e22e">getPlainBody</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">q</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`Read the following text and select one of the words of &#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">keys</span>.<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;,&#34;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; related to the text.`</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">apiKey</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">payload</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">contents</span><span style="color:#f92672">:</span> [{ <span style="color:#a6e22e">parts</span><span style="color:#f92672">:</span> [{ <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">q</span> }, { <span style="color:#a6e22e">text</span> }] }] };
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">options</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">payload</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">payload</span>),
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">contentType</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json&#34;</span>,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">url</span>, <span style="color:#a6e22e">options</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">getContentText</span>());
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">candidates</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">candidates</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">content</span>.<span style="color:#a6e22e">parts</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">k</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">candidates</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">content</span>.<span style="color:#a6e22e">parts</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">text</span>.<span style="color:#a6e22e">trim</span>().<span style="color:#a6e22e">toLowerCase</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">kk</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">keys</span>.<span style="color:#a6e22e">find</span>(<span style="color:#a6e22e">e</span> =&gt; <span style="color:#a6e22e">k</span>.<span style="color:#a6e22e">includes</span>(<span style="color:#a6e22e">e</span>)) <span style="color:#f92672">||</span> <span style="color:#e6db74">&#34;other&#34;</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">iif</span> (<span style="color:#a6e22e">kk</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;other&#34;</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">labalObj</span>[<span style="color:#a6e22e">kk</span>]) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">moveToArchive</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">addLabel</span>(<span style="color:#a6e22e">GmailApp</span>.<span style="color:#a6e22e">getUserLabelByName</span>(<span style="color:#a6e22e">labalObj</span>[<span style="color:#a6e22e">kk</span>]));
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">warn</span>(<span style="color:#e6db74">&#34;No response.&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#e6db74">&#34;prev&#34;</span>, <span style="color:#a6e22e">nowTime</span>.<span style="color:#a6e22e">toString</span>());
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">setTimeDrivenTrigger</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">functionName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;setLabelByGeminiAPI&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">getProjectTriggers</span>().<span style="color:#a6e22e">forEach</span>(<span style="color:#a6e22e">t</span> =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">getHandlerFunction</span>() <span style="color:#f92672">==</span> <span style="color:#a6e22e">functionName</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">deleteTrigger</span>(<span style="color:#a6e22e">t</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">newTrigger</span>(<span style="color:#a6e22e">functionName</span>).<span style="color:#a6e22e">timeBased</span>().<span style="color:#a6e22e">everyMinutes</span>(<span style="color:#ae81ff">10</span>).<span style="color:#a6e22e">create</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In this sample, Gemini API selects one of the keys of <code>labalObj</code> by reading the email, and the specific label is used using the selected key. This is an important point of this process.</p>
<p>If you don&rsquo;t want to move the email to the folder of the label, please remove the line of <code>t.moveToArchive();</code>.</p>
<h3 id="4-testing">4. Testing</h3>
<p>When I tested this script for sample emails, the labels were correctly added to about 90 % of emails. However, I think that I have still not been able to test various emails. So, if there is a large number of situations that the labels are not correctly added, I would like to recommend to consider modifying <code>const q = </code>Read the following text and select one of the words of &ldquo;${keys.join(&rdquo;,&quot;)}&quot; related to the text.<code>;</code>. I would like to expect future updates to refine the Gemini API and further improve the overall accuracy.</p>
<h2 id="summary">Summary</h2>
<p>From this result, I believe that Gemini API has the potential to be used for automatic labeling in Gmail.</p>
<h2 id="note">Note</h2>
<ul>
<li>In the current stage, Gemini Pro API can be requested 60 times in 1 minute as the default. <a href="https://cloud.google.com/vertex-ai/docs/generative-ai/migrate/migrate-google-ai#google-ai">Ref</a> Please be careful about this.</li>
</ul>
<h2 id="reference">Reference</h2>
<ul>
<li>
<p><a href="https://ai.google.dev/api/rest/v1beta/models/generateContent">Method: models.generateContent</a></p>
</li>
<li>
<p>In the current stage, Gemini Pro can be freely used. But the official site says that the competitively priced will be given in the future. <a href="https://blog.google/technology/ai/gemini-api-developers-cloud/">Ref</a></p>
</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2023%2f12%2f19%2fflexible-labeling-for-gmail-using-gemini-pro-api-with-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2023%2f12%2f19%2fflexible-labeling-for-gmail-using-gemini-pro-api-with-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f12%2f19%2fflexible-labeling-for-gmail-using-gemini-pro-api-with-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2023%2f12%2f19%2fflexible-labeling-for-gmail-using-gemini-pro-api-with-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f12%2f19%2fflexible-labeling-for-gmail-using-gemini-pro-api-with-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f12%2f19%2fflexible-labeling-for-gmail-using-gemini-pro-api-with-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2023/12/17/automatically-creating-descriptions-of-files-on-google-drive-using-gemini-pro-api-with-google-apps-script/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2023/12/17/automatically-creating-descriptions-of-files-on-google-drive-using-gemini-pro-api-with-google-apps-script/">Automatically Creating Descriptions of Files on Google Drive using Gemini Pro API with Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2023/12/20/expanding-error-messages-of-google-apps-script-using-gemini-pro-api-with-google-apps-script/">Expanding Error Messages of Google Apps Script using Gemini Pro API with Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2023/12/20/expanding-error-messages-of-google-apps-script-using-gemini-pro-api-with-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

