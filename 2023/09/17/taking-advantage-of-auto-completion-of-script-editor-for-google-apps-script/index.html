<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="Official profile of Kanshi Tanaike, a Google Developer Expert (GDE) in Google Workspace and Physicist. Specializing in Google Apps Script, Gemini API, and innovative IT solutions.">
  <meta name="generator" content="Hugo 0.98.0" />

  <meta property="og:title" content="tanaike - Developer Blog">
  <meta property="og:description" content="Leverage Google APIs, GAS, and Gemini with specialized technical insights.">
  <meta property="og:url" content="https://tanaikech.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tanaikech.github.io/img/og-main.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@tanaikech">

  <title>tanaike - Google Apps Script, Gemini API Expert & Physicist</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": "tanaike",
  "author": {
    "@type": "Person",
    "name": "Kanshi Tanaike"
  },
  "description": "Technical blog about Google Apps Script, Google API, Node.js and AI.",
  "url": "https://tanaikech.github.io/"
}
</script>

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-square-x-twitter"></i>X</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://medium.com/@tanaike" rel="me" target="_blank"><i class="fa-brands fa-medium"></i>Medium</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tanaike" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fa-brands fa-github"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://gist.github.com/tanaikech" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Gists</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://dev.to/tanaike" rel="me" target="_blank"><i class="fa-brands fa-dev fa-fw"></i>DEV</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://zenn.dev/tanaike" rel="me" target="_blank"><i class="fas fa-edit fa-fw"></i>Zenn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://devpost.com/tanaike" rel="me" target="_blank"><i class="fas fa-code fa-fw"></i>Devpost</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2026. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Taking Advantage of Auto-completion of Script Editor for Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Sep 2023, 09:41</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/script-editor">script editor</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-api">google api</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/b2f0461c1060b54d2edbd43733708f52">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230917a/fig1.png" alt=""></p>
<h2 id="introduction">Introduction</h2>
<p>This is a report for taking advantage of the auto-completion of the script editor for Google Apps Script.</p>
<p>In the current stage, the auto-completion is implemented in the script editor of Google Apps Script. This auto-completion can be used for not only the built-in classes and methods but also the methods for Javascript. This helps develop scripts and applications very much. In the case of the built-in classes and methods and the methods for Javascript, you can see the detailed specifications of the documents like <a href="https://developers.google.com/apps-script/reference">the official documents</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference">developer.mozilla.org</a>.</p>
<p>Google Apps Script can also use Google APIs like Drive API, Sheets API, and so on. In this case, the users can request APIs by the following 2 patterns.</p>
<ol>
<li>Request directly the endpoint of APIs with the HTTP request.</li>
<li>Request APIs with <a href="https://developers.google.com/apps-script/guides/services/advanced">Advanced Google services</a>.</li>
</ol>
<p>In the case of the former, this can be used by checking the official documents of the APIs. The official documents of the Google APIs are written with detailed information. In the case of the latter, the official document says as follows.</p>
<blockquote>
<p>The script editor&rsquo;s autocomplete function usually provides enough information to get started.</p>
</blockquote>
<p>However, I often see questions related to how to use the APIs with Advanced Google services on Stackoverflow. From this situation, it is considered that when the detailed information for using APIs of Advanced Google services is published, it might be useful for a lot of users. This report introduces the detailed method for simply using Advanced Google services with auto-completion.</p>
<h2 id="auto-completion-of-script-editor">Auto-completion of Script Editor</h2>
<p>As preparation for testing the following situations, please open the script editor of Google Apps Script on your browser. And, enable Sheets API and Drive API at Advanced Google services. As a sample situation, I would like to introduce the auto-completion of the script editor using Sheets API and Drive API.</p>
<h3 id="situation-1">Situation 1</h3>
<p>In this sample situation, <code>Sheets.Spreadsheets.get()</code> is used. <a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/get">Ref: Method: spreadsheets.get</a></p>
<p>When you input &ldquo;Sheets&rdquo; into the script editor, you can see some candidates by the auto-completion of the script editor. And, when you write <code>Sheets.Spreadsheets.get()</code>, you can see detailed information about the &ldquo;get&rdquo; method of &ldquo;Sheets.Spreadsheets&rdquo; in a dialog as following image.</p>
<p><img src="https://tanaikech.github.io/image-storage/20230917a/fig2.gif" alt=""></p>
<p>From this dialog, you can see that the arguments of <code>Sheets.Spreadsheets.get</code> are as follows.</p>
<ul>
<li>1st argument is <code>spreadsheetId: string</code>.</li>
<li>2nd argument is <code>optionalArgs: Object</code>.</li>
</ul>
<p>The value of <code>Sheets_v4.Sheets.V4.Schema.Spreadsheet</code> is returned. Also, you can see the detailed information about this method as follows.</p>
<blockquote>
<p>The spreadsheet to request.</p>
</blockquote>
<blockquote>
<p>Returns the spreadsheet at the given ID. The caller must specify the spreadsheet ID. By default, data within grids is not returned. You can include grid data in one of 2 ways: _ Specify a field mask listing your desired fields using the fields URL parameter in HTTP _ Set the includeGridData URL parameter to true. If a field mask is set, the includeGridData parameter is ignored For large spreadsheets, as a best practice, retrieve only the specific spreadsheet fields that you want. To retrieve only subsets of spreadsheet data, use the ranges URL parameter. Ranges are specified using A1 notation. You can define a single cell (for example, A1) or multiple cells (for example, A1:D5). You can also get cells from other sheets within the same spreadsheet (for example, Sheet2!A1:C4) or retrieve multiple ranges at once (for example, ?ranges=A1:D5&amp;ranges=Sheet2!A1:C4). Limiting the range returns only the portions of the spreadsheet that intersect the requested ranges.</p>
</blockquote>
<p>In order to correspond these values and the official document, please open the official document of &ldquo;<a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/get">Method: spreadsheets.get</a>&rdquo;.</p>
<p>The values of <code>spreadsheetId</code> and <code>optionalArgs</code> are seen in the official document as follows.</p>
<ul>
<li><code>spreadsheetId</code> is the spreadsheet ID of the target Spreadsheet.</li>
<li><code>optionalArgs</code> is <code>ranges[]</code>, <code>includeGridData</code>, and from <code>Object</code> of <code>optionalArgs: Object</code>, it is found that the value of <code>optionalArgs</code> is like <code>{ranges: [&quot;Sheet1!A1&quot;,,,], includeGridData: true}</code>. The value of <code>field</code> is also included in <code>optionalArgs</code>.</li>
</ul>
<p>About the explanation of <code>spreadsheetId</code> and <code>optionalArgs</code>, you can see them as &ldquo;Path parameters&rdquo; and &ldquo;Query parameters&rdquo; in the official document. <code>Sheets_v4.Sheets.V4.Schema.Spreadsheet</code> of the returned value can be seen at <a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets">&ldquo;REST Resource: spreadsheets&rdquo;</a> of the official document.</p>
<h3 id="situation-2">Situation 2</h3>
<p>In this sample situation, <code>Sheets.Spreadsheets.batchUpdate()</code> is used. <a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/batchUpdate">Ref: Method: spreadsheets.batchUpdate</a></p>
<p>When you input &ldquo;Sheets&rdquo; into the script editor, you can see some candidates by the auto-completion of the script editor. And, when you write <code>Sheets.Spreadsheets.batchUpdate()</code>, you can see detailed information on the &ldquo;batchUpdate&rdquo; method of &ldquo;Sheets.Spreadsheets&rdquo; in a dialog as following image.</p>
<p><img src="https://tanaikech.github.io/image-storage/20230917a/fig3.gif" alt=""></p>
<p>From this dialog, you can see that the arguments of <code>Sheets.Spreadsheets.batchUpdate</code> are as follows.</p>
<ul>
<li>1st argument is <code>resource: Sheets_v4.Sheets.V4.Schema.BatchUpdateSpreadsheetRequest</code>.</li>
<li>2nd argument is <code>spreadsheetId: string</code>.</li>
</ul>
<p>In the above image, the 3rd argument is not shown. But, in the case of Google API, the property of <code>fields</code> can be used as the query parameter. So, it is considered that <code>optionalArgs</code> is included as the 3rd argument. I guess that the situation without showing <code>optionalArgs</code> of the 3rd argument might be a bug. For example, when <code>{ fields: &quot;spreadsheetId&quot; }</code> is used as the 3rd argument of <code>Sheets.Spreadsheets.batchUpdate()</code>, only the Spreadsheet ID is returned.</p>
<p>From the above image, you can see the detailed information about <code>Sheets.Spreadsheets.batchUpdate()</code> as follows.</p>
<blockquote>
<p>Applies one or more updates to the spreadsheet. Each request is validated before being applied. If any request is not valid then the entire request will fail and nothing will be applied. Some requests have replies to give you some information about how they are applied. The replies will mirror the requests. For example, if you applied 4 updates and the 3rd one had a reply, then the response will have 2 empty replies, the actual reply, and another empty reply, in that order. Due to the collaborative nature of spreadsheets, it is not guaranteed that the spreadsheet will reflect exactly your changes after this completes, however it is guaranteed that the updates in the request will be applied together atomically. Your changes may be altered with respect to collaborator changes. If there are no collaborators, the spreadsheet should reflect your changes.</p>
</blockquote>
<p>From the official document of &ldquo;<a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/batchUpdate">Method: spreadsheets.batchUpdate</a>&rdquo;, <code>resource</code> can be seen at &ldquo;<a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/batchUpdate#request-body">Request body</a>&rdquo;. spreadsheetId` is the spreadsheet ID of the target Spreadsheet.</p>
<p>When you want to create the request body of <code>resource</code>, there are 2 patterns.</p>
<p>You can create the request body at &ldquo;Try this method&rdquo; in the official document. At &ldquo;Try this method&rdquo;, you can also test the created request body. The created request body can be directly used as the value of <code>resource</code>.</p>
<p>As another approach for creating the request body, you can also do it using the auto-completion of the script editor under Advanced Google services enabled. When Sheets API is used with Advanced Google services, the request body can be created as follows. In this sample, a new sheet is inserted using the Sheets API.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample1</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spreadsheetId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set Spreadsheet ID.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">newSheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sample&#34;</span>; <span style="color:#75715e">// Please set new sheet name.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Create request body.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">addSheetRequest</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Sheets</span>.<span style="color:#a6e22e">newAddSheetRequest</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheetProperties</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Sheets</span>.<span style="color:#a6e22e">newSheetProperties</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sheetProperties</span>.<span style="color:#a6e22e">title</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">newSheetName</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">addSheetRequest</span>.<span style="color:#a6e22e">properties</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheetProperties</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">request</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Sheets</span>.<span style="color:#a6e22e">newRequest</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">addSheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">addSheetRequest</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">requests</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">Sheets</span>.<span style="color:#a6e22e">newBatchUpdateSpreadsheetRequest</span>().<span style="color:#a6e22e">requests</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">request</span>,
</span></span><span style="display:flex;"><span>  ]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Request Sheets API.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Sheets</span>.<span style="color:#a6e22e">Spreadsheets</span>.<span style="color:#a6e22e">batchUpdate</span>({ <span style="color:#a6e22e">requests</span> }, <span style="color:#a6e22e">spreadsheetId</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fields</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;spreadsheetId&#34;</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>); <span style="color:#75715e">// { spreadsheetId: &#39;###&#39; }
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p>Here, in this sample script, <code>requests</code> is <code>[{&quot;addSheet&quot;:{&quot;properties&quot;:{&quot;title&quot;:&quot;sample123&quot;}}}]</code>. It is found that the valid request body can be created. You can create the request body for each Google API using Advanced Google services like this.</p>
<p>Unfortunately, the method for creating the request body using auto-completion with Advanced Google services has never been published in the official document. So, in this case, it is required to use the script by confirming the explanation showing with the auto-completion.</p>
<h3 id="situation-3">Situation 3</h3>
<p>In this sample situation, <code>Drive.Files.insert()</code> is used. <a href="https://developers.google.com/drive/api/reference/rest/v2/files/insert">Ref: Method: files.insert</a> In the current stage, Drive API v2 can be used with Advanced Google services.</p>
<p>When you input &ldquo;Drive&rdquo; into the script editor, you can see some candidates by the auto-completion of the script editor. And, when you write <code>Drive.Files.insert()</code>, you can see detailed information on the &ldquo;insert&rdquo; method of &ldquo;Drive.Files&rdquo; in a dialog as the following image.</p>
<p><img src="https://tanaikech.github.io/image-storage/20230917a/fig4.gif" alt=""></p>
<p>From this dialog, you can see that the arguments of <code>Drive.Files.insert</code> are as follows.</p>
<ul>
<li>1st argument is <code>resource: Drive_v2.Drive.V2.Schema.File</code>.</li>
<li>2nd argument is <code>mediaData: Blob</code>. If you are not required to use Blob, you can set <code>null</code> instead the Blob.</li>
<li>3rd argument is <code>optionalArgs: Object</code>.</li>
</ul>
<p>The value of <code>Drive_v2.Drive.V2.Schema.File</code> is returned. Also, you can see the detailed information about this method as follows.</p>
<blockquote>
<p>Inserts a new file. This method supports an /upload URI and accepts uploaded media with the following characteristics: - Maximum file size: 5,120 GB - Accepted Media MIME types:<em>/</em> Note: Specify a valid MIME type, rather than the literal <em>/</em> value. The literal <em>/</em> is only used to indicate that any valid MIME type can be uploaded. For more information on uploading files, see Upload file data. Apps creating shortcuts with files.insert must specify the MIME type application/vnd.google-apps.shortcut. Apps should specify a file extension in the title property when inserting files with the API. For example, an operation to insert a JPEG file should specify something like &ldquo;title&rdquo;: &ldquo;cat.jpg&rdquo; in the metadata. Subsequent GET requests include the read-only fileExtension property populated with the extension originally specified in the title property. When a Google Drive user requests to download a file, or when the file is downloaded through the sync client, Drive builds a full filename (with extension) based on the title. In cases where the extension is missing, Drive attempts to determine the extension based on the file&rsquo;s MIME type.</p>
</blockquote>
<p>In order to correspond these values and the official document, please open the official document of &ldquo;<a href="https://developers.google.com/drive/api/reference/rest/v2/files/insert">Method: files.insert</a>&rdquo;.</p>
<p>The values of <code>spreadsheetId</code> and <code>optionalArgs</code> are seen in the official document as follows.</p>
<ul>
<li><code>resource</code> is the request body. You can see this in the official document. <a href="https://developers.google.com/drive/api/reference/rest/v2/files#File">Ref</a></li>
<li><code>mediaData</code> is a blob.</li>
<li><code>optionalArgs</code> is the values showing as &ldquo;Query parameters&rdquo; in the official document. <a href="https://developers.google.com/drive/api/reference/rest/v2/files/insert#query-parameters">Ref</a> In this case, please set the values as JSON objects.</li>
</ul>
<p>When you want to create the request body of <code>resource</code>, there are 2 patterns.</p>
<p>You can create the request body at &ldquo;Try this method&rdquo; in the official document. At &ldquo;Try this method&rdquo;, you can also test the created request body. The created request body can be directly used as the value of <code>resource</code>.</p>
<p>As another approach for creating the request body, you can also do it using the auto-completion of the script editor under Advanced Google services enabled. When Drive API is used with Advanced Google services, the request body can be created as follows. In this sample, a new shortcut is created using Drive API.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sample2</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">shortcutName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sample shortcut&#34;</span>; <span style="color:#75715e">// Please set shortcut filename.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">targetFileId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the target ID.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">parentFolderId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set parent folder ID.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Create request body.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">newFile</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">newFile</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">newFile</span>.<span style="color:#a6e22e">title</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">shortcutName</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">newFile</span>.<span style="color:#a6e22e">mimeType</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">MimeType</span>.<span style="color:#a6e22e">SHORTCUT</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">parent</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">newParentReference</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">parent</span>.<span style="color:#a6e22e">id</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">parentFolderId</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">newFile</span>.<span style="color:#a6e22e">parents</span> <span style="color:#f92672">=</span> [<span style="color:#a6e22e">parent</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">newFileShortcutDetails</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">newFileShortcutDetails</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">newFileShortcutDetails</span>.<span style="color:#a6e22e">targetId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">targetFileId</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">newFile</span>.<span style="color:#a6e22e">shortcutDetails</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">newFileShortcutDetails</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Request Drive API.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Drive</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">insert</span>(<span style="color:#a6e22e">newFile</span>, <span style="color:#66d9ef">null</span>, { <span style="color:#a6e22e">fields</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;id&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>); <span style="color:#75715e">// { id: &#39;###&#39; }
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p>Here, in this sample script, <code>newFile</code> is <code>{&quot;title&quot;:&quot;sample shortcut&quot;,&quot;mimeType&quot;:&quot;application/vnd.google-apps.shortcut&quot;,&quot;parents&quot;:[{&quot;id&quot;:&quot;root&quot;}],&quot;shortcutDetails&quot;:{&quot;targetId&quot;:&quot;###&quot;}}</code>. It is found that the valid request body can be created. You can create the request body for each Google API using Advanced Google services like this.</p>
<p>Unfortunately, the method for creating the request body using auto-completion with Advanced Google services has never been published in the official document. So, in this case, it is required to use the script by confirming the explanation showing with the auto-completion.</p>
<h2 id="note">Note</h2>
<p>From the above explanation, it is found that the detailed information for using each method of APIs of Advanced Google services can be confirmed by the auto-completion of the script editor. It is considered that this indicates the importance of the auto-completion of Advanced Google services with the script editor. I believe that if AI-assisted auto-completion is implemented in future updates, it will be more useful and important for developing applications using Google Apps Script. I would like to expect such a situation.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://developers.google.com/apps-script/guides/services/advanced">Advanced Google services</a></li>
<li>I proposed this explanation to <a href="https://stackoverflow.com/a/75480727">this thread on Stackoverflow</a>.</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2023%2f09%2f17%2ftaking-advantage-of-auto-completion-of-script-editor-for-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2023%2f09%2f17%2ftaking-advantage-of-auto-completion-of-script-editor-for-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f09%2f17%2ftaking-advantage-of-auto-completion-of-script-editor-for-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2023%2f09%2f17%2ftaking-advantage-of-auto-completion-of-script-editor-for-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f09%2f17%2ftaking-advantage-of-auto-completion-of-script-editor-for-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f09%2f17%2ftaking-advantage-of-auto-completion-of-script-editor-for-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2023/09/03/copy-date-object-between-google-spreadsheets-with-different-timezone-using-google-apps-script/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2023/09/03/copy-date-object-between-google-spreadsheets-with-different-timezone-using-google-apps-script/">Copy Date Object between Google Spreadsheets with Different Timezone using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2023/10/05/gas-library-scripthistoryapp/">GAS Library - ScriptHistoryApp</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2023/10/05/gas-library-scripthistoryapp/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

