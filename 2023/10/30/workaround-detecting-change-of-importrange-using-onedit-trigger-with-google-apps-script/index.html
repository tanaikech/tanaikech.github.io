<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Workaround: Detecting Change of IMPORTRANGE using OnEdit trigger with Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>X</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Workaround: Detecting Change of IMPORTRANGE using OnEdit trigger with Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Oct 2023, 16:10</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/report">report</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/spreadsheet">spreadsheet</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/workaround">workaround</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/spreadsheet">spreadsheet</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/trigger">trigger</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/0cf57b2684c2ac2c2562b1ec229c9ace">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20231030a/fig1.png" alt=""></p>
<h2 id="abstract">Abstract</h2>
<p>One day, you might have a situation where you are required to update a sheet using Google Apps Script when the cell values retrieved by IMPORTRANGE are changed. This report introduces a workaround for achieving this situation.</p>
<h2 id="introduction">Introduction</h2>
<p>Google Apps Script can be executed by several triggers. <a href="https://developers.google.com/apps-script/guides/triggers">Ref</a> When a cell in a Google Spreadsheet is manually edited, a function of Google Apps Script can be executed by detecting this edit. In most cases, the OnEdit trigger trigger of the simple trigger or the installable trigger is used. When the OnEdit trigger is used, a function can be executed by manually editing a cell. When the function is executed, the function can be run by giving the event object including the information about the edited cell.</p>
<p>Here, there is an important point. The OnEdit trigger is fired only when a cell is manually edited. For example, when a cell is edited by a script and a formula, the OnEdit trigger is not fired. In the case that a cell is edited by a script, the time when the script is run can be used as a trigger. On the other hand, in the case that a cell is updated by a formula, this cannot be directly detected by the OnEdit trigger. This is the current specification. However, there might be a situation where you are required to run a script when a cell is updated by a formula. This report introduces a workaround for achieving this situation.</p>
<p>Here, as a sample situation, I would like to introduce a workaround in which a script is run using the OnEdit trigger when the cell values retrieved with <code>IMPORTRANGE</code> are changed. <code>IMPORTRANGE</code> is one of the sample situations for explaining this workaround. This workaround introduced in this report can be also used for detecting the change of not only <code>IMPORTRANGE</code> but also other formulas. I sometimes saw questions related to this situation in Stackoverflow. So, I thought that when this workaround is introduced, it might be useful for the users.</p>
<h2 id="principle">Principle</h2>
<p>The 2 key factors for achieving this workaround are as follows.</p>
<ul>
<li>OnEdit trigger is fired when a cell is manually edited.</li>
<li>The installable trigger can be also installed by a Google Apps Script project different from the target Google Apps Script project.</li>
</ul>
<p>In the current stage, unfortunately, even when the value of a formula in a cell is changed by recalculating, the OnEdit trigger is not fired because of the current specification. However, it is considered that when the cell of the origin for recalculating the formula is manually edited, the OnEdit trigger can be used by detecting the cell. This workaround uses this situation.</p>
<p>In the case of <code>IMPORTRANGE</code>, the target Spreadsheet is usually different from the active Spreadsheet. In order to detect the origin cells in the target Spreadsheet, the installable OnEdit trigger is used. The installable OnEdit trigger can be also set from a Google Apps Script project outside of the container-bound script of the target Spreadsheet. This specification is also used in this workaround.</p>
<h2 id="sample-situation">Sample situation</h2>
<p>The sample situation is shown in the following image.</p>
<p><img src="https://tanaikech.github.io/image-storage/20231030a/fig2.png" alt=""></p>
<p>The details of this sample situation is as follows.</p>
<ol>
<li>
<p>There are 3 Spreadsheets like &ldquo;MasterSpreadsheet&rdquo;, &ldquo;SourceSpreadsheet1&rdquo;, and &ldquo;SourceSpreadsheet2&rdquo;.</p>
</li>
<li>
<p>A sheet &ldquo;MasterSheet&rdquo; in &ldquo;MasterSpreadsheet&rdquo; has following 2 formulas.</p>
<ul>
<li><code>=IMPORTRANGE(&quot;https://docs.google.com/spreadsheets/d/{spreadsheetId of SourceSpreadsheet1}/edit&quot;,&quot;SourceSheet1!A1:D&quot;)</code> in cell &ldquo;A2&rdquo;</li>
<li><code>=IMPORTRANGE(&quot;https://docs.google.com/spreadsheets/d/{spreadsheetId of SourceSpreadsheet2}/edit&quot;,&quot;SourceSheet2!A1:D&quot;)</code> in cell &ldquo;E2&rdquo;</li>
</ul>
</li>
<li>
<p>Data is retrieved from 2 Spreadsheets of &ldquo;SourceSpreadsheet1&rdquo;, and &ldquo;SourceSpreadsheet2&rdquo; to &ldquo;MasterSheet&rdquo; in &ldquo;MasterSpreadsheet&rdquo;.</p>
</li>
<li>
<p>&ldquo;SourceSheet1!A1:D&rdquo; in &ldquo;SourceSpreadsheet1&rdquo; and &ldquo;SourceSheet2!A1:D&rdquo; in &ldquo;SourceSpreadsheet2&rdquo; are manually edited.</p>
</li>
<li>
<p>When the cell values of <code>=IMPORTRANGE(&quot;https://docs.google.com/spreadsheets/d/{spreadsheetId of SourceSpreadsheet1}/edit&quot;,&quot;SourceSheet1!A1:D&quot;)</code> in cell &ldquo;A2&rdquo; and <code>=IMPORTRANGE(&quot;https://docs.google.com/spreadsheets/d/{spreadsheetId of SourceSpreadsheet2}/edit&quot;,&quot;SourceSheet2!A1:D&quot;)</code> in cell &ldquo;E2&rdquo; are updated, it is required to put the updated date to column &ldquo;I&rdquo; and put the update details to column &ldquo;J&rdquo;.</p>
</li>
</ol>
<p>In this report, this situation is achieved using Google Apps Script as the sample goal of this report.</p>
<h2 id="important">IMPORTANT</h2>
<p>This report introduces the workaround for achieving the above sample goal using a simple script as the methodology. So, when you want to use this workaround to your actual situation, I thin that the script is required to be prepared for your actual situation. Please be careful about this.</p>
<h2 id="usage">Usage</h2>
<p>In this section, it introduces the sample script for achieving the above goal. In order to test this workaround, please do the following flow.</p>
<h3 id="prepare-spreadsheets">Prepare Spreadsheets</h3>
<p>In this sample, 3 Spreadsheets are used. Here, I prepared a script for creating the sample Spreadsheets of this report as follows.</p>
<p>Please access to <a href="https://script.new">https://script.new</a>. By this, the script editor is opened as a new standalone script. Here, copy and paste the following script to the script editor and please give a filename, set your folder ID to <code>folderId</code>, and save the script.</p>
<p>And, please run <code>createSamples()</code> with the script editor. By this, the sample Spreadsheets for using this workaround are created in
the folder of <code>folderId</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">createSamples</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">folderId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set your folder ID. The sample Spreadsheets are created to this folder.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Create MasterSpreadsheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">header</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Spreadsheet title&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Column B&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Column C&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Column D&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Spreadsheet title&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Column B&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Column C&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Column D&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Updated date&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Details&#34;</span>,
</span></span><span style="display:flex;"><span>  ];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">create</span>(<span style="color:#e6db74">&#34;MasterSpreadsheet&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss1</span>.<span style="color:#a6e22e">getSheets</span>()[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">setName</span>(<span style="color:#e6db74">&#34;MasterSheet&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sheet1</span>.<span style="color:#a6e22e">appendRow</span>(<span style="color:#a6e22e">header</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Create SourceSpreadsheets.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ar</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;SourceSpreadsheet1&#34;</span>, <span style="color:#a6e22e">sheetName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;SourceSheet1&#34;</span> },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;SourceSpreadsheet2&#34;</span>, <span style="color:#a6e22e">sheetName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;SourceSheet2&#34;</span> },
</span></span><span style="display:flex;"><span>  ];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">map</span>(({ <span style="color:#a6e22e">title</span>, <span style="color:#a6e22e">sheetName</span> }, <span style="color:#a6e22e">i</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">create</span>(<span style="color:#a6e22e">title</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss2</span>.<span style="color:#a6e22e">getSheets</span>()[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">setName</span>(<span style="color:#a6e22e">sheetName</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">k</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">=</span> [...Array(<span style="color:#ae81ff">10</span>)].<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">i</span>) =&gt; [
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">title</span>,
</span></span><span style="display:flex;"><span>      ...[<span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#e6db74">&#34;b&#34;</span>, <span style="color:#e6db74">&#34;c&#34;</span>].<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span>Array(<span style="color:#a6e22e">k</span>).<span style="color:#a6e22e">fill</span>(<span style="color:#a6e22e">e</span>).<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#e6db74">}${</span><span style="color:#a6e22e">k</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>),
</span></span><span style="display:flex;"><span>    ]);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sheet2</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">values</span>.<span style="color:#a6e22e">length</span>, <span style="color:#a6e22e">values</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">length</span>).<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">values</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ss2</span>;
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Move Spreadsheets to folder.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">folder</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFolderById</span>(<span style="color:#a6e22e">folderId</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#34;root&#34;</span>);
</span></span><span style="display:flex;"><span>  [<span style="color:#a6e22e">ss1</span>, ...<span style="color:#a6e22e">sss</span>].<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">getId</span>()).<span style="color:#a6e22e">moveTo</span>(<span style="color:#a6e22e">folder</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Set formulas to MasterSpreadsheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">token</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">getOAuthToken</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cells</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;A2&#34;</span>, <span style="color:#e6db74">&#34;E2&#34;</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sss</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">i</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sheet1</span>
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">cells</span>[<span style="color:#a6e22e">i</span>])
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">setFormula</span>(<span style="color:#e6db74">`=IMPORTRANGE(&#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">getUrl</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;,&#34;SourceSheet</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">!A1:D&#34;)`</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`https://docs.google.com/spreadsheets/d/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">ss1</span>.<span style="color:#a6e22e">getId</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">/externaldata/addimportrangepermissions?donorDocId=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">getId</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">UrlFetchApp</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">url</span>, {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">url</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;post&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">Authorization</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Bearer </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">token</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span> },
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">muteHttpExceptions</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>([<span style="color:#a6e22e">ss1</span>, ...<span style="color:#a6e22e">sss</span>].<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>) =&gt; ({ [<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">getName</span>()]<span style="color:#f92672">:</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">getId</span>() }))); <span style="color:#75715e">// You can see the Spreadsheet ID of each Spreadsheet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p>When you run <code>createSamples()</code>, 3 Spreadsheets are created. When you open &ldquo;MasterSpreadsheet&rdquo;, &ldquo;SourceSpreadsheet1&rdquo;, and &ldquo;SourceSpreadsheet2&rdquo;, you can see the Spreadsheet shown in &ldquo;Sample situation&rdquo;. These Spreadsheets are used for testing the following script.</p>
<h3 id="sample-script">Sample script</h3>
<p>Please copy and paste the following script to the script editor of &ldquo;MasterSpreadsheet&rdquo;. I think that in this method, the standalone script can be also used. But, in this report. the container-bound script of &ldquo;MasterSpreadsheet&rdquo; is used.</p>
<p>Before you run this script, please set <code>masterSpreadsheetId</code>, <code>sourceSpreadsheet1Id</code>, and <code>sourceSpreadsheet2Id</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// Please set your values to this function.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">variables_</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">masterSpreadsheetId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set spreadsheet ID of &#34;MasterSpreadsheet&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">masterSheetName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;MasterSheet&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sourceSpreadsheet1Id</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set spreadsheet ID of &#34;SourceSpreadsheet1&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sourceSpreadsheet1Range</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SourceSheet1!A1:D&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sourceSpreadsheet2Id</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set spreadsheet ID of &#34;SourceSpreadsheet2&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sourceSpreadsheet2Range</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SourceSheet2!A1:D&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">master</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">masterSpreadsheetId</span>, <span style="color:#a6e22e">masterSheetName</span> },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sources</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>      { <span style="color:#a6e22e">ssId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">sourceSpreadsheet1Id</span>, <span style="color:#a6e22e">a1Notation</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">sourceSpreadsheet1Range</span> },
</span></span><span style="display:flex;"><span>      { <span style="color:#a6e22e">ssId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">sourceSpreadsheet2Id</span>, <span style="color:#a6e22e">a1Notation</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">sourceSpreadsheet2Range</span> },
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// This function is automatically run when the cell of source Spreadsheet 1 or source Spreadsheet 2 is edited.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// Please don&#39;t directly run this function.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">installedOnEdit</span>(<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">e</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;This function is automatically run when the cell of source Spreadsheet 1 or source Spreadsheet 2 is edited. Please don&#39;t directly run this function.&#34;</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">lock</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">LockService</span>.<span style="color:#a6e22e">getScriptLock</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">lock</span>.<span style="color:#a6e22e">tryLock</span>(<span style="color:#ae81ff">350000</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">master</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">masterSpreadsheetId</span>, <span style="color:#a6e22e">masterSheetName</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">sources</span>,
</span></span><span style="display:flex;"><span>      } <span style="color:#f92672">=</span> <span style="color:#a6e22e">variables_</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">range</span>, <span style="color:#a6e22e">source</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">a1Notation</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">sources</span>.<span style="color:#a6e22e">find</span>(({ <span style="color:#a6e22e">ssId</span> }) =&gt; <span style="color:#a6e22e">ssId</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">source</span>.<span style="color:#a6e22e">getId</span>());
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">srcRange</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">source</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">a1Notation</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">getSheet</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">editedSheetName</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheet</span>.<span style="color:#a6e22e">getSheetName</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">columnStart</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">srcRange</span>.<span style="color:#a6e22e">getNumColumns</span>() <span style="color:#f92672">||</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">editedSheetName</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">srcRange</span>.<span style="color:#a6e22e">getSheet</span>().<span style="color:#a6e22e">getSheetName</span>()
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">details</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`row </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">rowStart</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> and column </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">columnStart</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> in &#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">editedSheetName</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; was edited.`</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">masterSheet</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">masterSpreadsheetId</span>).<span style="color:#a6e22e">getSheetByName</span>(
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">masterSheetName</span>
</span></span><span style="display:flex;"><span>        );
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">masterSheet</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">getRange</span>(<span style="color:#a6e22e">range</span>.<span style="color:#a6e22e">rowStart</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">setValues</span>([[<span style="color:#66d9ef">new</span> Date(), <span style="color:#a6e22e">details</span>]]);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> ({ <span style="color:#a6e22e">stack</span> }) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">stack</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">finally</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">lock</span>.<span style="color:#a6e22e">releaseLock</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Done&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;Timeout&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Please run this function.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">functionName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;installedOnEdit&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">getProjectTriggers</span>().<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">t</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">getHandlerFunction</span>() <span style="color:#f92672">==</span> <span style="color:#a6e22e">functionName</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">deleteTrigger</span>(<span style="color:#a6e22e">t</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">sources</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">variables_</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sources</span>.<span style="color:#a6e22e">forEach</span>(({ <span style="color:#a6e22e">ssId</span> }) =&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ScriptApp</span>.<span style="color:#a6e22e">newTrigger</span>(<span style="color:#a6e22e">functionName</span>)
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">forSpreadsheet</span>(<span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">openById</span>(<span style="color:#a6e22e">ssId</span>))
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">onEdit</span>()
</span></span><span style="display:flex;"><span>      .<span style="color:#a6e22e">create</span>()
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Done. As a test, please edit a cell of source Spreadsheet 1 or source Spreadsheet 2.&#34;</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="testing">Testing</h3>
<p><img src="https://tanaikech.github.io/image-storage/20231030a/fig3.png" alt=""></p>
<p>Please run <code>main</code> function with the script editor. By this, the installable OnEdit trigger is installed. After this, in order to test this script, please edit &ldquo;SourceSheet1!A1:D&rdquo; in &ldquo;SourceSpreadsheet1&rdquo; and &ldquo;SourceSheet2!A1:D&rdquo; in &ldquo;SourceSpreadsheet2&rdquo;. By this, you can see that the values are put into columns &ldquo;I&rdquo; and &ldquo;J&rdquo; of &ldquo;MasterSheet&rdquo; in &ldquo;MasterSpreadsheet&rdquo; with the same row of the edited row. The result situation is shown in the above image.</p>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2023%2f10%2f30%2fworkaround-detecting-change-of-importrange-using-onedit-trigger-with-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2023%2f10%2f30%2fworkaround-detecting-change-of-importrange-using-onedit-trigger-with-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f10%2f30%2fworkaround-detecting-change-of-importrange-using-onedit-trigger-with-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2023%2f10%2f30%2fworkaround-detecting-change-of-importrange-using-onedit-trigger-with-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f10%2f30%2fworkaround-detecting-change-of-importrange-using-onedit-trigger-with-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f10%2f30%2fworkaround-detecting-change-of-importrange-using-onedit-trigger-with-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2023/10/26/retrieve-comments-with-emoji-reactions-from-google-documents-google-slides-and-google-spreadsheets-using-google-apps-script/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2023/10/26/retrieve-comments-with-emoji-reactions-from-google-documents-google-slides-and-google-spreadsheets-using-google-apps-script/">Retrieve Comments with Emoji Reactions from Google Documents, Google Slides, and Google Spreadsheets using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2023/11/08/uploading-files-without-authorizing-scopes-by-shared-users-with-dialog-on-google-spreadsheet-using-google-apps-script/">Uploading Files without Authorizing Scopes by Shared Users with Dialog on Google Spreadsheet using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2023/11/08/uploading-files-without-authorizing-scopes-by-shared-users-with-dialog-on-google-spreadsheet-using-google-apps-script/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>






<script src="https://tanaikech.github.io/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

