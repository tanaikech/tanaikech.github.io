<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="google-site-verification" content="1BvDMY90ui0jRLHkrpqdQ_x62h5VNEMuK6mQsDvVQH0" />

  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.98.0" />

  <title>Cooking PDF over Google Apps Script &middot; tanaike</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://tanaikech.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://tanaikech.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://tanaikech.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://tanaikech.github.io/">TANAIKE</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/link/"><i class='fa fa-thumbs-up fa-fw'></i>Links</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/webapps/"><i class='fas fa-toolbox'></i>Web Applications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/donate/"><i class='fas fa-donate'></i>Donate</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tanaikech.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tanaikech" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tanaikech" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/7108653" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Cooking PDF over Google Apps Script</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Aug 2023, 14:42</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/gastips">GasTips</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="https://tanaikech.github.io/topics/jstips">jstips</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/google-apps-script">Google Apps Script</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/pdf">PDF</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://tanaikech.github.io/tags/javascript">Javascript</a>
    
  </div>
  
  

</div>

  <p><a href="https://gist.github.com/tanaikech/42ad6a83322364d0b99ad11260862f04">Gists</a></p>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig1.png" alt=""></p>
<h2 id="abstract">Abstract</h2>
<p>When PDF file can be managed with Google Apps Script, that will lead to the automation process on cloud. In this report, the method for cooking PDF over Google Apps Script.</p>
<h2 id="introduction">Introduction</h2>
<p>Google Apps Script is one of the strong tools for achieving the automation process. When Google Apps Script can be used for the situation, it can be processed with cloud computing. By this, the users are not required to stay on the desks with the PC. One day, there might be a case where you are required to manage PDF files using Google Apps Script. When PDF files can be managed with Google Apps Script, that will be very important for achieving the automation process. Unfortunately, there are no built-in methods for directly managing PDF data using Google Apps Script. Fortunately, after the V8 runtime has been released, several raw Javascript libraries could be used with Google Apps Script. <a href="https://pdf-lib.js.org/">pdf-lib</a> is also one of them. When this is used, PDF data can be cooked over Google Apps Script. In this report, I would like to introduce achieving this using a Google Apps Script library.</p>
<h2 id="install-google-apps-script-library-pdfapp">Install Google Apps Script library: PDFApp</h2>
<p>All sample scripts in this report use PDFApp of a Google Apps Script library.</p>
<p>In order to efficiently manage PDFs, I created a Google Apps Script library (PDFApp). In this post, this library is used. So, please install this library.</p>
<p>You can see how to install it <a href="https://github.com/tanaikech/PDFApp#1-install-library">here</a>. <strong>And also, you can see detailed information about the specification of this library <a href="https://github.com/tanaikech/PDFApp">there</a>.</strong></p>
<p>The project key for installing the library is <strong><code>1Xmtr5XXEakVql7N6FqwdCNdpdijsJOxgqH173JSB0UOwdb0GJYJbnJLk</code></strong>.</p>
<h2 id="original-posts">Original posts</h2>
<p>I have already published several posts as shown in &ldquo;Refference&rdquo; section. I created this library to more efficiently manage PDFs with a simple script by summarising the scripts of these posts.</p>
<h2 id="cooking">Cooking</h2>
<p>The following scripts suppose that you have already installed a Google Apps Script library of PDFApp. Please be careful about this.</p>
<h3 id="export-pages-from-a-pdf">Export pages from a PDF</h3>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig2.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#e6db74">&#34;###fileId of PDF file###&#34;</span>).<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pageNumbers</span> <span style="color:#f92672">=</span> [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">8</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PDFApp</span>.<span style="color:#a6e22e">setPDFBlob</span>(<span style="color:#a6e22e">blob</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">exportPages</span>(<span style="color:#a6e22e">pageNumbers</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">blob</span>) =&gt; <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">blob</span>))
</span></span><span style="display:flex;"><span>  .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">err</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>));
</span></span></code></pre></div><ul>
<li>In this sample, 2, 4, 6, 8, pages are exported. And, a new PDF file is created to the root folder.</li>
</ul>
<h3 id="get-metadata-of-a-pdf">Get metadata of a PDF</h3>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig3.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#e6db74">&#34;###fileId of PDF file###&#34;</span>).<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PDFApp</span>.<span style="color:#a6e22e">setPDFBlob</span>(<span style="color:#a6e22e">blob</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getMetadata</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">res</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>))
</span></span><span style="display:flex;"><span>  .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">err</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>));
</span></span></code></pre></div><ul>
<li>
<p>When this script is run, the metadata is retrieved from the inputted PDF blob.</p>
</li>
<li>
<p>When I tested this script, I noticed that the values of <code>modificationDate</code> and <code>producer</code> might be a bug in pdf-lib. <code>modificationDate</code> returns the execution time. <code>producer</code> always returns pdf-lib (<a href="https://github.com/Hopding/pdf-lib)">https://github.com/Hopding/pdf-lib)</a>. I guessed that this might be a bug in pdf-lib. And, I would like to believe that this will be resolved in the future update.</p>
</li>
</ul>
<h3 id="update-metadata-of-a-pdf">Update metadata of a PDF</h3>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig3.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#e6db74">&#34;###fileId of PDF file###&#34;</span>).<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;sample title&#34;</span>, { <span style="color:#a6e22e">showInWindowTitleBar</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> }], <span style="color:#75715e">// This property is an array.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">subject</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample subject&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">author</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample author&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">creator</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample creator&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">creationDate</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Date(<span style="color:#e6db74">&#34;2023-08-01T00:00:00&#34;</span>), <span style="color:#75715e">// This value is date object.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">modificationDate</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Date(<span style="color:#e6db74">&#34;2023-08-01T10:00:00&#34;</span>), <span style="color:#75715e">// This value is date object.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">keywords</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;sample keyword 1&#34;</span>, <span style="color:#e6db74">&#34;sample keyword 2&#34;</span>, <span style="color:#e6db74">&#34;sample keyword 3&#34;</span>], <span style="color:#75715e">// This property is an array.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">producer</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample producer&#34;</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PDFApp</span>.<span style="color:#a6e22e">setPDFBlob</span>(<span style="color:#a6e22e">blob</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">udpateMetadata</span>(<span style="color:#a6e22e">object</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">newBlob</span>) =&gt; <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">newBlob</span>))
</span></span><span style="display:flex;"><span>  .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">err</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>));
</span></span></code></pre></div><ul>
<li>
<p>When this script is run, the metadata of &ldquo;title&rdquo;, &ldquo;subject&rdquo;, &ldquo;author&rdquo;, &ldquo;creator&rdquo;, &ldquo;creationDate&rdquo;, &ldquo;modificationDate&rdquo;, &ldquo;keywords&rdquo;, and &ldquo;producer&rdquo; is updated. And, after the update is finished, a new PDF file is created in the root folder.</p>
</li>
<li>
<p>The detailed information of each property in the object can be seen at <a href="https://pdf-lib.js.org/docs/api/classes/pdfdocument">https://pdf-lib.js.org/docs/api/classes/pdfdocument</a>.</p>
</li>
</ul>
<h3 id="reorder-pages-of-a-pdf">Reorder pages of a PDF</h3>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig4.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#e6db74">&#34;###fileId of PDF file###&#34;</span>).<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">newOrderOfpages</span> <span style="color:#f92672">=</span> [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">4</span>]; <span style="color:#75715e">// Please set new order of the pages in a PDF file. In this sample, the order of pages of the original PDF file is changed to 3, 1, 2, 5, 4.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ignoreSkippedPages</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>; <span style="color:#75715e">// If this is false, when the PDF has 5 pages and &#34;newOrderOfpages&#34; is &#34;[3, 2]&#34;, the exported PDF file has 5 pages of 3, 2, 1, 4, 5. If this is true, when the PDF has 5 pages and &#34;newOrderOfpages&#34; is &#34;[3, 2]&#34;, the exported PDF file has only 2 pages of 3 and 2.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PDFApp</span>.<span style="color:#a6e22e">setPDFBlob</span>(<span style="color:#a6e22e">blob</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">reorderPages</span>({ <span style="color:#a6e22e">newOrderOfpages</span>, <span style="color:#a6e22e">ignoreSkippedPages</span> })
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">newBlob</span>) =&gt; <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">newBlob</span>))
</span></span><span style="display:flex;"><span>  .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">err</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>));
</span></span></code></pre></div><ul>
<li>
<p>When this script is run, a new PDF file is created with the new order of pages.</p>
</li>
<li>
<p>When the order of pages is changed, I thought that for example, when a PDF file has 5 pages and you want to replace only the 1st page and the 2nd page, the actual exported pages are 2, 1, 3, 4, 5. But, in this script, when <code>ignoreSkippedPages</code> is used as false, this can be achieved by <code>newOrderOfpages</code> of <code>[2, 1]</code>. On the other hand, when <code>ignoreSkippedPages</code> and <code>newOrderOfpages</code> are <code>true</code> and <code>[2, 1]</code>, respectively, a new PDF file with only 2 pages of the 2nd page and the 1st page is created.</p>
</li>
</ul>
<h3 id="merge-pdf-files">Merge PDF files</h3>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig5.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#e6db74">&#34;###fileId of PDF file 1###&#34;</span>).<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#e6db74">&#34;###fileId of PDF file 2###&#34;</span>).<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pdfBlobs</span> <span style="color:#f92672">=</span> [<span style="color:#a6e22e">blob1</span>, <span style="color:#a6e22e">blob2</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PDFApp</span>.<span style="color:#a6e22e">mergePDFs</span>(<span style="color:#a6e22e">pdfBlobs</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">newBlob</span>) =&gt; <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">newBlob</span>))
</span></span><span style="display:flex;"><span>  .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">err</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>));
</span></span></code></pre></div><ul>
<li>
<p>When this script is run, the PDF of <code>blob1</code> and <code>blob2</code> are merged in order.</p>
</li>
<li>
<p>For example, if you want to merge 5 PDF files, please use <code>const pdfBlobs = [blob1, blob2, blob3, blob4, blob5]</code>.</p>
</li>
</ul>
<h3 id="convert-pdf-pages-to-png-files">Convert PDF pages to PNG files</h3>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig6.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#e6db74">&#34;###fileId of PDF file###&#34;</span>).<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PDFApp</span>.<span style="color:#a6e22e">setPDFBlob</span>(<span style="color:#a6e22e">blob</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">convertPDFToPng</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">imageBlobs</span>) =&gt; <span style="color:#a6e22e">imageBlobs</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">b</span>) =&gt; <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">b</span>)))
</span></span><span style="display:flex;"><span>  .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">err</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>));
</span></span></code></pre></div><ul>
<li>
<p>When this script is run, all pages of the PDF of <code>blob</code> are converted to PNG images, and those images are saved as the image files in the root folder.</p>
</li>
<li>
<p>When the number of pages is large, it might be better when the PDF is split by &ldquo;exportPages&rdquo; method.</p>
</li>
</ul>
<h3 id="get-values-from-pdf-form">Get values from PDF form</h3>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig7.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#e6db74">&#34;###fileId of PDF file###&#34;</span>).<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PDFApp</span>.<span style="color:#a6e22e">setPDFBlob</span>(<span style="color:#a6e22e">blob</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">getValuesFromPDFForm</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">res</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>))
</span></span><span style="display:flex;"><span>  .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">err</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>));
</span></span></code></pre></div><ul>
<li>When this script is run, the values are retrieved from all fields of PDF form in the inputted PDF blob.</li>
</ul>
<h4 id="limitations">Limitations</h4>
<p>In the current stage, the fields of the textbox, the checkbox, the dropdown list, and the radio button of the PDF Form can be used.</p>
<h3 id="set-values-to-pdf-form">Set values to PDF form</h3>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig7.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#e6db74">&#34;###fileId of PDF file###&#34;</span>).<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">values</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;textbox.sample1.sample1.page1&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample update text&#34;</span> },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;dropdownlist.sample2.sample1.page1&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample option5&#34;</span> },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;checkbox.sample3.checkbox1.page1&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;checkbox.sample3.checkbox2.page1&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span> },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;checkbox.sample3.checkbox3.page1&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;radiobutton.sample4.page1&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;radiobutton.sample4.radiobutton2.page1&#34;</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">PDFA</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">PDFApp</span>.<span style="color:#a6e22e">setPDFBlob</span>(<span style="color:#a6e22e">blob</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PDFA</span>.<span style="color:#a6e22e">setValuesToPDFForm</span>(<span style="color:#a6e22e">object</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">newBlob</span>) =&gt; <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">newBlob</span>))
</span></span><span style="display:flex;"><span>  .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">err</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>));
</span></span></code></pre></div><ul>
<li>
<p>When this script is run, the values of <code>object</code> are put into each field of PDF form and a new PDF blob is returned.</p>
</li>
<li>
<p>About the names of each field of PDF form, they can be retrieved by &ldquo;getValuesFromPDFForm&rdquo; method.</p>
</li>
<li>
<p>In this sample, the default font is used. When you want to use the standard font and/or the custom font, it can be seen at <a href="https://github.com/tanaikech/PDFApp">the repository of PDFApp</a>.</p>
</li>
</ul>
<h4 id="limitations-1">Limitations</h4>
<p>In the current stage, the fields of the textbox, the checkbox, the dropdown list, and the radio button of the PDF Form can be used.</p>
<h3 id="create-pdf-form-using-google-slide-as-a-template">Create PDF form using Google Slide as a template</h3>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig8.png" alt=""></p>
<h4 id="preparation">Preparation</h4>
<p>In this case, first, please create a Google Slide as a template as follows.</p>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig8b.png" alt=""></p>
<p>In the template slide, please set shapes and please set the shape titles. The shape title is required to be the unique value in the slide. Please be careful about this. The following script converts the template shapes to the fields of the PDF form using the shape titles. The flow of this is as follows.</p>
<ol>
<li>
<p>Create a new Google Slide.</p>
</li>
<li>
<p>Put texts and shapes on the slide.</p>
</li>
<li>
<p>Texts are used as the text in PDF.</p>
</li>
</ol>
<ul>
<li>Shapes are converted to the fields in PDF form.</li>
<li>Set the ID to the shape title (Alt Text).</li>
</ul>
<ol start="4">
<li>There is a rule regarding the format of ID. Please check the section “Rule of shape title (Alt Text)”.</li>
</ol>
<h4 id="rule-of-shape-title-alt-text">Rule of shape title (Alt Text)</h4>
<p>The format of ID (shape title (Alt Text)) is as follows.</p>
<pre tabindex="0"><code>{field type}.{group name}.{field name}
</code></pre><p>When the above sample Google Slide template is used, the IDs of fields of PDF form are as follows.</p>
<ul>
<li>Textbox
<ul>
<li><code>textbox.sample1.sample1</code></li>
<li><code>textbox.sample1.sample2</code></li>
</ul>
</li>
<li>Checkbox
<ul>
<li><code>checkbox.sample2.checkbox1</code></li>
<li><code>checkbox.sample2.checkbox2</code></li>
<li><code>checkbox.sample2.checkbox3</code></li>
</ul>
</li>
<li>Dropdown
<ul>
<li><code>dropdownlist.sample4.sample1</code></li>
</ul>
</li>
<li>Radiobutton
<ul>
<li><code>radiobutton.sample5.radiobutton1</code></li>
<li><code>radiobutton.sample5.radiobutton2</code></li>
<li><code>radiobutton.sample5.radiobutton3</code></li>
</ul>
</li>
</ul>
<p>In the case of <code>radiobutton.sample5.radiobutton1</code>, <code>radiobutton</code> is a type of field. <code>sample5</code> is a group of fields. <code>radiobutton1</code> is a unique name of the group. <code>radiobutton.sample5</code> has 3 fields of <code>radiobutton.sample5.radiobutton1</code>, <code>radiobutton.sample5.radiobutton2</code>, and <code>radiobutton.sample5.radiobutton3</code>.</p>
<h4 id="script">Script</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#e6db74">&#34;###fileId of PDF file###&#34;</span>).<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">templateId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;###&#34;</span>; <span style="color:#75715e">// Please set the file ID of your Google Slide template.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">values</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">shapeTitle</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;textbox.sample1.sample1&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> [{ <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;setText&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample text1&#34;</span> }],
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">shapeTitle</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;checkbox.sample2.checkbox1&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> [{ <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;enableRequired&#34;</span> }],
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">shapeTitle</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;checkbox.sample2.checkbox2&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> [{ <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;enableRequired&#34;</span> }, { <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;check&#34;</span> }],
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">shapeTitle</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;checkbox.sample2.checkbox3&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> [{ <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;enableRequired&#34;</span> }, { <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;check&#34;</span> }],
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">shapeTitle</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;textbox.sample1.sample2&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>        { <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;setText&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample text2&#34;</span> },
</span></span><span style="display:flex;"><span>        { <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;enableMultiline&#34;</span> },
</span></span><span style="display:flex;"><span>        { <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;setFontSize&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;12&#34;</span> },
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">shapeTitle</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;dropdownlist.sample4.sample1&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;setOptions&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;sample option1&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;sample option2&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;sample option3&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;sample option4&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;sample option5&#34;</span>,
</span></span><span style="display:flex;"><span>          ],
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        { <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;enableEditing&#34;</span> },
</span></span><span style="display:flex;"><span>        { <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;enableMultiselect&#34;</span> },
</span></span><span style="display:flex;"><span>        { <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;select&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample option3&#34;</span> },
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">shapeTitle</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;radiobutton.sample5.radiobutton1&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> [{ <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;enableRequired&#34;</span> }],
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">shapeTitle</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;radiobutton.sample5.radiobutton2&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>        { <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;enableRequired&#34;</span> },
</span></span><span style="display:flex;"><span>        { <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;select&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;radiobutton.sample5.radiobutton2&#34;</span> },
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">shapeTitle</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;radiobutton.sample5.radiobutton3&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> [{ <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;enableRequired&#34;</span> }],
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">templateSlide</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#a6e22e">templateId</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">folder</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">templateSlide</span>.<span style="color:#a6e22e">getParents</span>().<span style="color:#a6e22e">next</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">temp</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">templateSlide</span>.<span style="color:#a6e22e">makeCopy</span>(<span style="color:#e6db74">&#34;temp&#34;</span>, <span style="color:#a6e22e">folder</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tempId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">getId</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PDFApp</span>.<span style="color:#a6e22e">createPDFFormBySlideTemplate</span>(<span style="color:#a6e22e">tempId</span>, <span style="color:#a6e22e">object</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">newBlob</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">folder</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">newBlob</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">temp</span>.<span style="color:#a6e22e">setTrashed</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>  })
</span></span><span style="display:flex;"><span>  .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">err</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>));
</span></span></code></pre></div><ul>
<li>
<p>When this script is run, a PDF form is created from Google Slide template.</p>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig8c.png" alt=""></p>
</li>
<li>
<p><code>shapeTitle</code>: Shape title (Alt Text).</p>
</li>
<li>
<p><code>method</code> in <code>methods</code>: Method names of Class PDFCheckBox, PDFDropdown, PDFRadioGroup, and PDFTextField.</p>
</li>
<li>
<p><code>value</code> in <code>methods</code>: Arguments of the methods of Class PDFCheckBox, PDFDropdown, PDFRadioGroup, and PDFTextField.</p>
</li>
<li>
<p>The detailed information about the format of <code>name</code> and each properties can be seen in <a href="https://medium.com/google-cloud/creating-pdf-forms-from-google-slide-template-using-google-apps-script-cef35e7d9822">this post</a>.</p>
</li>
<li>
<p>In this sample, the default font is used. When you want to use the standard font and/or the custom font, it can be seen at <a href="https://github.com/tanaikech/PDFApp">the repository of PDFApp</a>.</p>
</li>
</ul>
<h4 id="limitations-2">Limitations</h4>
<p>In the current stage, the fields of the textbox, the checkbox, the dropdown list, and the radio button of the PDF Form can be created.</p>
<h3 id="embed-objects-into-a-pdf">Embed objects into a PDF</h3>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig9.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">getFileById</span>(<span style="color:#e6db74">&#34;###fileId of PDF file###&#34;</span>).<span style="color:#a6e22e">getBlob</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">page1</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample text1&#34;</span>, <span style="color:#a6e22e">x</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">150</span>, <span style="color:#a6e22e">y</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">635</span>, <span style="color:#a6e22e">size</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">30</span> },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample text2&#34;</span>, <span style="color:#a6e22e">x</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">390</span>, <span style="color:#a6e22e">y</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">602</span>, <span style="color:#a6e22e">size</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">16</span> },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">imageFileId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;### file ID of image file ###&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">x</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">175</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">y</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">340</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">scale</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0.35</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PDFApp</span>.<span style="color:#a6e22e">setPDFBlob</span>(<span style="color:#a6e22e">blob</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">embedObjects</span>(<span style="color:#a6e22e">object</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">newBlob</span>) =&gt; <span style="color:#a6e22e">DriveApp</span>.<span style="color:#a6e22e">createFile</span>(<span style="color:#a6e22e">newBlob</span>))
</span></span><span style="display:flex;"><span>  .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">err</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>));
</span></span></code></pre></div><ul>
<li>
<p>When this script is run, 2 texts and 1 image are embedded to the 1st page of the PDF file with the default font.</p>
<ul>
<li>
<p>From</p>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig9b.png" alt=""></p>
</li>
<li>
<p>To</p>
<p><img src="https://tanaikech.github.io/image-storage/20230817a/fig9c.png" alt=""></p>
</li>
</ul>
</li>
<li>
<p>In this case, <code>object</code> is constructed as follows. By this, you can set the objects for each page.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">page1</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample text1&#34;</span>, <span style="color:#a6e22e">x</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">150</span>, <span style="color:#a6e22e">y</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">635</span>, <span style="color:#a6e22e">size</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">30</span> },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sample text2&#34;</span>, <span style="color:#a6e22e">x</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">390</span>, <span style="color:#a6e22e">y</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">602</span>, <span style="color:#a6e22e">size</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">16</span> },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">imageFileId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;### file ID of image file ###&#34;</span>, <span style="color:#a6e22e">x</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">175</span>, <span style="color:#a6e22e">y</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">340</span>, <span style="color:#a6e22e">scale</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0.35</span> },
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">page2</span><span style="color:#f92672">:</span> [,,,],
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">page3</span><span style="color:#f92672">:</span> [,,,],
</span></span><span style="display:flex;"><span>  ,
</span></span><span style="display:flex;"><span>  ,
</span></span><span style="display:flex;"><span>  ,
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h4 id="limitations-3">Limitations</h4>
<p>In the current stage, the objects of texts and images can be embedded in a PDF.</p>
<h2 id="summary">Summary</h2>
<p>This library (PDFApp) is used as a wrapper for connecting Google Apps Script and <a href="https://pdf-lib.js.org/">pdf-lib</a>. When this library is used, PDF data can be managed more efficiently with a simple script with cloud computing and can help to achieve the automation process.</p>
<h2 id="references">References</h2>
<ul>
<li>
<p>GitHub repository of PDFApp is <a href="https://github.com/tanaikech/PDFApp">here</a>.</p>
</li>
<li>
<p><a href="https://pdf-lib.js.org/">pdf-lib</a></p>
</li>
<li>
<p><a href="https://medium.com/google-cloud/exporting-specific-pages-from-a-pdf-as-a-new-pdf-using-google-apps-script-2f22d07b4618">Exporting Specific Pages From a PDF as a New PDF Using Google Apps Script</a></p>
</li>
<li>
<p><a href="https://medium.com/google-cloud/management-of-pdf-metadata-using-google-apps-script-60fd41f4fc16">Management of PDF Metadata using Google Apps Script</a></p>
</li>
<li>
<p><a href="https://medium.com/google-cloud/changing-order-of-pages-in-pdf-file-using-google-apps-script-f6b3de05d7df">Changing Order of Pages in PDF file using Google Apps Script</a></p>
</li>
<li>
<p><a href="https://tanaikech.github.io/2023/01/10/merging-multiple-pdf-files-as-a-single-pdf-file-using-google-apps-script/">Merging Multiple PDF Files as a Single PDF File using Google Apps Script</a></p>
</li>
<li>
<p><a href="https://tanaikech.github.io/2023/01/11/converting-all-pages-in-pdf-file-to-png-images-using-google-apps-script/">Converting All Pages in PDF File to PNG Images using Google Apps Script</a></p>
</li>
<li>
<p><a href="https://medium.com/google-cloud/retrieving-and-putting-values-for-pdf-forms-using-google-apps-script-92412a7cf0af">Retrieving and Putting Values for PDF Forms using Google Apps Script</a></p>
</li>
<li>
<p><a href="https://medium.com/google-cloud/creating-pdf-forms-from-google-slide-template-using-google-apps-script-cef35e7d9822">Creating PDF Forms from Google Slide Template using Google Apps Script</a></p>
</li>
<li>
<p><a href="https://medium.com/google-cloud/embedding-objects-in-pdf-using-google-apps-script-ddbee857c642">Embedding Objects in PDF using Google Apps Script</a></p>
</li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanaikech.github.io%2f2023%2f08%2f17%2fcooking-pdf-over-google-apps-script%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2ftanaikech.github.io%2f2023%2f08%2f17%2fcooking-pdf-over-google-apps-script%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f08%2f17%2fcooking-pdf-over-google-apps-script%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2ftanaikech.github.io%2f2023%2f08%2f17%2fcooking-pdf-over-google-apps-script%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f08%2f17%2fcooking-pdf-over-google-apps-script%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2ftanaikech.github.io%2f2023%2f08%2f17%2fcooking-pdf-over-google-apps-script%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://tanaikech.github.io/2023/08/13/benchmark-efficiently-deleting-rows-by-conditions-on-google-spreadsheet-using-google-apps-script/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://tanaikech.github.io/2023/08/13/benchmark-efficiently-deleting-rows-by-conditions-on-google-spreadsheet-using-google-apps-script/">Benchmark: Efficiently Deleting Rows by Conditions on Google Spreadsheet using Google Apps Script</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://tanaikech.github.io/2023/08/17/gas-library-pdfapp/">GAS Library - PDFApp</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://tanaikech.github.io/2023/08/17/gas-library-pdfapp/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="https://tanaikech.github.io/js/ui.js"></script>
<script src="https://tanaikech.github.io/js/menus.js"></script>






<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3Z6T50WL5"></script>
<script>
  
  if (window.location.hostname != "localhost") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J3Z6T50WL5');
  }
</script>








</body>
</html>

